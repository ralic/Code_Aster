# MODIF  DATE 27/05/2003   AUTEUR D6BHHJP J.P.LEFEBVRE 
# TITRE CHOC THERMIQUE SUR UN MUR INFINI QUAD8 - TEMP_INIT
#            CONFIGURATION MANAGEMENT OF EDF VERSION
# ======================================================================
# COPYRIGHT (C) 1991 - 2001  EDF R&D                  WWW.CODE-ASTER.ORG
# THIS PROGRAM IS FREE SOFTWARE; YOU CAN REDISTRIBUTE IT AND/OR MODIFY
# IT UNDER THE TERMS OF THE GNU GENERAL PUBLIC LICENSE AS PUBLISHED BY
# THE FREE SOFTWARE FOUNDATION; EITHER VERSION 2 OF THE LICENSE, OR   
# (AT YOUR OPTION) ANY LATER VERSION.                                 
#
# THIS PROGRAM IS DISTRIBUTED IN THE HOPE THAT IT WILL BE USEFUL, BUT 
# WITHOUT ANY WARRANTY; WITHOUT EVEN THE IMPLIED WARRANTY OF          
# MERCHANTABILITY OR FITNESS FOR A PARTICULAR PURPOSE. SEE THE GNU    
# GENERAL PUBLIC LICENSE FOR MORE DETAILS.                            
#
# YOU SHOULD HAVE RECEIVED A COPY OF THE GNU GENERAL PUBLIC LICENSE   
# ALONG WITH THIS PROGRAM; IF NOT, WRITE TO EDF R&D CODE_ASTER,       
#    1 AVENUE DU GENERAL DE GAULLE, 92141 CLAMART CEDEX, FRANCE.      
# ======================================================================
#CAS_TEST__: TTLL01B
# CAS TEST TTLL01B
#
#  CAS 2D AVEC CHOC VERITABLE POUR TESTER TEMP_INI.
#
#

DEBUT( CODE=_F( NOM = 'TTLL01B',NIV_PUB_WEB='INTERNET'))

MAIL=LIRE_MAILLAGE( )

TIMPVAR=DEFI_CONSTANTE(   NOM_RESU='TEMP',    VALE=100.0E0 )

ACIER=DEFI_MATERIAU( THER=_F(  LAMBDA = 1.0, RHO_CP = 1.0))

CHMAT=AFFE_MATERIAU(  MAILLAGE=MAIL,
                AFFE=_F(  TOUT = 'OUI', MATER = ACIER) )

MOTH=AFFE_MODELE(  MAILLAGE=MAIL,
                      AFFE=_F( TOUT = 'OUI', MODELISATION = 'PLAN',
                                      PHENOMENE = 'THERMIQUE'))

#

TEMP0=CREA_CHAMP( OPERATION='AFFE', TYPE_CHAM='NOEU_TEMP_R', 
MAILLAGE=MAIL,
                   AFFE=_F(   TOUT = 'OUI', NOM_CMP = 'TEMP', VALE = 0.0E0)
                        )

# ---------------------------------------------------------------------


CHTH=AFFE_CHAR_THER_F(MODELE=MOTH,
          TEMP_IMPO=_F( GROUP_NO = 'GRNM14', TEMP = TIMPVAR)
         )

LR8=DEFI_LIST_REEL(        DEBUT=0.,INTERVALLE=(
       _F(    JUSQU_A = 1.E-3, NOMBRE = 10),
       _F(    JUSQU_A = 1.E-2, NOMBRE = 9),
       _F(    JUSQU_A = 1.E-1, NOMBRE = 9),
       _F(    JUSQU_A = 1.E0,  NOMBRE = 9),
       _F(    JUSQU_A = 2.0,   NOMBRE = 10))
                       )

TEMPE=THER_LINEAIRE(        MODELE=MOTH,
           TEMP_INIT=_F( CHAM_NO = TEMP0),
          INCREMENT=_F( LIST_INST = LR8),
             CHAM_MATER=CHMAT, EXCIT=_F( CHARGE = CHTH)
             )

TEMP_1=CREA_CHAMP( OPERATION='EXTR', TYPE_CHAM='NOEU_TEMP_R',
RESULTAT=TEMPE, NOM_CHAM='TEMP',
             INST=0.1 )

TEMP_2=CREA_CHAMP( OPERATION='EXTR', TYPE_CHAM='NOEU_TEMP_R',
RESULTAT=TEMPE, NOM_CHAM='TEMP',
             INST=0.2 )

TEMP_3=CREA_CHAMP( OPERATION='EXTR', TYPE_CHAM='NOEU_TEMP_R',
RESULTAT=TEMPE, NOM_CHAM='TEMP',
             INST=0.7 )

TEMP_4=CREA_CHAMP( OPERATION='EXTR', TYPE_CHAM='NOEU_TEMP_R',
RESULTAT=TEMPE, NOM_CHAM='TEMP',
             INST=2.0 )

TEST_RESU(CHAM_NO=(
   # VALEURS DE REFERENCE:
      _F( CHAM_GD = TEMP_1, NOEUD = 'NO9', NOM_CMP = 'TEMP',
                                            VALE = 65.48, PRECISION = 1.E-2),
      _F( CHAM_GD = TEMP_2, NOEUD = 'NO9', NOM_CMP = 'TEMP',
                                            VALE = 75.58, PRECISION = 1.E-2),
      _F( CHAM_GD = TEMP_3, NOEUD = 'NO9', NOM_CMP = 'TEMP',
                                            VALE = 93.01, PRECISION = 1.E-2),
      _F( CHAM_GD = TEMP_4, NOEUD = 'NO9', NOM_CMP = 'TEMP',
                                            VALE = 99.72, PRECISION = 1.E-2),

      _F( CHAM_GD = TEMP_1, NOEUD = 'NO33', NOM_CMP = 'TEMP',
                                            VALE = 8.09, PRECISION = 1.E-2),
      _F( CHAM_GD = TEMP_2, NOEUD = 'NO33', NOM_CMP = 'TEMP',
                                            VALE = 26.37, PRECISION = 3.E-2),
      _F( CHAM_GD = TEMP_3, NOEUD = 'NO33', NOM_CMP = 'TEMP',
                                            VALE = 78.47, PRECISION = 1.E-2),
      _F( CHAM_GD = TEMP_4, NOEUD = 'NO33', NOM_CMP = 'TEMP',
                                            VALE = 99.13, PRECISION = 1.E-2),
   # VALEURS TROUVEES JUSQU'A PRESENT:
 _F( CHAM_GD = TEMP_1, NOEUD = 'NO9', NOM_CMP = 'TEMP',
                                          VALE = 65.368,  PRECISION = 1.E-4),
 _F( CHAM_GD = TEMP_2, NOEUD = 'NO9', NOM_CMP = 'TEMP',
                                          VALE = 75.841,  PRECISION = 1.E-4),
 _F( CHAM_GD = TEMP_3, NOEUD = 'NO9', NOM_CMP = 'TEMP',
                                          VALE = 92.874,  PRECISION = 1.E-4),
 _F( CHAM_GD = TEMP_4, NOEUD = 'NO9', NOM_CMP = 'TEMP',
                                          VALE = 99.700,  PRECISION = 1.E-4),

 _F( CHAM_GD = TEMP_1, NOEUD = 'NO33', NOM_CMP = 'TEMP',
                                           VALE = 8.113, PRECISION = 1.E-4),
 _F( CHAM_GD = TEMP_2, NOEUD = 'NO33', NOM_CMP = 'TEMP',
                                           VALE = 25.871, PRECISION = 1.E-4),
 _F( CHAM_GD = TEMP_3, NOEUD = 'NO33', NOM_CMP = 'TEMP',
                                           VALE = 78.071, PRECISION = 1.E-4),
 _F( CHAM_GD = TEMP_4, NOEUD = 'NO33', NOM_CMP = 'TEMP',
                                           VALE = 99.077, PRECISION = 1.E-4))
    )

# ----------------------------------------------------------------------
# POUR VALIDER AFFE_CHAR_THER_F/TEMP_IMPO/EVOL_THER :
# ON RECUPERE L'EVOLUTION THERMIQUE (TEMPE) SUR UNE PARTIE DU BORD
# ET ON L'IMPOSE COMME TEMP_IMPO.
# LE RESULTAT DOIT ETRE LE MEME.
# ----------------------------------------------------------------------


CHTH2=AFFE_CHAR_THER_F(MODELE=MOTH,TEMP_IMPO=(
          _F( GROUP_NO = 'GRNM14', TEMP = TIMPVAR),
          _F( GROUP_MA = 'GRMA12', NOEUD = ('NO67','NO68','NO69',),
                     EVOL_THER = TEMPE))
         )

TEMPE2=THER_LINEAIRE(        MODELE=MOTH,
           TEMP_INIT=_F( CHAM_NO = TEMP0),
          INCREMENT=_F( LIST_INST = LR8, NUME_FIN = 29),
             CHAM_MATER=CHMAT, EXCIT=_F( CHARGE = CHTH2)
             )

TEST_RESU(RESU=(
_F( RESULTAT = TEMPE2,  INST = 0.1,  NOM_CHAM = 'TEMP',
 NOEUD = 'NO9', NOM_CMP = 'TEMP', VALE = 65.48, PRECISION = 1.E-2),
_F( RESULTAT = TEMPE2,  INST = 0.1,  NOM_CHAM = 'TEMP',
 NOEUD = 'NO33', NOM_CMP = 'TEMP', VALE = 8.09, PRECISION = 1.E-2))
)

#----------------------------------------------------------
# TEST DE IMPR_RESU
#----------------------------------------------------------

DEFI_FICHIER( FICHIER = 'TEMPE', UNITE = 37 ) 

#

IMPR_RESU(RESU=_F(   FORMAT = 'IDEAS',  FICHIER = 'TEMPE',
                   RESULTAT = TEMPE))

#----------------------------------------------------------
# TEST DE LIRE_RESU
#----------------------------------------------------------


TEMPEE=LIRE_RESU(       MODELE=MOTH,
                             UNITE=37,
                            FORMAT='IDEAS',
                         TYPE_RESU='EVOL_THER',
                          NOM_CHAM='TEMP',
                               INST=(0.70, 1., 2., ),
                         PRECISION=1.E-4,
                           CRITERE='RELATIF'
                    )

TEMP_1E=CREA_CHAMP( OPERATION='EXTR', TYPE_CHAM='NOEU_TEMP_R',
RESULTAT=TEMPEE, NOM_CHAM='TEMP',
             INST=.7 )

TEST_RESU(
       CHAM_NO=_F( CHAM_GD = TEMP_1E, NOEUD = 'NO33', NOM_CMP = 'TEMP',
                         VALE = 78.47, PRECISION = 3.E-2,
                         REFERENCE = 'AUTRE_ASTER'))

# ---------------------------------------------------------------------


TEMPAE=LIRE_RESU(        MAILLAGE=MAIL,
                               FORMAT='IDEAS',
                                 UNITE=37,
                            TYPE_RESU='EVOL_THER',
                             NOM_CHAM='TEMP',
                            NUME_ORDRE=37,
                         FORMAT_IDEAS=_F( NOM_CHAM = 'TEMP',
                             NUME_DATASET = 55,
                                       RECORD_6 = ( 2, 4, 1, 5, 2, 9999, ),
                             POSI_ORDRE = ( 7, 4, ),
                             POSI_INST = ( 8, 1, ),
                             NOM_CMP = 'TEMP')
                    )

TEMPAE=THER_LINEAIRE(reuse=TEMPAE,       MODELE=MOTH,
                         TEMP_INIT=_F( EVOL_THER = TEMPAE,
                         NUME_INIT = 37),
                         INCREMENT=_F( LIST_INST = LR8),
                           CHAM_MATER=CHMAT, EXCIT=_F( CHARGE = CHTH)
                        )

TEMP_2E=CREA_CHAMP( OPERATION='EXTR', TYPE_CHAM='NOEU_TEMP_R',
RESULTAT=TEMPAE, NOM_CHAM='TEMP',
             INST=2. )

TEST_RESU(
      CHAM_NO=_F( CHAM_GD = TEMP_2E, NOEUD = 'NO33', NOM_CMP = 'TEMP',
                                      VALE = 99.13, PRECISION = 3.E-2,
                                      REFERENCE = 'AUTRE_ASTER')
   )

FIN()
#
