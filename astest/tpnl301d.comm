# MODIF  DATE 03/04/2012   AUTEUR SELLENET N.SELLENET 
# TITRE THERMO-HYDRATATION D'UN CYLINDRE DE BETON AXIS AXIS_DIAG QUA9 TRIA6
# tpnl301d.para = tps_job 300 mem_job 100Mo ncpus 1 liste_test S
#            CONFIGURATION MANAGEMENT OF EDF VERSION
# ======================================================================
# COPYRIGHT (C) 1991 - 2012  EDF R&D                  WWW.CODE-ASTER.ORG
# THIS PROGRAM IS FREE SOFTWARE; YOU CAN REDISTRIBUTE IT AND/OR MODIFY  
# IT UNDER THE TERMS OF THE GNU GENERAL PUBLIC LICENSE AS PUBLISHED BY  
# THE FREE SOFTWARE FOUNDATION; EITHER VERSION 2 OF THE LICENSE, OR     
# (AT YOUR OPTION) ANY LATER VERSION.                                                    
#                                                                       
# THIS PROGRAM IS DISTRIBUTED IN THE HOPE THAT IT WILL BE USEFUL, BUT   
# WITHOUT ANY WARRANTY; WITHOUT EVEN THE IMPLIED WARRANTY OF            
# MERCHANTABILITY OR FITNESS FOR A PARTICULAR PURPOSE. SEE THE GNU      
# GENERAL PUBLIC LICENSE FOR MORE DETAILS.                              
#                                                                       
# YOU SHOULD HAVE RECEIVED A COPY OF THE GNU GENERAL PUBLIC LICENSE     
# ALONG WITH THIS PROGRAM; IF NOT, WRITE TO EDF R&D CODE_ASTER,         
#    1 AVENUE DU GENERAL DE GAULLE, 92141 CLAMART CEDEX, FRANCE.        
# ======================================================================
# CAS TEST TPNL301D
# RESPONSABLE HAELEWYN J.HAELEWYN

DEBUT(CODE=_F(NOM='TPNL301D',
              NIV_PUB_WEB='INTERNET',),
      DEBUG=_F(SDVERI='OUI',),);

MAILTH=LIRE_MAILLAGE(FORMAT='MED',);

MAIL2=CREA_MAILLAGE(MAILLAGE=MAILTH,
                    LINE_QUAD=_F(TOUT='OUI',),);

MAIL3=CREA_MAILLAGE(MAILLAGE=MAIL2,
                    MODI_MAILLE=_F(TOUT='OUI',
                                   OPTION='QUAD8_9',
                                   PREF_NOEUD='NSS',),);
##MAILTH=DEFI_GROUP(
##reuse =MAILTH,
##MAILLAGE=MAILTH,
##
##CREA_GROUP_NO=_F(OPTION='SEGM_DROI_ORDO',
##NOM='COUPE2',
##GROUP_NO='COUPE',
##NOEUD_ORIG='N52',
##NOEUD_EXTR='N14',
##PRECISION=0.01,
##CRITERE='ABSOLU',),
##INFO=2,
##);


MODELETH=AFFE_MODELE(MAILLAGE=MAIL3,
                     AFFE=_F(TOUT='OUI',
                             PHENOMENE='THERMIQUE',
                             MODELISATION='AXIS',),);

MODDIAG=AFFE_MODELE(MAILLAGE=MAIL3,
                    AFFE=_F(TOUT='OUI',
                            PHENOMENE='THERMIQUE',
                            MODELISATION='AXIS_DIAG',),);

#------------------------------------------------------------------
# Definition des constantes materiaux
#------------------------------------------------------------------
# definition des teneurs en eau dans le beton [litre/m3]
# Le beton
# CONDUCTION EN KJ/H/M/K

COND=DEFI_FONCTION(NOM_PARA='TEMP',VALE=(0.,6.,
                         300.,6.,
                         ),PROL_DROITE='LINEAIRE',PROL_GAUCHE='LINEAIRE',);


# DEFINITION DE L'AFFINITE FONCTION DU DEGRE D'HYDRATATION
Ar = 4700;

TZ0 = 273.15;


AA = FORMULE(VALE='exp(-Ar/(TZ0+TEMP))*(1586000*HYDR*HYDR*HYDR*HYDR*HYDR-5224000*HYDR*HYDR*HYDR*HYDR+6432000*HYDR*HYDR*HYDR-3530500*HYDR*HYDR+730000*HYDR+6510)',
             NOM_PARA=('HYDR','TEMP',),);

LL=DEFI_LIST_REEL(DEBUT=0.0,
                  INTERVALLE=_F(JUSQU_A=1.0,
                                PAS=0.002,),);

LT=DEFI_LIST_REEL(DEBUT=0.0,
                  INTERVALLE=_F(JUSQU_A=100.0,
                                PAS=0.1,),);

AFF=CALC_FONC_INTERP(FONCTION=AA,
                     LIST_PARA=LL,
                     NOM_RESU='AFF',
                     NOM_PARA='HYDR',
                     PROL_DROITE='CONSTANT',
                     PROL_GAUCHE='EXCLU',
                     NOM_PARA_FONC='TEMP',
                     LIST_PARA_FONC=LT,
                     PROL_DROITE_FONC='LINEAIRE',
                     PROL_GAUCHE_FONC='LINEAIRE',);

# ENTHALPIE EN KJ/H/M

ENTH=DEFI_FONCTION(NOM_PARA='TEMP',VALE=(0.,0.,
                         10.0,24000.0,
                         ),PROL_DROITE='LINEAIRE',PROL_GAUCHE='LINEAIRE',);

BETON=DEFI_MATERIAU(THER_HYDR=_F(LAMBDA=COND,
                                 BETA=ENTH,
                                 AFFINITE=AFF,
                                 CHALHYDR=1.4904e5,),);

# -------------------------------------------------
#   Definition des temps caracteristiques
# ------------------------------------------------
#temps 1 jour
tps_1j = 24.0;


#temps 5 jours
tps_5j = (5.0 * tps_1j);


#temps 1 an
tps_1an = (365.25 * tps_1j);

tps_10an = (10 * tps_1an);


#temps 1 mois
tps_1m = (tps_1an / 12.0);


#temps 10 mois
tps_10m = (10.0 * tps_1m);

t50h = 50;

t730h = 730;


# -------------------------------------------------
#   Definition des listes d'instants
# ------------------------------------------------

LINIT=DEFI_LIST_REEL(DEBUT=-10.0,
                     INTERVALLE=_F(JUSQU_A=0.0,
                                   NOMBRE=2,),);

LINST=DEFI_LIST_REEL(DEBUT=-1.0,
                     INTERVALLE=(_F(JUSQU_A=0.0,
                                    NOMBRE=1,),
                                 _F(JUSQU_A=300,
                                    PAS=2,),
                                 _F(JUSQU_A=t730h,
                                    PAS=10,),),);

# ---------------------------------------------------------------------------------
#   Calcul Hydrique / Sechage
# ---------------------------------------------------------------------------------
#Champ de temperature

CHMATTH=AFFE_MATERIAU(MAILLAGE=MAIL3,
                      AFFE=_F(TOUT='OUI',
                              MATER=BETON,),
                      AFFE_VARC=_F(TOUT='OUI',
                                   NOM_VARC='TEMP',
                                   VALE_REF=15.0,),);

TEMP_INT=DEFI_FONCTION(NOM_PARA='INST',VALE=(-1000.0,40.0,
                             tps_10an,40.0,
                             ),PROL_DROITE='CONSTANT',PROL_GAUCHE='CONSTANT',);

TEMP_EXT=DEFI_FONCTION(NOM_PARA='INST',VALE=(-1000.0,15.0,
                             tps_10an,15.0,
                             ),PROL_DROITE='CONSTANT',PROL_GAUCHE='CONSTANT',);

CL_THER=AFFE_CHAR_THER_F(MODELE=MODELETH,
                         TEMP_IMPO=(_F(GROUP_NO='SEXTERI',
                                       TEMP=TEMP_EXT,),
                                    _F(GROUP_NO='SINTERI',
                                       TEMP=TEMP_INT,),),);

CHARDIAG=AFFE_CHAR_THER_F(MODELE=MODDIAG,
                          TEMP_IMPO=(_F(GROUP_NO='SEXTERI',
                                        TEMP=TEMP_EXT,),
                                     _F(GROUP_NO='SINTERI',
                                        TEMP=TEMP_INT,),),);

line=DEFI_MATERIAU(THER=_F(LAMBDA=6.0,
                           RHO_CP=2400.0,),);

matline=AFFE_MATERIAU(MAILLAGE=MAIL3,
                      AFFE=_F(TOUT='OUI',
                              MATER=line,),);

THINI=THER_NON_LINE(MODELE=MODELETH,
                    CHAM_MATER=CHMATTH,
                    EXCIT=_F(CHARGE=CL_THER,),
                    INCREMENT=_F(LIST_INST=LINIT,),
                    ETAT_INIT=_F(STATIONNAIRE='OUI',),);

TINIDIAG=THER_NON_LINE(MODELE=MODDIAG,
                       CHAM_MATER=CHMATTH,
                       EXCIT=_F(CHARGE=CHARDIAG,),
                       INCREMENT=_F(LIST_INST=LINIT,),
                       ETAT_INIT=_F(STATIONNAIRE='OUI',),);

RESUTHER=THER_NON_LINE(MODELE=MODELETH,
                       CHAM_MATER=CHMATTH,
                       COMP_THER_NL=_F(RELATION='THER_HYDR',),
                       EXCIT=_F(CHARGE=CL_THER,),
                       INCREMENT=_F(LIST_INST=LINST,),
                       ETAT_INIT=_F(EVOL_THER=THINI,),);

RESUDIAG=THER_NON_LINE(MODELE=MODDIAG,
                       CHAM_MATER=CHMATTH,
                       COMP_THER_NL=_F(RELATION='THER_HYDR',),
                       EXCIT=_F(CHARGE=CHARDIAG,),
                       INCREMENT=_F(LIST_INST=LINST,),
                       ETAT_INIT=_F(EVOL_THER=THINI,),);

TT=POST_RELEVE_T(ACTION=_F(OPERATION='EXTRACTION',
                           INTITULE='TT',
                           RESULTAT=RESUTHER,
                           NOM_CHAM='TEMP',
                           GROUP_NO='X205',
                           TOUT_CMP='OUI',),);

TTDIAG=POST_RELEVE_T(ACTION=_F(OPERATION='EXTRACTION',
                               INTITULE='TTDIAG',
                               RESULTAT=RESUDIAG,
                               NOM_CHAM='TEMP',
                               GROUP_NO='X205',
                               TOUT_CMP='OUI',),);

TEST_TABLE(TABLE=TT,
           TYPE_TEST='MAX',
           NOM_PARA='TEMP',
           VALE=48.8675,
           PRECISION=0.07,
           REFERENCE='ANALYTIQUE',);

TEST_TABLE(TABLE=TTDIAG,
           TYPE_TEST='MAX',
           NOM_PARA='TEMP',
           VALE=48.8675,
           PRECISION=0.06,
           REFERENCE='ANALYTIQUE',);

#Tests de non-regression (version 10.1)

TEST_TABLE(TABLE=TT,
           TYPE_TEST='MAX',
           NOM_PARA='TEMP',
           VALE=52.12961985707579,PRECISION=1e-9,
           REFERENCE='NON_REGRESSION',
           );

TEST_TABLE(TABLE=TTDIAG,
           TYPE_TEST='MAX',
           NOM_PARA='TEMP',
           VALE=51.5950585726619,PRECISION=1e-9,
           REFERENCE='NON_REGRESSION',
           );

TM1=CREA_CHAMP(TYPE_CHAM='NOEU_TEMP_R',
               OPERATION='EXTR',
               RESULTAT=THINI,
               NOM_CHAM='TEMP',
               INST=0.0,);

TM1D=CREA_CHAMP(TYPE_CHAM='NOEU_TEMP_R',
                OPERATION='EXTR',
                RESULTAT=TINIDIAG,
                NOM_CHAM='TEMP',
                INST=0.0,);

T5j=CREA_CHAMP(TYPE_CHAM='NOEU_TEMP_R',
               OPERATION='EXTR',
               RESULTAT=RESUTHER,
               NOM_CHAM='TEMP',
               INST=t50h,);

T5JD=CREA_CHAMP(TYPE_CHAM='NOEU_TEMP_R',
                OPERATION='EXTR',
                RESULTAT=RESUDIAG,
                NOM_CHAM='TEMP',
                INST=t50h,);

T1m=CREA_CHAMP(TYPE_CHAM='NOEU_TEMP_R',
               OPERATION='EXTR',
               RESULTAT=RESUTHER,
               NOM_CHAM='TEMP',
               INST=t730h,);

T1MD=CREA_CHAMP(TYPE_CHAM='NOEU_TEMP_R',
                OPERATION='EXTR',
                RESULTAT=RESUDIAG,
                NOM_CHAM='TEMP',
                INST=t730h,);

TEST_RESU(CHAM_NO=(_F(CHAM_GD=TM1,
                      GROUP_NO='X205',
                      NOM_CMP='TEMP',
                      VALE=27.3475,
                      PRECISION=0.025,
                      REFERENCE='ANALYTIQUE',),
                   _F(CHAM_GD=TM1D,
                      GROUP_NO='X205',
                      NOM_CMP='TEMP',
                      VALE=27.3475,
                      PRECISION=0.015,
                      REFERENCE='ANALYTIQUE',),
                   _F(CHAM_GD=T5j,
                      GROUP_NO='X205',
                      NOM_CMP='TEMP',
                      VALE=48.7091,
                      PRECISION=0.07,
                      REFERENCE='ANALYTIQUE',),
                   _F(CHAM_GD=T5JD,
                      GROUP_NO='X205',
                      NOM_CMP='TEMP',
                      VALE=48.7091,
                      PRECISION=0.06,
                      REFERENCE='ANALYTIQUE',),
                   _F(CHAM_GD=T1m,
                      GROUP_NO='X205',
                      NOM_CMP='TEMP',
                      VALE=27.7116,
                      PRECISION=0.025,
                      REFERENCE='ANALYTIQUE',),
                   _F(CHAM_GD=T1MD,
                      GROUP_NO='X205',
                      NOM_CMP='TEMP',
                      VALE=27.7116,
                      PRECISION=0.015,
                      REFERENCE='ANALYTIQUE',),),);

#Tests de non-regression (version 10.1.6)

TEST_RESU(CHAM_NO=(_F(CHAM_GD=TM1,
                      GROUP_NO='X205',
                      NOM_CMP='TEMP',
                      VALE=27.95686528477279,PRECISION=1e-9,
                      REFERENCE='NON_REGRESSION',
                      ),
                   _F(CHAM_GD=TM1D,
                      GROUP_NO='X205',
                      NOM_CMP='TEMP',
                      VALE=27.69600548628183,PRECISION=1e-9,
                      REFERENCE='NON_REGRESSION',
                      ),
                   _F(CHAM_GD=T5j,
                      GROUP_NO='X205',
                      NOM_CMP='TEMP',
                      VALE=51.81417722249665,PRECISION=1e-9,
                      REFERENCE='NON_REGRESSION',
                      ),
                   _F(CHAM_GD=T5JD,
                      GROUP_NO='X205',
                      NOM_CMP='TEMP',
                      VALE=51.28373024091091,PRECISION=1e-9,
                      REFERENCE='NON_REGRESSION',
                      ),
                   _F(CHAM_GD=T1m,
                      GROUP_NO='X205',
                      NOM_CMP='TEMP',PRECISION=1e-9,
                      VALE=28.28983336619919,
                      REFERENCE='NON_REGRESSION',
                      ),
                   _F(CHAM_GD=T1MD,
                      GROUP_NO='X205',
                      NOM_CMP='TEMP',
                      VALE=28.06430591548828,PRECISION=1e-9,
                      REFERENCE='NON_REGRESSION',
                      ),),);

RESUTHER=CALC_CHAMP(reuse =RESUTHER,
                    RESULTAT=RESUTHER,
                    THERMIQUE='HYDR_NOEU',);

RESUDIAG=CALC_CHAMP(reuse =RESUDIAG,
                    RESULTAT=RESUDIAG,
                    THERMIQUE='HYDR_NOEU',);

H49h=CREA_CHAMP(TYPE_CHAM='NOEU_HYDR_R',
                OPERATION='EXTR',
                RESULTAT=RESUTHER,
                NOM_CHAM='HYDR_NOEU',
                INST=t50h,);

H49D=CREA_CHAMP(TYPE_CHAM='NOEU_HYDR_R',
                OPERATION='EXTR',
                RESULTAT=RESUDIAG,
                NOM_CHAM='HYDR_NOEU',
                INST=t50h,);

H730h=CREA_CHAMP(TYPE_CHAM='NOEU_HYDR_R',
                 OPERATION='EXTR',
                 RESULTAT=RESUTHER,
                 NOM_CHAM='HYDR_NOEU',
                 INST=t730h,);

H730D=CREA_CHAMP(TYPE_CHAM='NOEU_HYDR_R',
                 OPERATION='EXTR',
                 RESULTAT=RESUDIAG,
                 NOM_CHAM='HYDR_NOEU',
                 INST=t730h,);

TEST_RESU(CHAM_NO=(_F(CHAM_GD=H49h,
                      GROUP_NO='X205',
                      NOM_CMP='HYDR',
                      VALE=0.4778,
                      PRECISION=0.08,
                      REFERENCE='ANALYTIQUE',),
                   _F(CHAM_GD=H49D,
                      GROUP_NO='X205',
                      NOM_CMP='HYDR',
                      VALE=0.4778,
                      PRECISION=0.05,
                      REFERENCE='ANALYTIQUE',),
                   _F(CHAM_GD=H730D,
                      GROUP_NO='X205',
                      NOM_CMP='HYDR',
                      VALE=0.9558,
                      PRECISION=0.01,
                      REFERENCE='ANALYTIQUE',),
                   _F(CHAM_GD=H730h,
                      GROUP_NO='X205',
                      NOM_CMP='HYDR',
                      VALE=0.9558,
                      PRECISION=0.01,
                      REFERENCE='ANALYTIQUE',),),);

#Tests de non-regression (version 10.1)

TEST_RESU(CHAM_NO=(_F(CHAM_GD=H49h,
                      GROUP_NO='X205',
                      NOM_CMP='HYDR',
                      VALE=0.5151184354606535,PRECISION=1e-9,
                      REFERENCE='NON_REGRESSION',
                      ),
                   _F(CHAM_GD=H49D,
                      GROUP_NO='X205',
                      NOM_CMP='HYDR',
                      VALE=0.4969533079534615,PRECISION=1e-9,
                      REFERENCE='NON_REGRESSION',
                      ),
                   _F(CHAM_GD=H730D,
                      GROUP_NO='X205',
                      NOM_CMP='HYDR',
                      VALE=0.9610798713119711,PRECISION=1e-9,
                      REFERENCE='NON_REGRESSION',
                      ),
                   _F(CHAM_GD=H730h,
                      GROUP_NO='X205',
                      NOM_CMP='HYDR',
                      VALE=0.9650700455657765,PRECISION=1e-9,
                      REFERENCE='NON_REGRESSION',
                      ),),);

FIN();
