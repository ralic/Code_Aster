# MODIF  DATE 23/02/2011   AUTEUR LAVERNE J.LAVERNE 
# TITRE FISSURATION INTERFACE 2D PLAN (QUAD8), LOI CZM_TRA_MIX
# ssnp118v.para = tps_job 60 mem_job 32Mo ncpus 1 liste_test S
#            CONFIGURATION MANAGEMENT OF EDF VERSION
# ======================================================================
# COPYRIGHT (C) 1991 - 2011  EDF R&D                  WWW.CODE-ASTER.ORG
# THIS PROGRAM IS FREE SOFTWARE; YOU CAN REDISTRIBUTE IT AND/OR MODIFY  
# IT UNDER THE TERMS OF THE GNU GENERAL PUBLIC LICENSE AS PUBLISHED BY  
# THE FREE SOFTWARE FOUNDATION; EITHER VERSION 2 OF THE LICENSE, OR     
# (AT YOUR OPTION) ANY LATER VERSION.                                                    
#                                                                       
# THIS PROGRAM IS DISTRIBUTED IN THE HOPE THAT IT WILL BE USEFUL, BUT   
# WITHOUT ANY WARRANTY; WITHOUT EVEN THE IMPLIED WARRANTY OF            
# MERCHANTABILITY OR FITNESS FOR A PARTICULAR PURPOSE. SEE THE GNU      
# GENERAL PUBLIC LICENSE FOR MORE DETAILS.                              
#                                                                       
# YOU SHOULD HAVE RECEIVED A COPY OF THE GNU GENERAL PUBLIC LICENSE     
# ALONG WITH THIS PROGRAM; IF NOT, WRITE TO EDF R&D CODE_ASTER,         
#    1 AVENUE DU GENERAL DE GAULLE, 92141 CLAMART CEDEX, FRANCE.        
# ======================================================================
 
DEBUT(CODE=_F( NOM = 'SSNP118V',NIV_PUB_WEB='INTERNET',VISU_EFICAS='OUI'),PAR_LOT='OUI',IGNORE_ALARM=('MODELISA4_9','CALCULEL_7'))
# ON IGNORE LES ALARMES SUR LA MAILLE DE JOINT DEGENERE (AVEC DES NOEUDS CONFONDUS)

# PARAMETRES D'INSTANT
tfin=26
nbpas=5
nbarch=nbpas

# PARAMETRES MATERIAU (NON REALISTES)
gc = 0.9
sigc = 9.
young  = 1000000.
nu=0.0

# PARAMETRES DE FORME DE LA LOI CZM
coee = 0.01/0.16
coep = 0.05/0.16

delc = 2*gc/((sigc)*(1.-coee+coep))
dele=coee*delc
delp=coep*delc

# ORIENTATION DES MAILLES
angle=30./180*pi

MA=LIRE_MAILLAGE()

MA=DEFI_GROUP(reuse =MA,
              MAILLAGE=MA,
              CREA_GROUP_NO=(_F(
                                GROUP_MA='GM_DROI',
                                NOM='DROITE',),),
                               );

MO=AFFE_MODELE(

                MAILLAGE=MA,
                VERIF='MAILLE',

                AFFE= (
                _F(
                   MAILLE = ('CUBE','DROITE'),
                   PHENOMENE = 'MECANIQUE',
                   MODELISATION = 'D_PLAN'
                     ),
                 _F(
                   MAILLE = 'CUBEDEG',
                   PHENOMENE = 'MECANIQUE',
                   MODELISATION = 'PLAN_INTERFACE'
                   )
                 )
              )


MAT=DEFI_MATERIAU(

     ELAS=_F(
              E =  young,
              NU = nu),
     RUPT_DUCT = _F(
                     GC = gc,
                     SIGM_C = sigc,
                     COEF_EXTR = coee,
                     COEF_PLAS = coep,
                     PENA_LAGR = 100,
                     RIGI_GLIS = 10,    
                    )
            )

CM=AFFE_MATERIAU(

               MAILLAGE=MA,
               AFFE=_F(
                       TOUT = 'OUI',
                       MATER = MAT),
              )

# AFFECTATION DES ANGLES NAUTIQUES : POSITION DE LA FISSURE DANS LE REPERE GLOBAL
ORIEN_FI=AFFE_CARA_ELEM(MODELE=MO,INFO=1,
                     MASSIF=(
           _F(MAILLE='CUBEDEG',ANGL_REP=(30,0,0)),         
                                 ));


# ENCASTREMENT
LIAISON=AFFE_CHAR_MECA(
  MODELE=MO,
  FACE_IMPO= (
    _F(MAILLE='GAUCHE2', DX=0, DY=0),
    )
  )

# CHARGEMENT MODE I PUR
TRAC_N=AFFE_CHAR_MECA(
  MODELE=MO,
  FACE_IMPO= (
    _F(MAILLE='DROITE', DX=cos(angle), DY= sin(angle)),
    )
  )

# CREATION DE LISTE D'INSTANT POUR CHARGEMENT CYCLIQUE                                  
LREEL1=DEFI_LIST_REEL(

                     DEBUT   = 0.0,
     INTERVALLE=(
      _F( JUSQU_A =   tfin/26,    NOMBRE = 1 ),
      _F( JUSQU_A = 2*tfin/26,    NOMBRE = 1 ),
      _F( JUSQU_A = 3*tfin/26,    NOMBRE = 4 ),
      _F( JUSQU_A = 4*tfin/26,    NOMBRE = 1 ),
      _F( JUSQU_A = 5*tfin/26,    NOMBRE = nbpas ),
      _F( JUSQU_A = 6*tfin/26,    NOMBRE = nbpas ),
      _F( JUSQU_A = 7*tfin/26,    NOMBRE = 2*nbpas),
      _F( JUSQU_A = 8*tfin/26,    NOMBRE = 2*nbpas ),
      _F( JUSQU_A = 9*tfin/26,    NOMBRE = 1 ),
      _F( JUSQU_A = 10*tfin/26,   NOMBRE = nbpas ),
      _F( JUSQU_A = 11*tfin/26,   NOMBRE = 2*nbpas ),
      _F( JUSQU_A = 12*tfin/26,   NOMBRE = 2*nbpas ),
      _F( JUSQU_A = 13*tfin/26,   NOMBRE = nbpas ),
      _F( JUSQU_A = 14*tfin/26,   NOMBRE = 2*nbpas ),
      _F( JUSQU_A = 15*tfin/26,   NOMBRE = 2*nbpas ),
      _F( JUSQU_A = 16*tfin/26,   NOMBRE = nbpas ),
      _F( JUSQU_A = 17*tfin/26,   NOMBRE = nbpas ),
      _F( JUSQU_A = 18*tfin/26,   NOMBRE = nbpas ),
      _F( JUSQU_A = 19*tfin/26,   NOMBRE = nbpas ),
      _F( JUSQU_A = 20*tfin/26,   NOMBRE = 1 ),
      _F( JUSQU_A = 21*tfin/26,   NOMBRE = 1 ),
      _F( JUSQU_A = 22*tfin/26,   NOMBRE = 1 ),
      _F( JUSQU_A = 23*tfin/26,   NOMBRE = 1 ),
      _F( JUSQU_A = 24*tfin/26,   NOMBRE = 1 ),
      _F( JUSQU_A = 25*tfin/26,   NOMBRE = 1 ),
      _F( JUSQU_A =       tfin,   NOMBRE = 1 ),
      )
     )

eps=0.0001
      
FCT=DEFI_FONCTION(NOM_PARA='INST',VALE=(       0.0,   0.0, 
                                           tfin/26,  dele/2.,  
                                         2*tfin/26,   0.0,
                                         3*tfin/26,   -eps,  
                                         4*tfin/26,   0.0,
                                         5*tfin/26,   dele,
                                         6*tfin/26,   dele + (delp-dele)/2.,              
                                         7*tfin/26,   dele + (delp-dele)/2.-dele-eps,             
                                         8*tfin/26,   dele + (delp-dele)/2.,      
                                         9*tfin/26,   delp,   
                                        10*tfin/26,   delp +   (delc-delp)/3.,
                                        11*tfin/26,   delp +   (delc-delp)/3. -dele*0.8,              
                                        12*tfin/26,   delp +   (delc-delp)/3.,
                                        13*tfin/26,   delp + 2*(delc-delp)/3.,
                                        14*tfin/26,   delp + 2*(delc-delp)/3. -dele*0.5,
                                        16*tfin/26,   delp + 2*(delc-delp)/3.,
                                        17*tfin/26,   delc,
                                        18*tfin/26,   delc-eps,
                                        19*tfin/26,   delc,
                                        20*tfin/26,   delc*1.1,
                                        21*tfin/26,   delc*1.1,
                                        22*tfin/26,   delc*1.1,
                                        23*tfin/26,   delc*1.1,
                                        24*tfin/26,   delc*1.1,
                                        25*tfin/26,   delc*1.1,
                                              tfin,   delc*1.1,
 
                                                        ),       
                                 PROL_DROITE='LINEAIRE',);                                                           


LISTCY =DEFI_LIST_INST(DEFI_LIST=_F(LIST_INST =LREEL1 ),
                        ECHEC=_F(SUBD_METHODE = 'UNIFORME',
                                 SUBD_PAS     = 4,
                                 SUBD_COEF_PAS_1 = 0.01,
                                 SUBD_NIVEAU  = 5,
                                ),)
                                
# CREATION DE LISTE D'INSTANT POUR CHARGEMENT MONOTONE                                  

LREEL2=DEFI_LIST_REEL(DEBUT   = 0.0,INTERVALLE=(
                                                 _F( JUSQU_A =   tfin,    NOMBRE = 10*tfin ),
      ))
      
FCTMON=DEFI_FONCTION(NOM_PARA='INST',VALE=( 0.0,   0.0, tfin,   delc*1.1,),  PROL_DROITE='LINEAIRE',);                                                           


LISTMO =DEFI_LIST_INST(DEFI_LIST=_F(LIST_INST =LREEL2 ),
                        ECHEC=_F(SUBD_METHODE = 'UNIFORME',
                                 SUBD_PAS     = 4,
                                 SUBD_COEF_PAS_1 = 0.01,
                                 SUBD_NIVEAU  = 5,
                                ),)

#----------------------------------------------------------------------------------
# CALCUL AVEC CHARGEMENT EN MODE I AVEC LOI CZM_TRA_MIX
#-----------------------------------------------------------------------------------

# CHARGEMENT CYCLIQUE
U_TRA=STAT_NON_LINE(
  MODELE     = MO,
  CHAM_MATER = CM,
  CARA_ELEM  = ORIEN_FI,
  EXCIT      = (
    _F(CHARGE = LIAISON , ),
    _F(CHARGE = TRAC_N, FONC_MULT = FCT),
  ),
  COMP_INCR  = (
          _F(RELATION = 'CZM_TRA_MIX',  MAILLE = 'CUBEDEG', ),
          _F(RELATION = 'ELAS',         MAILLE = 'CUBE',),
          ),
  INCREMENT = _F(
    LIST_INST    = LISTCY,
    INST_FIN     = tfin,
    ),
  CONVERGENCE = _F(
    RESI_REFE_RELA = 1.E-6,
    SIGM_REFE      = sigc,
    DEPL_REFE      = delc,
    ITER_GLOB_MAXI = 5,
    ),
  SOLVEUR = _F(METHODE = 'MUMPS', PCENT_PIVOT = 100),
  NEWTON     = _F(MATRICE = 'TANGENTE', REAC_ITER=1),
  ARCHIVAGE = _F(LIST_INST = LREEL1,),
  )

# CHARGEMENT MONOTONE
U_MON=STAT_NON_LINE(
  MODELE     = MO,
  CHAM_MATER = CM,
  CARA_ELEM  = ORIEN_FI,
  EXCIT      = (
    _F(CHARGE = LIAISON , ),
    _F(CHARGE = TRAC_N, FONC_MULT = FCTMON),
  ),
  COMP_INCR  = (
          _F(RELATION = 'CZM_TRA_MIX',  MAILLE = 'CUBEDEG', ),
          _F(RELATION = 'ELAS',         MAILLE = 'CUBE',),
          ),
  INCREMENT = _F(
    LIST_INST    = LISTMO,
    INST_FIN     = tfin,
    ),
  CONVERGENCE = _F(
    RESI_REFE_RELA = 1.E-6,
    SIGM_REFE      = sigc,
    DEPL_REFE      = delc,
    ITER_GLOB_MAXI = 5,
    ),
  SOLVEUR = _F(METHODE = 'MUMPS', PCENT_PIVOT = 100),
  NEWTON     = _F(MATRICE = 'TANGENTE', REAC_ITER=1),
  ARCHIVAGE = _F(LIST_INST = LREEL2,),
  )

#---------------------------------------------------------------------------------- 
# POST TRAITEMENT
#-----------------------------------------------------------------------------------
             
# CALCUL DE LA FORCE NODALE
U_TRA=CALC_NO(
            reuse =U_TRA,
            RESULTAT=U_TRA,
            OPTION='FORC_NODA',
            );
          
# VECTEUR-FORCE NODALE RESULTANTE : (F_X,F_Y) 
TF_N=POST_RELEVE_T(ACTION=_F(OPERATION='EXTRACTION',
                               INTITULE='F_PILOTE',
                               RESULTAT=U_TRA,
                               NOM_CHAM='FORC_NODA',
                               TOUT_ORDRE='OUI',
                               GROUP_NO='DROITE',
                               RESULTANTE=('DX','DY'),),);
                               

# PROJECTEUR SUR LA NORMALE 
PNOR = FORMULE(VALE='DX*cos(angle)+DY*sin(angle)',
              NOM_PARA=('DX','DY',),); 
                           
# INSERTION D'UNE COLONNE AVEC LA PROJECTION NORMALE DE LA FORCE NODALE                              
TF_N=CALC_TABLE(reuse =TF_N,
                  TABLE=TF_N,
                  ACTION=_F(OPERATION='OPER',
                            FORMULE=PNOR,
                            NOM_PARA='F_N',),);                                                           

# DEPLACEMENT DU NOEUD EN_HAUT
TU_N=POST_RELEVE_T(ACTION=_F(OPERATION='EXTRACTION',
                              INTITULE='DEPL',
                              RESULTAT=U_TRA,
                              NOM_CHAM='DEPL',
                              TOUT_ORDRE='OUI',
                              NOEUD='NO2',
                              NOM_CMP=('DX','DY',),),);
                              
# INSERTION D'UNE COLONNE AVEC LA PROJECTION NORMALE DE DEPLACEMENT                              
TU_N=CALC_TABLE(reuse =TU_N,
                    TABLE=TU_N,
                    ACTION=_F(OPERATION='OPER',
                            FORMULE=PNOR,
                            NOM_PARA='U_N',),);                                     

           
# MANIPULATION POUR IMPRIMER LA COURBE FORCE-DEPLACEMENT AU FORMAT XMGRACE
FN=RECU_FONCTION(TABLE=TF_N,
                  PARA_X='INST',
                  PARA_Y='F_N',);

DN=RECU_FONCTION(TABLE=TU_N,
                  PARA_X='INST',
                  PARA_Y='U_N',);


# RECUPERATION DES VALEURS DE VI EN FONCTION DES INSTANT ET IMPRESSION DANS UNE TABLE UNIQUE : TRESU

VARI_1=RECU_FONCTION(   RESULTAT=U_TRA,
                        NOM_CHAM='VARI_ELGA',
                        NOM_CMP=('V1',),
                        MAILLE='CUBEDEG',
                        POINT=1)
T_VARI_1=CREA_TABLE(FONCTION=_F(FONCTION=VARI_1))
TRESU=CREA_TABLE(FONCTION=_F(FONCTION=VARI_1))


VARI_2=RECU_FONCTION(   RESULTAT=U_TRA,
                        NOM_CHAM='VARI_ELGA',
                        NOM_CMP='V2',
                        MAILLE='CUBEDEG',
                        POINT=1)
T_VARI_2=CREA_TABLE(FONCTION=_F(FONCTION=VARI_2))


VARI_3=RECU_FONCTION(   RESULTAT=U_TRA,
                        NOM_CHAM='VARI_ELGA',
                        NOM_CMP='V3',
                        MAILLE='CUBEDEG',
                        POINT=1)
T_VARI_3=CREA_TABLE(FONCTION=_F(FONCTION=VARI_3))



VARI_4=RECU_FONCTION(   RESULTAT=U_TRA,
                        NOM_CHAM='VARI_ELGA',
                        NOM_CMP='V4',
                        MAILLE='CUBEDEG',
                        POINT=1)
T_VARI_4=CREA_TABLE(FONCTION=_F(FONCTION=VARI_4))


VARI_7=RECU_FONCTION(   RESULTAT=U_TRA,
                        NOM_CHAM='VARI_ELGA',
                        NOM_CMP='V7',
                        MAILLE='CUBEDEG',
                        POINT=1)
T_VARI_7=CREA_TABLE(FONCTION=_F(FONCTION=VARI_7))


SIGN=RECU_FONCTION( RESULTAT=U_TRA,
                        NOM_CHAM='SIEF_ELGA',
                        NOM_CMP='SIGN',
                        MAILLE='CUBEDEG',
                        POINT=1)
T_SIGN=CREA_TABLE(FONCTION=_F(FONCTION=SIGN))



SN=RECU_FONCTION(TABLE=T_SIGN,
                  PARA_X='INST',
                  PARA_Y='SIGN',);

DN2=RECU_FONCTION(TABLE=T_VARI_7,
                  PARA_X='INST',
                  PARA_Y='V7',);
                  

TRESU = CALC_TABLE(reuse = TRESU,
                     TABLE = TRESU,
                     ACTION = (
                     _F(OPERATION = 'COMB',NOM_PARA  = 'INST',TABLE = T_VARI_2,),
                     _F(OPERATION = 'COMB',NOM_PARA  = 'INST',TABLE = T_VARI_3,),
                     _F(OPERATION = 'COMB',NOM_PARA  = 'INST',TABLE = T_VARI_4,),
                     _F(OPERATION = 'COMB',NOM_PARA  = 'INST',TABLE = T_VARI_7,),
                     _F(OPERATION = 'COMB',NOM_PARA  = 'INST',TABLE = T_SIGN,),
                     
                               ),
                        );

#IMPR_FONCTION(FORMAT='XMGRACE',
#              PILOTE='INTERACTIF',
#              COURBE=_F(FONC_X=DN2,
#                        FONC_Y=SN,
#                        LEGENDE='Ldc CZM ductile',),
#              BORNE_X=(-0.001,1.3*delc),          
#              BORNE_Y=(-2*sigc,1.2*sigc),          
#              LEGENDE_X='\\xd\\s\\0n',
#              LEGENDE_Y='SIG\\sn',
#              TITRE='Reponse Ldc Mode I avec charge-decharge',)


#---------------------------------------------------------------------------------- 
# TESTS DES RESULTATS
#-----------------------------------------------------------------------------------

# TEST REPONSE GLOBALE

TEST_RESU(
  RESU = (
    _F(
      REFERENCE = 'ANALYTIQUE',
      RESULTAT  = U_TRA,
      NOM_CHAM  = 'FORC_NODA',
      NOM_CMP   = 'DX',
      VALE      = 1.03932,
      MAILLE    = 'CUBE',
      NOEUD    = 'NO4',
      INST      = 9.6,
      ),
    )
  )
  
TEST_RESU(
  RESU = (
    _F(
      REFERENCE = 'ANALYTIQUE',
      RESULTAT  = U_TRA,
      NOM_CHAM  = 'DEPL',
      NOM_CMP   = 'DX',
      VALE      = 0.06235,
      MAILLE    = 'CUBE',
      NOEUD    = 'NO4',
      INST      = 9.6,
      ),
    )
  )

# TEST CONTRAINTE NORMALE LDC (INSTANT SUR LE PLATEAU)
TEST_RESU(
  RESU = (
    _F(
      REFERENCE = 'ANALYTIQUE',
      RESULTAT  = U_TRA,
      NOM_CHAM  = 'SIEF_ELGA',
      NOM_CMP   = 'SIGN',
      VALE      = sigc,
      MAILLE    = 'CUBEDEG', 
      POINT     = 1,
      INST      = 9.0,
      ),
    )
  )

# TEST MULTIPLICATEUR DE LAGRANGE (DOIT ETRE EGAL A LA SIGN PRECEDENTE)
TEST_RESU(
  RESU = (
    _F(
      REFERENCE = 'ANALYTIQUE',
      RESULTAT  = U_TRA,
      NOM_CHAM  = 'DEPL',
      NOM_CMP   = 'SIGN',
      VALE      = sigc,
      NOEUD    = 'NS6',
      INST      = 9.0,
      ),
    )
  )

# VERIF MODE II NUL 
TEST_RESU(
  RESU = (
    _F(
      REFERENCE = 'ANALYTIQUE',
      RESULTAT  = U_TRA,
      NOM_CHAM  = 'SIEF_ELGA',
      NOM_CMP   = 'SITX',
      VALE      = 0.0,
      CRITERE   = 'ABSOLU',
      MAILLE    = 'CUBEDEG',
      POINT     = 1,
      INST      = 9.6,
      ),
    )
  )

# TEST DES VI1 ET VI4 (SAUT_N ET POURCENTAGE D'ENERGIE DISSIPEE)
# DANS LES DIFFERENTS REGIMES DE LA LOI

# CONTACT (VI2 = -1)
TEST_RESU(
  RESU = (
    _F(
      REFERENCE = 'ANALYTIQUE',
      RESULTAT  = U_TRA,
      NOM_CHAM  = 'VARI_ELGA',
      NOM_CMP   = 'V1',
      VALE      = 1.00000E-02,
      MAILLE    = 'CUBEDEG',
      POINT     = 1,
      INST      = 2.5,
      ),))

TEST_RESU(
  RESU = (
    _F(
      REFERENCE = 'ANALYTIQUE',
      RESULTAT  = U_TRA,
      NOM_CHAM  = 'VARI_ELGA',
      NOM_CMP   = 'V4',
      VALE      = 0.00000E+00,
      CRITERE   = 'ABSOLU',
      MAILLE    = 'CUBEDEG',
      POINT     = 2,
      INST      = 2.5,
      ),))

# PLATEAU (VI2 = 3)
TEST_RESU(
  RESU = (
    _F(
      REFERENCE = 'ANALYTIQUE',
      RESULTAT  = U_TRA,
      NOM_CHAM  = 'VARI_ELGA',
      NOM_CMP   = 'V1',
      VALE      = 1.79910E-02,
      MAILLE    = 'CUBEDEG',
      POINT     = 1,
      INST      = 5.4,
      ),))

TEST_RESU(
  RESU = (
    _F(
      REFERENCE = 'ANALYTIQUE',
      RESULTAT  = U_TRA,
      NOM_CHAM  = 'VARI_ELGA',
      NOM_CMP   = 'V4',
      VALE      = 3.99100E-02,
      MAILLE    = 'CUBEDEG',
      POINT     = 2,
      INST      = 5.4,
      ),))

# ADHERENCE OU DECHARGE (VI2 = 0)
TEST_RESU(
  RESU = (
    _F(
      REFERENCE = 'ANALYTIQUE',
      RESULTAT  = U_TRA,
      NOM_CHAM  = 'VARI_ELGA',
      NOM_CMP   = 'V1',
      VALE      = 2.99910E-02,
      MAILLE    = 'CUBEDEG',
      POINT     = 1,
      INST      = 7.4,
      ),))

TEST_RESU(
  RESU = (
    _F(
      REFERENCE = 'ANALYTIQUE',
      RESULTAT  = U_TRA,
      NOM_CHAM  = 'VARI_ELGA',
      NOM_CMP   = 'V4',
      VALE      = 1.99910E-01,
      MAILLE    = 'CUBEDEG',
      POINT     = 2,
      INST      = 7.4,
      ),))

# ENDOMMAGEMENT (VI2 = 1)
TEST_RESU(
  RESU = (
    _F(
      REFERENCE = 'ANALYTIQUE',
      RESULTAT  = U_TRA,
      NOM_CHAM  = 'VARI_ELGA',
      NOM_CMP   = 'V1',
      VALE      = 1.08662E-01,
      MAILLE    = 'CUBEDEG',
      POINT     = 1,
      INST      = 12.6,
      ),))

TEST_RESU(
  RESU = (
    _F(
      REFERENCE = 'ANALYTIQUE',
      RESULTAT  = U_TRA,
      NOM_CHAM  = 'VARI_ELGA',
      NOM_CMP   = 'V4',
      VALE      = 8.29305E-01,
      MAILLE    = 'CUBEDEG',
      POINT     = 2,
      INST      = 12.6,
      ),))

# RUPTURE TOTALE (VI2 = 2)
TEST_RESU(
  RESU = (
    _F(
      REFERENCE = 'ANALYTIQUE',
      RESULTAT  = U_TRA,
      NOM_CHAM  = 'VARI_ELGA',
      NOM_CMP   = 'V1',
      VALE      = delc,
      MAILLE    = 'CUBEDEG',
      POINT     = 1,
      INST      = 23.0,
      ),))

TEST_RESU(
  RESU = (
    _F(
      REFERENCE = 'ANALYTIQUE',
      RESULTAT  = U_TRA,
      NOM_CHAM  = 'VARI_ELGA',
      NOM_CMP   = 'V4',
      VALE      = 1.0,
      MAILLE    = 'CUBEDEG',
      POINT     = 2,
      INST      = 23.0,
      ),))


# IMPRESSION DES RESULTATS DANS LE FICHIER RESU
IMPR_FONCTION(FORMAT='TABLEAU',
              COURBE=_F(FONC_X=DN,
                        FONC_Y=FN,
                        LEGENDE='REPONSE GLOBALE',),
             );

IMPR_TABLE(TABLE = TRESU);
#IMPR_RESU(FORMAT='GMSH',RESU=(_F(RESULTAT=U_TRA,NOM_CHAM='DEPL',TYPE_CHAM='VECT_2D',NOM_CMP=('DX','DY')))),

FIN(FORMAT_HDF='OUI')

