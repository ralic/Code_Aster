# TITRE NON DIVERGENCE D'UNE PLAQUE EN DYNAMIQUE EXPLICITE
#            CONFIGURATION MANAGEMENT OF EDF VERSION
# ======================================================================
# COPYRIGHT (C) 1991 - 2012  EDF R&D                  WWW.CODE-ASTER.ORG
# THIS PROGRAM IS FREE SOFTWARE; YOU CAN REDISTRIBUTE IT AND/OR MODIFY
# IT UNDER THE TERMS OF THE GNU GENERAL PUBLIC LICENSE AS PUBLISHED BY
# THE FREE SOFTWARE FOUNDATION; EITHER VERSION 2 OF THE LICENSE, OR
# (AT YOUR OPTION) ANY LATER VERSION.
#
# THIS PROGRAM IS DISTRIBUTED IN THE HOPE THAT IT WILL BE USEFUL, BUT
# WITHOUT ANY WARRANTY; WITHOUT EVEN THE IMPLIED WARRANTY OF
# MERCHANTABILITY OR FITNESS FOR A PARTICULAR PURPOSE. SEE THE GNU
# GENERAL PUBLIC LICENSE FOR MORE DETAILS.
#
# YOU SHOULD HAVE RECEIVED A COPY OF THE GNU GENERAL PUBLIC LICENSE
# ALONG WITH THIS PROGRAM; IF NOT, WRITE TO EDF R&D CODE_ASTER,
#    1 AVENUE DU GENERAL DE GAULLE, 92141 CLAMART CEDEX, FRANCE.
# ======================================================================
# ON TESTE LA COMBINAISON DKT->DYNA_TRAN_EXPLI->PETIT_REAC->MASS_MECA_DIAG
# DANS LA VERSION PRECEDENTE CALCUL DIVERGEAIT A CAUSE DE LA MAUVAISE VALEUR (=0)
# DE LA COMPOSANTE DDL 6 DE LA MASSE.

DEBUT(CODE=_F(NOM='SDLS116A',NIV_PUB_WEB='INTERNET'),DEBUG=_F(SDVERI='OUI'))
RHO  = 2500.E0
EP   = 0.1

EY  = 4.3880E10
NU  = 0.

C0   = 4.1895e+03
K    = 0.4

FREQ = 1.6758e+03
Q0   = 1.0E-4

F0   = 1.6166e+05

TMAX = 1.2E-3
DT = 1.0E-5

MAIL=LIRE_MAILLAGE(FORMAT='MED',);

MAIL=DEFI_GROUP(reuse =MAIL,
                MAILLAGE=MAIL,
                CREA_GROUP_NO=(_F(GROUP_MA='A1A2',),
                               _F(GROUP_MA='A4A3' ,),
                               _F(GROUP_MA='A2A4' ,),
                               _F(GROUP_MA='A3A1' ,),
                             ),);

MOD1=AFFE_MODELE(MAILLAGE=MAIL,
                AFFE=_F(TOUT='OUI',
                        PHENOMENE='MECANIQUE',
                        MODELISATION='DKT',),);



MAT=DEFI_MATERIAU(
                  ELAS = _F(
                             E    =  EY,
                             NU   =  NU,
                             RHO  = RHO,
                           ),
                 );


CHMAT=AFFE_MATERIAU(MAILLAGE=MAIL,
                    AFFE=(_F(TOUT='OUI',MATER=MAT,),),
                    );

CELE1=AFFE_CARA_ELEM(MODELE=MOD1,
                        COQUE=_F(GROUP_MA='MESH',
                                 EPAIS=EP,
                                 INER_ROTA = 'OUI',
                                 ANGL_REP=(0.0,0.0),
                                ),
                       );



COND_L1=AFFE_CHAR_MECA(MODELE=MOD1,
                        DDL_IMPO=(
                                  _F(GROUP_NO='A1',
                                     DX=0.0,
                                     DY=0.0,
                                     DZ=0.0,
                                     DRX=0.0,
                                     DRY=0.0,
                                     DRZ=0.0,
                                     ),
                                  _F(GROUP_NO='A3A1',
                                     DX=0.0,
                                     DZ=0.0,
                                     DRX=0.0,
                                     DRY=0.0,
                                     DRZ=0.0,
                                      ),
                                  ),
                     FORCE_NODALE = _F(
                                      GROUP_NO = 'A2A4',
                                      FX       = F0,
                                      FZ       = F0
                                      )
                       );

INST1=DEFI_LIST_REEL(DEBUT=0.0,INTERVALLE=(
                          _F(JUSQU_A = TMAX,PAS = DT),
                      ),);

chf1 = DEFI_FONCTION(NOM_PARA='INST',
                     VALE=(
                            0.0, 0.0,
                            TMAX ,  1.0,
                           ),
                     PROL_DROITE='CONSTANT',
                     PROL_GAUCHE='CONSTANT',
                    );

NN1  = int(TMAX/DT)

RESU1 = DYNA_NON_LINE(
                       MODELE=MOD1,
                       CHAM_MATER= CHMAT,
                       CARA_ELEM = CELE1,
                       COMP_INCR=_F(
                                    RELATION ='ELAS',
                                    DEFORMATION='PETIT_REAC'
                                   ),
                       INCREMENT=_F( LIST_INST = INST1,
                                     PRECISION =1.E-1),
                       EXCIT=(   _F( CHARGE = COND_L1,
                                     FONC_MULT = chf1,),
                             ),
                       SCHEMA_TEMPS=_F(SCHEMA='DIFF_CENT',FORMULATION='ACCELERATION',),
                       MASS_DIAG = 'OUI',
                     );

TEST_RESU(RESU=(_F(INST=1.1999999999999999E-3,
                   REFERENCE='SOURCE_EXTERNE',
                   RESULTAT=RESU1,
                   NOM_CHAM='DEPL',
                   NOEUD='N2',
                   NOM_CMP='DZ',
                   VALE_CALC=0.011750853,
                   VALE_REFE=0.0117509,
                   PRECISION=5.0000000000000001E-3, TOLE_MACHINE=(5.0000000000000001E-3, 5.0000000000000004E-06),),
                _F(INST=1.1999999999999999E-3,
                   REFERENCE='SOURCE_EXTERNE',
                   RESULTAT=RESU1,
                   NOM_CHAM='VITE',
                   NOEUD='N4',
                   NOM_CMP='DRX',
                   VALE_CALC=4.577056970,
                   VALE_REFE=4.5782600000000002,
                   PRECISION=0.02, TOLE_MACHINE=(0.02, 5.0000000000000004E-06),),
                ),
          )

FIN();
