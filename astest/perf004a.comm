# MODIF  DATE 10/10/2012   AUTEUR COURTOIS M.COURTOIS 
# TITRE CALCUL ELASTO-PLASTIQUE D'UN ANNEAU CREUX SOUMIS A UNE PRESSION INTERIEURE
# perf004a.para = tps_job 500 mem_job 512Mo ncpus 1 liste_test S
#            CONFIGURATION MANAGEMENT OF EDF VERSION
# ======================================================================
# COPYRIGHT (C) 1991 - 2012  EDF R&D                  WWW.CODE-ASTER.ORG
# THIS PROGRAM IS FREE SOFTWARE; YOU CAN REDISTRIBUTE IT AND/OR MODIFY
# IT UNDER THE TERMS OF THE GNU GENERAL PUBLIC LICENSE AS PUBLISHED BY
# THE FREE SOFTWARE FOUNDATION; EITHER VERSION 2 OF THE LICENSE, OR
# (AT YOUR OPTION) ANY LATER VERSION.
#
# THIS PROGRAM IS DISTRIBUTED IN THE HOPE THAT IT WILL BE USEFUL, BUT
# WITHOUT ANY WARRANTY; WITHOUT EVEN THE IMPLIED WARRANTY OF
# MERCHANTABILITY OR FITNESS FOR A PARTICULAR PURPOSE. SEE THE GNU
# GENERAL PUBLIC LICENSE FOR MORE DETAILS.
#
# YOU SHOULD HAVE RECEIVED A COPY OF THE GNU GENERAL PUBLIC LICENSE
# ALONG WITH THIS PROGRAM; IF NOT, WRITE TO EDF R&D CODE_ASTER,
#    1 AVENUE DU GENERAL DE GAULLE, 92141 CLAMART CEDEX, FRANCE.
# ======================================================================
#       INTERET : MESURER LES PERFORMANCES D'UN CALCUL ELASTO-PLASTIQUE 3D
#---------------------------------------------------------------------------

DEBUT(CODE=_F(NOM='PERF004A',NIV_PUB_WEB='INTERNET'))

MA=LIRE_MAILLAGE(FORMAT='MED')

MA = MODI_MAILLAGE( reuse=MA,  MAILLAGE=MA, ORIE_PEAU_3D=_F(GROUP_MA = ('P1')))

MO=AFFE_MODELE(MAILLAGE=MA,
         AFFE=_F(TOUT='OUI', PHENOMENE='MECANIQUE', MODELISATION='3D') )


MAT1=DEFI_MATERIAU(ELAS=_F(E= 5.E11, NU=0.3, RHO=9800. ),
                   ECRO_LINE=_F(D_SIGM_EPSI=1.0E4, SY=1.0E9,),
                  )


CHMAT=AFFE_MATERIAU(MAILLAGE=MA, AFFE=_F(TOUT='OUI',MATER=MAT1))

CHAR1=AFFE_CHAR_MECA(MODELE=MO,
        PRES_REP=_F(  GROUP_MA = 'P1',  PRES = 2.E6) ,
        DDL_IMPO=(_F(GROUP_NO=('A',), DX=0., DY=0., DZ=0.,),
                  _F(GROUP_NO=('A2'), DY=0., DZ=0.,),
                  _F(GROUP_NO=('X1'), DZ=0.),
        ))

RAMPE=DEFI_FONCTION(NOM_PARA='INST', VALE=(0., 0., 20., 20.))
LINST1=DEFI_LIST_REEL(DEBUT=0.,
         INTERVALLE=(_F(JUSQU_A = 9.0,  NOMBRE = 1),
                     _F(JUSQU_A = 10.0, NOMBRE = 4),
                    )
         )


RESU=STAT_NON_LINE( MODELE=MO, CHAM_MATER=CHMAT, INFO=1,
             SOLVEUR=_F(NPREC=9),
             EXCIT=( _F(CHARGE = CHAR1, FONC_MULT=RAMPE),),
             INCREMENT=_F(LIST_INST = LINST1, ),
             #COMP_INCR=_F(  RELATION = 'ELAS'),
             COMP_INCR=_F(RELATION='VMIS_ISOT_LINE',),
             NEWTON=_F(  MATRICE = 'TANGENTE', REAC_ITER = 1),
             #RECH_LINEAIRE=_F( ITER_LINE_MAXI = 10),
             CONVERGENCE=_F(ARRET='OUI',
                            ITER_GLOB_MAXI=20,
                            ITER_GLOB_ELAS=25),
             )

TEST_RESU(RESU=_F(NUME_ORDRE=3,
                  GROUP_NO='X2',
                  REFERENCE='NON_DEFINI',
                  RESULTAT=RESU,
                  NOM_CHAM='DEPL',
                  NOM_CMP='DZ',
                  VALE_CALC= 5.55604099E-03,
                  VALE_REFE=5.4999999999999997E-3,
                  CRITERE='RELATIF',
                  PRECISION=0.02,),
          )

if 0 :
    # pour faire une belle image :
    RESU=CALC_CHAMP(reuse=RESU,RESULTAT=RESU,CRITERES=('SIEQ_ELNO'),VARI_INTERNE=('VARI_ELNO'),CONTRAINTE=('SIEF_ELNO'))


    RESU=CALC_CHAMP(reuse =RESU,RESULTAT=RESU,CRITERES='SIEQ_NOEU',VARI_INTERNE='VARI_NOEU')

    IMPR_RESU(FORMAT='CASTEM', UNITE=38,
              RESU=_F(MAILLAGE=MA, RESULTAT=RESU, NOM_CHAM=('DEPL','SIEQ_NOEU','VARI_NOEU',)))

if 0 :
    # pour evaluer le % de PG plastifies, on compte ceux qui ont V2=1.0 :
    X1=CREA_CHAMP(  OPERATION='EXTR', TYPE_CHAM='ELGA_VARI_R', INFO=2,
                    NOM_CHAM='VARI_ELGA', RESULTAT=RESU, NUME_ORDRE=5)


FIN()
