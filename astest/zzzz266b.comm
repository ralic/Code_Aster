# MODIF  DATE 13/12/2011   AUTEUR PELLET J.PELLET 
# TITRE  COOR_ELGA POUR MAILLES 2D et LEUR PEAUX
#            CONFIGURATION MANAGEMENT OF EDF VERSION
# ======================================================================
# COPYRIGHT (C) 1991 - 2011  EDF R&D                  WWW.CODE-ASTER.ORG
# THIS PROGRAM IS FREE SOFTWARE; YOU CAN REDISTRIBUTE IT AND/OR MODIFY  
# IT UNDER THE TERMS OF THE GNU GENERAL PUBLIC LICENSE AS PUBLISHED BY  
# THE FREE SOFTWARE FOUNDATION; EITHER VERSION 2 OF THE LICENSE, OR     
# (AT YOUR OPTION) ANY LATER VERSION.                                                    
#                                                                       
# THIS PROGRAM IS DISTRIBUTED IN THE HOPE THAT IT WILL BE USEFUL, BUT   
# WITHOUT ANY WARRANTY; WITHOUT EVEN THE IMPLIED WARRANTY OF            
# MERCHANTABILITY OR FITNESS FOR A PARTICULAR PURPOSE. SEE THE GNU      
# GENERAL PUBLIC LICENSE FOR MORE DETAILS.                              
#                                                                       
# YOU SHOULD HAVE RECEIVED A COPY OF THE GNU GENERAL PUBLIC LICENSE     
# ALONG WITH THIS PROGRAM; IF NOT, WRITE TO EDF R&D CODE_ASTER,         
#    1 AVENUE DU GENERAL DE GAULLE, 92141 CLAMART CEDEX, FRANCE.        
# ======================================================================
# zzzz266b.para = tps_job 60 mem_job 32Mo ncpus 1 liste_test R

DEBUT(CODE=_F(NOM='zzzz266b', NIV_PUB_WEB='INTERNET'),
      DEBUG=_F(SDVERI='OUI'),
      IGNORE_ALARM=('CALCULEL2_63'))

mail2d=LIRE_MAILLAGE()

modeldp=AFFE_MODELE(MAILLAGE=mail2d, 
                    AFFE=_F(TOUT='OUI',
                            PHENOMENE='MECANIQUE',MODELISATION='D_PLAN',), )

modelcp=AFFE_MODELE(MAILLAGE=mail2d, 
                    AFFE=_F(TOUT='OUI',
                            PHENOMENE='MECANIQUE',MODELISATION='C_PLAN',), )

bidon=DEFI_MATERIAU(ELAS=_F(E=1.0, NU=0.2,),)

mater=AFFE_MATERIAU(MAILLAGE=mail2d, AFFE=_F(TOUT='OUI', MATER=bidon,), )


coordp=CALC_CHAM_ELEM(MODELE=modeldp, CHAM_MATER=mater, OPTION='COOR_ELGA',)
coorcp=CALC_CHAM_ELEM(MODELE=modelcp, CHAM_MATER=mater, OPTION='COOR_ELGA',)

IMPR_RESU(RESU=_F(CHAM_GD=coordp,),)
IMPR_RESU(RESU=_F(CHAM_GD=coorcp,),)

# =============================================================================================
#  On peut verifier que l'on obtient bien la bonne longueur de la maille M5 
#  qui est une branche de parabole a l'aide du module de calcul symbolique
#  Sympy de Python.
#  Determination des parametres de la parabole :
#
#  from sympy import *
#  x, y, z = symbols('xyz')
#  solve(( (-0.5)**2*x -0.5*y+z+0.05, (0.5**2)*x +0.5*y+z, (1.5**2)*x + 1.5*y +z+0.05),x,y,z)
#  f= x*x* -0.0500000000000000 +x*0.0500000000000000 -0.0125000000000000
#  e = Integral(sqrt(1 + diff(f,x)**2),(x,-0.5,1.5))
#  e.n()
# =============================================================================================


PourTest = [
['M1',   1,  0.00000E+00,  6.69991E-01,  3.26073E-01], 
['M1',   2,  0.00000E+00,  3.30009E-01,  3.26073E-01], 
['M1',   3,  0.00000E+00,  9.30568E-01,  1.73927E-01], 
['M1',   4,  0.00000E+00,  6.94318E-02,  1.73927E-01], 
['M2',   1,  6.69991E-01,  1.00000E+00,  3.26073E-01], 
['M2',   2,  3.30009E-01,  1.00000E+00,  3.26073E-01], 
['M2',   3,  9.30568E-01,  1.00000E+00,  1.73927E-01], 
['M2',   4,  6.94318E-02,  1.00000E+00,  1.73927E-01], 
['M3',   1,  1.00000E+00,  3.30009E-01,  3.26073E-01], 
['M3',   2,  1.00000E+00,  6.69991E-01,  3.26073E-01], 
['M3',   3,  1.00000E+00,  6.94318E-02,  1.73927E-01], 
['M3',   4,  1.00000E+00,  9.30568E-01,  1.73927E-01], 
['M4',   1,  3.30009E-01,  0.00000E+00,  3.26073E-01], 
['M4',   2,  6.69991E-01,  0.00000E+00,  3.26073E-01], 
['M4',   3,  6.94318E-02,  0.00000E+00,  1.73927E-01], 
['M4',   4,  9.30568E-01,  0.00000E+00,  1.73927E-01], 
['M5',   1,  1.60019E-01, -5.77936E-03,  6.52522E-01], 
['M5',   2,  8.39981E-01, -5.77936E-03,  6.52522E-01], 
['M5',   3, -3.61136E-01, -3.70778E-02,  3.49142E-01], 
['M5',   4,  1.36114E+00, -3.70778E-02,  3.49142E-01], 
['M6',   1,  1.12702E-01,  1.12702E-01,  7.71605E-02], 
['M6',   2,  8.87298E-01,  1.12702E-01,  7.71605E-02], 
['M6',   3,  8.87298E-01,  8.87298E-01,  7.71605E-02], 
['M6',   4,  1.12702E-01,  8.87298E-01,  7.71605E-02], 
['M6',   5,  5.00000E-01,  1.12702E-01,  1.23457E-01], 
['M6',   6,  8.87298E-01,  5.00000E-01,  1.23457E-01], 
['M6',   7,  5.00000E-01,  8.87298E-01,  1.23457E-01], 
['M6',   8,  1.12702E-01,  5.00000E-01,  1.23457E-01], 
['M6',   9,  5.00000E-01,  5.00000E-01,  1.97531E-01]
]


for maille,point,X,Y,W in PourTest:
   TEST_RESU(CHAM_ELEM=(_F(CHAM_GD = coordp, MAILLE = maille, POINT = point, NOM_CMP = 'X',VALE=X , REFERENCE='ANALYTIQUE'),
                        _F(CHAM_GD = coordp, MAILLE = maille, POINT = point, NOM_CMP = 'Y',VALE=Y , REFERENCE='ANALYTIQUE'),
                        _F(CHAM_GD = coordp, MAILLE = maille, POINT = point, NOM_CMP = 'W',VALE=W , REFERENCE='ANALYTIQUE'),
                       )
            );
   TEST_RESU(CHAM_ELEM=(_F(CHAM_GD = coorcp, MAILLE = maille, POINT = point, NOM_CMP = 'X',VALE=X , REFERENCE='ANALYTIQUE'),
                        _F(CHAM_GD = coorcp, MAILLE = maille, POINT = point, NOM_CMP = 'Y',VALE=Y , REFERENCE='ANALYTIQUE'),
                        _F(CHAM_GD = coorcp, MAILLE = maille, POINT = point, NOM_CMP = 'W',VALE=W , REFERENCE='ANALYTIQUE'),
                       )
            );

FIN()
