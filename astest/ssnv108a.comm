
# ======================================================================
# COPYRIGHT (C) 1991 - 2016  EDF R&D                  WWW.CODE-ASTER.ORG
# THIS PROGRAM IS FREE SOFTWARE; YOU CAN REDISTRIBUTE IT AND/OR MODIFY
# IT UNDER THE TERMS OF THE GNU GENERAL PUBLIC LICENSE AS PUBLISHED BY
# THE FREE SOFTWARE FOUNDATION; EITHER VERSION 2 OF THE LICENSE, OR
# (AT YOUR OPTION) ANY LATER VERSION.
#
# THIS PROGRAM IS DISTRIBUTED IN THE HOPE THAT IT WILL BE USEFUL, BUT
# WITHOUT ANY WARRANTY; WITHOUT EVEN THE IMPLIED WARRANTY OF
# MERCHANTABILITY OR FITNESS FOR A PARTICULAR PURPOSE. SEE THE GNU
# GENERAL PUBLIC LICENSE FOR MORE DETAILS.
#
# YOU SHOULD HAVE RECEIVED A COPY OF THE GNU GENERAL PUBLIC LICENSE
# ALONG WITH THIS PROGRAM; IF NOT, WRITE TO EDF R&D CODE_ASTER,
#    1 AVENUE DU GENERAL DE GAULLE, 92141 CLAMART CEDEX, FRANCE.
# ======================================================================
# ----------------------------------------------------------------------
# CALCUL DE G ET G LOCAL PAR LA METHODE 'THETA_LEGENDRE'
#
# MODELISATION : ELEMENTS MECANIQUE 3D (PENTA15 ET HEXA20)
# MAILLAGE     : ASTER
#
# ----------------------------------------------------------------------
# GROUPES DE MAILLES:           PRES_REP : BOUT
# ----------------------------------------------------------------------

DEBUT(CODE=_F(
NIV_PUB_WEB='INTERNET',),DEBUG=_F(SDVERI='OUI'))
#
# --------------------------------------------------------------------

MA=LIRE_MAILLAGE(FORMAT='MED',);

MA=DEFI_GROUP( reuse=MA,   MAILLAGE=MA,
                     CREA_GROUP_NO= _F(NOM = 'NTEST',
                                       OPTION='ENV_SPHERE',
                                       POINT=(12.5,-10.,0.),
                                       PRECISION=0.0001,
                                       RAYON=0.0001),
                )

# Barsoum
MA=MODI_MAILLAGE(reuse=MA,
                 MAILLAGE=MA,
                 MODI_MAILLE=_F(OPTION='NOEUD_QUART',
                                GROUP_NO_FOND='FONFIS'));

MO=AFFE_MODELE(MAILLAGE=MA,
               AFFE=_F(TOUT='OUI',
                       PHENOMENE='MECANIQUE',
                       MODELISATION='3D',),);

FONC1=DEFI_FONCTION(NOM_PARA='EPSI',
                    VALE=
                    (      0.001707,350.0,0.002,394.0,0.002333,450.5,0.002667,491.5,0.003,518.8,0.003333,534.4,
                           0.004,546.1,0.004667,551.9,0.008,565.6,0.016,590.0,0.024,614.3,0.035,643.6,0.045,663.1,0.055,669.0,
                           0.075,674.8,0.1,676.0,1.0,680.0,100.0,700.0,),
                    PROL_DROITE='LINEAIRE',
                    PROL_GAUCHE='LINEAIRE',);

MAT=DEFI_MATERIAU(ELAS=_F(E=205000.0,
                          NU=0.3,
                          RHO=0.0,
                          ALPHA=0.0,),
                  TRACTION=_F(SIGM=FONC1,),);

CHMAT=AFFE_MATERIAU(MAILLAGE=MA,
                    AFFE=_F(TOUT='OUI',
                            MATER=MAT,
                            ),);
# ------------------------------------------------------------------
#    -------------------------------------------------------------

CH=AFFE_CHAR_MECA(MODELE=MO,
                  DDL_IMPO=(_F(GROUP_NO='GRN2',
                               DZ=0.0,),
                            _F(GROUP_NO='GRN1',
                               DY=0.0,),
                            _F(GROUP_NO='GRN5',
                               DX=0.0,
                               DY=-1.0,),),);
#
RAMPE=DEFI_FONCTION(  NOM_PARA='INST',
                        VALE=(0.,0.,1.,1.,),
                        PROL_DROITE='LINEAIRE'
                      )
L_INST=DEFI_LIST_REEL(DEBUT=0.0,
                      INTERVALLE=_F(JUSQU_A=1.0,
                                    NOMBRE=1,),);

U=STAT_NON_LINE(MODELE=MO,
                CHAM_MATER=CHMAT,
                EXCIT=_F(CHARGE=CH,FONC_MULT = RAMPE),
                COMPORTEMENT=_F(RELATION='ELAS_VMIS_TRAC',),
#                COMPORTEMENT=_F(RELATION='ELAS',),
                INCREMENT=_F(LIST_INST=L_INST,),
                NEWTON=_F(MATRICE='TANGENTE',
                          REAC_ITER=1,),
                RECH_LINEAIRE=_F(RESI_LINE_RELA=0.001,
                                 ITER_LINE_MAXI=3,),
                CONVERGENCE=_F(SIGM_REFE=0.055,
                               RESI_REFE_RELA=1.0,
                               ITER_GLOB_MAXI=25,),
                 );

U=CALC_CHAMP(reuse=U,RESULTAT=U,CONTRAINTE=('SIGM_ELNO'),VARI_INTERNE=('VARI_ELNO'))

#

TABDEP= POST_RELEVE_T ( ACTION =_F(INTITULE   = 'DEPLACEMENT_FISSURE',
                                   GROUP_NO   = 'NTEST',
                                   RESULTAT   = U,
                                   NOM_CHAM   = 'DEPL',
                                   NOM_CMP    = ( 'DX','DY',),
                                   OPERATION  = 'EXTRACTION',),);

IMPR_TABLE(TABLE=TABDEP,);


TEST_TABLE(CRITERE='RELATIF',
           VALE_CALC=-0.79431973268239,
           NOM_PARA='DY',
           TABLE=TABDEP,
           FILTRE=_F(NOM_PARA='NUME_ORDRE',
                     VALE_I=1,),
           )

TEST_RESU(RESU=(_F(NUME_ORDRE=1,
                   PARA='INST',
                   RESULTAT=U,
                   VALE_CALC=1.0,
                   ),
                _F(NUME_ORDRE=1,
                   PARA='ITER_GLOB',
                   VALE_CALC_I=8,
                   RESULTAT=U,
                   CRITERE='ABSOLU',
                   ),
                ),
          )

#

FISS1=DEFI_FOND_FISS(MAILLAGE=MA,
                     SYME='OUI',
                     FOND_FISS=_F(GROUP_NO='FONFIS',
                                  DTAN_ORIG=(1.0,0.0,0.0,),),
                    );

FISS2=DEFI_FOND_FISS(MAILLAGE=MA,
                     SYME='OUI',
                     FOND_FISS=_F(NOEUD=('NO3173','NO3174','NO3180',
                                         'NO3181','NO3190','NO3191',
                                         'NO3198','NO3199','NO3204',
                                         'NO3205','NO3206',),
                                  DTAN_ORIG=(1.0,0.0,0.0,),),
                    );

#

G1=CALC_G(        OPTION='CALC_G_GLOB',
                  THETA=_F(
                           FOND_FISS=FISS1,
                           MODULE=1.0,
                           R_INF=0.4,
                           R_SUP=1.2),
                  RESULTAT=U,
                  NUME_ORDRE=1,
                   );
#

G2=CALC_G(        OPTION='CALC_G_GLOB',
                  THETA=_F(
                           FOND_FISS=FISS2,
                           MODULE=1.0,
                           R_INF=1.2,
                           R_SUP=2.857),
                  RESULTAT=U,
                  NUME_ORDRE=1,
                   );
#

G3=CALC_G(        OPTION='CALC_G_GLOB',
                  THETA=_F(
                           FOND_FISS=FISS1,
                           MODULE=1.0,
                           R_INF=2.857,
                           R_SUP=5.2),
                  RESULTAT=U,
                  NUME_ORDRE=1,
                   );
#

GLOC1=CALC_G(        THETA=_F(FOND_FISS=FISS1,
                              R_INF=0.4,
                              R_SUP=1.2,),
                     RESULTAT=U,
                     NUME_ORDRE=1,

                     LISSAGE=_F(DEGRE=3),)
#

GLOC2=CALC_G(        THETA=_F(FOND_FISS=FISS2,
                              R_INF=1.2,
                              R_SUP=2.857,),
                     RESULTAT=U,
                     NUME_ORDRE=1,

                     LISSAGE=_F(DEGRE=3),)

#

GLOC3=CALC_G(        THETA=_F(FOND_FISS=FISS1,
                              R_INF=2.857,
                              R_SUP=5.2,),
                     RESULTAT=U,
                     NUME_ORDRE=1,

                     LISSAGE=_F(DEGRE=3,))

#----------------------------------------------------------------------
#              TEST DE G SUR LES 3 COURONNES
#----------------------------------------------------------------------

TEST_TABLE(
           VALE_CALC=3316.0437477613,

           NOM_PARA='G',
           TABLE=G1,)

TEST_TABLE(
           VALE_CALC=3457.1755904832,

           NOM_PARA='G',
           TABLE=G2,)

TEST_TABLE(
           VALE_CALC=3449.5796006255,

           NOM_PARA='G',
           TABLE=G3,)

#----------------------------------------------------------------------
#              TEST DE G(S)LOCAL SUR LES 3 COURONNES
#----------------------------------------------------------------------

TEST_TABLE(
           VALE_CALC=42.96782361684,

           NOM_PARA='G',
           TABLE=GLOC1,
           FILTRE=_F(NOM_PARA='NOEUD',
                     VALE_K='NO3173',),
           )

TEST_TABLE(
           VALE_CALC=43.609504168104,

           NOM_PARA='G',
           TABLE=GLOC2,
           FILTRE=_F(NOM_PARA='NOEUD',
                     VALE_K='NO3173',),
           )

TEST_TABLE(
           VALE_CALC=41.764452822347,
           NOM_PARA='G',
           TABLE=GLOC3,
           FILTRE=_F(NOM_PARA='NOEUD',
                     VALE_K='NO3173',),
           )

IMPR_RESU(FORMAT='GMSH',UNITE=81,RESU=_F(RESULTAT=U,
                                         NOM_CHAM='DEPL',
                                         NUME_ORDRE=1,
             ));

#NO793
#NO794
#NO795
#NO796
#NO797
#NO798

# ======================================================================

FIN();
#
