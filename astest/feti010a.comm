# MODIF  DATE 22/06/2010   AUTEUR SELLENET N.SELLENET 
# TITRE VALIDATION CALCUL FETI + CONTACT CONTINU ENTRE DEUX CLOISONS
# feti010a.para = tps_job 60 mem_job 128Mo ncpus 1 liste_test S
#            CONFIGURATION MANAGEMENT OF EDF VERSION
# ======================================================================
# COPYRIGHT (C) 1991 - 2007  EDF R&D                  WWW.CODE-ASTER.ORG
# THIS PROGRAM IS FREE SOFTWARE; YOU CAN REDISTRIBUTE IT AND/OR MODIFY
# IT UNDER THE TERMS OF THE GNU GENERAL PUBLIC LICENSE AS PUBLISHED BY
# THE FREE SOFTWARE FOUNDATION; EITHER VERSION 2 OF THE LICENSE, OR
# (AT YOUR OPTION) ANY LATER VERSION.
#
# THIS PROGRAM IS DISTRIBUTED IN THE HOPE THAT IT WILL BE USEFUL, BUT
# WITHOUT ANY WARRANTY; WITHOUT EVEN THE IMPLIED WARRANTY OF
# MERCHANTABILITY OR FITNESS FOR A PARTICULAR PURPOSE. SEE THE GNU
# GENERAL PUBLIC LICENSE FOR MORE DETAILS.
#
# YOU SHOULD HAVE RECEIVED A COPY OF THE GNU GENERAL PUBLIC LICENSE
# ALONG WITH THIS PROGRAM; IF NOT, WRITE TO EDF R&D CODE_ASTER,
#    1 AVENUE DU GENERAL DE GAULLE, 92141 CLAMART CEDEX, FRANCE.
# ======================================================================
# ======================================================================
# INTERNES DE CUVE MODELISES TRES GROSSIEREMENT POUR VALIDER INFORMATI
# QUEMENT LA FAISABILITE D'UN TEL CALCUL AVEC FETI ET LA METHODE DE
# CONTACT CONTINUE.
# LE PARTITIONNEMENT EN DEUX SOUS-DOMAINES EST MANUEL.
# CHAQUE SOUS-DOMAINE EST COMPOSE DE DEUX PARTIES DISJOINTES, DES
# MOITIES DE CLOISON DECOUPEES A MI-HAUTEUR. CELA NE POSE PAS DE PB
# POUR FETI CAR CETTE NON CONNEXITE NE PERTURBE PAS LA DEFINITION DES
# INTERFACES.
# LE CONTACT S'OPERE JUSTEMENT, AU SEIN DE CHAQUE SOUS-DOMAINE, ENTRE
# SES DEUX PAROIES. LES ZONES DE CONTACT NE TOUCHENT PAS L'INTERFACE.
# ON FAIT UN PREMIER CALCUL SANS CONTACT POUR VALIDER LA DEMARCHE DE
# SOUS-DOMAINES NON CONNEXES AINSI QUE L'ACCELERATION SECOND MEMBRE.
# PUIS ON RAJOUTE LE CONTACT POUR FAIRE LE SECOND CALCUL.
# PARALLELE: VALEUR CONSEILLEE 2 PROCS.
# ======================================================================
# RESPONSABLE BOITEAU O.BOITEAU

DEBUT(CODE=_F(NOM='FETI010A',NIV_PUB_WEB='INTRANET'),DEBUG=_F(SDVERI='NON'))

PRE_GIBI();
MA=LIRE_MAILLAGE();

MOMEQ=AFFE_MODELE(MAILLAGE=MA,
                  AFFE=_F(GROUP_MA=('CLOIS_1B','CLOIS_1H','CLOIS_2B','CLOIS_2H','BAS_CL_1','BAS_CL_2','FAC_EX11','FAC_EX12',
                                    'FAC_EX21','FAC_EX22','FAC_PRE1','FAC_PRE2','BH','CH','BB','CB',),
                          PHENOMENE='MECANIQUE',
                          MODELISATION=('3D','3D_SI',),),);

MA=MODI_MAILLAGE(reuse =MA,
                 MAILLAGE=MA,
                 ORIE_PEAU_3D=_F(GROUP_MA=('BAS_CL_1','BAS_CL_2','FAC_EX11','FAC_EX12','FAC_EX21','FAC_EX22',
                                            'FAC_PRE1','FAC_PRE2','FAC_CO12','FAC_CO15','FAC_CO22','FAC_CO25',),),
                 INFO=1,);

MACLOI=DEFI_MATERIAU(ELAS=_F(E=204000.0,
                             NU=0.3,
                             ALPHA=1.122e-05,),);

CM1=AFFE_MATERIAU(MAILLAGE=MA,
                  AFFE=_F(GROUP_MA=('CLOIS_1B','CLOIS_1H','CLOIS_2B','CLOIS_2H','BAS_CL_1','BAS_CL_2','FAC_EX11','FAC_EX12',
                                    'FAC_EX21','FAC_EX22','FAC_PRE1','FAC_PRE2',),
                          MATER=MACLOI,
                          ),);


CHCONT = DEFI_CONTACT( MODELE=MOMEQ,
                    FORMULATION='CONTINUE',
                    ZONE = (
                             _F(GROUP_MA_MAIT='FAC_CO12',
                                  GROUP_MA_ESCL='FAC_CO22',
                               ),
                             _F(GROUP_MA_MAIT='FAC_CO15',
                                  GROUP_MA_ESCL='FAC_CO25',
                               ),                                
                       ),
                    );


BRIDE=AFFE_CHAR_MECA(MODELE=MOMEQ,
                     DDL_IMPO=_F(GROUP_MA=('BAS_CL_1','BAS_CL_2',),
                                  LIAISON='ENCASTRE',),);

F_PRES=DEFI_FONCTION(NOM_PARA='INST',VALE=(0.,0.,
                           2.,0.2,
                           4.,0.4,
                           6.,0.6,
                           8.,0.8,
                           10.,1.,
                           ),PROL_DROITE='CONSTANT',PROL_GAUCHE='CONSTANT',);

CHAR_PSC=AFFE_CHAR_MECA(MODELE=MOMEQ,
                        PRES_REP=_F(GROUP_MA=('FAC_PRE1','FAC_PRE2',),
                                    PRES=1.E2,),);

SDFETISC=DEFI_PART_OPS(MODELE=MOMEQ,
                     NOM='SD',
                     DEFI=(_F(GROUP_MA='CB',
                              GROUP_MA_BORD='BB',),
                           _F(GROUP_MA='CH',
                              GROUP_MA_BORD='BH',),),
                     EXCIT=(
                            _F(CHARGE=BRIDE,),
                            _F(CHARGE=CHAR_PSC,),
                            ),);
SDFETIAC=DEFI_PART_OPS(MODELE=MOMEQ,
                     NOM='SD',
                     DEFI=(_F(GROUP_MA='CB',
                              GROUP_MA_BORD='BB',),
                           _F(GROUP_MA='CH',
                              GROUP_MA_BORD='BH',),),
                     EXCIT=(
                            _F(CHARGE=BRIDE,),
                            _F(CHARGE=CHAR_PSC,),
                            ),);
LINST=DEFI_LIST_REEL(DEBUT=0.,
                     INTERVALLE=_F(JUSQU_A=3.,
                                   PAS=1.,),);
# CALCUL SANS CONTACT
RESUSC=STAT_NON_LINE(MODELE=MOMEQ,
                 CHAM_MATER=CM1,
                 EXCIT=(
                        _F(CHARGE=BRIDE,),
                        _F(CHARGE=CHAR_PSC,),
                        ),
     
                 COMP_INCR=_F(RELATION='ELAS',
                              GROUP_MA=
                              ('CLOIS_1B','CLOIS_1H','CLOIS_2B','CLOIS_2H','BAS_CL_1',
                                         'BAS_CL_2','FAC_EX11','FAC_EX12',
                                         'FAC_EX21','FAC_EX22','FAC_PRE1','FAC_PRE2',),),
                 INCREMENT=_F(LIST_INST=LINST,),
                 NEWTON=_F(
                           PREDICTION='ELASTIQUE',
                           MATRICE='TANGENTE',
                           REAC_ITER=1,
                           REAC_INCR=0),
                 CONVERGENCE=_F(RESI_GLOB_MAXI=0.01,
                                RESI_GLOB_RELA=1e-04,
                                ITER_GLOB_MAXI=20,
                                ),
                 SOLVEUR=_F(METHODE='FETI',
                            PARTITION=SDFETISC,
                            RESI_RELA=1.E-8,
                            NMAX_ITER=20,
                            NB_REORTHO_DD=20,
                            NB_REORTHO_INST=5,
                            ),
                 INFO=1,);

# CALCUL AVEC CONTACT
RESUAC=STAT_NON_LINE(MODELE=MOMEQ,
                 CHAM_MATER=CM1,
                 CONTACT = CHCONT,                   
                 EXCIT=(
                        _F(CHARGE=BRIDE,),
                        _F(CHARGE=CHAR_PSC,),
                        ),
                        
                 COMP_INCR=_F(RELATION='ELAS',
                              GROUP_MA=
                              ('CLOIS_1B','CLOIS_1H','CLOIS_2B','CLOIS_2H','BAS_CL_1',
                                         'BAS_CL_2','FAC_EX11','FAC_EX12',
                                         'FAC_EX21','FAC_EX22','FAC_PRE1','FAC_PRE2',),),
                 INCREMENT=_F(LIST_INST=LINST,),
                 NEWTON=_F(
                           PREDICTION='ELASTIQUE',
                           MATRICE='TANGENTE',
                           REAC_ITER=1,),
                 CONVERGENCE=_F(RESI_GLOB_MAXI=0.01,
                                RESI_GLOB_RELA=1e-04,
                                ITER_GLOB_MAXI=20,
                                ARRET='OUI',),
                 SOLVEUR=_F(METHODE='MUMPS',
                            MATR_DISTRIBUEE='OUI',),
                 INFO=1,);
# TEST DEPLACEMENTS
# 2 NOEUDS DIRICHLET, 1 NOEUD AU MILIEU DE LA STRUCTURE
# SI CONTACT: 2 NOEUDS  DE CONTACT, CHACUN DANS UN SD (+LAGS_C )
TEST_RESU(RESU=(
     _F(  RESULTAT = RESUSC,   NUME_ORDRE = 3,
          NOM_CHAM = 'DEPL',   NOEUD = 'N1',
          CRITERE = 'ABSOLU', PRECISION = 1.E-10,
          NOM_CMP = 'DX',    VALE = 0., REFERENCE = 'NON_REGRESSION' ),
     _F(  RESULTAT = RESUSC,   NUME_ORDRE = 3,
          NOM_CHAM = 'DEPL',   NOEUD = 'N1',
          CRITERE = 'ABSOLU', PRECISION = 1.E-10,
          NOM_CMP = 'DY',    VALE = 0., REFERENCE = 'NON_REGRESSION' ),
     _F(  RESULTAT = RESUSC,   NUME_ORDRE = 3,
          NOM_CHAM = 'DEPL',   NOEUD = 'N1',
          CRITERE = 'ABSOLU', PRECISION = 1.E-10,
          NOM_CMP = 'DZ',    VALE = 0., REFERENCE = 'NON_REGRESSION' ),
     _F(  RESULTAT = RESUSC,   NUME_ORDRE = 3,
          NOM_CHAM = 'DEPL',   NOEUD = 'N60',
          CRITERE = 'ABSOLU', PRECISION = 1.E-10,
          NOM_CMP = 'DX',    VALE = 0., REFERENCE = 'NON_REGRESSION' ),
     _F(  RESULTAT = RESUSC,   NUME_ORDRE = 3,
          NOM_CHAM = 'DEPL',   NOEUD = 'N60',
          CRITERE = 'ABSOLU', PRECISION = 1.E-10,
          NOM_CMP = 'DY',    VALE = 0., REFERENCE = 'NON_REGRESSION' ),
     _F(  RESULTAT = RESUSC,   NUME_ORDRE = 3,
          NOM_CHAM = 'DEPL',   NOEUD = 'N60',
          CRITERE = 'ABSOLU', PRECISION = 1.E-10,
          NOM_CMP = 'DZ',    VALE = 0., REFERENCE = 'NON_REGRESSION' ),
     _F(  RESULTAT = RESUSC,   NUME_ORDRE = 3,
          NOM_CHAM = 'DEPL',   NOEUD = 'N81',
          CRITERE = 'ABSOLU', PRECISION = 1.E-10,
          NOM_CMP = 'DX',    VALE = -8.3008339843883E-18, REFERENCE = 'NON_REGRESSION' ),
     _F(  RESULTAT = RESUSC,   NUME_ORDRE = 3,
          NOM_CHAM = 'DEPL',   NOEUD = 'N81',
          CRITERE = 'RELATIF', PRECISION = 1.E-6,
          NOM_CMP = 'DY',    VALE = 7.1543318506902E-02, REFERENCE = 'NON_REGRESSION' ),
     _F(  RESULTAT = RESUSC,   NUME_ORDRE = 3,
          NOM_CHAM = 'DEPL',   NOEUD = 'N81',
          CRITERE = 'RELATIF', PRECISION = 1.E-6,
          NOM_CMP = 'DZ',    VALE = 2.6654320679098E-02, REFERENCE = 'NON_REGRESSION' ),
          ),);
TEST_RESU(RESU=(
     _F(  RESULTAT = RESUAC,   NUME_ORDRE = 3,
          NOM_CHAM = 'DEPL',   NOEUD = 'N1',
          CRITERE = 'ABSOLU', PRECISION = 1.E-10,
          NOM_CMP = 'DX',    VALE = 0., REFERENCE = 'NON_REGRESSION' ),
     _F(  RESULTAT = RESUAC,   NUME_ORDRE = 3,
          NOM_CHAM = 'DEPL',   NOEUD = 'N1',
          CRITERE = 'ABSOLU', PRECISION = 1.E-10,
          NOM_CMP = 'DY',    VALE = 0., REFERENCE = 'NON_REGRESSION' ),
     _F(  RESULTAT = RESUAC,   NUME_ORDRE = 3,
          NOM_CHAM = 'DEPL',   NOEUD = 'N1',
          CRITERE = 'ABSOLU', PRECISION = 1.E-10,
          NOM_CMP = 'DZ',    VALE = 0., REFERENCE = 'NON_REGRESSION' ),
     _F(  RESULTAT = RESUAC,   NUME_ORDRE = 3,
          NOM_CHAM = 'DEPL',   NOEUD = 'N60',
          CRITERE = 'ABSOLU', PRECISION = 1.E-10,
          NOM_CMP = 'DX',    VALE = 0., REFERENCE = 'NON_REGRESSION' ),
     _F(  RESULTAT = RESUAC,   NUME_ORDRE = 3,
          NOM_CHAM = 'DEPL',   NOEUD = 'N60',
          CRITERE = 'ABSOLU', PRECISION = 1.E-10,
          NOM_CMP = 'DY',    VALE = 0., REFERENCE = 'NON_REGRESSION' ),
     _F(  RESULTAT = RESUAC,   NUME_ORDRE = 3,
          NOM_CHAM = 'DEPL',   NOEUD = 'N60',
          CRITERE = 'ABSOLU', PRECISION = 1.E-10,
          NOM_CMP = 'DZ',    VALE = 0., REFERENCE = 'NON_REGRESSION' ),
     _F(  RESULTAT = RESUAC,   NUME_ORDRE = 3,
          NOM_CHAM = 'DEPL',   NOEUD = 'N81',
          CRITERE = 'RELATIF', PRECISION = 1.E-6,
          NOM_CMP = 'DX',    VALE = 1.4962042296068E-03, REFERENCE = 'NON_REGRESSION' ),
     _F(  RESULTAT = RESUAC,   NUME_ORDRE = 3,
          NOM_CHAM = 'DEPL',   NOEUD = 'N81',
          CRITERE = 'RELATIF', PRECISION = 1.E-6,
          NOM_CMP = 'DY',    VALE = 2.3819504221574E-02, REFERENCE = 'NON_REGRESSION' ),
     _F(  RESULTAT = RESUAC,   NUME_ORDRE = 3,
          NOM_CHAM = 'DEPL',   NOEUD = 'N81',
          CRITERE = 'RELATIF', PRECISION = 1.E-6,
          NOM_CMP = 'DZ',    VALE = 7.2124720969976E-03, REFERENCE = 'NON_REGRESSION' ),
     _F(  RESULTAT = RESUAC,   NUME_ORDRE = 3,
          NOM_CHAM = 'DEPL',   NOEUD = 'N43',
          CRITERE = 'RELATIF', PRECISION = 1.E-6,
          NOM_CMP = 'DX',    VALE = 5.6700806178104E-04, REFERENCE = 'NON_REGRESSION' ),
     _F(  RESULTAT = RESUAC,   NUME_ORDRE = 3,
          NOM_CHAM = 'DEPL',   NOEUD = 'N43',
          CRITERE = 'RELATIF', PRECISION = 1.E-6,
          NOM_CMP = 'DY',    VALE = 5.3139955129224E-03, REFERENCE = 'NON_REGRESSION' ),
     _F(  RESULTAT = RESUAC,   NUME_ORDRE = 3,
          NOM_CHAM = 'DEPL',   NOEUD = 'N43',
          CRITERE = 'RELATIF', PRECISION = 1.E-6,
          NOM_CMP = 'DZ',    VALE = 4.9769949461976E-03, REFERENCE = 'NON_REGRESSION' ),
     _F(  RESULTAT = RESUAC,   NUME_ORDRE = 3,
          NOM_CHAM = 'DEPL',   NOEUD = 'N43',
          CRITERE = 'ABSOLU', PRECISION = 1.E-10,
          NOM_CMP = 'LAGS_C', VALE = 0., REFERENCE = 'NON_REGRESSION' ),
     _F(  RESULTAT = RESUAC,   NUME_ORDRE = 3,
          NOM_CHAM = 'DEPL',   NOEUD = 'N48',
          CRITERE = 'RELATIF', PRECISION = 1.E-6,
          NOM_CMP = 'DX',    VALE = 3.7068985502003E-03, REFERENCE = 'NON_REGRESSION' ),
     _F(  RESULTAT = RESUAC,   NUME_ORDRE = 3,
          NOM_CHAM = 'DEPL',   NOEUD = 'N48',
          CRITERE = 'RELATIF', PRECISION = 1.E-6,
          NOM_CMP = 'DY',    VALE = 3.3683128945845E-02, REFERENCE = 'NON_REGRESSION' ),
     _F(  RESULTAT = RESUAC,   NUME_ORDRE = 3,
          NOM_CHAM = 'DEPL',   NOEUD = 'N48',
          CRITERE = 'RELATIF', PRECISION = 1.E-6,
          NOM_CMP = 'DZ',    VALE = 1.0934419826327E-02, REFERENCE = 'NON_REGRESSION' ),
     _F(  RESULTAT = RESUAC,   NUME_ORDRE = 3,
          NOM_CHAM = 'DEPL',   NOEUD = 'N48',
          CRITERE = 'RELATIF', PRECISION = 1.E-6,
          NOM_CMP = 'LAGS_C', VALE = -2.60866393E+02, REFERENCE = 'NON_REGRESSION' ),
          ),);
#IMPR_RESU(UNITE=6,RESU=_F(RESULTAT=RESUSC,),);
#IMPR_RESU(UNITE=6,RESU=_F(RESULTAT=RESUAC,),);
#STANLEY();
FIN();
