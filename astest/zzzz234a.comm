# MODIF  DATE 21/02/2011   AUTEUR ABBAS M.ABBAS 
# TITRE VALEUR DE REFERENCE POUR LES ELEMENTS POUTRES
# zzzz234a.para = tps_job 60 mem_job 64Mo ncpus 1 liste_test R
#            CONFIGURATION MANAGEMENT OF EDF VERSION
# ======================================================================
# COPYRIGHT (C) 1991 - 2011  EDF R&D                  WWW.CODE-ASTER.ORG
# THIS PROGRAM IS FREE SOFTWARE; YOU CAN REDISTRIBUTE IT AND/OR MODIFY
# IT UNDER THE TERMS OF THE GNU GENERAL PUBLIC LICENSE AS PUBLISHED BY
# THE FREE SOFTWARE FOUNDATION; EITHER VERSION 2 OF THE LICENSE, OR
# (AT YOUR OPTION) ANY LATER VERSION.
#
# THIS PROGRAM IS DISTRIBUTED IN THE HOPE THAT IT WILL BE USEFUL, BUT
# WITHOUT ANY WARRANTY; WITHOUT EVEN THE IMPLIED WARRANTY OF
# MERCHANTABILITY OR FITNESS FOR A PARTICULAR PURPOSE. SEE THE GNU
# GENERAL PUBLIC LICENSE FOR MORE DETAILS.
#
# YOU SHOULD HAVE RECEIVED A COPY OF THE GNU GENERAL PUBLIC LICENSE
# ALONG WITH THIS PROGRAM; IF NOT, WRITE TO EDF R&D CODE_ASTER,
#    1 AVENUE DU GENERAL DE GAULLE, 92141 CLAMART CEDEX, FRANCE.
# ======================================================================
DEBUT(CODE=_F(NOM='ZZZZ234A',NIV_PUB_WEB='INTERNET'),
      DEBUG=_F(SDVERI='OUI'))


# Fonction de calcul de l'erreur
CoefRef = 1.0E-05



MA = LIRE_MAILLAGE(INFO=2);

# Poutes multifibres POU_D_EM et POU_D_TGM
# lecture du maillage de la section

PRE_GMSH(UNITE_GMSH=19, UNITE_MAILLAGE=21)

MASECT=LIRE_MAILLAGE(UNITE=21,INFO=2)

GFF=DEFI_GEOM_FIBRE(SECTION= _F(MAILLAGE_SECT = MASECT , TOUT_SECT = 'OUI',
                                GROUP_FIBRE = 'ACIER',
                                COOR_AXE_POUTRE = (0.,0.,)))

MATE = DEFI_MATERIAU(ELAS=_F(E=2.1E11,NU=0.3),)

MATFF=DEFI_COMPOR(GEOM_FIBRE=GFF,MATER_SECT=MATE,
                 MULTIFIBRE=(_F(GROUP_FIBRE='ACIER',MATER=MATE,RELATION='ELAS')))

#

CHMAT = AFFE_MATERIAU(MAILLAGE=MA,
                      AFFE        = _F(TOUT='OUI',MATER=MATE,),
                      AFFE_COMPOR = _F(TOUT='OUI',COMPOR=MATFF))

#=====================================================================================
#    POUTRES
#=====================================================================================
#    POU_D_T   : Poutre droite de Timoshenko
#    POU_D_E   : Poutre droite d'EULER
#    POU_D_TG  : Poutre droite de Timoshenko (avec gauchissement)
#    POU_D_EM  : Poutres multi-fibres
#    POU_D_TGM : Poutre droite multi-fibres de Timoshenko (avec gauchissement)
#    POU_D_TGD : Poutre droite (grands deplassements)
#    POU_C_T   : Poutre courbe de Timoshenko
#-----------------------------------------------------------------------

LIS_INST =DEFI_LIST_REEL(DEBUT=0.0,INTERVALLE=(_F(JUSQU_A=1.0,NOMBRE=1,),),)

#-------------------------------------------------------------------------------------
# 1 --> POU_D_T
#-----------------

MO_D_T = AFFE_MODELE(MAILLAGE=MA,
                     AFFE=_F(GROUP_MA='POUD',PHENOMENE='MECANIQUE',MODELISATION='POU_D_T'),)

CA_D_T = AFFE_CARA_ELEM(  POUTRE=_F( GROUP_MA='POUD',
                                  SECTION='CERCLE',CARA= 'R',VALE=0.02,),
                                  MODELE=MO_D_T)

CL_D_T = AFFE_CHAR_MECA(MODELE=MO_D_T,
                               DDL_IMPO=_F(GROUP_NO='A',
                               DX=0., DY=0., DZ=0.,
                               DRX=0.,DRY=0.,DRZ=0.),)

CH_D_T = AFFE_CHAR_MECA(MODELE=MO_D_T,
                        FORCE_NODALE=_F(GROUP_NO='B',
                                        FX= 1000.,
                                        FY= 1100.,
                                        FZ= 1200.,
                                        MX= 1300.,
                                        MY= 1400.,
                                        MZ= 1500.,
                                        ),)


RE_D_T=STAT_NON_LINE(MODELE     = MO_D_T,
                     CHAM_MATER = CHMAT,
                     CARA_ELEM  = CA_D_T,
                     EXCIT      = (_F(CHARGE = CL_D_T),
                                   _F(CHARGE = CH_D_T),),
                     COMP_INCR  =  _F(RELATION   = 'ELAS',
                                     DEFORMATION = 'PETIT',
                                     GROUP_MA    = 'POUD',),
                     INCREMENT = _F(LIST_INST = LIS_INST,),
                     CONVERGENCE = _F(RESI_REFE_RELA=1.0,FORC_REFE =(CoefRef,CoefRef),),
   );

TB_D_T = RECU_TABLE(CO=RE_D_T,NOM_PARA=('ITER_GLOB'),)

IMPR_TABLE(TABLE=TB_D_T)
TEST_TABLE(TABLE=TB_D_T, NOM_PARA='ITER_GLOB', VALE_I=1, FILTRE=_F(NOM_PARA='NUME_ORDRE',VALE_I=1,),
           CRITERE = 'ABSOLU',        PRECISION = 0., REFERENCE='NON_REGRESSION',); 

TEST_RESU(RESU=(_F(RESULTAT   = RE_D_T,
                   INST       = 1.0,
                   NOM_CHAM   = 'DEPL',
                   GROUP_NO   = 'B',
                   NOM_CMP    = 'DY',
                   VALE       = 0.042327046592878,
                   REFERENCE  = 'NON_REGRESSION',
                   VERSION    = '10.2.20',
                   PRECISION  = 1E-8,
                   ),),
       )      

# --- validation CREA_CHAMP/'NEUT' aux points de GAUSS  ---   
FFDEUX = FORMULE(NOM_PARA=('X1','X2','X3'),VALE='3*X1 + 2*X2 - X3')

FELG01=CREA_CHAMP(
   OPERATION='AFFE', TYPE_CHAM='ELGA_NEUT_F',
   MODELE=MO_D_T,  PROL_ZERO='OUI',   INFO=1,
   AFFE=_F( GROUP_MA='POUD', NOM_CMP = ('X1'), VALE_F = FFDEUX,),)

NELG10=CREA_CHAMP(NUME_ORDRE = 1,
   OPERATION='EXTR', TYPE_CHAM='ELGA_SIEF_R',RESULTAT=RE_D_T, NOM_CHAM='SIEF_ELGA')

NELG11=CREA_CHAMP(
   OPERATION='ASSE', TYPE_CHAM='ELGA_NEUT_R',
   MODELE=MO_D_T,  PROL_ZERO='OUI',
   ASSE=_F( GROUP_MA='POUD',   CHAM_GD = NELG10, NOM_CMP = ('N','VY','VZ'  ), NOM_CMP_RESU = ('X1','X2','X3'),), )

NELG12=CREA_CHAMP(
   OPERATION='AFFE', TYPE_CHAM='ELGA_NEUT_R',
   MODELE=MO_D_T,  PROL_ZERO='OUI',   INFO=1,
   AFFE=_F( GROUP_MA='POUD', NOM_CMP = ('X1','X2','X3'), VALE =(1.0,0.5,2.0),),)

NELG01=CREA_CHAMP(
   OPERATION='ASSE', TYPE_CHAM='ELGA_NEUT_R',   MODELE=MO_D_T,  
   ASSE=(_F( GROUP_MA='POUD', CHAM_GD = NELG11, CUMUL='OUI',COEF_R= 1.0),
         _F( GROUP_MA='POUD', CHAM_GD = NELG12, CUMUL='OUI',COEF_R= -1000.0),),)

VELG01=CREA_CHAMP(
   OPERATION='EVAL', TYPE_CHAM='ELGA_NEUT_R', INFO=1,
   CHAM_F=FELG01,  CHAM_PARA=NELG01   )

SELG01=CREA_CHAMP(
   OPERATION='ASSE', TYPE_CHAM='ELGA_SIEF_R',
   MODELE=MO_D_T,  PROL_ZERO='OUI',
   ASSE=_F( GROUP_MA='POUD',   CHAM_GD = VELG01, NOM_CMP = ('X1',  ), NOM_CMP_RESU = ('N'),), )


TEST_RESU(CHAM_ELEM=_F(CHAM_GD=SELG01,NOM_CMP='N',MAILLE='M1',POINT=1,VALE=2000.0,REFERENCE='ANALYTIQUE'),)


# --- validation CREA_CHAMP/'NEUT' aux noeuds par element  ---   
FELN01=CREA_CHAMP(
   OPERATION='AFFE', TYPE_CHAM='ELNO_NEUT_F',
   MODELE=MO_D_T,  PROL_ZERO='OUI',   
   AFFE=_F( GROUP_MA='POUD', NOM_CMP = ('X1'), VALE_F = FFDEUX,),)

NELN10=CREA_CHAMP(MODELE=MO_D_T,
   OPERATION='DISC', TYPE_CHAM='ELNO_SIEF_R',CHAM_GD=NELG10)

NELN11=CREA_CHAMP(
   OPERATION='ASSE', TYPE_CHAM='ELNO_NEUT_R',
   MODELE=MO_D_T,  PROL_ZERO='OUI',
   ASSE=_F( GROUP_MA='POUD',   CHAM_GD = NELN10, NOM_CMP = ('N','VY','VZ'  ), NOM_CMP_RESU = ('X1','X2','X3'),), )

NELN12=CREA_CHAMP(
   OPERATION='AFFE', TYPE_CHAM='ELNO_NEUT_R',
   MODELE=MO_D_T,  PROL_ZERO='OUI',   INFO=1,
   AFFE=_F( GROUP_MA='POUD', NOM_CMP = ('X1','X2','X3'), VALE =(1.0,0.5,2.0),),)

NELN01=CREA_CHAMP(
   OPERATION='ASSE', TYPE_CHAM='ELNO_NEUT_R',   MODELE=MO_D_T,  
   ASSE=(_F( GROUP_MA='POUD', CHAM_GD = NELN11, CUMUL='OUI',COEF_R= 1.0),
         _F( GROUP_MA='POUD', CHAM_GD = NELN12, CUMUL='OUI',COEF_R= -1000.0),),)

VELN01=CREA_CHAMP(
   OPERATION='EVAL', TYPE_CHAM='ELNO_NEUT_R', INFO=1,
   CHAM_F=FELN01,  CHAM_PARA=NELN01   )

SELN01=CREA_CHAMP(
   OPERATION='ASSE', TYPE_CHAM='ELNO_SIEF_R',
   MODELE=MO_D_T,  PROL_ZERO='OUI',
   ASSE=_F( GROUP_MA='POUD',   CHAM_GD = VELN01, NOM_CMP = ('X1',  ), NOM_CMP_RESU = ('N'),), )


TEST_RESU(CHAM_ELEM=_F(CHAM_GD=SELN01,NOM_CMP='N',MAILLE='M1',NOEUD='N2',VALE=3275.25,REFERENCE='ANALYTIQUE'),)

# --- validation CREA_CHAMP/'NEUT' aux noeuds  ---   
FNOE01=CREA_CHAMP(
   OPERATION='AFFE', TYPE_CHAM='NOEU_NEUT_F',
   MODELE=MO_D_T,  PROL_ZERO='OUI', 
   AFFE=_F( GROUP_MA='POUD', NOM_CMP = ('X1'), VALE_F = FFDEUX,),)

NNOE10=CREA_CHAMP(MODELE=MO_D_T,
   OPERATION='DISC', TYPE_CHAM='NOEU_SIEF_R',CHAM_GD=NELN10)

NNOE11=CREA_CHAMP(
   OPERATION='ASSE', TYPE_CHAM='NOEU_NEUT_R',
   MODELE=MO_D_T,  PROL_ZERO='OUI',
   ASSE=_F( GROUP_MA='POUD',   CHAM_GD = NNOE10, NOM_CMP = ('N','VY','VZ'  ), NOM_CMP_RESU = ('X1','X2','X3'),), )

NNOE12=CREA_CHAMP(
   OPERATION='AFFE', TYPE_CHAM='NOEU_NEUT_R',
   MODELE=MO_D_T,  PROL_ZERO='OUI',   INFO=1,
   AFFE=_F( GROUP_MA='POUD', NOM_CMP = ('X1','X2','X3'), VALE =(1.0,0.5,2.0),),)

NNOE01=CREA_CHAMP(
   OPERATION='ASSE', TYPE_CHAM='NOEU_NEUT_R',   MODELE=MO_D_T,  
   ASSE=(_F( GROUP_MA='POUD', CHAM_GD = NNOE11, CUMUL='OUI',COEF_R= 1.0),
         _F( GROUP_MA='POUD', CHAM_GD = NNOE12, CUMUL='OUI',COEF_R= -1000.0),),)

VNOE01=CREA_CHAMP(
   OPERATION='EVAL', TYPE_CHAM='NOEU_NEUT_R', INFO=1,
   CHAM_F=FNOE01,  CHAM_PARA=NNOE01   )

SNOE01=CREA_CHAMP(
   OPERATION='ASSE', TYPE_CHAM='NOEU_SIEF_R',
   MODELE=MO_D_T,  PROL_ZERO='OUI',
   ASSE=_F( GROUP_MA='POUD',   CHAM_GD = VNOE01, NOM_CMP = ('X1',  ), NOM_CMP_RESU = ('N'),), )


TEST_RESU(CHAM_NO=_F(CHAM_GD=SNOE01,NOM_CMP='N',NOEUD='N2',VALE=3275.25,REFERENCE='ANALYTIQUE'),)

#
#-------------------------------------------------------------------------------------
# 2 --> POU_D_E
# ---------------

MO_D_E = AFFE_MODELE(MAILLAGE=MA,
                     AFFE=_F(GROUP_MA='POUD',PHENOMENE='MECANIQUE',MODELISATION='POU_D_E'),)

CA_D_E = AFFE_CARA_ELEM(  POUTRE=_F( GROUP_MA='POUD',
                                  SECTION='CERCLE',CARA= 'R',VALE=0.02,),
                                  MODELE=MO_D_E)

CL_D_E = AFFE_CHAR_MECA(MODELE=MO_D_E,
                    DDL_IMPO=_F(GROUP_NO='A',
                    DX=0., DY=0., DZ=0.,
                    DRX=0.,DRY=0.,DRZ=0.),)

CH_D_E = AFFE_CHAR_MECA(MODELE=MO_D_E,
                        FORCE_NODALE=_F(GROUP_NO='B',
                                        FX= 1000.,
                                        FY= 1100.,
                                        FZ= 1200.,
                                        MX= 1300.,
                                        MY= 1400.,
                                        MZ= 1500.,
                                        ),)

RE_D_E=STAT_NON_LINE(MODELE     = MO_D_E,
                     CHAM_MATER = CHMAT,
                     CARA_ELEM  = CA_D_E,
                     EXCIT      = (_F(CHARGE = CL_D_E),
                                   _F(CHARGE = CH_D_E),),
                     COMP_INCR  =  _F(RELATION   = 'ELAS',
                                     DEFORMATION = 'PETIT',
                                     GROUP_MA    = 'POUD',),
                     INCREMENT = _F(LIST_INST = LIS_INST,),
                     CONVERGENCE = _F(RESI_REFE_RELA=1.0,FORC_REFE =(CoefRef,CoefRef),),
   );
TB_D_E = RECU_TABLE(CO=RE_D_E,NOM_PARA=('ITER_GLOB'),)

IMPR_TABLE(TABLE=TB_D_E)
TEST_TABLE(TABLE=TB_D_E, NOM_PARA='ITER_GLOB', VALE_I=1, FILTRE=_F(NOM_PARA='NUME_ORDRE',VALE_I=1,),
           CRITERE = 'ABSOLU',        PRECISION = 0., REFERENCE='NON_REGRESSION',);  

TEST_RESU(RESU=(_F(RESULTAT   = RE_D_E,
                   INST       = 1.0,
                   NOM_CHAM   = 'DEPL',
                   GROUP_NO   = 'B',
                   NOM_CMP    = 'DY',
                   VALE       = 0.042315004710940,
                   
                   REFERENCE  = 'NON_REGRESSION',
                   VERSION    = '10.2.20',
                   PRECISION  = 1E-8,
                   ),),
       )

 
# --- validation CREA_CHAMP/'NEUT' aux points de GAUSS  ---   

FELG02=CREA_CHAMP(
   OPERATION='AFFE', TYPE_CHAM='ELGA_NEUT_F',
   MODELE=MO_D_E,  PROL_ZERO='OUI',   INFO=1,
   AFFE=_F( GROUP_MA='POUD', NOM_CMP = ('X1'), VALE_F = FFDEUX,),)

NELG20=CREA_CHAMP(NUME_ORDRE = 1,
   OPERATION='EXTR', TYPE_CHAM='ELGA_SIEF_R',RESULTAT=RE_D_E, NOM_CHAM='SIEF_ELGA')

NELG21=CREA_CHAMP(
   OPERATION='ASSE', TYPE_CHAM='ELGA_NEUT_R',
   MODELE=MO_D_E,  PROL_ZERO='OUI',
   ASSE=_F( GROUP_MA='POUD',   CHAM_GD = NELG20, NOM_CMP = ('N','VY','VZ'  ), NOM_CMP_RESU = ('X1','X2','X3'),), )

NELG22=CREA_CHAMP(
   OPERATION='AFFE', TYPE_CHAM='ELGA_NEUT_R',
   MODELE=MO_D_E,  PROL_ZERO='OUI',   INFO=1,
   AFFE=_F( GROUP_MA='POUD', NOM_CMP = ('X1','X2','X3'), VALE =(1.0,0.5,2.0),),)

NELG02=CREA_CHAMP(
   OPERATION='ASSE', TYPE_CHAM='ELGA_NEUT_R',   MODELE=MO_D_E,  
   ASSE=(_F( GROUP_MA='POUD', CHAM_GD = NELG21, CUMUL='OUI',COEF_R= 1.0),
         _F( GROUP_MA='POUD', CHAM_GD = NELG22, CUMUL='OUI',COEF_R= -1000.0),),)

VELG02=CREA_CHAMP(
   OPERATION='EVAL', TYPE_CHAM='ELGA_NEUT_R', INFO=1,
   CHAM_F=FELG02,  CHAM_PARA=NELG02   )

SELG02=CREA_CHAMP(
   OPERATION='ASSE', TYPE_CHAM='ELGA_SIEF_R',
   MODELE=MO_D_E,  PROL_ZERO='OUI',
   ASSE=_F( GROUP_MA='POUD',   CHAM_GD = VELG02, NOM_CMP = ('X1',  ), NOM_CMP_RESU = ('N'),), )

TEST_RESU(CHAM_ELEM=_F(CHAM_GD=SELG02,NOM_CMP='N',MAILLE='M1',POINT=1,VALE=2000.0,REFERENCE='ANALYTIQUE'),)


# --- validation CREA_CHAMP/'NEUT' aux noeuds par element  ---   
FELN02=CREA_CHAMP(
   OPERATION='AFFE', TYPE_CHAM='ELNO_NEUT_F',
   MODELE=MO_D_E,  PROL_ZERO='OUI',   
   AFFE=_F( GROUP_MA='POUD', NOM_CMP = ('X1'), VALE_F = FFDEUX,),)

NELN20=CREA_CHAMP(MODELE=MO_D_E,
   OPERATION='DISC', TYPE_CHAM='ELNO_SIEF_R',CHAM_GD=NELG20)

NELN21=CREA_CHAMP(
   OPERATION='ASSE', TYPE_CHAM='ELNO_NEUT_R',
   MODELE=MO_D_E,  PROL_ZERO='OUI',
   ASSE=_F( GROUP_MA='POUD',   CHAM_GD = NELN20, NOM_CMP = ('N','VY','VZ'  ), NOM_CMP_RESU = ('X1','X2','X3'),), )

NELN22=CREA_CHAMP(
   OPERATION='AFFE', TYPE_CHAM='ELNO_NEUT_R',
   MODELE=MO_D_E,  PROL_ZERO='OUI',   INFO=1,
   AFFE=_F( GROUP_MA='POUD', NOM_CMP = ('X1','X2','X3'), VALE =(1.0,0.5,2.0),),)

NELN02=CREA_CHAMP(
   OPERATION='ASSE', TYPE_CHAM='ELNO_NEUT_R',   MODELE=MO_D_E,  
   ASSE=(_F( GROUP_MA='POUD', CHAM_GD = NELN21, CUMUL='OUI',COEF_R= 1.0),
         _F( GROUP_MA='POUD', CHAM_GD = NELN22, CUMUL='OUI',COEF_R= -1000.0),),)

VELN02=CREA_CHAMP(
   OPERATION='EVAL', TYPE_CHAM='ELNO_NEUT_R', INFO=1,
   CHAM_F=FELN02,  CHAM_PARA=NELN02   )

SELN02=CREA_CHAMP(
   OPERATION='ASSE', TYPE_CHAM='ELNO_SIEF_R',
   MODELE=MO_D_E,  PROL_ZERO='OUI',
   ASSE=_F( GROUP_MA='POUD',   CHAM_GD = VELN02, NOM_CMP = ('X1',  ), NOM_CMP_RESU = ('N'),), )

TEST_RESU(CHAM_ELEM=_F(CHAM_GD=SELN02,NOM_CMP='N',MAILLE='M1',NOEUD='N2',VALE=3275.25,REFERENCE='ANALYTIQUE'),)


# --- validation CREA_CHAMP/'NEUT' aux noeuds  ---   
FNOE02=CREA_CHAMP(
   OPERATION='AFFE', TYPE_CHAM='NOEU_NEUT_F',
   MODELE=MO_D_E,  PROL_ZERO='OUI', 
   AFFE=_F( GROUP_MA='POUD', NOM_CMP = ('X1'), VALE_F = FFDEUX,),)

NNOE20=CREA_CHAMP(MODELE=MO_D_E,
   OPERATION='DISC', TYPE_CHAM='NOEU_SIEF_R',CHAM_GD=NELN20)

NNOE21=CREA_CHAMP(
   OPERATION='ASSE', TYPE_CHAM='NOEU_NEUT_R',
   MODELE=MO_D_E,  PROL_ZERO='OUI',
   ASSE=_F( GROUP_MA='POUD',   CHAM_GD = NNOE20, NOM_CMP = ('N','VY','VZ'  ), NOM_CMP_RESU = ('X1','X2','X3'),), )

NNOE22=CREA_CHAMP(
   OPERATION='AFFE', TYPE_CHAM='NOEU_NEUT_R',
   MODELE=MO_D_E,  PROL_ZERO='OUI',   INFO=1,
   AFFE=_F( GROUP_MA='POUD', NOM_CMP = ('X1','X2','X3'), VALE =(1.0,0.5,2.0),),)

NNOE02=CREA_CHAMP(
   OPERATION='ASSE', TYPE_CHAM='NOEU_NEUT_R',   MODELE=MO_D_E,  
   ASSE=(_F( GROUP_MA='POUD', CHAM_GD = NNOE21, CUMUL='OUI',COEF_R= 1.0),
         _F( GROUP_MA='POUD', CHAM_GD = NNOE22, CUMUL='OUI',COEF_R= -1000.0),),)

VNOE02=CREA_CHAMP(
   OPERATION='EVAL', TYPE_CHAM='NOEU_NEUT_R', INFO=1,
   CHAM_F=FNOE02,  CHAM_PARA=NNOE02   )

SNOE02=CREA_CHAMP(
   OPERATION='ASSE', TYPE_CHAM='NOEU_SIEF_R',
   MODELE=MO_D_E,  PROL_ZERO='OUI',
   ASSE=_F( GROUP_MA='POUD',   CHAM_GD = VNOE02, NOM_CMP = ('X1',  ), NOM_CMP_RESU = ('N'),), )

TEST_RESU(CHAM_NO=_F(CHAM_GD=SNOE02,NOM_CMP='N',NOEUD='N2',VALE=3275.25,REFERENCE='ANALYTIQUE'),)


#-------------------------------------------------------------------------------------
# 3 --> POU_D_TG
# ----------------

MO_D_TG = AFFE_MODELE(MAILLAGE=MA,
                     AFFE=_F(GROUP_MA='POUD',PHENOMENE='MECANIQUE',MODELISATION='POU_D_TG'),)

CA_D_TG = AFFE_CARA_ELEM(  POUTRE=_F( GROUP_MA='POUD',
                                  SECTION='CERCLE',CARA= 'R',VALE=0.02,),
                                  MODELE=MO_D_TG)

CL_D_TG = AFFE_CHAR_MECA(MODELE=MO_D_TG,
                    DDL_IMPO=_F(GROUP_NO='A',
                    DX=0., DY=0., DZ=0.,
                    DRX=0.,DRY=0.,DRZ=0.),)

CH_D_TG = AFFE_CHAR_MECA(MODELE=MO_D_TG,
                        FORCE_NODALE=_F(GROUP_NO='B',
                                        FX= 1000.,
                                        FY= 1100.,
                                        FZ= 1200.,
                                        MX= 1300.,
                                        MY= 1400.,
                                        MZ= 1500.,
                                        ),)

RE_D_TG=STAT_NON_LINE(MODELE     = MO_D_TG,
                     CHAM_MATER = CHMAT,
                     CARA_ELEM  = CA_D_TG,
                     EXCIT      = (_F(CHARGE = CL_D_TG),
                                   _F(CHARGE = CH_D_TG),),
                     COMP_INCR  =  _F(RELATION   = 'ELAS',
                                     DEFORMATION = 'PETIT',
                                     GROUP_MA    = 'POUD',),
                     INCREMENT = _F(LIST_INST = LIS_INST,),
                     CONVERGENCE = _F(RESI_REFE_RELA=1.0,FORC_REFE =(CoefRef,CoefRef),),
   );

TB_D_TG = RECU_TABLE(CO=RE_D_TG,NOM_PARA=('ITER_GLOB'),)

IMPR_TABLE(TABLE=TB_D_TG)
TEST_TABLE(TABLE=TB_D_TG, NOM_PARA='ITER_GLOB', VALE_I=1, FILTRE=_F(NOM_PARA='NUME_ORDRE',VALE_I=1,),
           CRITERE = 'ABSOLU',        PRECISION = 0., REFERENCE='NON_REGRESSION',); 


TEST_RESU(RESU=(_F(RESULTAT   = RE_D_TG,
                   INST       = 1.0,
                   NOM_CHAM   = 'DEPL',
                   GROUP_NO   = 'B',
                   NOM_CMP    = 'DY',
                   VALE       = 0.042327046592878,
                   
                   REFERENCE  = 'NON_REGRESSION',
                   VERSION    = '10.2.20',
                   PRECISION  = 1E-8,
                   ),),
       )   

# --- validation CREA_CHAMP/'NEUT' aux points de GAUSS  ---   

FELG03=CREA_CHAMP(
   OPERATION='AFFE', TYPE_CHAM='ELGA_NEUT_F',
   MODELE=MO_D_TG,  PROL_ZERO='OUI',   INFO=1,
   AFFE=_F( GROUP_MA='POUD', NOM_CMP = ('X1'), VALE_F = FFDEUX,),)

NELG30=CREA_CHAMP(NUME_ORDRE = 1,
   OPERATION='EXTR', TYPE_CHAM='ELGA_SIEF_R',RESULTAT=RE_D_TG, NOM_CHAM='SIEF_ELGA')

NELG31=CREA_CHAMP(
   OPERATION='ASSE', TYPE_CHAM='ELGA_NEUT_R',
   MODELE=MO_D_TG,  PROL_ZERO='OUI',
   ASSE=_F( GROUP_MA='POUD',   CHAM_GD = NELG30, NOM_CMP = ('N','VY','VZ'  ), NOM_CMP_RESU = ('X1','X2','X3'),), )

NELG32=CREA_CHAMP(
   OPERATION='AFFE', TYPE_CHAM='ELGA_NEUT_R',
   MODELE=MO_D_TG,  PROL_ZERO='OUI',   INFO=1,
   AFFE=_F( GROUP_MA='POUD', NOM_CMP = ('X1','X2','X3'), VALE =(1.0,0.5,2.0),),)

NELG03=CREA_CHAMP(
   OPERATION='ASSE', TYPE_CHAM='ELGA_NEUT_R',   MODELE=MO_D_TG,  
   ASSE=(_F( GROUP_MA='POUD', CHAM_GD = NELG31, CUMUL='OUI',COEF_R= 1.0),
         _F( GROUP_MA='POUD', CHAM_GD = NELG32, CUMUL='OUI',COEF_R= -1000.0),),)

VELG03=CREA_CHAMP(
   OPERATION='EVAL', TYPE_CHAM='ELGA_NEUT_R', INFO=1,
   CHAM_F=FELG03,  CHAM_PARA=NELG03   )

SELG03=CREA_CHAMP(
   OPERATION='ASSE', TYPE_CHAM='ELGA_SIEF_R',
   MODELE=MO_D_TG,  PROL_ZERO='OUI',
   ASSE=_F( GROUP_MA='POUD',   CHAM_GD = VELG03, NOM_CMP = ('X1',  ), NOM_CMP_RESU = ('N'),), )

TEST_RESU(CHAM_ELEM=_F(CHAM_GD=SELG03,NOM_CMP='N',MAILLE='M1',POINT=1,VALE=2000.0,REFERENCE='ANALYTIQUE'),)


# --- validation CREA_CHAMP/'NEUT' aux noeuds par element  ---   
FELN03=CREA_CHAMP(
   OPERATION='AFFE', TYPE_CHAM='ELNO_NEUT_F',
   MODELE=MO_D_TG,  PROL_ZERO='OUI',   
   AFFE=_F( GROUP_MA='POUD', NOM_CMP = ('X1'), VALE_F = FFDEUX,),)

NELN30=CREA_CHAMP(MODELE=MO_D_TG,
   OPERATION='DISC', TYPE_CHAM='ELNO_SIEF_R',CHAM_GD=NELG30)

NELN31=CREA_CHAMP(
   OPERATION='ASSE', TYPE_CHAM='ELNO_NEUT_R',
   MODELE=MO_D_TG,  PROL_ZERO='OUI',
   ASSE=_F( GROUP_MA='POUD',   CHAM_GD = NELN30, NOM_CMP = ('N','VY','VZ'  ), NOM_CMP_RESU = ('X1','X2','X3'),), )

NELN32=CREA_CHAMP(
   OPERATION='AFFE', TYPE_CHAM='ELNO_NEUT_R',
   MODELE=MO_D_TG,  PROL_ZERO='OUI',   INFO=1,
   AFFE=_F( GROUP_MA='POUD', NOM_CMP = ('X1','X2','X3'), VALE =(1.0,0.5,2.0),),)

NELN03=CREA_CHAMP(
   OPERATION='ASSE', TYPE_CHAM='ELNO_NEUT_R',   MODELE=MO_D_TG,  
   ASSE=(_F( GROUP_MA='POUD', CHAM_GD = NELN31, CUMUL='OUI',COEF_R= 1.0),
         _F( GROUP_MA='POUD', CHAM_GD = NELN32, CUMUL='OUI',COEF_R= -1000.0),),)

VELN03=CREA_CHAMP(
   OPERATION='EVAL', TYPE_CHAM='ELNO_NEUT_R', INFO=1,
   CHAM_F=FELN03,  CHAM_PARA=NELN03   )

SELN03=CREA_CHAMP(
   OPERATION='ASSE', TYPE_CHAM='ELNO_SIEF_R',
   MODELE=MO_D_TG,  PROL_ZERO='OUI',
   ASSE=_F( GROUP_MA='POUD',   CHAM_GD = VELN03, NOM_CMP = ('X1',  ), NOM_CMP_RESU = ('N'),), )


TEST_RESU(CHAM_ELEM=_F(CHAM_GD=SELN03,NOM_CMP='N',MAILLE='M1',NOEUD='N2',VALE=3275.25,REFERENCE='ANALYTIQUE'),)

# --- validation CREA_CHAMP/'NEUT' aux noeuds  ---   
FNOE03=CREA_CHAMP(
   OPERATION='AFFE', TYPE_CHAM='NOEU_NEUT_F',
   MODELE=MO_D_TG,  PROL_ZERO='OUI', 
   AFFE=_F( GROUP_MA='POUD', NOM_CMP = ('X1'), VALE_F = FFDEUX,),)

NNOE30=CREA_CHAMP(MODELE=MO_D_TG,
   OPERATION='DISC', TYPE_CHAM='NOEU_SIEF_R',CHAM_GD=NELN30)

NNOE31=CREA_CHAMP(
   OPERATION='ASSE', TYPE_CHAM='NOEU_NEUT_R',
   MODELE=MO_D_TG,  PROL_ZERO='OUI',
   ASSE=_F( GROUP_MA='POUD',   CHAM_GD = NNOE30, NOM_CMP = ('N','VY','VZ'  ), NOM_CMP_RESU = ('X1','X2','X3'),), )

NNOE32=CREA_CHAMP(
   OPERATION='AFFE', TYPE_CHAM='NOEU_NEUT_R',
   MODELE=MO_D_TG,  PROL_ZERO='OUI',   INFO=1,
   AFFE=_F( GROUP_MA='POUD', NOM_CMP = ('X1','X2','X3'), VALE =(1.0,0.5,2.0),),)

NNOE03=CREA_CHAMP(
   OPERATION='ASSE', TYPE_CHAM='NOEU_NEUT_R',   MODELE=MO_D_TG,  
   ASSE=(_F( GROUP_MA='POUD', CHAM_GD = NNOE31, CUMUL='OUI',COEF_R= 1.0),
         _F( GROUP_MA='POUD', CHAM_GD = NNOE32, CUMUL='OUI',COEF_R= -1000.0),),)

VNOE03=CREA_CHAMP(
   OPERATION='EVAL', TYPE_CHAM='NOEU_NEUT_R', INFO=1,
   CHAM_F=FNOE03,  CHAM_PARA=NNOE03   )

SNOE03=CREA_CHAMP(
   OPERATION='ASSE', TYPE_CHAM='NOEU_SIEF_R',
   MODELE=MO_D_TG,  PROL_ZERO='OUI',
   ASSE=_F( GROUP_MA='POUD',   CHAM_GD = VNOE03, NOM_CMP = ('X1',  ), NOM_CMP_RESU = ('N'),), )


TEST_RESU(CHAM_NO=_F(CHAM_GD=SNOE03,NOM_CMP='N',NOEUD='N2',VALE=3275.25,REFERENCE='ANALYTIQUE'),)

#
#-------------------------------------------------------------------------------------
# 4 --> POU_D_EM
# ----------------

MO_D_EM = AFFE_MODELE(MAILLAGE=MA,
                     AFFE=_F(GROUP_MA='POUD',PHENOMENE='MECANIQUE',MODELISATION='POU_D_EM'),)

CA_D_EM = AFFE_CARA_ELEM(  POUTRE=_F( GROUP_MA='POUD',
                                  SECTION='CERCLE',CARA= 'R',VALE=0.02,
  PREC_AIRE = 2.E-2),
    MULTIFIBRE = _F (GROUP_MA='POUD',GROUP_FIBRE= 'ACIER',),
                            GEOM_FIBRE = GFF ,
                            MODELE=MO_D_EM)

CL_D_EM = AFFE_CHAR_MECA(MODELE=MO_D_EM,
                    DDL_IMPO=_F(GROUP_NO='A',
                    DX=0., DY=0., DZ=0.,
                    DRX=0.,DRY=0.,DRZ=0.),)

CH_D_EM = AFFE_CHAR_MECA(MODELE=MO_D_EM,
                        FORCE_NODALE=_F(GROUP_NO='B',
                                        FX= 1000.,
                                        FY= 1100.,
                                        FZ= 1200.,
                                        MX= 1300.,
                                        MY= 1400.,
                                        MZ= 1500.,
                                        ),)

RE_D_EM=STAT_NON_LINE(MODELE     = MO_D_EM,
                     CHAM_MATER = CHMAT,
                     CARA_ELEM  = CA_D_EM,
                     EXCIT      = (_F(CHARGE = CL_D_EM),
                                   _F(CHARGE = CH_D_EM),),
                     COMP_INCR  =  _F(RELATION   = 'MULTIFIBRE',
                                     DEFORMATION = 'PETIT',
                                     GROUP_MA    = 'POUD',),
                     INCREMENT = _F(LIST_INST = LIS_INST,),
                     CONVERGENCE = _F(RESI_REFE_RELA=1.0,FORC_REFE =(CoefRef,CoefRef),),
   );

CALC_ELEM(reuse      = RE_D_EM,
          RESULTAT   = RE_D_EM,
          OPTION = 'SIEF_ELNO')

CALC_NO(reuse      = RE_D_EM,
        RESULTAT   = RE_D_EM,
        OPTION = 'SIEF_NOEU')

TB_D_EM = RECU_TABLE(CO=RE_D_EM,NOM_PARA=('ITER_GLOB'),)

IMPR_TABLE(TABLE=TB_D_EM)
TEST_TABLE(TABLE=TB_D_EM, NOM_PARA='ITER_GLOB', VALE_I=1, FILTRE=_F(NOM_PARA='NUME_ORDRE',VALE_I=1,),
           CRITERE = 'ABSOLU',        PRECISION = 0.,REFERENCE='NON_REGRESSION',); 


TEST_RESU(RESU=(_F(RESULTAT   = RE_D_EM,
                   INST       = 1.0,
                   NOM_CHAM   = 'DEPL',
                   GROUP_NO   = 'B',
                   NOM_CMP    = 'DY',
                   VALE       = 0.043854790675854,
                   
                   REFERENCE  = 'NON_REGRESSION',
                   VERSION    = '10.2.20',
                   PRECISION  = 1E-8,
                   ),),
       )

# --- validation CREA_CHAMP/'NEUT' aux points de GAUSS  ---   

NELG40=CREA_CHAMP(NUME_ORDRE = 1,
   OPERATION='EXTR', TYPE_CHAM='ELGA_SIEF_R',RESULTAT=RE_D_EM, NOM_CHAM='SIEF_ELGA')

NELG04=CREA_CHAMP(
   OPERATION='ASSE', TYPE_CHAM='ELGA_NEUT_R',
   MODELE=MO_D_EM,  PROL_ZERO='OUI',
   ASSE=_F( GROUP_MA='POUD',   CHAM_GD = NELG40, NOM_CMP = ('SIXX' ), NOM_CMP_RESU = ('X1'),), )

TEST_RESU(CHAM_ELEM=_F(CHAM_GD=NELG04,NOM_CMP='X1',MAILLE='M1',POINT=1, VALE=-222090484.5,REFERENCE='ANALYTIQUE'),)

# --- validation CREA_CHAMP/'NEUT' aux noeuds par element  ---   

NELN40=CREA_CHAMP(NUME_ORDRE = 1,
   OPERATION='EXTR', TYPE_CHAM='ELNO_SIEF_R',RESULTAT=RE_D_EM, NOM_CHAM='SIEF_ELNO')

NELN04=CREA_CHAMP(
   OPERATION='ASSE', TYPE_CHAM='ELNO_NEUT_R',
   MODELE=MO_D_EM,  PROL_ZERO='OUI',
   ASSE=_F( GROUP_MA='POUD',   CHAM_GD = NELN40, NOM_CMP = ('N' ), NOM_CMP_RESU = ('X1'),), )


TEST_RESU(CHAM_ELEM=_F(CHAM_GD=NELN04,NOM_CMP='X1',MAILLE='M1',NOEUD='N2', VALE=1000.0,REFERENCE='ANALYTIQUE'),)

# --- validation CREA_CHAMP/'NEUT' aux noeuds  ---   

NNOE40=CREA_CHAMP(NUME_ORDRE = 1,
   OPERATION='EXTR', TYPE_CHAM='NOEU_SIEF_R',RESULTAT=RE_D_EM, NOM_CHAM='SIEF_NOEU')

NNOE04=CREA_CHAMP(
   OPERATION='ASSE', TYPE_CHAM='NOEU_NEUT_R',
   MODELE=MO_D_EM,  PROL_ZERO='OUI',
   ASSE=_F( GROUP_MA='POUD',   CHAM_GD = NNOE40, NOM_CMP = ('N' ), NOM_CMP_RESU = ('X1'),), )


TEST_RESU(CHAM_NO=_F(CHAM_GD=NNOE04,NOM_CMP='X1',NOEUD='N2', VALE=1000.0,REFERENCE='ANALYTIQUE'),)

#-------------------------------------------------------------------------------------
# 5 --> POU_D_TGM
# -----------------

MO_D_TGM = AFFE_MODELE(MAILLAGE=MA,
                     AFFE=_F(GROUP_MA='POUD',PHENOMENE='MECANIQUE',MODELISATION='POU_D_TGM'),)

CA_D_TGM = AFFE_CARA_ELEM(  POUTRE=_F( GROUP_MA='POUD',
                                  SECTION='CERCLE',CARA= 'R',VALE=0.02,
  PREC_AIRE = 2.E-2),
    MULTIFIBRE = _F (GROUP_MA='POUD',GROUP_FIBRE= 'ACIER',),
                            GEOM_FIBRE = GFF ,
                            MODELE=MO_D_TGM)

CL_D_TGM = AFFE_CHAR_MECA(MODELE=MO_D_TGM,
                    DDL_IMPO=_F(GROUP_NO='A',
                    DX=0., DY=0., DZ=0.,
                    DRX=0.,DRY=0.,DRZ=0.),)

CH_D_TGM = AFFE_CHAR_MECA(MODELE=MO_D_TGM,
                        FORCE_NODALE=_F(GROUP_NO='B',
                                        FX= 1000.,
                                        FY= 1100.,
                                        FZ= 1200.,
                                        MX= 1300.,
                                        MY= 1400.,
                                        MZ= 1500.,
                                        ),)


RE_D_TGM=STAT_NON_LINE(MODELE     = MO_D_TGM,
                     CHAM_MATER = CHMAT,
                     CARA_ELEM  = CA_D_TGM,
                     EXCIT      = (_F(CHARGE = CL_D_TGM),
                                   _F(CHARGE = CH_D_TGM),),
                     COMP_INCR  =  _F(RELATION   = 'MULTIFIBRE',
                                     DEFORMATION = 'PETIT',
                                     GROUP_MA    = 'POUD',),
                     INCREMENT = _F(LIST_INST = LIS_INST,),
                     CONVERGENCE = _F(RESI_REFE_RELA=1.0,FORC_REFE =(CoefRef,CoefRef),),
)

CALC_ELEM(reuse      = RE_D_TGM,
          RESULTAT   = RE_D_TGM,
          OPTION = 'SIEF_ELNO')

CALC_NO(reuse      = RE_D_TGM,
        RESULTAT   = RE_D_TGM,
        OPTION = 'SIEF_NOEU')

TB_D_TGM = RECU_TABLE(CO=RE_D_TGM,NOM_PARA=('ITER_GLOB'),)

IMPR_TABLE(TABLE=TB_D_TGM)
TEST_TABLE(TABLE=TB_D_TGM, NOM_PARA='ITER_GLOB', VALE_I=2, FILTRE=_F(NOM_PARA='NUME_ORDRE',VALE_I=1,),
           CRITERE = 'ABSOLU',        PRECISION = 0., REFERENCE='NON_REGRESSION',);

TEST_RESU(RESU=(_F(RESULTAT   = RE_D_TGM,
                   INST       = 1.0,
                   NOM_CHAM   = 'DEPL',
                   GROUP_NO   = 'B',
                   NOM_CMP    = 'DY',
                   VALE       = 0.043866816313684,
                   
                   REFERENCE  = 'NON_REGRESSION',
                   VERSION    = '10.2.20',
                   PRECISION  = 1E-8,
                   ),),
       )


NELG50=CREA_CHAMP(NUME_ORDRE = 1,
   OPERATION='EXTR', TYPE_CHAM='ELGA_SIEF_R',RESULTAT=RE_D_TGM, NOM_CHAM='SIEF_ELGA')

NELG05=CREA_CHAMP(
   OPERATION='ASSE', TYPE_CHAM='ELGA_NEUT_R',
   MODELE=MO_D_TGM,  PROL_ZERO='OUI',
   ASSE=_F( GROUP_MA='POUD',   CHAM_GD = NELG50, NOM_CMP = ('SIXX' ), NOM_CMP_RESU = ('X1'),), )

TEST_RESU(CHAM_ELEM=_F(CHAM_GD=NELG05,NOM_CMP='X1',MAILLE='M1',POINT=1, VALE=-229905660.66,REFERENCE='ANALYTIQUE'),)

# --- validation CREA_CHAMP/'NEUT' aux noeuds par element  ---   

NELN50=CREA_CHAMP(NUME_ORDRE = 1,
   OPERATION='EXTR', TYPE_CHAM='ELNO_SIEF_R',RESULTAT=RE_D_TGM, NOM_CHAM='SIEF_ELNO')

NELN05=CREA_CHAMP(
   OPERATION='ASSE', TYPE_CHAM='ELNO_NEUT_R',
   MODELE=MO_D_TGM,  PROL_ZERO='OUI',
   ASSE=_F( GROUP_MA='POUD',   CHAM_GD = NELN50, NOM_CMP = ('N' ), NOM_CMP_RESU = ('X1'),), )


TEST_RESU(CHAM_ELEM=_F(CHAM_GD=NELN05,NOM_CMP='X1',MAILLE='M1',NOEUD='N2', VALE=1000.0,REFERENCE='ANALYTIQUE'),)

# --- validation CREA_CHAMP/'NEUT' aux noeuds  ---   

NNOE50=CREA_CHAMP(NUME_ORDRE = 1,
   OPERATION='EXTR', TYPE_CHAM='NOEU_SIEF_R',RESULTAT=RE_D_TGM, NOM_CHAM='SIEF_NOEU')

NNOE05=CREA_CHAMP(
   OPERATION='ASSE', TYPE_CHAM='NOEU_NEUT_R',
   MODELE=MO_D_TGM,  PROL_ZERO='OUI',
   ASSE=_F( GROUP_MA='POUD',   CHAM_GD = NNOE50, NOM_CMP = ('N' ), NOM_CMP_RESU = ('X1'),), )


TEST_RESU(CHAM_NO=_F(CHAM_GD=NNOE05,NOM_CMP='X1',NOEUD='N2', VALE=1000.0,REFERENCE='ANALYTIQUE'),)

#-------------------------------------------------------------------------------------
# 6 --> POU_D_T_GD
# ------------------

MO_D_TGD = AFFE_MODELE(MAILLAGE=MA,
                     AFFE=_F(GROUP_MA='POUD',PHENOMENE='MECANIQUE',MODELISATION='POU_D_T_GD'),)

CA_D_TGD = AFFE_CARA_ELEM(  POUTRE=_F( GROUP_MA='POUD',
                                  SECTION='CERCLE',CARA= 'R',VALE=0.02,),
                                  MODELE=MO_D_TGD)

CL_D_TGD = AFFE_CHAR_MECA(MODELE=MO_D_TGD,
                    DDL_IMPO=_F(GROUP_NO='A',
                    DX=0., DY=0., DZ=0.,
                    DRX=0.,DRY=0.,DRZ=0.),)

CH_D_TGD = AFFE_CHAR_MECA(MODELE=MO_D_TGD,
                        FORCE_NODALE=_F(GROUP_NO='B',
                                        FX= 10.,
                                        FY= 11.,
                                        FZ= 12.,
                                        MX= 13.,
                                        MY= 14.,
                                        MZ= 15.,
                                        ),)

RE_D_TGD=STAT_NON_LINE(
   MODELE     = MO_D_TGD,
   CHAM_MATER = CHMAT,
   CARA_ELEM  = CA_D_TGD,
   EXCIT      = (_F(CHARGE = CL_D_TGD),
                  _F(CHARGE = CH_D_TGD),),
   COMP_ELAS  = _F(RELATION   = 'ELAS_POUTRE_GR',GROUP_MA= 'POUD',
                  DEFORMATION = 'GROT_GDEP'),
   INCREMENT = _F(LIST_INST = LIS_INST,),
   CONVERGENCE = _F(RESI_REFE_RELA=1.0,FORC_REFE =(CoefRef,CoefRef),),
   );

TB_D_TGD = RECU_TABLE(CO=RE_D_TGD,NOM_PARA=('ITER_GLOB'),)

IMPR_TABLE(TABLE=TB_D_TGD)
TEST_TABLE(TABLE=TB_D_TGD, NOM_PARA='ITER_GLOB', VALE_I=5,FILTRE=_F(NOM_PARA='NUME_ORDRE',VALE_I=1,),
           CRITERE = 'ABSOLU',        PRECISION = 0., REFERENCE='NON_REGRESSION',);


TEST_RESU(RESU=(_F(RESULTAT   = RE_D_TGD,
                   INST       = 1.0,
                   NOM_CHAM   = 'DEPL',
                   GROUP_NO   = 'B',
                   NOM_CMP    = 'DY',
                   VALE       = 3.8851048793357E-04,
                   
                   REFERENCE  = 'NON_REGRESSION',
                   VERSION    = '10.2.20',
                   PRECISION  = 1E-8,
                   ),),
       )
       
#-------------------------------------------------------------------------------------
# 7 --> POU_C_T
# ---------------

MO_C_T = AFFE_MODELE(MAILLAGE=MA,
                     AFFE=_F(GROUP_MA='POUC',PHENOMENE='MECANIQUE',MODELISATION='POU_C_T'),)

CA_C_T = AFFE_CARA_ELEM(
   MODELE=MO_C_T,
   POUTRE=_F( GROUP_MA='POUC', SECTION='CERCLE',CARA= 'R',VALE=0.02,),
   DEFI_ARC=_F(MAILLE='M2',NOEUD_CENTRE='N1'),
)

CL_C_T = AFFE_CHAR_MECA(MODELE=MO_C_T,
                   DDL_IMPO=_F(GROUP_NO='C',
                   DX=0., DY=0., DZ=0.,
                   DRX=0.,DRY=0.,DRZ=0.),)

CH_C_T = AFFE_CHAR_MECA(MODELE=MO_C_T,
                        FORCE_NODALE=_F(GROUP_NO='B',FY=-1000.0,FZ= 1000.0),)


RE_C_T=STAT_NON_LINE(MODELE     = MO_C_T,
                     CHAM_MATER = CHMAT,
                     CARA_ELEM  = CA_C_T,
                     EXCIT      = (_F(CHARGE = CL_C_T),
                                   _F(CHARGE = CH_C_T),),
      COMP_ELAS  =  _F(RELATION   = 'ELAS',
                      DEFORMATION = 'PETIT',
                      GROUP_MA    = 'POUC',),
      NEWTON=_F(PREDICTION='ELASTIQUE',MATRICE='ELASTIQUE'),
      INCREMENT = _F(LIST_INST = LIS_INST,),
      CONVERGENCE = _F(RESI_REFE_RELA=1.0,FORC_REFE =(CoefRef,CoefRef),),
   );

TB_C_T = RECU_TABLE(CO=RE_C_T,NOM_PARA=('ITER_GLOB'),)

IMPR_TABLE(TABLE=TB_C_T)
TEST_TABLE(TABLE=TB_C_T, NOM_PARA='ITER_GLOB', VALE_I=1, FILTRE=_F(NOM_PARA='NUME_ORDRE',VALE_I=1,),
           CRITERE = 'ABSOLU',        PRECISION = 0., REFERENCE='NON_REGRESSION',); 


TEST_RESU(RESU=(_F(RESULTAT   = RE_C_T,
                   INST       = 1.0,
                   NOM_CHAM   = 'DEPL',
                   GROUP_NO   = 'B',
                   NOM_CMP    = 'DY',
                   VALE       = -0.013509220220791,
                   
                   REFERENCE  = 'NON_REGRESSION',
                   VERSION    = '10.2.20',
                   PRECISION  = 1E-8,
                   ),),
       )

# --- validation CREA_CHAMP/'NEUT' aux points de GAUSS  ---   

FELG07=CREA_CHAMP(
   OPERATION='AFFE', TYPE_CHAM='ELGA_NEUT_F',
   MODELE=MO_C_T,  PROL_ZERO='OUI',   INFO=1,
   AFFE=_F( GROUP_MA='POUC', NOM_CMP = ('X1'), VALE_F = FFDEUX,),)

NELG70=CREA_CHAMP(NUME_ORDRE = 1,
   OPERATION='EXTR', TYPE_CHAM='ELGA_SIEF_R',RESULTAT=RE_C_T, NOM_CHAM='SIEF_ELGA')

NELG71=CREA_CHAMP(
   OPERATION='ASSE', TYPE_CHAM='ELGA_NEUT_R',
   MODELE=MO_C_T,  PROL_ZERO='OUI',
   ASSE=_F( GROUP_MA='POUC',   CHAM_GD = NELG70, NOM_CMP = ('N','VY','VZ'  ), NOM_CMP_RESU = ('X1','X2','X3'),), )

NELG72=CREA_CHAMP(
   OPERATION='AFFE', TYPE_CHAM='ELGA_NEUT_R',
   MODELE=MO_C_T,  PROL_ZERO='OUI',   INFO=1,
   AFFE=_F( GROUP_MA='POUC', NOM_CMP = ('X1','X2','X3'), VALE =(1.0,0.5,2.0),),)

NELG07=CREA_CHAMP(
   OPERATION='ASSE', TYPE_CHAM='ELGA_NEUT_R',   MODELE=MO_C_T,  
   ASSE=(_F( GROUP_MA='POUC', CHAM_GD = NELG71, CUMUL='OUI',COEF_R= 1.0),
         _F( GROUP_MA='POUC', CHAM_GD = NELG72, CUMUL='OUI',COEF_R= -1000.0),),)

VELG07=CREA_CHAMP(
   OPERATION='EVAL', TYPE_CHAM='ELGA_NEUT_R', INFO=1,
   CHAM_F=FELG07,  CHAM_PARA=NELG07   )

SELG07=CREA_CHAMP(
   OPERATION='ASSE', TYPE_CHAM='ELGA_SIEF_R',
   MODELE=MO_C_T,  PROL_ZERO='OUI',
   ASSE=_F( GROUP_MA='POUC',   CHAM_GD = VELG07, NOM_CMP = ('X1',  ), NOM_CMP_RESU = ('N'),), )

TEST_RESU(CHAM_ELEM=_F(CHAM_GD=SELG07,NOM_CMP='N',MAILLE='M2',POINT=1,VALE=-5000.0,REFERENCE='ANALYTIQUE'),)


# --- validation CREA_CHAMP/'NEUT' aux noeuds par element  ---   
FELN07=CREA_CHAMP(
   OPERATION='AFFE', TYPE_CHAM='ELNO_NEUT_F',
   MODELE=MO_C_T,  PROL_ZERO='OUI',   
   AFFE=_F( GROUP_MA='POUC', NOM_CMP = ('X1'), VALE_F = FFDEUX,),)

NELN70=CREA_CHAMP(MODELE=MO_C_T,
   OPERATION='DISC', TYPE_CHAM='ELNO_SIEF_R',CHAM_GD=NELG70)

NELN71=CREA_CHAMP(
   OPERATION='ASSE', TYPE_CHAM='ELNO_NEUT_R',
   MODELE=MO_C_T,  PROL_ZERO='OUI',
   ASSE=_F( GROUP_MA='POUC',   CHAM_GD = NELN70, NOM_CMP = ('N','VY','VZ'  ), NOM_CMP_RESU = ('X1','X2','X3'),), )

NELN72=CREA_CHAMP(
   OPERATION='AFFE', TYPE_CHAM='ELNO_NEUT_R',
   MODELE=MO_C_T,  PROL_ZERO='OUI',   INFO=1,
   AFFE=_F( GROUP_MA='POUC', NOM_CMP = ('X1','X2','X3'), VALE =(1.0,0.5,2.0),),)

NELN07=CREA_CHAMP(
   OPERATION='ASSE', TYPE_CHAM='ELNO_NEUT_R',   MODELE=MO_C_T,  
   ASSE=(_F( GROUP_MA='POUC', CHAM_GD = NELN71, CUMUL='OUI',COEF_R= 1.0),
         _F( GROUP_MA='POUC', CHAM_GD = NELN72, CUMUL='OUI',COEF_R= -1000.0),),)

VELN07=CREA_CHAMP(
   OPERATION='EVAL', TYPE_CHAM='ELNO_NEUT_R', INFO=1,
   CHAM_F=FELN07,  CHAM_PARA=NELN07   )

SELN07=CREA_CHAMP(
   OPERATION='ASSE', TYPE_CHAM='ELNO_SIEF_R',
   MODELE=MO_C_T,  PROL_ZERO='OUI',
   ASSE=_F( GROUP_MA='POUC',   CHAM_GD = VELN07, NOM_CMP = ('X1',  ), NOM_CMP_RESU = ('N'),), )

TEST_RESU(CHAM_ELEM=_F(CHAM_GD=SELN07,NOM_CMP='N',MAILLE='M2',NOEUD='N2',VALE=-6830.127,REFERENCE='ANALYTIQUE'),)

# --- validation CREA_CHAMP/'NEUT' aux noeuds  ---   
FNOE07=CREA_CHAMP(
   OPERATION='AFFE', TYPE_CHAM='NOEU_NEUT_F',
   MODELE=MO_C_T,  PROL_ZERO='OUI', 
   AFFE=_F( GROUP_MA='POUC', NOM_CMP = ('X1'), VALE_F = FFDEUX,),)

NNOE70=CREA_CHAMP(MODELE=MO_C_T,
   OPERATION='DISC', TYPE_CHAM='NOEU_SIEF_R',CHAM_GD=NELN70)

NNOE71=CREA_CHAMP(
   OPERATION='ASSE', TYPE_CHAM='NOEU_NEUT_R',
   MODELE=MO_C_T,  PROL_ZERO='OUI',
   ASSE=_F( GROUP_MA='POUC',   CHAM_GD = NNOE70, NOM_CMP = ('N','VY','VZ'  ), NOM_CMP_RESU = ('X1','X2','X3'),), )

NNOE72=CREA_CHAMP(
   OPERATION='AFFE', TYPE_CHAM='NOEU_NEUT_R',
   MODELE=MO_C_T,  PROL_ZERO='OUI',   INFO=1,
   AFFE=_F( GROUP_MA='POUC', NOM_CMP = ('X1','X2','X3'), VALE =(1.0,0.5,2.0),),)

NNOE07=CREA_CHAMP(
   OPERATION='ASSE', TYPE_CHAM='NOEU_NEUT_R',   MODELE=MO_C_T,  
   ASSE=(_F( GROUP_MA='POUC', CHAM_GD = NNOE71, CUMUL='OUI',COEF_R= 1.0),
         _F( GROUP_MA='POUC', CHAM_GD = NNOE72, CUMUL='OUI',COEF_R= -1000.0),),)

VNOE07=CREA_CHAMP(
   OPERATION='EVAL', TYPE_CHAM='NOEU_NEUT_R', INFO=1,
   CHAM_F=FNOE07,  CHAM_PARA=NNOE07   )

SNOE07=CREA_CHAMP(
   OPERATION='ASSE', TYPE_CHAM='NOEU_SIEF_R',
   MODELE=MO_C_T,  PROL_ZERO='OUI',
   ASSE=_F( GROUP_MA='POUC',   CHAM_GD = VNOE07, NOM_CMP = ('X1',  ), NOM_CMP_RESU = ('N'),), )

TEST_RESU(CHAM_NO=_F(CHAM_GD=SNOE07,NOM_CMP='N',NOEUD='N2',VALE=-6830.127,REFERENCE='ANALYTIQUE'),)
#
FIN()
