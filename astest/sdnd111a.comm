# MODIF  DATE 09/07/2012   AUTEUR PELLET J.PELLET 
# TITRE SYSTEME MASSE RESSORT AVEC EXCITATION HARMONIQUE ET
#            CONFIGURATION MANAGEMENT OF EDF VERSION
# ======================================================================
# COPYRIGHT (C) 1991 - 2012  EDF R&D                  WWW.CODE-ASTER.ORG
# THIS PROGRAM IS FREE SOFTWARE; YOU CAN REDISTRIBUTE IT AND/OR MODIFY
# IT UNDER THE TERMS OF THE GNU GENERAL PUBLIC LICENSE AS PUBLISHED BY
# THE FREE SOFTWARE FOUNDATION; EITHER VERSION 2 OF THE LICENSE, OR
# (AT YOUR OPTION) ANY LATER VERSION.
#
# THIS PROGRAM IS DISTRIBUTED IN THE HOPE THAT IT WILL BE USEFUL, BUT
# WITHOUT ANY WARRANTY; WITHOUT EVEN THE IMPLIED WARRANTY OF
# MERCHANTABILITY OR FITNESS FOR A PARTICULAR PURPOSE. SEE THE GNU
# GENERAL PUBLIC LICENSE FOR MORE DETAILS.
#
# YOU SHOULD HAVE RECEIVED A COPY OF THE GNU GENERAL PUBLIC LICENSE
# ALONG WITH THIS PROGRAM; IF NOT, WRITE TO EDF R&D CODE_ASTER,
#    1 AVENUE DU GENERAL DE GAULLE, 92141 CLAMART CEDEX, FRANCE.
# ======================================================================
# FORCES DE LAME FLUIDE
# CAS_TEST__:SDND111A
#   FICHIER DE COMMANDE ASTER DU CAS-TEST DE FROTTEMNT A 1 DDL
#

DEBUT(CODE=_F(NOM='SDND111A',NIV_PUB_WEB='INTERNET'),DEBUG=_F(SDVERI='OUI'))

#

POUTRE=LIRE_MAILLAGE( )

POUTRE=DEFI_GROUP( reuse=POUTRE,   MAILLAGE=POUTRE,
  CREA_GROUP_MA=_F(  NOM = 'TOUT', TOUT = 'OUI'))

#

MODELE=AFFE_MODELE(   MAILLAGE=POUTRE,
                         AFFE=_F( TOUT = 'OUI', PHENOMENE = 'MECANIQUE',
                        MODELISATION = 'DIS_T'))

#
CHAMPCAR=AFFE_CARA_ELEM(  MODELE=MODELE,DISCRET=(
      _F(
       GROUP_MA = 'TOUT',
 CARA = 'K_T_D_N',
                             VALE = (24674.E0, 1.E0, 1.E0,)),
      _F(
       GROUP_MA = 'TOUT',
   CARA = 'M_T_D_N', VALE = 25.))
                         )

#
CHARGE=AFFE_CHAR_MECA(  MODELE=MODELE,DDL_IMPO=(
             _F( TOUT = 'OUI',  DZ = 0.0),
             _F( NOEUD = 'NO2',   DX = 0.0, DY = 0.0),
             _F( NOEUD = 'NO1',   DY = 0.0))
                      )

#
FORCE=AFFE_CHAR_MECA(  MODELE=MODELE,
                     FORCE_NODALE=_F( NOEUD = 'NO1',  FX = 1.)
                       )

#
RIGIELEM=CALC_MATR_ELEM(  MODELE=MODELE,  CHARGE=CHARGE,
                         CARA_ELEM=CHAMPCAR,
                         OPTION='RIGI_MECA')

#
MASSELEM=CALC_MATR_ELEM(  MODELE=MODELE,  CHARGE=CHARGE,
                         CARA_ELEM=CHAMPCAR,
                         OPTION='MASS_MECA')

#
VECTELEM=CALC_VECT_ELEM(   CHARGE=CHARGE,  OPTION='CHAR_MECA')

VECTEL1=CALC_VECT_ELEM(   CHARGE=FORCE,   OPTION='CHAR_MECA')

#
#
NUMEROTA=NUME_DDL(   MATR_RIGI=RIGIELEM )

#
MATRRIGI=ASSE_MATRICE(MATR_ELEM=RIGIELEM,NUME_DDL=NUMEROTA)

#
MATRMASS=ASSE_MATRICE(MATR_ELEM=MASSELEM,NUME_DDL=NUMEROTA)

#
VECTASS=ASSE_VECTEUR(   VECT_ELEM=VECTEL1,  NUME_DDL=NUMEROTA)

#
MODES=MODE_ITER_SIMULT(   MATR_A=MATRRIGI,  MATR_B=MATRMASS,
                         CALC_FREQ=_F( OPTION = 'CENTRE',
                        NMAX_FREQ = 1,
                        FREQ = ( 0.1, )),
)

#
DEPLPHY1=CREA_CHAMP( OPERATION='AFFE', TYPE_CHAM='NOEU_DEPL_R',
                            MAILLAGE=POUTRE,AFFE=(
                 _F( TOUT = 'OUI',
                    NOM_CMP = ('DX','DY',), VALE = (0.E0, 0., )),
                 _F( NOEUD = 'NO1',
                    NOM_CMP = ('DX','DY',), VALE = (-1.,  0., ))),
          CHAM_NO=VECTASS
                          )

#
DEPLPHY2=CREA_CHAMP( OPERATION='AFFE', TYPE_CHAM='NOEU_DEPL_R',
                            MAILLAGE=POUTRE,AFFE=(
                 _F( TOUT = 'OUI',
                    NOM_CMP = ('DX','DY',), VALE = (0.E0, 0., )),
                 _F( NOEUD = 'NO1',
                    NOM_CMP = ('DX','DY',), VALE = (-0.1,  0., ))),
          CHAM_NO=VECTASS
                          )

#
DEPLPHY3=CREA_CHAMP( OPERATION='AFFE', TYPE_CHAM='NOEU_DEPL_R',
                            MAILLAGE=POUTRE,AFFE=(
                 _F( TOUT = 'OUI',
                    NOM_CMP = ('DX','DY',), VALE = (0.E0, 0., )),
                 _F( NOEUD = 'NO1',
                    NOM_CMP = ('DX','DY',), VALE = (-0.001,  0., ))),
          CHAM_NO=VECTASS
                          )

#
#
PROJ_BASE(  BASE=MODES,
            STOCKAGE='DIAG',
            MATR_ASSE_GENE=(
             _F(
                             MATRICE = CO("MASSEGEN"),
                             MATR_ASSE = MATRMASS),
             _F(
                             MATRICE = CO("RIGIDGEN"),
                             MATR_ASSE = MATRRIGI)),VECT_ASSE_GENE=(
             _F(
                             VECTEUR = CO("VITINI1"),
                             VECT_ASSE = DEPLPHY1,
                             TYPE_VECT = 'VITE'),
             _F(
                             VECTEUR = CO("VITINI2"),
                             VECT_ASSE = DEPLPHY2,
                             TYPE_VECT = 'VITE'),
             _F(
                             VECTEUR = CO("VITINI3"),
                             VECT_ASSE = DEPLPHY3,
                             TYPE_VECT = 'VITE'),
             _F(
                             VECTEUR = CO("FOGENE"),
                             VECT_ASSE = VECTASS))
)

#
PLANZ=DEFI_OBSTACLE(   TYPE='BI_PLAN_Z' )

PLANY=DEFI_OBSTACLE(   TYPE='BI_PLAN_Y' )

# -----------  DEFINITION DE LA FONCTION D'EXCITATION
FREQ=3.876

AMPL=-100.

OMEGA=2.* pi * FREQ

PAS2=0.05/FREQ

#
# DEFINITION DE L'EVOLUTION TEMPORELLE DU CHARGEMENT
#---------------------------------------------------
SINUS = FORMULE(NOM_PARA='INST',VALE='AMPL*sin(OMEGA*INST) ')
#
LI1=DEFI_LIST_REEL(    DEBUT=0.,
                      INTERVALLE=_F(  JUSQU_A = 8.1, PAS = 0.0025))

#
FONCTIO1=CALC_FONC_INTERP(    FONCTION=SINUS,  LIST_PARA=LI1,
NOM_PARA = 'INST',
                               NOM_RESU='TOUT_RESU',
                               PROL_GAUCHE='CONSTANT',
                               PROL_DROITE='EXCLU',
                               INTERPOL='LIN'
                            )

#
DYNAMOD1=DYNA_VIBRA(TYPE_CALCUL='TRAN',BASE_CALCUL='GENE',
                       SCHEMA_TEMPS=_F(SCHEMA='EULER',),
                       MATR_MASS=MASSEGEN,
                       MATR_RIGI=RIGIDGEN,
                       AMOR_MODAL=_F(AMOR_REDUIT=( 0., ),),
                       INCREMENT=_F(  INST_INIT = 0.,
                                   INST_FIN = 2.,
                                   PAS = 1.E-5),
                      ARCHIVAGE=_F(  PAS_ARCH = 10),
                      PARA_LAME_FLUI=_F(NMAX_ITER=30,
                       RESI_RELA=1.2E-2,),
                       EXCIT=_F(
                      VECT_ASSE_GENE = FOGENE,
                      FONC_MULT = FONCTIO1),
                      CHOC=_F(
                               NOEUD_1 = 'NO1',
                               NOEUD_2 = 'NO2',
                               INTITULE = 'LIAISON',
                               OBSTACLE = PLANZ,
                               NORM_OBST = (0., 0., 1.,),
                               ANGL_VRIL = 0.,
                               DIST_1 = 0.4975,
                               DIST_2 = 0.4975,
                               RIGI_NOR = 2.E10,
                               RIGI_TAN = 2.E10,
                               FROTTEMENT='COULOMB',
                               COULOMB = 0.,
                               LAME_FLUIDE = 'OUI',
                               ALPHA = -0.08325,
                               BETA = 0.07493,
                               CHI = -0.9996E-6,
                               DELTA = -0.1665)
                          )

#
LISTER1=DEFI_LIST_REEL(  DEBUT=0.13,INTERVALLE=(
                    _F( JUSQU_A = 0.2684, NOMBRE = 1),
                    _F( JUSQU_A = 0.3902, NOMBRE = 1),
                    _F( JUSQU_A = 0.531,  NOMBRE = 1))
                            )

#
DYNATRAN=REST_GENE_PHYS(
                    RESU_GENE=DYNAMOD1,
                    LIST_INST=LISTER1,
                    NOM_CHAM='DEPL',
                    INTERPOL='LIN'
                            )

TEST_RESU( RESU=_F(
                     RESULTAT = DYNATRAN,
                     NUME_ORDRE = 1,
                     NOEUD = 'NO1',
                     PRECISION = 0.001,
                     NOM_CHAM = 'DEPL',
                     NOM_CMP = 'DX',
                     VALE = -3.5435E-3)
          )

#
TEST_RESU( RESU=_F(
                     RESULTAT = DYNATRAN,
                     NUME_ORDRE = 2,
                     NOEUD = 'NO1',
                     PRECISION = 0.005,
                     NOM_CHAM = 'DEPL',
                     NOM_CMP = 'DX',
                     VALE = 5.99203E-3)
          )

#
TEST_RESU( RESU=_F(
                     RESULTAT = DYNATRAN,
                     NUME_ORDRE = 3,
                     NOEUD = 'NO1',
                     PRECISION = 0.005,
                     NOM_CHAM = 'DEPL',
                     NOM_CMP = 'DX',
                     VALE = -3.78488E-3)
          )

#
TEST_RESU( RESU=_F(
                     RESULTAT = DYNATRAN,
                     NUME_ORDRE = 4,
                     NOEUD = 'NO1',
                     PRECISION = 0.01,
                     NOM_CHAM = 'DEPL',
                     NOM_CMP = 'DX',
                     VALE = 5.66919E-3)
          )

#
DYNAMOD2=DYNA_VIBRA(TYPE_CALCUL='TRAN',BASE_CALCUL='GENE',
                       MATR_MASS=MASSEGEN,
                       MATR_RIGI=RIGIDGEN,
                       SCHEMA_TEMPS=_F(SCHEMA='EULER',),
                       AMOR_MODAL=_F(AMOR_REDUIT=( 0.0, ),),
                       INCREMENT=_F(  INST_INIT = 0.,
                                   INST_FIN = 2.,
                                   PAS = 1.E-5),
                      ARCHIVAGE=_F(  PAS_ARCH = 10),
                       EXCIT=_F(
                      VECT_ASSE_GENE = FOGENE,
                      FONC_MULT = FONCTIO1),
                      CHOC=_F(
                               NOEUD_1 = 'NO1',
                               NOEUD_2 = 'NO2',
                               INTITULE = 'LIAISON',
                               OBSTACLE = PLANZ,
                               NORM_OBST = (0., 0., 1.,),
                               ANGL_VRIL = 0.,
                               DIST_1 = 0.4975,
                               DIST_2 = 0.4975,
                               RIGI_NOR = 2.E10,
                               RIGI_TAN = 2.E10,
                               FROTTEMENT='COULOMB',
                               COULOMB = 0.,
                               LAME_FLUIDE = 'OUI',
                               ALPHA = -0.08325,
                               BETA = 0.041625,
                               CHI = 0.,
                               DELTA = -0.1665)
                          )

#
#
LISTER2=DEFI_LIST_REEL(
                         DEBUT=0.1282,INTERVALLE=(
 _F( JUSQU_A = 0.2651, NOMBRE = 1),
 _F( JUSQU_A = 0.3876, NOMBRE = 1),
 _F( JUSQU_A = 0.5263,  NOMBRE = 1))
                            )

#
DYNATRA2=REST_GENE_PHYS(
                    RESU_GENE=DYNAMOD2,
                    LIST_INST=LISTER2,
                    NOM_CHAM='DEPL',
                    INTERPOL='LIN'
                            )

#
#
TEST_RESU( RESU=_F(
                     RESULTAT = DYNATRA2,
                     NUME_ORDRE = 1,
                     NOEUD = 'NO1',
                     PRECISION = 0.001,
                     NOM_CHAM = 'DEPL',
                     NOM_CMP = 'DX',
                     VALE = -3.71678E-3)
          )

#
TEST_RESU( RESU=_F(
                     RESULTAT = DYNATRA2,
                     NUME_ORDRE = 2,
                     NOEUD = 'NO1',
                     PRECISION = 0.005,
                     NOM_CHAM = 'DEPL',
                     NOM_CMP = 'DX',
                     VALE = 5.22565E-3)
          )

#
TEST_RESU( RESU=_F(
                     RESULTAT = DYNATRA2,
                     NUME_ORDRE = 3,
                     NOEUD = 'NO1',
                     PRECISION = 0.005,
                     NOM_CHAM = 'DEPL',
                     NOM_CMP = 'DX',
                     VALE = -3.99499E-3)
          )

#
TEST_RESU( RESU=_F(
                     RESULTAT = DYNATRA2,
                     NUME_ORDRE = 4,
                     NOEUD = 'NO1',
                     PRECISION = 0.01,
                     NOM_CHAM = 'DEPL',
                     NOM_CMP = 'DX',
                     VALE = 4.68796E-3)
          )

#

FIN()
#
#
