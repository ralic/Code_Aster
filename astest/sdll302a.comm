# MODIF  DATE 21/10/2008   AUTEUR NISTOR I.NISTOR 
# TITRE REPONSE TEMPORELLE D'UNE POUTRE
#            CONFIGURATION MANAGEMENT OF EDF VERSION
# ======================================================================
# COPYRIGHT (C) 1991 - 2001  EDF R&D                  WWW.CODE-ASTER.ORG
# THIS PROGRAM IS FREE SOFTWARE; YOU CAN REDISTRIBUTE IT AND/OR MODIFY
# IT UNDER THE TERMS OF THE GNU GENERAL PUBLIC LICENSE AS PUBLISHED BY
# THE FREE SOFTWARE FOUNDATION; EITHER VERSION 2 OF THE LICENSE, OR
# (AT YOUR OPTION) ANY LATER VERSION.
#
# THIS PROGRAM IS DISTRIBUTED IN THE HOPE THAT IT WILL BE USEFUL, BUT
# WITHOUT ANY WARRANTY; WITHOUT EVEN THE IMPLIED WARRANTY OF
# MERCHANTABILITY OR FITNESS FOR A PARTICULAR PURPOSE. SEE THE GNU
# GENERAL PUBLIC LICENSE FOR MORE DETAILS.
#
# YOU SHOULD HAVE RECEIVED A COPY OF THE GNU GENERAL PUBLIC LICENSE
# ALONG WITH THIS PROGRAM; IF NOT, WRITE TO EDF R&D CODE_ASTER,
#    1 AVENUE DU GENERAL DE GAULLE, 92141 CLAMART CEDEX, FRANCE.
# ======================================================================
#
# A) METHODE DE DEVOGELARE (INTEGRATION SUR BASE MODALE)
#
DEBUT(CODE=_F(NOM='SDLL302A', NIV_PUB_WEB='INTERNET'), BASE=_F(FICHIER='GLOBALE', LONG_REPE=30000), DEBUG=_F(SDVERI='OUI'))

#
# LIRE ACCELEROGRAMME FFFF EN R11
#
CENTROA=LIRE_FONCTION(          UNITE=18,
                                  NOM_PARA='INST',
                                  NOM_RESU='ACCEL_SOL',
                                     TITRE='EL CENTRO NS - A ',
                                  INTERPOL='LIN',
                                PROL_DROITE='EXCLU',
                               PROL_GAUCHE='EXCLU'
                           )

#
VITESSA=CALC_FONCTION(    INTEGRE=_F( FONCTION = CENTROA,
                                        METHODE = 'SIMPSON',
                                        COEF = 0.)
                           )

#
DEPLACA=CALC_FONCTION(    INTEGRE=_F( FONCTION = VITESSA,
                                        METHODE = 'SIMPSON',
                                        COEF = 0.)
                           )

#
MA=LIRE_MAILLAGE(  )

#
MA=DEFI_GROUP( reuse=MA,        MAILLAGE=MA,
                        CREA_GROUP_NO=_F( GROUP_MA = 'POUTRE')
                        )

#
# DEFINITION DES CARACTERISTIQUES DE LA SECTION RECTANGULAIRE
#
HY=0.0508

#
HZ=0.0254

#
# DEFINITION DES PARAMETRES POUR LA DISCRETISATION TEMPORELLE
#
DEBUTR=0.

DEBUTI=0

TFIN=2.

PAS=0.001

NPAS=2000

#
# LISTE DE DISCRETISATION TEMPORELLE
#
L_INST=DEFI_LIST_REEL(         DEBUT=DEBUTR,
                              INTERVALLE=_F( JUSQU_A = TFIN,
                                          PAS = 0.01)
                          )

#
L_INST1=DEFI_LIST_REEL(         DEBUT=DEBUTR,
                              INTERVALLE=_F( JUSQU_A = TFIN,
                                          PAS = PAS)
                          )

#
# LISTE D ARCHIVAGE
#
L_ARCH=DEFI_LIST_ENTI(         DEBUT=DEBUTI,
                              INTERVALLE=_F( JUSQU_A = NPAS,
                                          PAS = 10)
                          )

#
# DEFINITION DU MODELE
#
MO=AFFE_MODELE(    MAILLAGE=MA,
                                AFFE=_F( PHENOMENE = 'MECANIQUE',
                                      GROUP_MA = 'POUTRE',
                                      MODELISATION = 'POU_D_T')
                        )

#
# CARACTERISTIQUES DES POUTRES, ET AUTRES ELEMENTS
#
CARAELEM=AFFE_CARA_ELEM(      MODELE=MO,
                                 POUTRE=_F( GROUP_MA = 'POUTRE',
                                         SECTION = 'RECTANGLE',
                                         CARA = ('HY',  'HZ', ),
                                         VALE = ( HY,    HZ,  ))
                           )

#
# DEFINITION DU MATERIAU
#
MAT=DEFI_MATERIAU(    ELAS=_F( E = 2.068E11,
                                    NU = 0.3,
                                    RHO = 7780.)
                          )

#
# AFFECTATION DU MATERIAU
#
CHMAT=AFFE_MATERIAU(    MAILLAGE=MA,
                                  AFFE=_F( TOUT = 'OUI',
                                        MATER = MAT)
                          )

#
# CONDITIONS AUX LIMITES
#
CH1A=AFFE_CHAR_MECA(      MODELE=MO,DDL_IMPO=(
                                _F( GROUP_NO = ('P0', 'P2',),
                                          DX = 0.,
                                          DY = 0.,
                                          DZ = 0.,
                                          DRX = 0.,
                                          DRY = 0.,
                                          DRZ = 0.),
                                _F( TOUT = 'OUI',
                                          DZ = 0.))
                            )

#
# CALCUL DES MATRICES ELEMENTAIRES DE RIGIDITES
#
RIGIELEM=CALC_MATR_ELEM(        MODELE=MO,
                                   CHARGE=CH1A,
                                   OPTION='RIGI_MECA',
                               CHAM_MATER=CHMAT,
                                CARA_ELEM=CARAELEM
                           )

#
# CALCUL DES MATRICES ELEMENTAIRES DE MASSES
#
MASSELEM=CALC_MATR_ELEM(        MODELE=MO,
                                   CHARGE=CH1A,
                                   OPTION='MASS_MECA',
                               CHAM_MATER=CHMAT,
                                CARA_ELEM=CARAELEM
                           )

#
# NUMEROTATIOM
#
NUMEDDL=NUME_DDL(    MATR_RIGI=RIGIELEM )

#
# MATRICE DE RIGIDITE
#
RIGIDITE=ASSE_MATRICE(    MATR_ELEM=RIGIELEM,
                             NUME_DDL=NUMEDDL
                        )

#
# MATRICE DE MASSE
#
MASSE=ASSE_MATRICE(    MATR_ELEM=MASSELEM,
                             NUME_DDL=NUMEDDL
                        )

#
# CALCUL MODAL
#
MODE1=MODE_ITER_SIMULT(       MATR_A=RIGIDITE,
                                   MATR_B=MASSE,
                                CALC_FREQ=_F( NMAX_FREQ = 6,
                                           OPTION = 'PLUS_PETITE')
                            )

#
# DEFINITION DE LA DIRECTION DU SEISME
#
# CALCUL DES MODES STATIQUES
#
MODESTA=MODE_STATIQUE(    MATR_RIGI=RIGIDITE,
                             MATR_MASS=MASSE,
                              MODE_STAT =_F(  GROUP_NO = ('P0', 'P2',),
                                         AVEC_CMP = 'DY')
                         )

#
# CALCUL DE CHARGEMENT SISMIQUE EN RELATIF
#
MONOX=CALC_CHAR_SEISME(     MATR_MASS=MASSE,
                                 DIRECTION=(0., 1., 0.,),
                                MONO_APPUI='OUI'
                            )

#
# CALCUL DE CHARGEMENT SISMIQUE EN ABSOLU
#
MULTIX=CALC_CHAR_SEISME(     MATR_MASS=MASSE,
                                 DIRECTION=(0., 1., 0.,),
                                 MODE_STAT=MODESTA,
                                  GROUP_NO=('P0', 'P2',)
                            )

#
#  RESOLUTION TEMPORELLE
#
# PROJECTION DANS LA BASE DES MODES : MODE1
#
NUMGEN=NUME_DDL_GENE(        BASE=MODE1,
                             STOCKAGE='PLEIN'
                         )

#
# EN ABSOLU
#
RIGIGEN1=PROJ_MATR_BASE(             BASE=MODE1,
                              NUME_DDL_GENE=NUMGEN,
                                  MATR_ASSE=RIGIDITE
                          )

#
MASSGEN1=PROJ_MATR_BASE(             BASE=MODE1,
                              NUME_DDL_GENE=NUMGEN,
                                  MATR_ASSE=MASSE
                          )

#
VECTGEN1=PROJ_VECT_BASE(             BASE=MODE1,
                              NUME_DDL_GENE=NUMGEN,
                                  VECT_ASSE=MULTIX
                          )

#
REPBASE1=DYNA_TRAN_MODAL(      METHODE='DEVOGE',
                               RIGI_GENE=RIGIGEN1,
                               MASS_GENE=MASSGEN1,
                               ARCHIVAGE=_F( LIST_ARCH = L_ARCH),
                              INCREMENT=_F(  INST_INIT = DEBUTR,
                                          PAS = PAS,
                                          INST_FIN = TFIN),
                               MODE_STAT=MODESTA,
                                   EXCIT=_F(  VECT_GENE = VECTGEN1,
                                           MULT_APPUI = 'OUI',
                                           ACCE = CENTROA,
                                           VITE = VITESSA,
                                           DEPL = DEPLACA,
                                           DIRECTION = (0., 1., 0.,),
                                           GROUP_NO = ('P0', 'P2',))
                           )

#
#
# PROJECTION DANS LA BASE PHYSIQUE DES DEPLACEMENTS ABSOLUS
#
REP_LIN1=REST_GENE_PHYS(     RESU_GENE=REPBASE1,
                                  NOM_CHAM='DEPL',
                                MULT_APPUI='OUI'
                            )

#
# DEPLACEMENT ABSOLU AU POINT P1
#
P1_DY1=RECU_FONCTION(      RESULTAT=REP_LIN1,
                                NOM_CHAM='DEPL',
                                GROUP_NO='P1',
                                     NOM_CMP='DY'
                          )

#
# TEST_RESU DES MODES PROPRES
#
TEST_RESU(  RESU=_F( RESULTAT = MODE1,
                   PARA = 'FREQ',
                   CRITERE = 'RELATIF',
                   PRECISION = 0.01,
                   NUME_ORDRE = 1,
                   VALE = 4.60)
          )

#
TEST_RESU(  RESU=_F( RESULTAT = MODE1,
                   PARA = 'FREQ',
                   CRITERE = 'RELATIF',
                   PRECISION = 0.005,
                   NUME_ORDRE = 2,
                   VALE = 12.78)
          )

#
TEST_RESU(  RESU=_F( RESULTAT = MODE1,
                   PARA = 'FREQ',
                   CRITERE = 'RELATIF',
                   PRECISION = 0.001,
                   NUME_ORDRE = 3,
                   VALE = 25.05)
          )

#
TEST_RESU(  RESU=_F( RESULTAT = MODE1,
                   PARA = 'FREQ',
                   CRITERE = 'RELATIF',
                   PRECISION = 0.002,
                   NUME_ORDRE = 4,
                   VALE = 41.42)
          )

#
TEST_RESU(  RESU=_F( RESULTAT = MODE1,
                   PARA = 'FREQ',
                   CRITERE = 'RELATIF',
                   PRECISION = 0.003,
                   NUME_ORDRE = 5,
                   VALE = 61.87)
          )

#
TEST_RESU(  RESU=_F( RESULTAT = MODE1,
                   PARA = 'FREQ',
                   CRITERE = 'RELATIF',
                   PRECISION = 0.003,
                   NUME_ORDRE = 6,
                   VALE = 86.42)
          )

#
# TEST_RESU DES DEPLACEMENTS ABSOLUS SUIVANT Y
#
TEST_RESU(   RESU=_F( RESULTAT = REP_LIN1,
                    NOM_CHAM = 'DEPL',
                    NUME_ORDRE = 10,
                    GROUP_NO = 'P1',
                    NOM_CMP = 'DY',
                    VALE = -5.80E-4,
                    PRECISION = 0.03)
          )

#
TEST_RESU(   RESU=_F( RESULTAT = REP_LIN1,
                    NOM_CHAM = 'DEPL',
                    NUME_ORDRE = 20,
                    GROUP_NO = 'P1',
                    NOM_CMP = 'DY',
                    VALE = -24.60E-4,
                    PRECISION = 0.005)
          )

#
TEST_RESU(   RESU=_F( RESULTAT = REP_LIN1,
                    NOM_CHAM = 'DEPL',
                    NUME_ORDRE = 30,
                    GROUP_NO = 'P1',
                    NOM_CMP = 'DY',
                    CRITERE = 'ABSOLU',
                    VALE = -8.42E-4,
                    PRECISION = 0.01)
          )

#
TEST_RESU(   RESU=_F( RESULTAT = REP_LIN1,
                    NOM_CHAM = 'DEPL',
                    NUME_ORDRE = 40,
                    GROUP_NO = 'P1',
                    NOM_CMP = 'DY',
                    VALE = -2.07E-3,
                    PRECISION = 0.01)
          )

#
TEST_RESU(   RESU=_F( RESULTAT = REP_LIN1,
                    NOM_CHAM = 'DEPL',
                    NUME_ORDRE = 50,
                    GROUP_NO = 'P1',
                    NOM_CMP = 'DY',
                    CRITERE = 'ABSOLU',
                    VALE = 5.18E-4,
                    PRECISION = 0.01)
          )

#
TEST_RESU(   RESU=_F( RESULTAT = REP_LIN1,
                    NOM_CHAM = 'DEPL',
                    NUME_ORDRE = 60,
                    GROUP_NO = 'P1',
                    NOM_CMP = 'DY',
                    CRITERE = 'ABSOLU',
                    VALE = 9.71E-4,
                    PRECISION = 0.01)
          )

#
TEST_RESU(   RESU=_F( RESULTAT = REP_LIN1,
                    NOM_CHAM = 'DEPL',
                    NUME_ORDRE = 70,
                    GROUP_NO = 'P1',
                    NOM_CMP = 'DY',
                    CRITERE = 'ABSOLU',
                    VALE = -5.18E-4,
                    PRECISION = 0.01)
          )

#
TEST_RESU(   RESU=_F( RESULTAT = REP_LIN1,
                    NOM_CHAM = 'DEPL',
                    NUME_ORDRE = 80,
                    GROUP_NO = 'P1',
                    NOM_CMP = 'DY',
                    VALE = -51.80E-4,
                    PRECISION = 0.1)
          )

#
TEST_RESU(   RESU=_F( RESULTAT = REP_LIN1,
                    NOM_CHAM = 'DEPL',
                    NUME_ORDRE = 90,
                    GROUP_NO = 'P1',
                    NOM_CMP = 'DY',
                    VALE = -77.70E-4,
                    PRECISION = 0.23)
          )

#
TEST_RESU(   RESU=_F( RESULTAT = REP_LIN1,
                    NOM_CHAM = 'DEPL',
                    NUME_ORDRE = 100,
                    GROUP_NO = 'P1',
                    NOM_CMP = 'DY',
                    VALE = -163.20E-4,
                    PRECISION = 0.055)
          )

#
TEST_RESU(   RESU=_F( RESULTAT = REP_LIN1,
                    NOM_CHAM = 'DEPL',
                    NUME_ORDRE = 110,
                    GROUP_NO = 'P1',
                    NOM_CMP = 'DY',
                    VALE = -54.40E-4,
                    PRECISION = 0.18)
          )

#
TEST_RESU(   RESU=_F( RESULTAT = REP_LIN1,
                    NOM_CHAM = 'DEPL',
                    NUME_ORDRE = 120,
                    GROUP_NO = 'P1',
                    NOM_CMP = 'DY',
                    VALE = -123.05E-4,
                    PRECISION = 0.12)
          )

#
TEST_RESU(   RESU=_F( RESULTAT = REP_LIN1,
                    NOM_CHAM = 'DEPL',
                    NUME_ORDRE = 130,
                    GROUP_NO = 'P1',
                    NOM_CMP = 'DY',
                    CRITERE = 'ABSOLU',
                    VALE = -3.90E-4,
                    PRECISION = 0.01)
          )

#
TEST_RESU(   RESU=_F( RESULTAT = REP_LIN1,
                    NOM_CHAM = 'DEPL',
                    NUME_ORDRE = 140,
                    GROUP_NO = 'P1',
                    NOM_CMP = 'DY',
                    VALE = -108.80E-4,
                    PRECISION = 0.19)
          )

#
TEST_RESU(   RESU=_F( RESULTAT = REP_LIN1,
                    NOM_CHAM = 'DEPL',
                    NUME_ORDRE = 150,
                    GROUP_NO = 'P1',
                    NOM_CMP = 'DY',
                    VALE = 45.35E-4,
                    PRECISION = 0.35)
          )

#
TEST_RESU(   RESU=_F( RESULTAT = REP_LIN1,
                    NOM_CHAM = 'DEPL',
                    NUME_ORDRE = 160,
                    GROUP_NO = 'P1',
                    NOM_CMP = 'DY',
                    VALE = -99.75E-4,
                    PRECISION = 0.19)
          )

#
TEST_RESU(   RESU=_F( RESULTAT = REP_LIN1,
                    NOM_CHAM = 'DEPL',
                    NUME_ORDRE = 170,
                    GROUP_NO = 'P1',
                    NOM_CMP = 'DY',
                    VALE = -25.90E-4,
                    PRECISION = 0.36)
          )

#
TEST_RESU(   RESU=_F( RESULTAT = REP_LIN1,
                    NOM_CHAM = 'DEPL',
                    NUME_ORDRE = 180,
                    GROUP_NO = 'P1',
                    NOM_CMP = 'DY',
                    VALE = -116.60E-4,
                    PRECISION = 0.24)
          )

#
TEST_RESU(   RESU=_F( RESULTAT = REP_LIN1,
                    NOM_CHAM = 'DEPL',
                    NUME_ORDRE = 190,
                    GROUP_NO = 'P1',
                    NOM_CMP = 'DY',
                    VALE = -80.30E-4,
                    PRECISION = 0.04)
          )

#
TEST_RESU(   RESU=_F( RESULTAT = REP_LIN1,
                    NOM_CHAM = 'DEPL',
                    NUME_ORDRE = 200,
                    GROUP_NO = 'P1',
                    NOM_CMP = 'DY',
                    VALE = -6.47E-3,
                    PRECISION = 0.24)
          )

#
# B) METHODE DE NEWMARK (INTEGRATION DIRECTE SUR BASE PHYSIQUE)
#
#
# -------------------------------------------------------------------
#  RESOLUTION TEMPORELLE PAR INTEGRATION DIRECTE
# -------------------------------------------------------------------
#
#
REP_LIN=DYNA_LINE_TRAN(    MATR_RIGI=RIGIDITE,
                              MATR_MASS=MASSE,
                                NEWMARK=_F( ALPHA = 0.25,
                                         DELTA = 0.50),
                            INCREMENT=_F( LIST_INST = L_INST1),
                              ARCHIVAGE=_F( LIST_ARCH = L_ARCH,
                                         CHAM_EXCLU = ('ACCE', 'VITE',)),
                                  EXCIT=_F(  VECT_ASSE = MONOX,
                                          FONC_MULT = CENTROA)
                          )

#
# RECUPERATION DE LA FONCTION
#
# DEPLACEMENT AU POINT P1
#
P1_DY2=RECU_FONCTION(    RESULTAT=REP_LIN,
                              NOM_CHAM='DEPL',
                              GROUP_NO='P1',
                                   NOM_CMP='DY'
                          )

#
# DEPLACEMENT SUIVANT Y AVEC LA REF. K2000
#
TEST_RESU(   RESU=_F( RESULTAT = REP_LIN,
                    NOM_CHAM = 'DEPL',
                    NUME_ORDRE = 20,
                    GROUP_NO = 'P1',
                    NOM_CMP = 'DY',
                    VALE = -1.38111E-03,
                    PRECISION = 0.035)
          )

#
TEST_RESU(   RESU=_F( RESULTAT = REP_LIN,
                    NOM_CHAM = 'DEPL',
                    NUME_ORDRE = 40,
                    GROUP_NO = 'P1',
                    NOM_CMP = 'DY',
                    VALE = -8.97697E-04,
                    PRECISION = 0.015)
          )

#
TEST_RESU(   RESU=_F( RESULTAT = REP_LIN,
                    NOM_CHAM = 'DEPL',
                    NUME_ORDRE = 60,
                    GROUP_NO = 'P1',
                    NOM_CMP = 'DY',
                    VALE = 3.80874E-04,
                    PRECISION = 0.03)
          )

#
TEST_RESU(   RESU=_F( RESULTAT = REP_LIN,
                    NOM_CHAM = 'DEPL',
                    NUME_ORDRE = 80,
                    GROUP_NO = 'P1',
                    NOM_CMP = 'DY',
                    VALE = -6.28406E-05,
                    PRECISION = 0.09)
          )

#
TEST_RESU(   RESU=_F( RESULTAT = REP_LIN,
                    NOM_CHAM = 'DEPL',
                    NUME_ORDRE = 100,
                    GROUP_NO = 'P1',
                    NOM_CMP = 'DY',
                    VALE = -3.91707E-03,
                    PRECISION = 0.01)
          )

#
TEST_RESU(   RESU=_F( RESULTAT = REP_LIN,
                    NOM_CHAM = 'DEPL',
                    NUME_ORDRE = 120,
                    GROUP_NO = 'P1',
                    NOM_CMP = 'DY',
                    VALE = -4.54598E-03,
                    PRECISION = 0.01)
          )

#
TEST_RESU(   RESU=_F( RESULTAT = REP_LIN,
                    NOM_CHAM = 'DEPL',
                    NUME_ORDRE = 140,
                    GROUP_NO = 'P1',
                    NOM_CMP = 'DY',
                    VALE = -7.28983E-03,
                    PRECISION = 0.01)
          )

#
TEST_RESU(   RESU=_F( RESULTAT = REP_LIN,
                    NOM_CHAM = 'DEPL',
                    NUME_ORDRE = 160,
                    GROUP_NO = 'P1',
                    NOM_CMP = 'DY',
                    VALE = -6.29329E-03,
                    PRECISION = 0.03)
          )

#
TEST_RESU(   RESU=_F( RESULTAT = REP_LIN,
                    NOM_CHAM = 'DEPL',
                    NUME_ORDRE = 180,
                    GROUP_NO = 'P1',
                    NOM_CMP = 'DY',
                    VALE = -3.00262E-03,
                    PRECISION = 0.04)
          )

#
TEST_RESU(   RESU=_F( RESULTAT = REP_LIN,
                    NOM_CHAM = 'DEPL',
                    NUME_ORDRE = 200,
                    GROUP_NO = 'P1',
                    NOM_CMP = 'DY',
                    VALE = 5.35166E-04,
                    PRECISION = 0.3)
          )

#
FIN()
#
