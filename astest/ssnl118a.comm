# MODIF  DATE 05/03/2012   AUTEUR PELLET J.PELLET 
# TITRE BARRE SOUMISE A UN CHAMP DE VITESSE DE VENT
#            CONFIGURATION MANAGEMENT OF EDF VERSION
# ======================================================================
# COPYRIGHT (C) 1991 - 2012  EDF R&D                  WWW.CODE-ASTER.ORG
# THIS PROGRAM IS FREE SOFTWARE; YOU CAN REDISTRIBUTE IT AND/OR MODIFY
# IT UNDER THE TERMS OF THE GNU GENERAL PUBLIC LICENSE AS PUBLISHED BY
# THE FREE SOFTWARE FOUNDATION; EITHER VERSION 2 OF THE LICENSE, OR
# (AT YOUR OPTION) ANY LATER VERSION.
#
# THIS PROGRAM IS DISTRIBUTED IN THE HOPE THAT IT WILL BE USEFUL, BUT
# WITHOUT ANY WARRANTY; WITHOUT EVEN THE IMPLIED WARRANTY OF
# MERCHANTABILITY OR FITNESS FOR A PARTICULAR PURPOSE. SEE THE GNU
# GENERAL PUBLIC LICENSE FOR MORE DETAILS.
#
# YOU SHOULD HAVE RECEIVED A COPY OF THE GNU GENERAL PUBLIC LICENSE
# ALONG WITH THIS PROGRAM; IF NOT, WRITE TO EDF R&D CODE_ASTER,
#    1 AVENUE DU GENERAL DE GAULLE, 92141 CLAMART CEDEX, FRANCE.
# ======================================================================
#   Calcul realise avec un Stat_non_line
#   Lecture d'un champ de vitesse de vent
#   Prise en compte d'une fonction decrivant la force repartie
#
# VALIDATION PAR REFERENCE AU CALCUL ANALYTIQUE
#
DEBUT(CODE=_F(NOM='ssnl118a', NIV_PUB_WEB='INTERNET'), DEBUG=_F(SDVERI='OUI'))

# Maillage supportant les champs de vent
PRE_IDEAS(
    UNITE_IDEAS    = 30,
    UNITE_MAILLAGE = 32,
)
MAVENT=LIRE_MAILLAGE(UNITE= 32)

# Lecture du fichier de vitesse de vent
VVENT=LIRE_RESU(
    TITRE='VITESSE DE VENT',
    MAILLAGE=MAVENT,
    FORMAT='IDEAS',
    TYPE_RESU='EVOL_CHAR',
    NOM_CHAM= ('VITE_VENT'),
    FORMAT_IDEAS=_F( POSI_ORDRE=(7,4),
                     NOM_CMP=('DX','DY','DZ'),
                     POSI_INST=(8,1),
                     NOM_CHAM='VITE_VENT',
                     NUME_DATASET=55,
                     RECORD_6=(1,4,2,0,2,3)
                    ),
    TOUT_ORDRE='OUI',
    UNITE=38,
)

# Maillage supportant la structure
MA=LIRE_MAILLAGE(UNITE= 20)

# Modele contenant la structure
MO=AFFE_MODELE(
    MAILLAGE=MA,
    AFFE=(_F( GROUP_MA=('BARR1'),
              PHENOMENE='MECANIQUE', MODELISATION='BARRE'),
          _F( GROUP_MA=('RESS1','RESS2'),
              PHENOMENE='MECANIQUE', MODELISATION='DIS_T')
         )
)

FCXV=DEFI_FONCTION(
  NOM_PARA='VITE',
  VALE=(  0.0 ,   0.0,
         10.0 ,  10.0 ),
  PROL_GAUCHE='LINEAIRE',
  PROL_DROITE='LINEAIRE',
)

CARELEM=AFFE_CARA_ELEM(
    MODELE=MO,
    BARRE=_F( GROUP_MA=('BARR1'), SECTION='CERCLE',
               CARA=('R','EP'),
               VALE=(0.5,0.5),
               FCX = FCXV ),
    DISCRET=(_F( GROUP_MA=('RESS1'), CARA='K_T_D_L',
                 VALE=(10.0,20.0,100000.0) ),
             _F( GROUP_MA=('RESS2'), CARA='K_T_D_L',
                 VALE=(25.0,30.0,100000.0) )
            )
)

ACIER=DEFI_MATERIAU(
    ELAS=_F( RHO   = 1000.0,
             E     = 2.0E+08,
             NU    = 0.3,
             ALPHA = 2.3E-05,
            )
)

CHMAT=AFFE_MATERIAU(
    MAILLAGE=MA,
    AFFE=_F( MATER=ACIER, TOUT='OUI' )
)

LIMIT=AFFE_CHAR_MECA(
    MODELE=MO,
    DDL_IMPO=(_F( GROUP_NO=('PT1','PT2'),
                  DZ=0.0,DX=0.0,DY=0.0 ),
              _F( GROUP_NO=('PTR1','PTR2'),
                 DZ=0.0 )
             )
)

TEMPS=DEFI_LIST_REEL(VALE=(0.0, 1.0 , 1.05 , 1.1 , 2.0))

FVENTCX=AFFE_CHAR_MECA(
    MODELE    = MO,
    EVOL_CHAR = VVENT )

RSTAT1=STAT_NON_LINE(
    MODELE     = MO,
    CARA_ELEM  = CARELEM,
    CHAM_MATER = CHMAT,
    EXCIT =(_F(CHARGE = LIMIT ),
            _F(CHARGE = FVENTCX, TYPE_CHARGE='SUIV' )
            ),
    INCREMENT=_F( NUME_INST_FIN = 4,
                  LIST_INST     = TEMPS ),
    COMP_INCR=_F( GROUP_MA    = ('BARRE'),
                  RELATION    =  'ELAS',
                  DEFORMATION =  'PETIT_REAC' ),
    CONVERGENCE=_F( ITER_GLOB_MAXI = 20,
                    RESI_GLOB_RELA = 1.E-08,),
    NEWTON =_F(REAC_ITER=1),
    SOLVEUR=_F(STOP_SINGULIER='NON')
)

RSTAT1=CALC_ELEM(
    reuse      = RSTAT1,
    RESULTAT   = RSTAT1,

    TOUT_ORDRE='OUI',
    OPTION=('SIEF_ELNO'),
)

RSTAT1=CALC_CHAMP(
    reuse      = RSTAT1,
    RESULTAT   = RSTAT1,

    TOUT_ORDRE='OUI',
    FORCE='REAC_NODA'
)

TEST_RESU(RESU=(
  _F(  RESULTAT = RSTAT1 , NUME_ORDRE= 1   , NOM_CHAM = 'DEPL',
       GROUP_NO = 'PTR1' , NOM_CMP   = 'DX', REFERENCE= 'ANALYTIQUE',
       VALE =  -0.2091751, PRECISION = 6.E-3,CRITERE  = 'ABSOLU' ),
  _F(  RESULTAT = RSTAT1 , NUME_ORDRE= 1   , NOM_CHAM = 'DEPL',
       GROUP_NO = 'PTR1' , NOM_CMP   = 'DY', REFERENCE= 'ANALYTIQUE',
       VALE =   0.3276321, PRECISION = 6.E-3,CRITERE  = 'ABSOLU' ),
  _F(  RESULTAT = RSTAT1 , NUME_ORDRE= 1   , NOM_CHAM = 'DEPL',
       GROUP_NO = 'PTR2' , NOM_CMP   = 'DX', REFERENCE= 'ANALYTIQUE',
       VALE =  -0.1418189, PRECISION = 6.E-3,CRITERE  = 'ABSOLU' ),
  _F(  RESULTAT = RSTAT1 , NUME_ORDRE= 1   , NOM_CHAM = 'DEPL',
       GROUP_NO = 'PTR2' , NOM_CMP   = 'DY', REFERENCE= 'ANALYTIQUE',
       VALE =   0.1964749, PRECISION = 6.E-3,CRITERE  = 'ABSOLU' ),

  _F(  RESULTAT = RSTAT1 , NUME_ORDRE= 2   , NOM_CHAM = 'DEPL',
       GROUP_NO = 'PTR1' , NOM_CMP   = 'DX', REFERENCE= 'ANALYTIQUE',
       VALE =  -0.2885084, PRECISION = 7.E-3,CRITERE  = 'ABSOLU' ),
  _F(  RESULTAT = RSTAT1 , NUME_ORDRE= 2   , NOM_CHAM = 'DEPL',
       GROUP_NO = 'PTR1' , NOM_CMP   = 'DY', REFERENCE= 'ANALYTIQUE',
       VALE =   0.5049896, PRECISION = 7.E-3,CRITERE  = 'ABSOLU' ),
  _F(  RESULTAT = RSTAT1 , NUME_ORDRE= 2   , NOM_CHAM = 'DEPL',
       GROUP_NO = 'PTR2' , NOM_CMP   = 'DX', REFERENCE= 'ANALYTIQUE',
       VALE =  -0.1941954, PRECISION = 7.E-3,CRITERE  = 'ABSOLU' ),
  _F(  RESULTAT = RSTAT1 , NUME_ORDRE= 2   , NOM_CHAM = 'DEPL',
       GROUP_NO = 'PTR2' , NOM_CMP   = 'DY', REFERENCE= 'ANALYTIQUE',
       VALE =   0.3104827, PRECISION = 7.E-3,CRITERE  = 'ABSOLU' ),

  _F(  RESULTAT = RSTAT1 , NUME_ORDRE= 4   , NOM_CHAM = 'DEPL',
       GROUP_NO = 'PTR1' , NOM_CMP   = 'DX', REFERENCE= 'ANALYTIQUE',
       VALE =  -0.3501853, PRECISION = 8.E-3,CRITERE  = 'ABSOLU' ),
  _F(  RESULTAT = RSTAT1 , NUME_ORDRE= 4    ,NOM_CHAM = 'DEPL',
       GROUP_NO = 'PTR1' , NOM_CMP   = 'DY', REFERENCE= 'ANALYTIQUE',
       VALE =   0.6890068, PRECISION = 8.E-3,CRITERE  = 'ABSOLU' ),
  _F(  RESULTAT = RSTAT1 , NUME_ORDRE= 4   , NOM_CHAM = 'DEPL',
       GROUP_NO = 'PTR2' , NOM_CMP   = 'DX', REFERENCE= 'ANALYTIQUE',
       VALE =  -0.2327078, PRECISION = 8.E-3,CRITERE  = 'ABSOLU' ),
  _F(  RESULTAT = RSTAT1 , NUME_ORDRE= 4   , NOM_CHAM = 'DEPL',
       GROUP_NO = 'PTR2' , NOM_CMP   = 'DY', REFERENCE= 'ANALYTIQUE',
       VALE =   0.4324473, PRECISION = 8.E-3,CRITERE  = 'ABSOLU' ),

) )

FIN()
