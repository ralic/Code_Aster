# MODIF  DATE 31/05/2011   AUTEUR NISTOR I.NISTOR 
# TITRE TEST EFFET LAME FLUIDE ENTRE DEUX STRUCTURES MOBILES
# sdnd112a.para = tps_job 60 mem_job 128Mo ncpus 1 liste_test S
#            CONFIGURATION MANAGEMENT OF EDF VERSION
# ======================================================================
# COPYRIGHT (C) 1991 - 2011  EDF R&D                  WWW.CODE-ASTER.ORG
# THIS PROGRAM IS FREE SOFTWARE; YOU CAN REDISTRIBUTE IT AND/OR MODIFY
# IT UNDER THE TERMS OF THE GNU GENERAL PUBLIC LICENSE AS PUBLISHED BY
# THE FREE SOFTWARE FOUNDATION; EITHER VERSION 2 OF THE LICENSE, OR   
# (AT YOUR OPTION) ANY LATER VERSION.                                 
#
# THIS PROGRAM IS DISTRIBUTED IN THE HOPE THAT IT WILL BE USEFUL, BUT 
# WITHOUT ANY WARRANTY; WITHOUT EVEN THE IMPLIED WARRANTY OF          
# MERCHANTABILITY OR FITNESS FOR A PARTICULAR PURPOSE. SEE THE GNU    
# GENERAL PUBLIC LICENSE FOR MORE DETAILS.                            
#
# YOU SHOULD HAVE RECEIVED A COPY OF THE GNU GENERAL PUBLIC LICENSE   
# ALONG WITH THIS PROGRAM; IF NOT, WRITE TO EDF R&D CODE_ASTER,       
#    1 AVENUE DU GENERAL DE GAULLE, 92141 CLAMART CEDEX, FRANCE.      
# ======================================================================
# -----------------------------------------------------------------
# SYSTEME MASSE-RESSORT A DEUX NOEUDS
# LE PREMIER NOEUD ECARTE DE SA POSITION INITIALE VIENT TAPER
# SUR LE DEUXIEME NOEUD IMMOBILE INITIALEMENT
# -----------------------------------------------------------------
# REF: PAS DE REF BIBLIO, COMPARAISON CALCUL MATLAB
# -----------------------------------------------------------------

DEBUT(CODE=_F( NOM = 'SDND112A',NIV_PUB_WEB='INTERNET'))

MAILLA2=LIRE_MAILLAGE()

BICHOC=AFFE_MODELE(  MAILLAGE=MAILLA2,AFFE=(
              _F(  PHENOMENE = 'MECANIQUE', MODELISATION = 'DIS_T',
                     GROUP_MA = 'RESSORTS'),
                   _F(  PHENOMENE = 'MECANIQUE', MODELISATION = 'DIS_T',
                     GROUP_NO = ( 'MASSES1', 'MASSES2',)))
                    )

#
CARA_BIC=AFFE_CARA_ELEM(  MODELE=BICHOC,DISCRET=(
           _F(  CARA = 'K_T_D_L',  REPERE = 'GLOBAL', GROUP_MA = 'RESSORTS',
                     VALE = (98696., 0., 0., )),
           _F(  CARA = 'M_T_L',  REPERE = 'GLOBAL', GROUP_MA = 'RESSORTS',
                     VALE = (0.,0.,0.,0.,0.,0.,0.,0.,0.,0.,
                        0.,0.,0.,0.,0.,0.,0.,0.,0.,0.,0)),
                   _F(  CARA = 'M_T_D_N',  GROUP_NO = 'MASSES1', VALE = 25.),
                   _F(  CARA = 'M_T_D_N',  GROUP_NO = 'MASSES2', VALE = 25.))
                         )

#
CL_BICHO=AFFE_CHAR_MECA(  MODELE=BICHOC,DDL_IMPO=(
              _F(  GROUP_NO = 'ENCBICHO',    DX = 0.,  DY = 0.,  DZ = 0.),
              _F(  GROUP_NO = ( 'MASSES1', 'MASSES2',), DY = 0.,  DZ = 0.))
                       )

#
MACRO_MATR_ASSE(  MODELE=BICHOC,   CHARGE=CL_BICHO,   CARA_ELEM=CARA_BIC,
                   NUME_DDL=CO("NUMDDLC"),MATR_ASSE=(
                 _F(  MATRICE = CO("RIGI_BIC"),  OPTION = 'RIGI_MECA'),
                           _F(  MATRICE = CO("MASS_BIC"), OPTION = 'MASS_MECA'))
               )

FORCE=AFFE_CHAR_MECA(  MODELE=BICHOC,
                     FORCE_NODALE=_F( GROUP_NO = 'MASSES2',  FX = 1.)
                       )

#
VECTEL1=CALC_VECT_ELEM(   CHARGE=FORCE,   OPTION='CHAR_MECA')

#
VECTASS=ASSE_VECTEUR(   VECT_ELEM=VECTEL1,  NUME_DDL=NUMDDLC)

#
# CALCUL DES MODES AVEC BLOCAGE DES ANCRAGES:
#---------------------------------------------
MODE_BIC=MODE_ITER_SIMULT(  MATR_A=RIGI_BIC,   MATR_B=MASS_BIC,
                  METHODE='JACOBI',
                   OPTION='SANS',
                 CALC_FREQ=_F(  OPTION = 'BANDE',  FREQ = (1., 10., ))
                            )

#
DEPLPHY1=CREA_CHAMP( OPERATION='AFFE', TYPE_CHAM='NOEU_DEPL_R',
                            MAILLAGE=MAILLA2,AFFE=(
                 _F( GROUP_NO = 'MASSES1',
                    NOM_CMP = ('DX','DY','DZ',), VALE = (0.E0, 0., 0.,)),
                 _F( GROUP_NO = 'MASSES2',
                    NOM_CMP = ('DX','DY','DZ',), VALE = (0.001,  0., 0., ))),
          CHAM_NO=VECTASS
                          )

#
MACRO_PROJ_BASE(  BASE=MODE_BIC,MATR_ASSE_GENE=(
                   _F( 
                                   MATRICE = CO("MASSEGEN"),
                                   MATR_ASSE = MASS_BIC),
                   _F( 
                                   MATRICE = CO("RIGIDGEN"),
                                   MATR_ASSE = RIGI_BIC)),
                   VECT_ASSE_GENE=_F( 
                                   VECTEUR = CO("DEPLINI1"),
                                   VECT_ASSE = DEPLPHY1,
                                   TYPE_VECT = 'DEPL')
)

#
# DESCRIPTION DES PAS DE CALCUL
#------------------------------

L_INST=DEFI_LIST_REEL(  DEBUT=0.,
                            INTERVALLE=_F(  JUSQU_A = 1., PAS = 0.0001) )

#
# DEFINITION DE L'OBSTACLE ENTRE DEUX POINTS
# LIMITE LES DEPLACEMENTS EN X ABSOLU (Z LOCAL)
#-----------------------------------------------
GRILLE=DEFI_OBSTACLE(   TYPE='BI_PLAN_Z' )

#
TRAN_GE1=DYNA_TRAN_MODAL(  MATR_MASS=MASSEGEN,   MATR_RIGI=RIGIDGEN,
                       SCHEMA_TEMPS=_F(SCHEMA='ADAPT_ORDRE2',),
                       AMOR_MODAL=_F(AMOR_REDUIT=( 0.0, 0.0,),),
                       ETAT_INIT=_F( DEPL= DEPLINI1),
                       NMAX_ITER=100,
                       LAMBDA=10.,
                       RESI_RELA=1.E-5,
# CONDITION DE CHOC ENTRE LE NOEUD 2 ET LE NOEUD 12
# TEST SUR LA DIFFERENCE DES DEPLACEMENTS ABSOLUS
                CHOC=_F(  GROUP_NO_1 = 'MASSES1',
                       GROUP_NO_2 = 'MASSES2',
                       OBSTACLE = GRILLE,
                       INTITULE = 'NO2/NO12',
                       NORM_OBST = (0., 0., 1.,),
                       DIST_1 = 0.4495,
                       DIST_2 = 0.4495,
#                      RIGI_NOR: 2.88E7
# NE REGARDE QUE L'EFFET DE LA LAME FLUIDE
                       RIGI_NOR = 2.88E10,
                       AMOR_NOR = 0.,
                       RIGI_TAN = 0.,
                       FROTTEMENT='COULOMB',
                       COULOMB = 0.,
                       LAME_FLUIDE = 'OUI',
                       ALPHA = -0.08325,
                       BETA = 0.07493,
                       CHI = -0.9996E-6,
                       DELTA = -0.1665),
                 INCREMENT=_F( INST_INIT = 0.,  INST_FIN = 1.,
                            PAS = 0.00001),
                ARCHIVAGE=_F(  PAS_ARCH = 100)
                )

#
# RESTITUTION DES DEPLACEMENTS SUR LA BASE PHYSIQUE
# -------------------------------------------------
DYNATRA1=REST_GENE_PHYS(   RESU_GENE=TRAN_GE1,
                              NOM_CHAM='DEPL',
                              INTERPOL='LIN',
                         MODE_MECA=MODE_BIC,
                          LIST_INST=L_INST
                         )

TEST_RESU(RESU=( _F(  RESULTAT = DYNATRA1,  INST = 0.05,
                  NOM_CHAM = 'DEPL',    NOEUD = 'NO2',    NOM_CMP = 'DX',
                  CRITERE = ('RELATIF', 'ABSOLU',),
                  PRECISION = (0.001, 0.000005,), VALE = -0.675E-3),

                _F(  RESULTAT = DYNATRA1,  INST = 0.1,
                  NOM_CHAM = 'DEPL',    NOEUD = 'NO2',    NOM_CMP = 'DX',
                  CRITERE = ('RELATIF', 'ABSOLU',),
                  PRECISION = (0.006, 0.000005,), VALE = 0.544E-3),

                _F(  RESULTAT = DYNATRA1,  INST = 0.45,
                  NOM_CHAM = 'DEPL',    NOEUD = 'NO2',    NOM_CMP = 'DX',
                  CRITERE = ('RELATIF', 'ABSOLU',),
                  PRECISION = (0.04, 0.00002,), VALE = -0.473E-3),

                _F(  RESULTAT = DYNATRA1,  INST = 0.95,
                  NOM_CHAM = 'DEPL',    NOEUD = 'NO2',    NOM_CMP = 'DX',
                  CRITERE = ('RELATIF', 'ABSOLU',),
                  PRECISION = (0.07, 0.00004,), VALE = -0.468E-3),

                _F(  RESULTAT = DYNATRA1,  INST = 0.05,
                  NOM_CHAM = 'DEPL',    NOEUD = 'NO12',   NOM_CMP = 'DX',
                  CRITERE = ('RELATIF', 'ABSOLU',),
                  PRECISION = (0.008, 0.000005,), VALE = -0.322E-3),

                _F(  RESULTAT = DYNATRA1,  INST = 0.1,
                  NOM_CHAM = 'DEPL',    NOEUD = 'NO12',   NOM_CMP = 'DX',
                  CRITERE = ('RELATIF', 'ABSOLU',),
                  PRECISION = (0.007, 0.000005,), VALE = 0.450E-3),

                _F(  RESULTAT = DYNATRA1,  INST = 0.45,
                  NOM_CHAM = 'DEPL',    NOEUD = 'NO12',   NOM_CMP = 'DX',
                  CRITERE = ('RELATIF', 'ABSOLU',),
                  PRECISION = (0.04, 0.00003,), VALE = -0.497E-3),

                _F(  RESULTAT = DYNATRA1,  INST = 0.95,
                  NOM_CHAM = 'DEPL',    NOEUD = 'NO12',   NOM_CMP = 'DX',
                  CRITERE = ('RELATIF', 'ABSOLU',),
                  PRECISION = (0.07, 0.00004,), VALE = -0.468E-3))
          )

#
TRAN_GE2=DYNA_TRAN_MODAL(  MATR_MASS=MASSEGEN,   MATR_RIGI=RIGIDGEN,
                       SCHEMA_TEMPS=_F(SCHEMA='EULER',),
                       AMOR_MODAL=_F(AMOR_REDUIT=( 0.0, 0.0,),),
                       ETAT_INIT=_F( DEPL = DEPLINI1),
                       NMAX_ITER=100,
                       LAMBDA=10.,
                       RESI_RELA=1.E-5,
# CONDITION DE CHOC ENTRE LE NOEUD 2 ET LE NOEUD 12
# TEST SUR LA DIFFERENCE DES DEPLACEMENTS ABSOLUS
                CHOC=_F(  GROUP_NO_1 = 'MASSES1',
                       GROUP_NO_2 = 'MASSES2',
                       OBSTACLE = GRILLE,
                       INTITULE = 'NO2/NO12',
                       NORM_OBST = (0., 0., 1.,),
                       DIST_1 = 0.4495,
                       DIST_2 = 0.4495,
#                      RIGI_NOR: 2.88E7
# NE REGARDE QUE L'EFFET DE LA LAME FLUIDE
                       RIGI_NOR = 2.88E10,
                       AMOR_NOR = 0.,
                       RIGI_TAN = 0.,
                       FROTTEMENT='COULOMB',
                       COULOMB = 0.,
                       LAME_FLUIDE = 'OUI',
                       ALPHA = -0.08325,
                       BETA = 0.07493,
                       CHI = -0.9996E-6,
                       DELTA = -0.1665),
                 INCREMENT=_F( INST_INIT = 0.,  INST_FIN = 1.,
                            VERI_PAS = 'NON',
                            PAS = 0.00001),
                ARCHIVAGE=_F(  PAS_ARCH = 100)
                )

#
# RESTITUTION DES DEPLACEMENTS SUR LA BASE PHYSIQUE
# -------------------------------------------------
DYNATRA2=REST_GENE_PHYS(   RESU_GENE=TRAN_GE2,
                              NOM_CHAM='DEPL',
                              INTERPOL='LIN',
                         MODE_MECA=MODE_BIC,
                          LIST_INST=L_INST
                         )

TEST_RESU(RESU=( _F(  RESULTAT = DYNATRA2,  INST = 0.05,
                  NOM_CHAM = 'DEPL',    NOEUD = 'NO2',    NOM_CMP = 'DX',
                  CRITERE = ('RELATIF', 'ABSOLU',),
                  PRECISION = (0.002, 0.000005,), VALE = -0.675E-3),

                _F(  RESULTAT = DYNATRA2,  INST = 0.1,
                  NOM_CHAM = 'DEPL',    NOEUD = 'NO2',    NOM_CMP = 'DX',
                  CRITERE = ('RELATIF', 'ABSOLU',),
                  PRECISION = (0.006, 0.000005,), VALE = 0.544E-3),

                _F(  RESULTAT = DYNATRA2,  INST = 0.45,
                  NOM_CHAM = 'DEPL',    NOEUD = 'NO2',    NOM_CMP = 'DX',
                  CRITERE = ('RELATIF', 'ABSOLU',),
                  PRECISION = (0.04, 0.00001,), VALE = -0.473E-3),

                _F(  RESULTAT = DYNATRA2,  INST = 0.95,
                  NOM_CHAM = 'DEPL',    NOEUD = 'NO2',    NOM_CMP = 'DX',
                  CRITERE = ('RELATIF', 'ABSOLU',),
                  PRECISION = (0.07, 0.00004,), VALE = -0.468E-3),

                _F(  RESULTAT = DYNATRA2,  INST = 0.05,
                  NOM_CHAM = 'DEPL',    NOEUD = 'NO12',   NOM_CMP = 'DX',
                  CRITERE = ('RELATIF', 'ABSOLU',),
                  PRECISION = (0.008, 0.000005,), VALE = -0.322E-3),

                _F(  RESULTAT = DYNATRA2,  INST = 0.1,
                  NOM_CHAM = 'DEPL',    NOEUD = 'NO12',   NOM_CMP = 'DX',
                  CRITERE = ('RELATIF', 'ABSOLU',),
                  PRECISION = (0.007, 0.000005,), VALE = 0.450E-3),

                _F(  RESULTAT = DYNATRA2,  INST = 0.45,
                  NOM_CHAM = 'DEPL',    NOEUD = 'NO12',   NOM_CMP = 'DX',
                  CRITERE = ('RELATIF', 'ABSOLU',),
                  PRECISION = (0.04, 0.00003,), VALE = -0.497E-3),

                _F(  RESULTAT = DYNATRA2,  INST = 0.95,
                  NOM_CHAM = 'DEPL',    NOEUD = 'NO12',   NOM_CMP = 'DX',
                  CRITERE = ('RELATIF', 'ABSOLU',),
                  PRECISION = (0.07, 0.00004,), VALE = -0.468E-3))
)

FIN()
#
