# MODIF  DATE 04/05/2004   AUTEUR SMICHEL S.MICHEL-PONNELLE 
# TITRE COUPLAGE FLUAGE/BETON_DOUBLE_DP - TRACTION UNIAXIALE EN D_PLAN
#            CONFIGURATION MANAGEMENT OF EDF VERSION
# ======================================================================
# COPYRIGHT (C) 1991 - 2001  EDF R&D                  WWW.CODE-ASTER.ORG
# THIS PROGRAM IS FREE SOFTWARE; YOU CAN REDISTRIBUTE IT AND/OR MODIFY
# IT UNDER THE TERMS OF THE GNU GENERAL PUBLIC LICENSE AS PUBLISHED BY
# THE FREE SOFTWARE FOUNDATION; EITHER VERSION 2 OF THE LICENSE, OR   
# (AT YOUR OPTION) ANY LATER VERSION.                                 
#
# THIS PROGRAM IS DISTRIBUTED IN THE HOPE THAT IT WILL BE USEFUL, BUT 
# WITHOUT ANY WARRANTY; WITHOUT EVEN THE IMPLIED WARRANTY OF          
# MERCHANTABILITY OR FITNESS FOR A PARTICULAR PURPOSE. SEE THE GNU    
# GENERAL PUBLIC LICENSE FOR MORE DETAILS.                            
#
# YOU SHOULD HAVE RECEIVED A COPY OF THE GNU GENERAL PUBLIC LICENSE   
# ALONG WITH THIS PROGRAM; IF NOT, WRITE TO EDF R&D CODE_ASTER,       
#    1 AVENUE DU GENERAL DE GAULLE, 92141 CLAMART CEDEX, FRANCE.      
# ======================================================================
#-----------------------------------------------------------------------
#   TEST DU MODELE DE COUPLAGE D'UNE LOI DE FLUAGE DE GRANGER
#   (GRANGER_FP) ET D'UNE LOI DE PLASTICITE/FISSURATION BETON_DOUBLE_DP
#   (DOUBLE CRITERE DE DRUCKER PRAGER), EN DEPLACEMENT IMPOSE, EN 
#   MODELISATION D_PLAN, EN TRACTION UNIAXIALE (XX).
#   LES PARAMETRES DE LA LOI DE PLASTICITE/FISSURATION SONT CHOISIS
#   AFIN D'OBTENIR UN COMPORTMENT ELASTO PLASTIQUE QUASI PARFAIT
#   (ECROUISSAGE QUASI NUL) POUR SIMPLIFIER LA SOLUTION ANALYTIQUE DE
#   REFERENCE. 
#   ON TESTE AUSSI LE COUPLAGE GRANGER_FP/VMIS_ISOT_LINE ET 
#   GRANGER_FP/CHABOCHE, AVEC RETRAIT DE DESSICCATION ET RETRAIT
#   THERMIQUE
#
#-----------------------------------------------------------------------
#   LE MAILLAGE COMPREND :
#                1 ELEMENT  2D QUADRILATERE  A 4 NOEUDS
#                2 ELEMENTS 2D TRIANGULAIRES A 3 NOEUDS
#                1 ELEMENT  2D QUADRILATERE  A 4 NOEUDS
#                2 ELEMENTS 2D TRIANGULAIRES A 3 NOEUDS
#   LES ELEMENTS LINEAIRES ET QUADRATIQUES SONT LIEES PAR DES RELATIONS
#   LINEAIRES.
#-----------------------------------------------------------------------

DEBUT(     CODE=_F( NOM = 'SSNP116B',NIV_PUB_WEB='INTERNET') )

PRE_GIBI()

MAIL=LIRE_MAILLAGE(VERI_MAIL=_F(VERIF='OUI'), )

MAIL=DEFI_GROUP( reuse=MAIL,        MAILLAGE=MAIL,CREA_GROUP_NO=(
                       _F( GROUP_MA = 'LA'),
                       _F( GROUP_MA = 'LF'),
                       _F( GROUP_MA = 'LAY'),
                       _F( GROUP_MA = 'LDY'))
                   )

MO=AFFE_MODELE(    MAILLAGE=MAIL,
                            AFFE=_F( TOUT = 'OUI',
                                  PHENOMENE = 'MECANIQUE',
                                  MODELISATION = 'D_PLAN')
                    )

DESORP=DEFI_FONCTION(      NOM_PARA='SECH',
                           PROL_DROITE='LINEAIRE',
                          PROL_GAUCHE='LINEAIRE',
                                 VALE=(0.,  1.,  1.,  1.,)
                       )

E=DEFI_FONCTION(   NOM_PARA='TEMP',  PROL_DROITE='LINEAIRE',
                                         PROL_GAUCHE='LINEAIRE',
                        VALE=(   0.E0,      25000.,
                                20.E0,      31000.,
                               800.E0,       8000., )
                      )

NU=DEFI_FONCTION(   NOM_PARA='TEMP',  PROL_DROITE='LINEAIRE',
                                         PROL_GAUCHE='LINEAIRE',
                        VALE=(   0.E0,      0.2,
                                20.E0,      0.2,
                               800.E0,      0.1, )
                      )

ALPHA=DEFI_FONCTION(   NOM_PARA='TEMP',  PROL_DROITE='LINEAIRE',
                                         PROL_GAUCHE='LINEAIRE',
                        VALE=(   0.E0,      1.E-5,
                               800.E0,      1.E-5, )
                     )

FC=DEFI_FONCTION(   NOM_PARA='TEMP',  PROL_DROITE='LINEAIRE',
                                         PROL_GAUCHE='LINEAIRE',
                        VALE=(   0.E0,      40.,
                               400.E0,      40.,
                               800.E0,      15., )
                      )

FT=DEFI_FONCTION(   NOM_PARA='TEMP',  PROL_DROITE='LINEAIRE',
                                         PROL_GAUCHE='LINEAIRE',
                        VALE=(   0.E0,      4.,
                               400.E0,      4.,
                               800.E0,      1.5, )
                      )

BETA=DEFI_FONCTION(   NOM_PARA='TEMP',  PROL_DROITE='LINEAIRE',
                                         PROL_GAUCHE='LINEAIRE',
                        VALE=(   0.E0,      1.16,
                               800.E0,      1.16, )
                      )

GC=DEFI_FONCTION(   NOM_PARA='TEMP',  PROL_DROITE='LINEAIRE',
                                        PROL_GAUCHE='LINEAIRE',
                        VALE=(   0.E0,      10.,
                               800.E0,      10., )
                      )

GT=DEFI_FONCTION(   NOM_PARA='TEMP',  PROL_DROITE='LINEAIRE',
                                         PROL_GAUCHE='LINEAIRE',
                        VALE=(   0.E0,      10000.,
                               800.E0,      10000., )
                      )

# VALEUR NON PHYSIQUE DE GT POUR MODELISER UN ECROUISSAGE QUASI NUL
# VALEUR USUELLE : GT = 0.1

ECRO=DEFI_FONCTION(   NOM_PARA='TEMP',  PROL_DROITE='LINEAIRE',
                                         PROL_GAUCHE='LINEAIRE',
                        VALE=(   0.E0,      0.01,
                               400.E0,      0.01,
                               800.E0,      0.01, )
                      )

BETON=DEFI_MATERIAU(            ELAS_FO=_F( E = E,
                                            NU = NU,    
                                            K_DESSIC = 2.E-4,
                                            B_ENDOGE = 0.0,
                                            ALPHA = ALPHA,
                                            TEMP_DEF_ALPHA  = 0.0,
                                            FONC_DESORP = DESORP, ),
                                GRANGER_FP=_F( J1 = 0.2,
                                            TAUX_1 = 4320000.,
                                            QSR_K = 0.0),
                           BETON_DOUBLE_DP=_F( F_C = FC,
                                            F_T = FT,
                                            COEF_BIAX = BETA,
                                            ENER_COMP_RUPT = GC,
                                            ENER_TRAC_RUPT = GT,
                                            COEF_ELAS_COMP = 33.3333333,
                                            ECRO_COMP_P_PIC = 'LINEAIRE',
                                            ECRO_TRAC_P_PIC = 'LINEAIRE'),
                              ECRO_LINE_FO=_F( D_SIGM_EPSI = ECRO,
                                            SY = FT,),
                                  CHABOCHE=_F( R_I = 4.1,
                                            R_0 = 4.0,
                                            B = 0.0001,
                                            K = 1.,
                                            W = 0.,
                                            A1 = 0.,
                                            A2 = 0.,
                                            C1 = 0.,
                                            C2 = 0.)
                         )

SECH1=CREA_CHAMP(   OPERATION='AFFE',
                       TYPE_CHAM='NOEU_TEMP_R',
                        MAILLAGE=MAIL,
                            AFFE=_F(  TOUT = 'OUI', 
                                   NOM_CMP = 'TEMP',
                                   VALE = 0.)     )

SECH2=CREA_CHAMP(   OPERATION='AFFE',
                       TYPE_CHAM='NOEU_TEMP_R',
                        MAILLAGE=MAIL,
                            AFFE=_F(  TOUT = 'OUI', 
                                   NOM_CMP = 'TEMP',
                                   VALE = 1.)     )

TEMP1=CREA_CHAMP(   OPERATION='AFFE',
                       TYPE_CHAM='NOEU_TEMP_R',
                        MAILLAGE=MAIL,
                            AFFE=_F(  TOUT = 'OUI', 
                                   NOM_CMP = 'TEMP',
                                   VALE = 0.)     )

TEMP2=CREA_CHAMP(   OPERATION='AFFE',
                       TYPE_CHAM='NOEU_TEMP_R',
                        MAILLAGE=MAIL,
                            AFFE=_F(  TOUT = 'OUI', 
                                   NOM_CMP = 'TEMP',
                                   VALE = 20.)     )

CM=AFFE_MATERIAU(    MAILLAGE=MAIL,
                            AFFE=_F( TOUT = 'OUI',
                                  MATER = BETON,
                                  TEMP_REF = 20.,
                                  SECH_REF = 0.)
                    )

TEMP=CREA_RESU(  OPERATION='AFFE', TYPE_RESU='EVOL_THER',
                      NOM_CHAM='TEMP',AFFE=(
                       _F(  INST = 0.,         CHAM_GD = TEMP2),
                               _F(  INST = 100.,       CHAM_GD = TEMP2))
                    )

SECH=CREA_RESU(  OPERATION='AFFE', TYPE_RESU='EVOL_THER',
                      NOM_CHAM='TEMP',AFFE=(
                       _F(  INST = 0.,         CHAM_GD = SECH1),
                               _F(  INST = 100.,       CHAM_GD = SECH1))
                    )

COND_LIM=AFFE_CHAR_MECA(    
                      MODELE=MO,
               TEMP_CALCULEE=TEMP,
               SECH_CALCULEE=SECH,DDL_IMPO=(
                  _F(  GROUP_NO = 'LA',       DX = 0.),
                  _F(  GROUP_NO = ('A1', 'B1',),  DY = 0.),
                  _F(  GROUP_NO = ('F1', 'E1',),  DY = 0.)),LIAISON_DDL=(
               _F(  GROUP_NO = ( 'C1',  'D1', ),
                             DDL = ( 'DX', 'DX', ),
                             COEF_MULT = (  1., -1., ),
                             COEF_IMPO = 0.),
               _F(  GROUP_NO = ( 'C2',  'D2', ),
                             DDL = ( 'DX', 'DX', ),
                             COEF_MULT = (  1., -1., ),
                             COEF_IMPO = 0.)),
              LIAISON_UNIF=_F(  GROUP_MA = 'LD',
                             DDL = 'DX')
                   )

TRAC=AFFE_CHAR_MECA(    
                      MODELE=MO,
                    DDL_IMPO=_F(  GROUP_NO = 'LF',  DX = 0.006)
                            )

LINST=DEFI_LIST_REEL(              DEBUT=0.,INTERVALLE=(
                              
                           _F(  JUSQU_A = 10.,        NOMBRE = 4),
                           _F(  JUSQU_A = 13.0242,    NOMBRE = 3),
                           _F(  JUSQU_A = 100.,       NOMBRE = 1))
                         )

COEF_TR=DEFI_FONCTION(  
                              NOM_PARA='INST', 
                                  VALE=(        0.,     0.,
                                              100.,     1.,
                                              200.,     1.,  )
                        )

################################################
###    COUPLAGE GRANGER_FP BETON_DOUBLE_DP   ###
################################################

COUPLA=STAT_NON_LINE( 
                   TITRE='COUPLAGE FLUAGE/FISSURATION',
                  MODELE=MO,EXCIT=(
                   _F(  CHARGE = COND_LIM),
                   _F(  CHARGE = TRAC,
                           FONC_MULT = COEF_TR)),
               INCREMENT=_F(  LIST_INST = LINST),
              CHAM_MATER=CM,
               COMP_INCR=_F(  RELATION = 'KIT_DDI',
                           RELATION_KIT = ('GRANGER_FP', 
                                            'BETON_DOUBLE_DP',),
                           DEFORMATION = 'PETIT',
                           TOUT = 'OUI'),
                  NEWTON=_F(  MATRICE = 'TANGENTE',
                           REAC_INCR = 1,
                           REAC_ITER = 5),
             CONVERGENCE=_F(  ITER_GLOB_MAXI = 100,
                           ITER_INTE_MAXI = 20,
                           ITER_INTE_PAS = 0,
                           RESI_GLOB_RELA = 1.E-6,
                           RESI_INTE_RELA = 1.E-6)
                            )

COUPLA=CALC_ELEM(    reuse=COUPLA,          MODELE=MO,
                               CHAM_MATER=CM,EXCIT=(
                                   _F(  CHARGE = COND_LIM),
                                   _F(  CHARGE = TRAC)),
                                  OPTION=( 'EPSI_ELNO_DEPL',
                                           'SIEF_ELNO_ELGA',
                                           'EPGR_ELNO',
                                           'EPSP_ELNO', ),
                                 RESULTAT=COUPLA )

RELEVE_1=POST_RELEVE_T(ACTION=( 
                   _F(  RESULTAT = COUPLA,
                            INTITULE = 'DEPL',
                            NOM_CHAM = 'DEPL',
                            NOM_CMP = 'DX',
                            LIST_INST = LINST,
                            PRECISION = 1.E-8,
                            GROUP_NO = 'C1',
                            OPERATION = 'EXTRACTION'), 
                   _F(  RESULTAT = COUPLA,
                            INTITULE = 'SIEF',
                            NOM_CHAM = 'SIEF_ELNO_ELGA',
                            NOM_CMP = 'SIXX',
                            LIST_INST = LINST,
                            PRECISION = 1.E-8,
                            GROUP_NO = 'C1',
                            OPERATION = 'EXTRACTION'), 
                   _F(  RESULTAT = COUPLA,
                            INTITULE = 'EPSP',
                            NOM_CHAM = 'EPSP_ELNO',
                            TOUT_CMP = 'OUI',
                            LIST_INST = LINST,
                            PRECISION = 1.E-8,
                            GROUP_NO = 'C1',
                            OPERATION = 'EXTRACTION'), 
                   _F(  RESULTAT = COUPLA,
                            INTITULE = 'EPSF',
                            NOM_CHAM = 'EPGR_ELNO',
                            TOUT_CMP = 'OUI',
                            LIST_INST = LINST,
                            PRECISION = 1.E-8,
                            GROUP_NO = 'C1',
                            OPERATION = 'EXTRACTION'), 
                   _F(  RESULTAT = COUPLA,
                            INTITULE = 'EPSI',
                            NOM_CHAM = 'EPSI_ELNO_DEPL',
                            TOUT_CMP = 'OUI',
                            LIST_INST = LINST,
                            PRECISION = 1.E-8,
                            GROUP_NO = 'C1',
                            OPERATION = 'EXTRACTION')) 
                       )

IMPR_TABLE(  TABLE=RELEVE_1,
              NOM_PARA='DX', 
              FILTRE=_F(  NOM_PARA = 'INTITULE', VALE_K = 'DEPL')
           )

IMPR_TABLE(  TABLE=RELEVE_1,
              NOM_PARA='SIXX', 
              FILTRE=_F(  NOM_PARA = 'INTITULE', VALE_K = 'SIEF')
           )

IMPR_TABLE(  TABLE=RELEVE_1,
              NOM_PARA='EPXX', 
              FILTRE=_F(  NOM_PARA = 'INTITULE', VALE_K = 'EPSI')
           )

IMPR_TABLE(  TABLE=RELEVE_1,
              NOM_PARA='EPXX', 
              FILTRE=_F(  NOM_PARA = 'INTITULE', VALE_K = 'EPSP')
           )

IMPR_TABLE(  TABLE=RELEVE_1,
              NOM_PARA='EPXX', 
              FILTRE=_F(  NOM_PARA = 'INTITULE', VALE_K = 'EPSF')
           )

TEST_TABLE(  TABLE=RELEVE_1,
                NOM_PARA='SIXX',FILTRE=( 
                  _F(  NOM_PARA = 'INTITULE', VALE_K = 'SIEF'),
                  _F(  NOM_PARA = 'INST',     VALE = 10.)),
                    VALE=3.2061065182852E+00,
               PRECISION=1.E-4,
               REFERENCE='NON_REGRESSION',       VERSION='5.4.12'
           )

TEST_TABLE(  TABLE=RELEVE_1,
              NOM_PARA='EPXX',FILTRE=( 
              _F(  NOM_PARA = 'INTITULE', VALE_K = 'EPSF'),
                  _F(  NOM_PARA = 'INST',     VALE = 10.)),
                    VALE=7.1412072417121E-07,
               PRECISION=2.E-4,
               REFERENCE='NON_REGRESSION',       VERSION='5.4.12'
           )

TEST_TABLE(  TABLE=RELEVE_1,
                NOM_PARA='SIXX',FILTRE=( 
                  _F(  NOM_PARA = 'INTITULE', VALE_K = 'SIEF'),
                  _F(  NOM_PARA = 'INST',     VALE = 100.)),
                    VALE=4.3891268871563E+00,
               PRECISION=1.E-4,
               REFERENCE='NON_REGRESSION',       VERSION='5.4.12'
           )

TEST_TABLE(  TABLE=RELEVE_1,
              NOM_PARA='EPXX',FILTRE=( 
              _F(  NOM_PARA = 'INTITULE', VALE_K = 'EPSF'),
                  _F(  NOM_PARA = 'INST',     VALE = 100.)),
                    VALE=1.8331813010442E-05,
               PRECISION=1.E-4,
               REFERENCE='NON_REGRESSION',       VERSION='5.4.12'
           )

TEST_TABLE(  TABLE=RELEVE_1,
              NOM_PARA='EPXX',FILTRE=( 
              _F(  NOM_PARA = 'INTITULE', VALE_K = 'EPSP'),
                  _F(  NOM_PARA = 'INST',     VALE = 100.)),
                    VALE=8.2590247355716E-04,
               PRECISION=5.E-4,
               REFERENCE='NON_REGRESSION',       VERSION='5.4.12'
           )

RELEVE_2=POST_RELEVE_T(ACTION=( 
                   _F(  RESULTAT = COUPLA,
                            INTITULE = 'DEPL',
                            NOM_CHAM = 'DEPL',
                            NOM_CMP = 'DX',
                            LIST_INST = LINST,
                            PRECISION = 1.E-8,
                            GROUP_NO = 'F1',
                            OPERATION = 'EXTRACTION'), 
                   _F(  RESULTAT = COUPLA,
                            INTITULE = 'SIEF',
                            NOM_CHAM = 'SIEF_ELNO_ELGA',
                            NOM_CMP = 'SIXX',
                            LIST_INST = LINST,
                            PRECISION = 1.E-8,
                            GROUP_NO = 'F1',
                            OPERATION = 'EXTRACTION'), 
                   _F(  RESULTAT = COUPLA,
                            INTITULE = 'EPSP',
                            NOM_CHAM = 'EPSP_ELNO',
                            TOUT_CMP = 'OUI',
                            LIST_INST = LINST,
                            PRECISION = 1.E-8,
                            GROUP_NO = 'F1',
                            OPERATION = 'EXTRACTION'), 
                   _F(  RESULTAT = COUPLA,
                            INTITULE = 'EPSF',
                            NOM_CHAM = 'EPGR_ELNO',
                            TOUT_CMP = 'OUI',
                            LIST_INST = LINST,
                            PRECISION = 1.E-8,
                            GROUP_NO = 'F1',
                            OPERATION = 'EXTRACTION'), 
                   _F(  RESULTAT = COUPLA,
                            INTITULE = 'EPSI',
                            NOM_CHAM = 'EPSI_ELNO_DEPL',
                            TOUT_CMP = 'OUI',
                            LIST_INST = LINST,
                            PRECISION = 1.E-8,
                            GROUP_NO = 'F1',
                            OPERATION = 'EXTRACTION')) 
                       )

IMPR_TABLE(  TABLE=RELEVE_2,
              NOM_PARA='DX', 
              FILTRE=_F(  NOM_PARA = 'INTITULE', VALE_K = 'DEPL')
           )

IMPR_TABLE(  TABLE=RELEVE_2,
              NOM_PARA='SIXX', 
              FILTRE=_F(  NOM_PARA = 'INTITULE', VALE_K = 'SIEF')
           )

IMPR_TABLE(  TABLE=RELEVE_2,
              NOM_PARA='EPXX', 
              FILTRE=_F(  NOM_PARA = 'INTITULE', VALE_K = 'EPSI')
           )

IMPR_TABLE(  TABLE=RELEVE_2,
              NOM_PARA='EPXX', 
              FILTRE=_F(  NOM_PARA = 'INTITULE', VALE_K = 'EPSP')
           )

IMPR_TABLE(  TABLE=RELEVE_2,
              NOM_PARA='EPXX', 
              FILTRE=_F(  NOM_PARA = 'INTITULE', VALE_K = 'EPSF')
           )

TEST_TABLE(  TABLE=RELEVE_2,
                NOM_PARA='SIXX',FILTRE=( 
                  _F(  NOM_PARA = 'INTITULE', VALE_K = 'SIEF'),
                  _F(  NOM_PARA = 'INST',     VALE = 10.)),
                    VALE=3.2061065182883E+00,
               PRECISION=1.E-4,
               REFERENCE='NON_REGRESSION',       VERSION='5.4.12'
           )

TEST_TABLE(  TABLE=RELEVE_2,
              NOM_PARA='EPXX',FILTRE=( 
              _F(  NOM_PARA = 'INTITULE', VALE_K = 'EPSF'),
                  _F(  NOM_PARA = 'INST',     VALE = 10.)),
                    VALE=7.1412072405648E-07,
               PRECISION=2.E-4,
               REFERENCE='NON_REGRESSION',       VERSION='5.4.12'
           )

TEST_TABLE(  TABLE=RELEVE_2,
                NOM_PARA='SIXX',FILTRE=( 
                  _F(  NOM_PARA = 'INTITULE', VALE_K = 'SIEF'),
                  _F(  NOM_PARA = 'INST',     VALE = 100.)),
                    VALE=4.3891267779935E+00,
               PRECISION=1.E-4,
               REFERENCE='NON_REGRESSION',       VERSION='5.4.12'
           )

TEST_TABLE(  TABLE=RELEVE_2,
              NOM_PARA='EPXX',FILTRE=( 
              _F(  NOM_PARA = 'INTITULE', VALE_K = 'EPSF'),
                  _F(  NOM_PARA = 'INST',     VALE = 100.)),
                    VALE=1.8331813339306E-05,
               PRECISION=1.E-4,
               REFERENCE='NON_REGRESSION',       VERSION='5.4.12'
           )

TEST_TABLE(  TABLE=RELEVE_2,
              NOM_PARA='EPXX',FILTRE=( 
              _F(  NOM_PARA = 'INTITULE', VALE_K = 'EPSP'),
                  _F(  NOM_PARA = 'INST',     VALE = 100.)),
                    VALE=8.2590313035323E-04,
               PRECISION=5.E-4,
               REFERENCE='NON_REGRESSION',       VERSION='5.4.12'
           )

CM2=AFFE_MATERIAU(    MAILLAGE=MAIL,
                            AFFE=_F( TOUT = 'OUI',
                                  MATER = BETON,
                                  TEMP_REF = 0.,
                                  SECH_REF = 0.)
                    )

TEMPNC=CREA_RESU(  OPERATION='AFFE', TYPE_RESU='EVOL_THER',
                      NOM_CHAM='TEMP',AFFE=(
                       _F(  INST = 0.,         CHAM_GD = TEMP1),
                               _F(  INST = 100.,       CHAM_GD = TEMP2))
                    )

SECHNC=CREA_RESU(  OPERATION='AFFE', TYPE_RESU='EVOL_THER',
                      NOM_CHAM='TEMP',AFFE=(
                       _F(  INST = 0.,         CHAM_GD = SECH1),
                               _F(  INST = 100.,       CHAM_GD = SECH2))
                    )

COND_LI2=AFFE_CHAR_MECA(    
                      MODELE=MO,
               TEMP_CALCULEE=TEMPNC,
               SECH_CALCULEE=SECHNC,DDL_IMPO=(
                  _F(  GROUP_NO = 'LA',       DX = 0.),
                  _F(  GROUP_NO = ('A1', 'B1',),  DY = 0.),
                  _F(  GROUP_NO = ('F1', 'E1',),  DY = 0.)),LIAISON_DDL=(
               _F(  GROUP_NO = ( 'C1',  'D1', ),
                             DDL = ( 'DX', 'DX', ),
                             COEF_MULT = (  1., -1., ),
                             COEF_IMPO = 0.),
               _F(  GROUP_NO = ( 'C2',  'D2', ),
                             DDL = ( 'DX', 'DX', ),
                             COEF_MULT = (  1., -1., ),
                             COEF_IMPO = 0.)),
              LIAISON_UNIF=_F(  GROUP_MA = 'LD',
                             DDL = 'DX')
                   )

################################################
###    COUPLAGE GRANGER_FP  VMIS_ISOT_LINE   ###
################################################

COUPLA2=STAT_NON_LINE( 
                   TITRE='COUPLAGE FLUAGE/FISSURATION',
                  MODELE=MO,EXCIT=(
                   _F(  CHARGE = COND_LI2),
                   _F(  CHARGE = TRAC,
                           FONC_MULT = COEF_TR)),
               INCREMENT=_F(  LIST_INST = LINST),
              CHAM_MATER=CM2,
               COMP_INCR=_F(  RELATION = 'KIT_DDI',
                           RELATION_KIT = ('GRANGER_FP',
                                            'VMIS_ISOT_LINE',),
                           DEFORMATION = 'PETIT',
                           TOUT = 'OUI'),
                  NEWTON=_F(  MATRICE = 'TANGENTE',
                           REAC_INCR = 1,
                           REAC_ITER = 5),
             CONVERGENCE=_F(  ITER_GLOB_MAXI = 100,
                           ITER_INTE_MAXI = 20,
                           ITER_INTE_PAS = 0,
                           RESI_GLOB_RELA = 1.E-6,
                           RESI_INTE_RELA = 1.E-6)
                            )

COUPLA2=CALC_ELEM(    reuse=COUPLA2,          MODELE=MO,
                               CHAM_MATER=CM,EXCIT=(
                                   _F(  CHARGE = COND_LI2),
                                   _F(  CHARGE = TRAC)),
                                  OPTION=( 'EPSI_ELNO_DEPL',
                                           'SIEF_ELNO_ELGA',
                                           'EPGR_ELNO',
                                           'EPSP_ELNO', ),
                                 RESULTAT=COUPLA2 )

RELEVE_3=POST_RELEVE_T(ACTION=( 
                   _F(  RESULTAT = COUPLA2,
                            INTITULE = 'DEPL',
                            NOM_CHAM = 'DEPL',
                            NOM_CMP = 'DX',
                            LIST_INST = LINST,
                            PRECISION = 1.E-8,
                            GROUP_NO = 'F1',
                            OPERATION = 'EXTRACTION'), 
                   _F(  RESULTAT = COUPLA2,
                            INTITULE = 'SIEF',
                            NOM_CHAM = 'SIEF_ELNO_ELGA',
                            NOM_CMP = 'SIXX',
                            LIST_INST = LINST,
                            PRECISION = 1.E-8,
                            GROUP_NO = 'F1',
                            OPERATION = 'EXTRACTION'), 
                   _F(  RESULTAT = COUPLA2,
                            INTITULE = 'EPSP',
                            NOM_CHAM = 'EPSP_ELNO',
                            TOUT_CMP = 'OUI',
                            LIST_INST = LINST,
                            PRECISION = 1.E-8,
                            GROUP_NO = 'F1',
                            OPERATION = 'EXTRACTION'), 
                   _F(  RESULTAT = COUPLA2,
                            INTITULE = 'EPSF',
                            NOM_CHAM = 'EPGR_ELNO',
                            TOUT_CMP = 'OUI',
                            LIST_INST = LINST,
                            PRECISION = 1.E-8,
                            GROUP_NO = 'F1',
                            OPERATION = 'EXTRACTION'), 
                   _F(  RESULTAT = COUPLA2,
                            INTITULE = 'EPSI',
                            NOM_CHAM = 'EPSI_ELNO_DEPL',
                            TOUT_CMP = 'OUI',
                            LIST_INST = LINST,
                            PRECISION = 1.E-8,
                            GROUP_NO = 'F1',
                            OPERATION = 'EXTRACTION')) 
                       )

IMPR_TABLE(  TABLE=RELEVE_3,
              NOM_PARA='DX', 
              FILTRE=_F(  NOM_PARA = 'INTITULE', VALE_K = 'DEPL')
           )

IMPR_TABLE(  TABLE=RELEVE_3,
              NOM_PARA='SIXX', 
              FILTRE=_F(  NOM_PARA = 'INTITULE', VALE_K = 'SIEF')
           )

IMPR_TABLE(  TABLE=RELEVE_3,
              NOM_PARA='EPXX', 
              FILTRE=_F(  NOM_PARA = 'INTITULE', VALE_K = 'EPSI')
           )

IMPR_TABLE(  TABLE=RELEVE_3,
              NOM_PARA='EPXX', 
              FILTRE=_F(  NOM_PARA = 'INTITULE', VALE_K = 'EPSP')
           )

IMPR_TABLE(  TABLE=RELEVE_3,
              NOM_PARA='EPXX', 
              FILTRE=_F(  NOM_PARA = 'INTITULE', VALE_K = 'EPSF')
           )

TEST_TABLE(  TABLE=RELEVE_3,
                NOM_PARA='SIXX',FILTRE=( 
                  _F(  NOM_PARA = 'INTITULE', VALE_K = 'SIEF'),
                  _F(  NOM_PARA = 'INST',     VALE = 10.)),
                    VALE=1.3782953684785E+00,
               PRECISION=1.E-4,
               REFERENCE='NON_REGRESSION',       VERSION='7.2.25'
           )

TEST_TABLE(  TABLE=RELEVE_3,
              NOM_PARA='EPXX',FILTRE=( 
              _F(  NOM_PARA = 'INTITULE', VALE_K = 'EPSF'),
                  _F(  NOM_PARA = 'INST',     VALE = 10.)),
                    VALE=3.6221961613412E-07,
               PRECISION=2.E-4,
               REFERENCE='NON_REGRESSION',       VERSION='7.2.25'
           )

TEST_TABLE(  TABLE=RELEVE_3,
                NOM_PARA='SIXX',FILTRE=( 
                  _F(  NOM_PARA = 'INTITULE', VALE_K = 'SIEF'),
                  _F(  NOM_PARA = 'INST',     VALE = 100.)),
                    VALE=3.3363289731692E+00,
               PRECISION=1.E-4,
               REFERENCE='NON_REGRESSION',       VERSION='7.2.25'
           )

TEST_TABLE(  TABLE=RELEVE_3,
              NOM_PARA='EPXX',FILTRE=( 
              _F(  NOM_PARA = 'INTITULE', VALE_K = 'EPSF'),
                  _F(  NOM_PARA = 'INST',     VALE = 100.)),
                    VALE=1.5219596906058E-05,
               PRECISION=1.E-4,
               REFERENCE='NON_REGRESSION',       VERSION='7.2.25'
           )

TEST_TABLE(  TABLE=RELEVE_3,
              NOM_PARA='EPXX',FILTRE=( 
              _F(  NOM_PARA = 'INTITULE', VALE_K = 'EPSP'),
                  _F(  NOM_PARA = 'INST',     VALE = 100.)),
                    VALE=6.70072955E-04,
               PRECISION=5.E-4,
               REFERENCE='NON_REGRESSION',       VERSION='7.3.1'
           )

################################################
###    COUPLAGE    GRANGER_FP     CHABOCHE   ###
################################################

COUPLA3=STAT_NON_LINE( 
                   TITRE='COUPLAGE FLUAGE/FISSURATION',
                  MODELE=MO,EXCIT=(
                   _F(  CHARGE = COND_LI2),
                   _F(  CHARGE = TRAC,
                           FONC_MULT = COEF_TR)),
               INCREMENT=_F(  LIST_INST = LINST),
              CHAM_MATER=CM2,
               COMP_INCR=_F(  RELATION = 'KIT_DDI',
                           RELATION_KIT = ('GRANGER_FP',
                                            'CHABOCHE',),
                           DEFORMATION = 'PETIT',
                           TOUT = 'OUI'),
                  NEWTON=_F(  MATRICE = 'TANGENTE',
                           REAC_INCR = 1,
                           REAC_ITER = 5),
             CONVERGENCE=_F(  ITER_GLOB_MAXI = 100,
                           ITER_INTE_MAXI = 20,
                           ITER_INTE_PAS = 0,
                           RESI_GLOB_RELA = 1.E-6,
                           RESI_INTE_RELA = 1.E-6)
                            )

COUPLA3=CALC_ELEM(    reuse=COUPLA3,          MODELE=MO,
                               CHAM_MATER=CM,EXCIT=(
                                   _F(  CHARGE = COND_LI2),
                                   _F(  CHARGE = TRAC)),
                                  OPTION=( 'EPSI_ELNO_DEPL',
                                           'SIEF_ELNO_ELGA',
                                           'EPGR_ELNO',
                                           'EPSP_ELNO', ),
                                 RESULTAT=COUPLA3 )

RELEVE_4=POST_RELEVE_T(ACTION=( 
                   _F(  RESULTAT = COUPLA3,
                            INTITULE = 'DEPL',
                            NOM_CHAM = 'DEPL',
                            NOM_CMP = 'DX',
                            LIST_INST = LINST,
                            PRECISION = 1.E-8,
                            GROUP_NO = 'F1',
                            OPERATION = 'EXTRACTION'), 
                   _F(  RESULTAT = COUPLA3,
                            INTITULE = 'SIEF',
                            NOM_CHAM = 'SIEF_ELNO_ELGA',
                            NOM_CMP = 'SIXX',
                            LIST_INST = LINST,
                            PRECISION = 1.E-8,
                            GROUP_NO = 'F1',
                            OPERATION = 'EXTRACTION'), 
                   _F(  RESULTAT = COUPLA3,
                            INTITULE = 'EPSP',
                            NOM_CHAM = 'EPSP_ELNO',
                            TOUT_CMP = 'OUI',
                            LIST_INST = LINST,
                            PRECISION = 1.E-8,
                            GROUP_NO = 'F1',
                            OPERATION = 'EXTRACTION'), 
                   _F(  RESULTAT = COUPLA3,
                            INTITULE = 'EPSF',
                            NOM_CHAM = 'EPGR_ELNO',
                            TOUT_CMP = 'OUI',
                            LIST_INST = LINST,
                            PRECISION = 1.E-8,
                            GROUP_NO = 'F1',
                            OPERATION = 'EXTRACTION'), 
                   _F(  RESULTAT = COUPLA3,
                            INTITULE = 'EPSI',
                            NOM_CHAM = 'EPSI_ELNO_DEPL',
                            TOUT_CMP = 'OUI',
                            LIST_INST = LINST,
                            PRECISION = 1.E-8,
                            GROUP_NO = 'F1',
                            OPERATION = 'EXTRACTION')) 
                       )

IMPR_TABLE(  TABLE=RELEVE_4,
              NOM_PARA='DX', 
              FILTRE=_F(  NOM_PARA = 'INTITULE', VALE_K = 'DEPL')
           )

IMPR_TABLE(  TABLE=RELEVE_4,
              NOM_PARA='SIXX', 
              FILTRE=_F(  NOM_PARA = 'INTITULE', VALE_K = 'SIEF')
           )

IMPR_TABLE(  TABLE=RELEVE_4,
              NOM_PARA='EPXX', 
              FILTRE=_F(  NOM_PARA = 'INTITULE', VALE_K = 'EPSI')
           )

IMPR_TABLE(  TABLE=RELEVE_4,
              NOM_PARA='EPXX', 
              FILTRE=_F(  NOM_PARA = 'INTITULE', VALE_K = 'EPSP')
           )

IMPR_TABLE(  TABLE=RELEVE_4,
              NOM_PARA='EPXX', 
              FILTRE=_F(  NOM_PARA = 'INTITULE', VALE_K = 'EPSF')
           )

TEST_TABLE(  TABLE=RELEVE_4,
                NOM_PARA='SIXX',FILTRE=( 
                  _F(  NOM_PARA = 'INTITULE', VALE_K = 'SIEF'),
                  _F(  NOM_PARA = 'INST',     VALE = 10.)),
                    VALE=1.3782953775786E+00,
               PRECISION=1.E-4,
               REFERENCE='NON_REGRESSION',       VERSION='7.2.25'
           )

TEST_TABLE(  TABLE=RELEVE_4,
              NOM_PARA='EPXX',FILTRE=( 
              _F(  NOM_PARA = 'INTITULE', VALE_K = 'EPSF'),
                  _F(  NOM_PARA = 'INST',     VALE = 10.)),
                    VALE=3.6221961620259E-07,
               PRECISION=2.E-4,
               REFERENCE='NON_REGRESSION',       VERSION='7.2.25'
           )

TEST_TABLE(  TABLE=RELEVE_4,
                NOM_PARA='SIXX',FILTRE=( 
                  _F(  NOM_PARA = 'INTITULE', VALE_K = 'SIEF'),
                  _F(  NOM_PARA = 'INST',     VALE = 100.)),
                    VALE=3.3363251977141E+00,
               PRECISION=1.E-4,
               REFERENCE='NON_REGRESSION',       VERSION='7.2.25'
           )

TEST_TABLE(  TABLE=RELEVE_4,
              NOM_PARA='EPXX',FILTRE=( 
              _F(  NOM_PARA = 'INTITULE', VALE_K = 'EPSF'),
                  _F(  NOM_PARA = 'INST',     VALE = 100.)),
                    VALE=1.5219584906297E-05,
               PRECISION=1.E-4,
               REFERENCE='NON_REGRESSION',       VERSION='7.2.25'
           )

TEST_TABLE(  TABLE=RELEVE_4,
              NOM_PARA='EPXX',FILTRE=( 
              _F(  NOM_PARA = 'INTITULE', VALE_K = 'EPSP'),
                  _F(  NOM_PARA = 'INST',     VALE = 100.)),
                    VALE=6.70072955E-04,
               PRECISION=5.E-4,
               REFERENCE='NON_REGRESSION',       VERSION='7.3.1'
           )

FIN()
#
