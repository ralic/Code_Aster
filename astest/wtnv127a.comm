# MODIF  DATE 10/10/2006   AUTEUR REZETTE C.REZETTE 
# TITRE DESATURATION D UN MILIEU POREUX SANS AIR SUR CELLULE UNITAIRE 3D
#            CONFIGURATION MANAGEMENT OF EDF VERSION
# ======================================================================
# COPYRIGHT (C) 1991 - 2005  EDF R&D                  WWW.CODE-ASTER.ORG
# THIS PROGRAM IS FREE SOFTWARE; YOU CAN REDISTRIBUTE IT AND/OR MODIFY  
# IT UNDER THE TERMS OF THE GNU GENERAL PUBLIC LICENSE AS PUBLISHED BY  
# THE FREE SOFTWARE FOUNDATION; EITHER VERSION 2 OF THE LICENSE, OR     
# (AT YOUR OPTION) ANY LATER VERSION.                                                    
#                                                                       
# THIS PROGRAM IS DISTRIBUTED IN THE HOPE THAT IT WILL BE USEFUL, BUT   
# WITHOUT ANY WARRANTY; WITHOUT EVEN THE IMPLIED WARRANTY OF            
# MERCHANTABILITY OR FITNESS FOR A PARTICULAR PURPOSE. SEE THE GNU      
# GENERAL PUBLIC LICENSE FOR MORE DETAILS.                              
#                                                                       
# YOU SHOULD HAVE RECEIVED A COPY OF THE GNU GENERAL PUBLIC LICENSE     
# ALONG WITH THIS PROGRAM; IF NOT, WRITE TO EDF R&D CODE_ASTER,         
#    1 AVENUE DU GENERAL DE GAULLE, 92141 CLAMART CEDEX, FRANCE.        
# ======================================================================


DEBUT(CODE=_F(NOM='WTNV127A',NIV_PUB_WEB='INTERNET'),);


                                   
                                   
INST1=DEFI_LIST_REEL(DEBUT=0.0,
                     INTERVALLE=_F(
                      JUSQU_A=100.,NOMBRE=1,),);


MAIL=LIRE_MAILLAGE();

MAIL=DEFI_GROUP(reuse =MAIL,
                MAILLAGE=MAIL,
                CREA_GROUP_NO=(_F(GROUP_MA='BAS',),
                               _F(GROUP_MA='HAUT',),
                               _F(GROUP_MA='GAUCHE',),
                               _F(GROUP_MA='DROITE',),
                               _F(GROUP_MA='AVANT',),
                               _F(GROUP_MA='ARRIERE',),
                               _F(GROUP_MA='CUBE',),
                               ),);

MODELE=AFFE_MODELE(MAILLAGE=MAIL,
                   AFFE=_F(TOUT='OUI',
                           PHENOMENE='MECANIQUE',
                           MODELISATION='3D_THVD',),);



UN=DEFI_CONSTANTE(VALE=1.0,);
ZERO=DEFI_CONSTANTE(VALE=0.0,);

VISCOLIQ=DEFI_CONSTANTE(VALE=1.E-3,);

VISCOGAZ=DEFI_CONSTANTE(VALE=1.8E-05,);

DVISCOL=DEFI_CONSTANTE(VALE=0.0,);

DVISCOG=DEFI_CONSTANTE(VALE=0.0,);
                      
LI1=DEFI_LIST_REEL(DEBUT=0,
                   INTERVALLE=(_F(JUSQU_A=1.E6,
                                  NOMBRE=100,),
                               _F(JUSQU_A=1.E7,
                                  NOMBRE=100,),
                               _F(JUSQU_A=1.E8,
                                  NOMBRE=100,),
                               _F(JUSQU_A=1.E9,
                                  NOMBRE=100,),),);
                        
DLS=DEFI_CONSTANTE(VALE=0.3,);

SLO = FORMULE(NOM_PARA='PCAP' ,VALE='''
                (0.5-1.E-12*(PCAP-3700.+1.E5))''');

SATUBO=CALC_FONC_INTERP(FONCTION=SLO,
                        LIST_PARA=LI1,
                        NOM_PARA='PCAP',
                        PROL_GAUCHE='LINEAIRE',
                        PROL_DROITE='LINEAIRE',
                        INFO=2,);


DSATBO=DEFI_CONSTANTE(VALE=-1.E-12,);

KINTBO=DEFI_CONSTANTE(VALE=10.E-21,);


MATERBO=DEFI_MATERIAU(COMP_THM = 'LIQU_VAPE',
                      THM_LIQU=_F(RHO=1000.0,
                                  UN_SUR_K=0.,
                                  ALPHA=0.,
                                  CP=4180.0,
                                  VISC=VISCOLIQ,
                                  D_VISC_TEMP=DVISCOL,),
                      THM_GAZ=_F(MASS_MOL=0.02896,
                                 CP=1017.0,
                                 VISC=VISCOGAZ,
                                 D_VISC_TEMP=ZERO,),
                      THM_VAPE_GAZ=_F(MASS_MOL=0.018,
                                      CP=1900.0,
                                      VISC=VISCOGAZ,
                                      D_VISC_TEMP=ZERO,),
                      THM_INIT=_F(TEMP=300.0,
                                  PRE1=0.0,
                                  PRE2=0.,
                                  PORO=0.3,
                                  PRES_VAPE=3700.0,
                                  ),
                      THM_DIFFU=_F(R_GAZ=8.315,
                                   RHO=2200.0,
                                   CP=1050.0,
                                   BIOT_COEF=1.0,
                                   SATU_PRES=SATUBO,
                                   D_SATU_PRES=DSATBO,
                                   PESA_X=0.0,
                                   PESA_Y=0.0,
                                   PESA_Z=0.0,
                                   PERM_IN=KINTBO,
                                   PERM_LIQU=UN,
                                   D_PERM_LIQU_SATU=ZERO,
                                   PERM_GAZ=UN,
                                   D_PERM_SATU_GAZ=ZERO,
                                   D_PERM_PRES_GAZ=ZERO,
                                   LAMB_T=ZERO,
                                   D_LB_S=DLS,),);

CHMAT0=AFFE_MATERIAU(MAILLAGE=MAIL,
                     AFFE=(_F(GROUP_MA='CUBE',
                              MATER=MATERBO,),
                              ),);


CHAMNO=CREA_CHAMP(MAILLAGE=MAIL,
                    OPERATION='AFFE', 
                    TYPE_CHAM='NOEU_DEPL_R',
                    AFFE=(_F(TOUT='OUI',
                             NOM_CMP='TEMP',
                             VALE=0.0,),
                          _F(GROUP_NO='CUBE',
                             NOM_CMP='PRE1',
                             VALE=1.E5,),
                             ),);
                             

FLUTH=AFFE_CHAR_MECA(MODELE=MODELE,
                       FLUX_THM_REP=_F(GROUP_MA=('GAUCHE','DROITE','BAS','HAUT','AVANT','ARRIERE'),
                                       FLUN=1.E6,
                                       FLUN_HYDR1=0.0,
                                       ),
                                      );

               
                                   
                                   
SIGINIT=CREA_CHAMP(TYPE_CHAM='CART_SIEF_R',
                   OPERATION='AFFE',
                   MAILLAGE=MAIL,
                   AFFE=_F(GROUP_MA='CUBE',
                           NOM_CMP=
                           ('M11','FH11X','FH11Y','FH11Z','ENT11','M12','FH12X','FH12Y','FH12Z',
                                     'ENT12','QPRIM','FHTX','FHTY','FHTZ',),
                           VALE=(0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,2500000.0,0.0,0.0,0.0,0.0,),),);

U0=STAT_NON_LINE(MODELE=MODELE,
                 CHAM_MATER=CHMAT0,
                 EXCIT=(_F(CHARGE=FLUTH,),),
                 COMP_INCR=_F(RELATION='KIT_THV',PARM_THETA=0.57,
                              RELATION_KIT=('LIQU_VAPE','HYDR_UTIL'),
                              ITER_INTE_MAXI=5),
                 ETAT_INIT=_F(DEPL=CHAMNO,
                              SIGM=SIGINIT,
                              ),
                 INCREMENT=_F(LIST_INST=INST1,),
                 NEWTON=_F(MATRICE='TANGENTE',
                           REAC_ITER=1,),
                 CONVERGENCE=_F(
                                RESI_GLOB_RELA=1.E-10,
                                ITER_GLOB_MAXI=50,),
                 SOLVEUR=_F(METHODE='MULT_FRONT',
                            STOP_SINGULIER='NON',),
                 ARCHIVAGE=_F(PAS_ARCH=1,),
                 );
                 
U0=CALC_ELEM(reuse =U0,
             MODELE=MODELE,
             CHAM_MATER=CHMAT0,
             TOUT_ORDRE='OUI',
             OPTION=('SIEF_ELNO_ELGA','VARI_ELNO_ELGA'),
             RESULTAT=U0,);
             
         
TEST_RESU(RESU=_F(RESULTAT=U0,
                  INST=1.E2,
                  NOM_CHAM='DEPL',
                  NOM_CMP='TEMP',
                  NOEUD='N1',
                  VALE=2.,
                  CRITERE='RELATIF',
                  PRECISION=1.E-1,
                  REFERENCE='ANALYTIQUE',),);   
                        
TEST_RESU(RESU=_F(RESULTAT=U0,
                  INST=1.E2,
                  NOM_CHAM='DEPL',
                  NOM_CMP='PRE1',
                  NOEUD='N1',
                  VALE=-1.4E6,
                  CRITERE='RELATIF',
                  PRECISION=0.1,
                  REFERENCE='ANALYTIQUE',),);
                                          
TEST_RESU(RESU=_F(RESULTAT=U0,
                  INST=1.E2,
                  NOM_CHAM='VARI_ELNO_ELGA',
                  NOM_CMP='V3',
                  NOEUD='N1',
                  MAILLE='M1',
                  VALE=425.,
                  CRITERE='RELATIF',
                  PRECISION=0.1,
                  REFERENCE='ANALYTIQUE',),);

FIN();

