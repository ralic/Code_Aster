# MODIF  DATE 04/07/2011   AUTEUR ABBAS M.ABBAS 
# TITRE SECHAGE EN 2D AXISYMETRIQUE  - QUAD8
#            CONFIGURATION MANAGEMENT OF EDF VERSION
# ======================================================================
# COPYRIGHT (C) 1991 - 2011  EDF R&D                  WWW.CODE-ASTER.ORG
# THIS PROGRAM IS FREE SOFTWARE; YOU CAN REDISTRIBUTE IT AND/OR MODIFY
# IT UNDER THE TERMS OF THE GNU GENERAL PUBLIC LICENSE AS PUBLISHED BY
# THE FREE SOFTWARE FOUNDATION; EITHER VERSION 2 OF THE LICENSE, OR
# (AT YOUR OPTION) ANY LATER VERSION.
#
# THIS PROGRAM IS DISTRIBUTED IN THE HOPE THAT IT WILL BE USEFUL, BUT
# WITHOUT ANY WARRANTY; WITHOUT EVEN THE IMPLIED WARRANTY OF
# MERCHANTABILITY OR FITNESS FOR A PARTICULAR PURPOSE. SEE THE GNU
# GENERAL PUBLIC LICENSE FOR MORE DETAILS.
#
# YOU SHOULD HAVE RECEIVED A COPY OF THE GNU GENERAL PUBLIC LICENSE
# ALONG WITH THIS PROGRAM; IF NOT, WRITE TO EDF R&D CODE_ASTER,
#    1 AVENUE DU GENERAL DE GAULLE, 92141 CLAMART CEDEX, FRANCE.
# ======================================================================

DEBUT( CODE=_F( NOM = 'HSNA100A',NIV_PUB_WEB='INTERNET') )

MAGE=LIRE_MAILLAGE( )

MAGE=DEFI_GROUP( reuse=MAGE,        MAILLAGE=MAGE,CREA_GROUP_NO=(
                        _F( GROUP_MA = 'L_EXT',
                                       NOM = 'L_EXT',        ),
                        _F( GROUP_MA = 'L_INT',
                                       NOM = 'L_INT',        ))
                    )

BETON=DEFI_MATERIAU(    SECH_GRANGER=_F(  A = 3.8E-13,
                                          B = 0.05,
                                          QSR_K = 4700.,
                                          TEMP_0_C = 0.0,  ),
                                   THER=_F(  LAMBDA = 8000.,
                                          RHO_CP = 2.400E+6,      )
                       )

###################
# CALCUL THERMIQUE
###################


CHMAT=AFFE_MATERIAU(    MAILLAGE=MAGE,
                                AFFE=_F(  TOUT = 'OUI',
                                       MATER = BETON,        )
                         )

MOTH=AFFE_MODELE(   MAILLAGE=MAGE,
                             AFFE=_F( TOUT = 'OUI',
                                   MODELISATION = 'AXIS',
                                   PHENOMENE = 'THERMIQUE',    )
                        )

CHARTH05=AFFE_CHAR_THER(       MODELE=MOTH,TEMP_IMPO=(
                              _F(  GROUP_NO = 'L_EXT',
                                          TEMP = 15.,       ),
                              _F(  GROUP_NO = 'L_INT',
                                          TEMP = 15.,       ))
                            )

CHARTH10=AFFE_CHAR_THER(       MODELE=MOTH,TEMP_IMPO=(
                              _F(  GROUP_NO = 'L_EXT',
                                          TEMP = 15.,       ),
                              _F(  GROUP_NO = 'L_INT',
                                          TEMP = 35.,       ))
                            )

LISTTHER=DEFI_LIST_REEL(
             DEBUT=0.,INTERVALLE=(
        _F( JUSQU_A = 3.15360E+05,       NOMBRE = 1,  ), #   0.1 AN
        _F( JUSQU_A = 3.15360E+07,       NOMBRE = 1,  ), #   1   AN
        _F( JUSQU_A = 1.57680E+08,       NOMBRE = 4,  ), #   5   ANS
        _F( JUSQU_A = 1.60834E+08,       NOMBRE = 2,  ), #   5.1 ANS
        _F( JUSQU_A = 1.89216E+08,       NOMBRE = 1,  ), #   6   ANS
        _F( JUSQU_A = 3.15360E+08,       NOMBRE = 4,  ), #  10   ANS
        _F( JUSQU_A = 1.70294E+09,       NOMBRE = 1,  )) #  54   ANS
                          )

RESUTHER=THER_LINEAIRE(          MODELE=MOTH,
                                     EXCIT=_F( CHARGE = CHARTH05,   ),
                                CHAM_MATER=CHMAT,
                                   SOLVEUR=_F(  METHODE = 'MULT_FRONT',   ),
                                 PARM_THETA=0.57,
                                 ETAT_INIT=_F( VALE = 15.,   ),
                                 INCREMENT=_F( LIST_INST = LISTTHER,  
                                            NUME_INST_INIT = 0,   
                                            NUME_INST_FIN = 6,       ),
                                      INFO=1
                         )

RESUTHER=THER_LINEAIRE(reuse=RESUTHER,          MODELE=MOTH,
                                     EXCIT=_F( CHARGE = CHARTH10,   ),
                                CHAM_MATER=CHMAT,
                                   SOLVEUR=_F(  METHODE = 'MULT_FRONT',   ),
                                 PARM_THETA=0.57,
                                 ETAT_INIT=_F( EVOL_THER = RESUTHER,  
                                            NUME_ORDRE = 6,   ),
                                 INCREMENT=_F( LIST_INST = LISTTHER,  
                                            NUME_INST_INIT = 6,   
                                            NUME_INST_FIN = 14,      ),
                                      INFO=1
                         )

#####################
# CALCUL DU SECHAGE
#####################

# FLUX D HUMIDITE SUR LES PAROIS EXTERNES

BETA=3.41557E-08

C_0=105.7

C_EQ_I05=69.1

C_EQ_E05=69.1

C_EQ_I10=51.6

C_EQ_E10=69.1

FL_INT05 = FORMULE(NOM_PARA='TEMP',
                   VALE='''(0.5*BETA / ((C_0 - C_EQ_I05 )**2)
  * (TEMP - (2.*C_0 - C_EQ_I05 ))*(TEMP - C_EQ_I05 ))''')

FL_EXT05 = FORMULE(NOM_PARA='TEMP',
                   VALE='''(0.5*BETA / ((C_0 - C_EQ_E05 )**2)
  * (TEMP - (2.*C_0 - C_EQ_E05 ))*(TEMP - C_EQ_E05 ))''')

FL_INT10 = FORMULE(NOM_PARA='TEMP',
                   VALE='''(0.5*BETA / ((C_0 - C_EQ_I10 )**2)
  * (TEMP - (2.*C_0 - C_EQ_I10 ))*(TEMP - C_EQ_I10 ))''')

FL_EXT10 = FORMULE(NOM_PARA='TEMP',
                   VALE='''(0.5*BETA / ((C_0 - C_EQ_E10 )**2)
  * (TEMP - (2.*C_0 - C_EQ_E10 ))*(TEMP - C_EQ_E10 ))''')

LIST0=DEFI_LIST_REEL(  DEBUT=0.,INTERVALLE=(
                         _F(  JUSQU_A = 50.,    PAS = 10.,  ),
                         _F(  JUSQU_A = 100.,   PAS = 2.,  ),
                         _F(  JUSQU_A = 110.,   PAS = 2.,  ),
                         _F(  JUSQU_A = 200.,   PAS = 10.,  )) )

HU_INT05=CALC_FONC_INTERP(     FONCTION=FL_INT05,
                                LIST_PARA=LIST0,
                               NOM_PARA = 'TEMP',
                                 NOM_RESU='FL_INT05',
                              PROL_GAUCHE='LINEAIRE',
                               PROL_DROITE='LINEAIRE',
#                                 INTERPOL='INT',
                                 INTERPOL='LIN',
                                    TITRE='FLUX D HUMIDITE'
                            )

HU_EXT05=CALC_FONC_INTERP(     FONCTION=FL_EXT05,
                                LIST_PARA=LIST0,
                               NOM_PARA = 'TEMP',
                                 NOM_RESU='FL_EXT05',
                              PROL_GAUCHE='LINEAIRE',
                               PROL_DROITE='LINEAIRE',
#                                 INTERPOL='INT',
                                 INTERPOL='LIN',
                                    TITRE='FLUX D HUMIDITE'
                            )

HU_INT10=CALC_FONC_INTERP(     FONCTION=FL_INT10,
                                LIST_PARA=LIST0,
                                  NOM_PARA = 'TEMP',
                                 NOM_RESU='FL_INT10',
                              PROL_GAUCHE='LINEAIRE',
                               PROL_DROITE='LINEAIRE',
#                                 INTERPOL='INT',
                                INTERPOL='LIN',
                                    TITRE='FLUX D HUMIDITE'
                            )

HU_EXT10=CALC_FONC_INTERP(     FONCTION=FL_EXT10,
                                LIST_PARA=LIST0,
                                 NOM_PARA = 'TEMP',
                                 NOM_RESU='FL_EXT10',
                              PROL_GAUCHE='LINEAIRE',
                               PROL_DROITE='LINEAIRE',
#                                 INTERPOL='INT',
                                 INTERPOL='LIN',
                                    TITRE='FLUX D HUMIDITE'
                            )

CHARSE05=AFFE_CHAR_THER_F(     MODELE=MOTH,FLUX_NL=(
                                _F(  GROUP_MA = 'L_INT',
                                          FLUN = HU_INT05,       ),
                                _F(  GROUP_MA = 'L_EXT',
                                          FLUN = HU_EXT05,       ))
                            )

CHARSE10=AFFE_CHAR_THER_F(     MODELE=MOTH,FLUX_NL=(
                                _F(  GROUP_MA = 'L_INT',
                                          FLUN = HU_INT10,       ),
                                _F(  GROUP_MA = 'L_EXT',
                                          FLUN = HU_EXT10,       ))
                            )

LISTSECH=DEFI_LIST_REEL(
             DEBUT=0.,INTERVALLE=(
        _F( JUSQU_A = 3.15360E+04,       NOMBRE = 1,  ), #   0.001 A
        _F( JUSQU_A = 3.15360E+06,       NOMBRE = 2,  ), #   0.1 AN
        _F( JUSQU_A = 3.15360E+07,       NOMBRE = 9,  ), #   1   AN
        _F( JUSQU_A = 1.50000E+08,       NOMBRE = 16, ), #   4.9 ANS
        _F( JUSQU_A = 1.57680E+08,       NOMBRE = 16, ), #   5   ANS
        _F( JUSQU_A = 1.57712E+08,       NOMBRE = 1,  ), #   5.001 A
        _F( JUSQU_A = 1.60834E+08,       NOMBRE = 2,  ), #   5.1 ANS
        _F( JUSQU_A = 1.89216E+08,       NOMBRE = 9,  ), #   6   ANS
        _F( JUSQU_A = 3.15360E+08,       NOMBRE = 4,  ), #  10   ANS
        _F( JUSQU_A = 1.57680E+09,       NOMBRE = 8,  ), #  50   ANS
        _F( JUSQU_A = 1.70294E+09,       NOMBRE = 4,  )) #  54   ANS
                          )

RESUSECH=THER_NON_LINE(          MODELE=MOTH,
                                     EXCIT=_F( CHARGE = CHARSE05,   ),
                                CHAM_MATER=CHMAT,
                                   SOLVEUR=_F( METHODE = 'MULT_FRONT',   ),
                                 PARM_THETA=0.57,
                                 ETAT_INIT=_F( VALE = 105.7,   ),
                                 INCREMENT=_F( LIST_INST = LISTSECH,  
                                            NUME_INST_INIT = 0,   
                                            NUME_INST_FIN = 44,       ),
                              COMP_THER_NL=_F( RELATION = 'SECH_GRANGER',   
                                            TOUT = 'OUI',            ),
                            EVOL_THER_SECH=RESUTHER,
                            ARCHIVAGE=_F(DETR_NUME_SUIV='OUI'),
                                      INFO=1,
                             TITRE=( ' CAS TEST &CODE',
                                     '&RL COMMANDE &COMMANDE', )
                         )

RESUSECH=THER_NON_LINE(reuse=RESUSECH,          MODELE=MOTH,
                                     EXCIT=_F( CHARGE = CHARSE10,   ),
                                CHAM_MATER=CHMAT,
                                   SOLVEUR=_F( METHODE = 'MULT_FRONT',   ),
                                 PARM_THETA=0.57,
                                 ETAT_INIT=_F( EVOL_THER = RESUSECH,  
                                            NUME_ORDRE = 32,   ),
                                 INCREMENT=_F( LIST_INST = LISTSECH,  
                                            NUME_INST_INIT = 32,   
                                            NUME_INST_FIN = 72,       ),
                              COMP_THER_NL=_F( RELATION = 'SECH_GRANGER',   
                                            TOUT = 'OUI',            ),
                            EVOL_THER_SECH=RESUTHER,
                            ARCHIVAGE=_F(DETR_NUME_SUIV='OUI'),
                                      INFO=1,
                             TITRE=( ' CAS TEST &CODE',
                                     '&RL COMMANDE &COMMANDE', )
                         )

##############################
# TESTS DES RESULTATS
##############################

# VALIDATION
# VALEURS DE REFENCE DU CAS TEST: C.F. DOC DU CAS TEST HSNA100A

TEST_RESU(RESU=(
          _F(  RESULTAT = RESUSECH,   NOM_CHAM = 'TEMP',   
               NUME_ORDRE = 44,
            GROUP_NO = 'A2',  NOM_CMP = 'TEMP', VALE = 104.,  PRECISION = 1.E-2, ),
          _F(  RESULTAT = RESUSECH,   NOM_CHAM = 'TEMP',   
               NUME_ORDRE = 61,
            GROUP_NO = 'A2',  NOM_CMP = 'TEMP', VALE = 95.,   PRECISION = 2.E-2, ),
          _F(  RESULTAT = RESUSECH,   NOM_CHAM = 'TEMP',  
               NUME_ORDRE = 72,
            GROUP_NO = 'A2',  NOM_CMP = 'TEMP', VALE = 78.,   PRECISION = 1.E-2, ))
           )

# NON REGRESSION
# VALEURS DE REFERENCE ASTER DE LA VERSION 5.1.2

TEST_RESU(RESU=(
          _F(  RESULTAT = RESUSECH,   NOM_CHAM = 'TEMP',   NUME_ORDRE = 60,
            GROUP_NO = 'A2',  NOM_CMP = 'TEMP', VALE = 100.1,  PRECISION = 1.E-3, ),
          _F(  RESULTAT = RESUSECH,   NOM_CHAM = 'TEMP',   NUME_ORDRE = 62,
            GROUP_NO = 'A2',  NOM_CMP = 'TEMP', VALE = 92.8,   PRECISION = 1.E-3, ),
          _F(  RESULTAT = RESUSECH,   NOM_CHAM = 'TEMP',   NUME_ORDRE = 64,
            GROUP_NO = 'A2',  NOM_CMP = 'TEMP', VALE = 87.2,   PRECISION = 1.E-3, ),
          _F(  RESULTAT = RESUSECH,   NOM_CHAM = 'TEMP',   NUME_ORDRE = 66,
            GROUP_NO = 'A2',  NOM_CMP = 'TEMP', VALE = 82.9,   PRECISION = 1.E-3, ),
          _F(  RESULTAT = RESUSECH,   NOM_CHAM = 'TEMP',   NUME_ORDRE = 68,
            GROUP_NO = 'A2',  NOM_CMP = 'TEMP', VALE = 79.5,   PRECISION = 1.E-3, ))
           )

###################
# CALCUL MECANIQUE
###################

#
# DONNEES DE MODELISATION
#

MOMECA=AFFE_MODELE(   MAILLAGE=MAGE,
                            AFFE=_F( TOUT = 'OUI',
                                  MODELISATION = 'AXIS',
                                  PHENOMENE = 'MECANIQUE',    )
                        )

FCT1=DEFI_FONCTION(   NOM_PARA='EPSI',  PROL_DROITE='LINEAIRE',
                                          PROL_GAUCHE='LINEAIRE',
                       VALE=(0.200E-2,      400.,
                             0.400E-2,      500.,)
                                                    )

#

FCT2=DEFI_FONCTION(   NOM_PARA='EPSI',  PROL_DROITE='LINEAIRE',
                                          PROL_GAUCHE='LINEAIRE',
                       VALE=(0.100E-2,      200.,
                             0.300E-2,      300.,)
                                                    )

#

E=DEFI_FONCTION(       NOM_PARA='SECH',
                            PROL_DROITE='CONSTANT',
                           PROL_GAUCHE='CONSTANT',
                                 VALE=(
                                            0.0,   32.E+3,
                                         1000.0,   32.E+3,
                                     )    )

#

NU=DEFI_FONCTION(       NOM_PARA='SECH',
                            PROL_DROITE='CONSTANT',
                           PROL_GAUCHE='CONSTANT',
                                 VALE=(
                                            0.0,  0.3E0,
                                         1000.0,  0.3E0,
                                     )    )

#

ALPHA=DEFI_FONCTION(       NOM_PARA='TEMP',
                            PROL_DROITE='CONSTANT',
                           PROL_GAUCHE='CONSTANT',
                                 VALE=(
                                            0.0,  10.0E-6,
                                         1000.0,  10.0E-6,
                                     )    )

#

CTRACB=DEFI_NAPPE(   NOM_PARA='SECH',  PROL_DROITE='LINEAIRE',
                                        PROL_GAUCHE='LINEAIRE',
                          PARA=(0.,50.,),
                          FONCTION=(FCT1,FCT2,)            )

#

MAT=DEFI_MATERIAU(             THER=_F( RHO_CP = 0.0E-3,
                                        LAMBDA = 1.0E-3,        ),
                               ELAS_FO=_F( E = E,
                                        NU = NU,
                                        ALPHA = ALPHA,
                                        RHO = 2400.,
                                        TEMP_DEF_ALPHA=0.0,
                                        K_DESSIC = 1.25E-6,     ),
                              TRACTION=_F( SIGM = CTRACB,          )
                                )

#

CM=AFFE_MATERIAU(    MAILLAGE=MAGE,
                            AFFE=_F( TOUT = 'OUI',
                                  MATER = MAT ),
                            AFFE_VARC=(_F(TOUT='OUI',
                                         EVOL=RESUSECH,
                                         NOM_VARC="SECH",
                                         NOM_CHAM='TEMP',
                                         VALE_REF=C_0),
                                      _F(TOUT='OUI',
                                         EVOL=RESUTHER,
                                         NOM_VARC="TEMP",
                                         NOM_CHAM='TEMP',
                                         VALE_REF=15.),),
);
#

CHMECA=AFFE_CHAR_MECA(
                            MODELE=MOMECA,
                          DDL_IMPO=_F( GROUP_NO = 'A1',
                                    DY = 0.,         ),
                            )

#

CHME=AFFE_CHAR_MECA(
                            MODELE=MOMECA,
                          PRES_REP=_F(  GROUP_MA = 'L_INT',
                                     PRES = -15.50,       )
                        )

#
LISTMECA=DEFI_LIST_REEL(
             DEBUT=0.,INTERVALLE=(
        _F( JUSQU_A = 3.15360E+04,       NOMBRE = 1,  ), #  0.0001 A
        _F( JUSQU_A = 3.15360E+05,       NOMBRE = 1,  ), #   0.001 A
        _F( JUSQU_A = 3.15360E+07,       NOMBRE = 10, ), #   0.001 A
        _F( JUSQU_A = 1.70294E+09,       NOMBRE = 20, )) #  54   ANS
                          )

#

RESUMECA=STAT_NON_LINE(
                            MODELE=MOMECA,
                        CHAM_MATER=CM,EXCIT=(
                             _F(
                CHARGE = CHMECA,
                ),
                             _F(
                CHARGE = CHME,
                )),
                         COMP_INCR=_F(
                RELATION = 'VMIS_ISOT_TRAC',
                ),
                            NEWTON=_F(
                MATRICE = 'TANGENTE',
                REAC_ITER = 3,
                ),
                         INCREMENT=_F(
                LIST_INST = LISTMECA,
#                NUME_INST_FIN    : 1
                ),
                           SOLVEUR=_F(
                METHODE = 'LDLT',
                RENUM = 'RCMK',
                ),
                ARCHIVAGE=_F(DETR_NUME_SUIV='OUI'),
              )

#
# VALEURS DE REFERENCE ASTER DE LA VERSION 7.3.1

TEST_RESU(
           RESU=_F(  RESULTAT = RESUMECA,   NOM_CHAM = 'DEPL',  INST     = 1.70294E+09,
             GROUP_NO = 'A2',   NOM_CMP = 'DX',    VALE = -1.8582096E-01,
              REFERENCE = 'NON_REGRESSION', VERSION = '7.3.1'   )
            )

#

RESUSTAT=MECA_STATIQUE( MODELE=MOMECA,
                        CHAM_MATER=CM,
                        EXCIT=(_F(CHARGE = CHMECA,  ),
                               _F(CHARGE = CHME,    )),
                        LIST_INST=LISTMECA,
                        SOLVEUR=_F(METHODE = 'LDLT',
                                   RENUM   = 'RCMK', )
                       )

#

TEST_RESU(
           RESU=_F(  RESULTAT = RESUSTAT,   NOM_CHAM = 'DEPL',  INST     = 1.70294E+09,
             GROUP_NO = 'A2',   NOM_CMP = 'DX',    VALE = -2.780327E-01,
             REFERENCE = 'NON_REGRESSION', VERSION = '7.3.21' )
            )

#
FIN()
#
