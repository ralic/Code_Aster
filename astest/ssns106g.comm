# MODIF  DATE 20/07/2009   AUTEUR GENIAUT S.GENIAUT 
# RESPONSABLE SFAYOLLE S.FAYOLLE
# TITRE  : ENDOMMAGEMENT D UNE PLAQUE PLANE SOUS SOLLICITATIONS VARIEES
# ssns106g.para = tps_job 120 mem_job 64Mo ncpus 1 liste_test S
#            CONFIGURATION MANAGEMENT OF EDF VERSION
# ======================================================================
# COPYRIGHT (C) 1991 - 2007  EDF R&D                  WWW.CODE-ASTER.ORG
# THIS PROGRAM IS FREE SOFTWARE; YOU CAN REDISTRIBUTE IT AND/OR MODIFY  
# IT UNDER THE TERMS OF THE GNU GENERAL PUBLIC LICENSE AS PUBLISHED BY  
# THE FREE SOFTWARE FOUNDATION; EITHER VERSION 2 OF THE LICENSE, OR     
# (AT YOUR OPTION) ANY LATER VERSION.                                                    
#                                                                       
# THIS PROGRAM IS DISTRIBUTED IN THE HOPE THAT IT WILL BE USEFUL, BUT   
# WITHOUT ANY WARRANTY; WITHOUT EVEN THE IMPLIED WARRANTY OF            
# MERCHANTABILITY OR FITNESS FOR A PARTICULAR PURPOSE. SEE THE GNU      
# GENERAL PUBLIC LICENSE FOR MORE DETAILS.                              
#                                                                       
# YOU SHOULD HAVE RECEIVED A COPY OF THE GNU GENERAL PUBLIC LICENSE     
# ALONG WITH THIS PROGRAM; IF NOT, WRITE TO EDF R&D CODE_ASTER,         
#    1 AVENUE DU GENERAL DE GAULLE, 92141 CLAMART CEDEX, FRANCE.        
# ======================================================================

#  DETAILS : MODELISATION : MULTI-COUCHES
#                          (DKT- ENDO_ISOT_BETON+2*GRILLE ACIER)
#                                           VS.
#                           DKTG (GLRC_DM)
#            MAILLAGE     : TRIA3
#            CHARGEMENT   : CYCLIQUE CISAILLEMENT

DEBUT(CODE=_F(NOM='SSNS106G',NIV_PUB_WEB='INTERNET',),);

PRE_GIBI();

EP = 0.1
DCIS= 6.0E-4
t1 = 1.0
t2 = 2*t1
t3 = 3.0*t1
#dt = 0.05
dt = 0.25
fx = 5E5

MAIL=LIRE_MAILLAGE();

MAIL=DEFI_GROUP(reuse =MAIL,
                MAILLAGE=MAIL,
                CREA_GROUP_NO=(_F(GROUP_MA='A1A2',),
                               _F(GROUP_MA='A4A3' ,),
                               _F(GROUP_MA='A2A4' ,),
                               _F(GROUP_MA='A3A1' ,),
                             ),);

MAIL=MODI_MAILLAGE(reuse=MAIL,
                   MAILLAGE=MAIL,
                   ORIE_NORM_COQUE=_F(GROUP_MA='DALLE',
                                      VECT_NORM=(0.,0.,1.),
                                      GROUP_NO='A1',),
                   );

MA=CREA_MAILLAGE(MAILLAGE=MAIL,
                  CREA_GROUP_MA=(
                                 _F(NOM = 'ACIER2L',
                                   PREF_MAILLE = 'A2L',
                                   GROUP_MA = 'DALLE',),
                                 _F(NOM = 'ACIER1T',
                                   PREF_MAILLE = 'A1T',
                                   GROUP_MA = 'DALLE',),
                                 _F(NOM = 'ACIER2T',
                                   PREF_MAILLE = 'A2T',
                                   GROUP_MA = 'DALLE',), 
                                 _F(NOM = 'ACIER1L',
                                   PREF_MAILLE = 'A1L',
                                   GROUP_MA = 'DALLE',), 
                                 _F(NOM = 'ACIER1',
                                   PREF_MAILLE = 'A1',
                                   GROUP_MA = 'DALLE',),
                                 _F(NOM = 'DALLE_G',
                                   PREF_MAILLE = 'G',
                                   GROUP_MA = 'DALLE',),
                                 _F(NOM = 'ACIER2',
                                   PREF_MAILLE = 'A2',
                                   GROUP_MA = 'DALLE',),
                                ),   
                 )

MO=AFFE_MODELE(INFO=1,
                 MAILLAGE=MA,
                 AFFE=(
                       _F(PHENOMENE='MECANIQUE',
                          GROUP_MA='DALLE',
                          MODELISATION='DKT'),
                        _F(PHENOMENE='MECANIQUE',
                          GROUP_MA='ACIER1L',
                          MODELISATION='GRILLE_EXCENTRE'
                          ),
                       _F(PHENOMENE='MECANIQUE',
                          GROUP_MA='ACIER1T',
                          MODELISATION='GRILLE_EXCENTRE'
                          ),
                       _F(PHENOMENE='MECANIQUE',
                          GROUP_MA='ACIER2L',
                          MODELISATION='GRILLE_EXCENTRE'
                          ),
                       _F(PHENOMENE='MECANIQUE',
                          GROUP_MA='ACIER2T',
                          MODELISATION='GRILLE_EXCENTRE'
                          ),
                 )
                 );

MO_G=AFFE_MODELE(INFO=1,
               MAILLAGE=MA,
              AFFE = _F(PHENOMENE='MECANIQUE',
                          GROUP_MA='DALLE_G',
                          MODELISATION='DKTG'),
              )

E = 3.2308E10
BETON_E=DEFI_MATERIAU(
                      ELAS=(_F(
                               E=E,
                               NU=0.2,
                               RHO=2500)),
                       BETON_ECRO_LINE=_F(
                       SYT = 3.4E6,
                       D_SIGM_EPSI = -0.20*E)
               )

ACIER = DEFI_MATERIAU(INFO=1,
                       ELAS=(_F(AMOR_ALPHA=3.7771128018011707E-05,
                                E=2.E11,
                                NU=0.2,
                                RHO=7800.0,
                                AMOR_BETA=2.6476993459625175)),
                       ECRO_LINE=(_F(
#                                     SY=5.70000000E8,
                                     SY=5.0E7,
                                     D_SIGM_EPSI= 3.0*E
                                     )
                                 ),
                       );

EGM =5.45E10*0.78
EGF = 7.32E10
NUF = 0.12

MAT_G = DEFI_MATERIAU(
                      ELAS  =_F(
                                 E = EGM,
                                 NU=  0.16,
                              ),
                     GLRC_DM =_F(
                                        GAMMA_T = 0.225,
                                        GAMMA_F = 0.6,
                                        SYT     = 3.6E5,
                                        SYF     = 1.6E4,
                                        EF      = EGF,
                                        NUF     = NUF,
                                       ),
                     ECRO_LINE=_F(  D_SIGM_EPSI = EGM*0.1,
                                    SY = 11.E6
                                 )
                                          )

MATER=AFFE_MATERIAU( MAILLAGE=MA,

                     AFFE=(
                          _F(GROUP_MA='DALLE_G',
                               MATER=MAT_G),
                          _F(GROUP_MA='DALLE',
                               MATER=BETON_E),
                          _F(GROUP_MA = 'ACIER1',
                               MATER=ACIER),
                          _F(GROUP_MA = 'ACIER2',
                               MATER=ACIER),
                          _F(GROUP_MA = 'ACIER1L',
                               MATER=ACIER),
                          _F(GROUP_MA = 'ACIER1T',
                               MATER=ACIER),
                          _F(GROUP_MA = 'ACIER2L',
                               MATER=ACIER),
                          _F(GROUP_MA = 'ACIER2T',
                               MATER=ACIER),
                      )
                    )

CAEL=AFFE_CARA_ELEM(INFO=1,
                      COQUE=(
                             _F(EPAIS=EP,
                                GROUP_MA='DALLE',
                                COQUE_NCOU=11,
                                INER_ROTA = 'OUI',
                                ANGL_REP=(0.0,0.0,),
                                MODI_METRIQUE='NON')),
                      MODELE=MO,
                       GRILLE=(
                              _F(
                                 GROUP_MA='ACIER1L',
                                 SECTION=5.0E-3,
                                 EXCENTREMENT = -EP*0.4,
                                 ANGL_REP=(0,0,),
                                 GRILLE_NCOU=1,
                                 COEF_RIGI_DRZ=1.E-10),
                              _F(
                                 GROUP_MA='ACIER1T',
                                 SECTION=5.0E-3,
                                 EXCENTREMENT = -EP*0.4,
                                 ANGL_REP=(90,0,),
                                 GRILLE_NCOU=1,
                                 COEF_RIGI_DRZ=1.E-10),
                              _F(GROUP_MA='ACIER2L',
                                 SECTION=5.0E-3,
                                 EXCENTREMENT = EP*0.4,
                                 ANGL_REP=(0,0,),
                                 GRILLE_NCOU=1,
                                 COEF_RIGI_DRZ=1.E-10),
                              _F(GROUP_MA='ACIER2T',
                                 SECTION=5.0E-3,
                                 EXCENTREMENT = EP*0.4,
                                 ANGL_REP=(90,0,),
                                 GRILLE_NCOU=1,
                                 COEF_RIGI_DRZ=1.E-10),
                       ),
                    )

CAEL_G=AFFE_CARA_ELEM(MODELE=MO_G,
                        COQUE=_F(GROUP_MA='DALLE_G',
                                 EPAIS=EP,
                                 INER_ROTA = 'OUI',
                                 ANGL_REP=(0.0,0.0),
                                ),
                        )

COND_0 = AFFE_CHAR_MECA(MODELE=MO,
                        DDL_IMPO=(_F(GROUP_NO='A1',
                                     DX=0.0,
                                     DY=0.0,
                                     DZ=0.0,
                                     DRX=0.0,
                                     DRY=0.0,
                                     DRZ=0.0,
                                     ),
                                 _F(GROUP_MA='A3A1',
                                     DX=0.0,
                                     DY=0.0,
#                                      DRY=0.0,
#                                      DRX=0.0,
                                      ),
                                  ),
                       )

COND_1 = AFFE_CHAR_MECA(MODELE=MO,
                       DDL_IMPO=(
                                 _F(GROUP_MA='A2A4',
                                       DY=DCIS,
                                      ),
                                 ),
                       );

chf1 = DEFI_FONCTION(NOM_PARA='INST',
                     VALE=(0.0, 0.0,
                           t1 ,     1.,
                           t2 ,    -1.,
                           t3 ,     0.,
                           ),
                     PROL_DROITE='CONSTANT',
                     PROL_GAUCHE='CONSTANT',
                    );

inst1=DEFI_LIST_REEL(DEBUT=0.0,INTERVALLE=(
                          _F(JUSQU_A = t3,PAS = dt),
                      ),);

RESU1 = STAT_NON_LINE(
                     NEWTON=_F(
                              REAC_ITER=1,
                              PAS_MINI_ELAS=0.0,
                              MATRICE='TANGENTE',
                              REAC_INCR=1),


                      MODELE=MO,
                      CHAM_MATER= MATER,
                      CARA_ELEM = CAEL,
                      COMP_INCR=(_F(RESO_INTE='IMPLICITE',
                                    GROUP_MA='DALLE',
                                    RESI_INTE_RELA=1.0E-06,
                                    ITER_INTE_PAS=0,
                                    ALGO_1D='ANALYTIQUE',
                                    ITER_INTE_MAXI=10,
                                    RELATION='ENDO_ISOT_BETON',
                                    ALGO_C_PLAN='DEBORST',
                                    DEFORMATION='PETIT'),
                                 _F(RESO_INTE='IMPLICITE',
                                    GROUP_MA=('ACIER1L','ACIER2L',
                                              'ACIER1T','ACIER2T'),
                                    RESI_INTE_RELA=1.0E-06,
                                    ITER_INTE_PAS=0,
                                    ALGO_1D='ANALYTIQUE',
                                    ITER_INTE_MAXI=10,
                                     RELATION='GRILLE_ISOT_LINE',
                                    ALGO_C_PLAN='ANALYTIQUE',
                                    DEFORMATION='PETIT'),
                                  ),
                      CONVERGENCE=(_F(
                                      ITER_GLOB_MAXI=25,
                                      )),
                      INCREMENT=_F( LIST_INST = inst1,
                                    PRECISION =1.E-1,
                                  ),
                      EXCIT=(
                             _F( CHARGE = COND_0,
                                    FONC_MULT = chf1 ),
                             _F( CHARGE = COND_1,
                                    FONC_MULT = chf1 ),
                            ),
                     );

RESU1=CALC_NO(reuse = RESU1,
               OPTION='FORC_NODA',
               PRECISION=1.E-3,
               RESULTAT=RESU1,
               MODELE=MO,
               CHAM_MATER=MATER,
               );

RESU_G = STAT_NON_LINE(
                     CONVERGENCE=_F(
                                     ITER_GLOB_MAXI=25,
                                     ),
                     NEWTON=_F(
                              REAC_ITER=1, # FULL_MECA
                              PAS_MINI_ELAS=0.0,
                              MATRICE='TANGENTE',
                              REAC_INCR=1),


                      MODELE=MO_G,
                      CHAM_MATER= MATER,
                      CARA_ELEM = CAEL_G,
                      COMP_INCR=_F(
                                   RELATION ='KIT_DDI',
                                   RELATION_KIT = ('GLRC_DM','VMIS_ISOT_LINE'),
                                   ITER_MAXI_DEBORST = 15,
                                  ),
                      INCREMENT=_F( LIST_INST = inst1,
                                    PRECISION =1.E-1,
                                  ),
                      EXCIT=(
                             _F( CHARGE = COND_0,
                                    FONC_MULT = chf1 ),
                             _F( CHARGE = COND_1,
                                    FONC_MULT = chf1 ),
                            ),
                     );

RESU_G=CALC_NO(reuse = RESU_G,
               OPTION='FORC_NODA',
               PRECISION=1.E-3,
               RESULTAT=RESU_G,
               MODELE=MO_G,
               CHAM_MATER=MATER,
               );

TDXA4 = POST_RELEVE_T(ACTION=_F(INTITULE='A4DX',
                               GROUP_NO = 'A4',
                              RESULTAT=RESU1,
                              NOM_CHAM='DEPL',
                              NOM_CMP='DX',
                              OPERATION='EXTRACTION',),);

TDXA4_G = POST_RELEVE_T(ACTION=_F(INTITULE='A4DX',
                               GROUP_NO = 'A4',
                              RESULTAT=RESU_G,
                              NOM_CHAM='DEPL',
                              NOM_CMP='DX',
                              OPERATION='EXTRACTION',),);

TFYA4 = POST_RELEVE_T(ACTION=_F(INTITULE='A4FY',
                               GROUP_NO = 'A4',
                              RESULTAT=RESU1,
                              NOM_CHAM='FORC_NODA',
                              NOM_CMP='DY',
                              OPERATION='EXTRACTION',),);

TFYA4_G = POST_RELEVE_T(ACTION=_F(INTITULE='A4FY',
                               GROUP_NO = 'A4',
                              RESULTAT=RESU_G,
                              NOM_CHAM='FORC_NODA',
                              NOM_CMP='DY',
                              OPERATION='EXTRACTION',),);

FORM_Y = FORMULE(NOM_PARA=('DY','DYG'),VALE='(DY-DYG)/DY')
FORM_X = FORMULE(NOM_PARA=('DX','DXG'),VALE='(DX-DXG)/DX')

TDXA4_G0 = CALC_TABLE(TABLE = TDXA4_G,
                      ACTION = _F (OPERATION = 'EXTR',
                      NOM_PARA = ('INST','DX')))

TFYA4_G0 = CALC_TABLE(TABLE = TFYA4_G,
                      ACTION = _F (OPERATION = 'EXTR',
                                   NOM_PARA = ('INST','DY')))

TDXA4_G1 = CALC_TABLE(TABLE = TDXA4_G0,
                      ACTION = _F(OPERATION = 'RENOMME',
                                   NOM_PARA = ('DX','DXG')))

TFYA4_G1 = CALC_TABLE(TABLE = TFYA4_G0,
                      ACTION = _F(OPERATION = 'RENOMME',
                                   NOM_PARA = ('DY','DYG')))

TDXA4_G2 = CALC_TABLE(TABLE = TDXA4,
                      ACTION = _F(OPERATION = 'COMB',
                                  TABLE = TDXA4_G1,
                                  NOM_PARA = ('INST')))

TFYA4_G2 = CALC_TABLE(TABLE = TFYA4,
                      ACTION = _F(OPERATION = 'COMB',
                                  TABLE = TFYA4_G1,
                                  NOM_PARA = ('INST')))

DETRUIRE(CONCEPT = _F(NOM =TDXA4_G1))
DETRUIRE(CONCEPT = _F(NOM =TFYA4_G1))

D_DXA4 = CALC_TABLE(TABLE = TDXA4_G2,
                    ACTION = _F (OPERATION = 'OPER',
                                 FORMULE = FORM_X,
                                 NOM_PARA = ('DX_DXG')))
D_FYA4 = CALC_TABLE(TABLE = TFYA4_G2,
                    ACTION = _F (OPERATION = 'OPER',
                                  FORMULE = FORM_Y,
                                  NOM_PARA = ('DY_DYG')))

DETRUIRE(CONCEPT = _F(NOM =TDXA4_G2))
DETRUIRE(CONCEPT = _F(NOM =TFYA4_G2))

TEST_TABLE(TABLE=D_DXA4,
           FILTRE=_F(NOM_PARA='INST',VALE=t1*0.25,),
           NOM_PARA='DX_DXG',
           VALE = 0.0,
           CRITERE = 'ABSOLU',
           PRECISION = 25.0E-2,
           REFERENCE='AUTRE_ASTER',)

TEST_TABLE(TABLE=D_FYA4,
           FILTRE=_F(NOM_PARA='INST',VALE=t1*0.25,),
           NOM_PARA='DY_DYG',
           VALE = 0.0,
           CRITERE = 'ABSOLU',
           PRECISION = 5.0E-2,
           REFERENCE='AUTRE_ASTER',)

TEST_TABLE(TABLE=TFYA4_G0,
           FILTRE=_F(NOM_PARA='INST',VALE=t1,),
           NOM_PARA='DY',
           VALE = 3.17911E+03,
           CRITERE = 'RELATIF',
           PRECISION = 1.E-4,
           REFERENCE='NON_REGRESSION',)

TEST_TABLE(TABLE=D_DXA4,
           FILTRE=_F(NOM_PARA='INST',VALE=t2,),
           NOM_PARA='DX_DXG',
           VALE = -2.52955E-01,
           PRECISION = 1.0E-4,
           REFERENCE='NON_REGRESSION',)

TEST_TABLE(TABLE=D_FYA4,
           FILTRE=_F(NOM_PARA='INST',VALE=t2,),
           NOM_PARA='DY_DYG',
           VALE = 0.0,
           CRITERE = 'ABSOLU',
           PRECISION = 25.0E-2,
           REFERENCE='AUTRE_ASTER',)

TEST_TABLE(TABLE=TFYA4_G0,
           FILTRE=_F(NOM_PARA='INST',VALE=t2,),
           NOM_PARA='DY',
           VALE = -2.89607E+03,
           CRITERE = 'RELATIF',
           PRECISION = 1.E-4,
           REFERENCE='NON_REGRESSION',)

TEST_TABLE(TABLE=TFYA4_G0,
           FILTRE=_F(NOM_PARA='INST',VALE=t3,),
           NOM_PARA='DY',
           VALE = 3.07974E+01,
           CRITERE = 'RELATIF',
           PRECISION = 1.E-4,
           REFERENCE='NON_REGRESSION',)


FIN();
