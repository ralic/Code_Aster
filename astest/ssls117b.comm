# person_in_charge: jean-michel.proix at edf.fr
# TITRE PLAQUE STRATIFIEE EN FLEXION
#            CONFIGURATION MANAGEMENT OF EDF VERSION
# ======================================================================
# COPYRIGHT (C) 1991 - 2012  EDF R&D                  WWW.CODE-ASTER.ORG
# THIS PROGRAM IS FREE SOFTWARE; YOU CAN REDISTRIBUTE IT AND/OR MODIFY
# IT UNDER THE TERMS OF THE GNU GENERAL PUBLIC LICENSE AS PUBLISHED BY
# THE FREE SOFTWARE FOUNDATION; EITHER VERSION 2 OF THE LICENSE, OR
# (AT YOUR OPTION) ANY LATER VERSION.
#
# THIS PROGRAM IS DISTRIBUTED IN THE HOPE THAT IT WILL BE USEFUL, BUT
# WITHOUT ANY WARRANTY; WITHOUT EVEN THE IMPLIED WARRANTY OF
# MERCHANTABILITY OR FITNESS FOR A PARTICULAR PURPOSE. SEE THE GNU
# GENERAL PUBLIC LICENSE FOR MORE DETAILS.
#
# YOU SHOULD HAVE RECEIVED A COPY OF THE GNU GENERAL PUBLIC LICENSE
# ALONG WITH THIS PROGRAM; IF NOT, WRITE TO EDF R&D CODE_ASTER,
#    1 AVENUE DU GENERAL DE GAULLE, 92141 CLAMART CEDEX, FRANCE.
# ======================================================================
# PLAQUE DE STRATIFIE RECTANGULAIRE EXCENTREE
# CALCUL : 2 MONOCOUCHES EXCENTRES
# SOLUTION ANALYTIQUE DE PLAQUE SANS CT
# MODELISATION DKT
# ------------------------------------------------
#
#                 MAILLES TRI3
#----------------------------------------------------------------------
#POINTS:  A4                          A3
#           -------------------------
#           -                       -
#           -                       -
#           -                       -
#           -                       -
#           -------------------------
#         A1                          A2
#
# ______________________________________________________________________

DEBUT(CODE=_F(NOM='SSLS117B',NIV_PUB_WEB='INTERNET'),DEBUG=_F(SDVERI='OUI'))

# parametres
h = 0.8;       # epaisseur
hs2 = h/2
# hs4 = h/4      # excentrement sup
# hs4m = -hs4    # excentrement inf

h = 0.6;       # epaisseur
hs2 = h/2
# h2a = h/3      # excentrement sup
# h2b = 2*(h/3)  # excentrement inf
exce1 = 0.1
exce2 = -0.2


E = 200000000000.0;
Nu=0.0
G = E/2/(1.0+Nu)

# chargement
frep = -1000.0;

# solution analytique
L=10.0
b=5.0
I=b*h*h*h/12.0
u_l = frep*b*L*L*L/3/E/I
T=frep
M=-T*L

# Materiau

# MATA=DEFI_MATERIAU(ELAS_ORTH=_F(E_L=E,
#                                 E_T=E,
#                                 NU_LT=0.0,
#                                 G_LT=G,
#                                 RHO=1000.0,),);

MATISO=DEFI_MATERIAU(ELAS=_F(E=E,
                             NU=0.0,
                             RHO=1000.0,),);

# ______________________________________________________________________
#
#                         2 PLAQUES EXCENTREES
# ______________________________________________________________________

MA0=LIRE_MAILLAGE(VERI_MAIL=_F(VERIF='OUI',),FORMAT='MED',);


# creation de plaq2 : meme noeuds que plaq1 mais mailles distinctes

MA1=CREA_MAILLAGE(MAILLAGE=MA0,
                  CREA_GROUP_MA=_F(NOM = 'PLAQ2',
                                   PREF_MAILLE = 'B',
                                   GROUP_MA = 'PLAQ1',)
                 )

MA1=DEFI_GROUP(reuse =MA1,
               MAILLAGE=MA1,
               CREA_GROUP_NO=(_F(GROUP_MA='PLAQ1',
                                 NOM='PLAQ1',),
                              _F(GROUP_MA='PLAQ2',
                                 NOM='PLAQ2',),),);

MO2=AFFE_MODELE(MAILLAGE=MA1,
                AFFE=_F(GROUP_MA=('PLAQ1','PLAQ2','L12',),
                        PHENOMENE='MECANIQUE',
                        MODELISATION='DKT',),);

EP2=AFFE_CARA_ELEM(MODELE=MO2,
                   COQUE=(_F(GROUP_MA=('PLAQ1','L12'),
                             EPAIS=hs2,
                             ANGL_REP=(0.0,0.0,),
                             EXCENTREMENT=exce1,
                             INER_ROTA='OUI',),
                          _F(GROUP_MA='PLAQ2',
                             EPAIS=hs2,
                             ANGL_REP=(0.0,0.0,),
                             EXCENTREMENT=exce2,
                             INER_ROTA='OUI',),),);

CHMAT2=AFFE_MATERIAU(MAILLAGE=MA1,
                     AFFE=(_F(GROUP_MA='PLAQ1',
                              MATER=MATISO,),
                           _F(GROUP_MA='PLAQ2',
                              MATER=MATISO,),),);

# egalite des deplacements car ils sont calcules sur le plan mail

CL2=AFFE_CHAR_MECA(MODELE=MO2,
                     DDL_IMPO=(_F(GROUP_MA='L14',
                                  DX=0.0,
                                  DY=0.0,
                                  DZ=0.0,
                                  DRX=0.0,
                                  DRY=0.0,
                                  DRZ=0.0,),),
                                     );

CHME2A=AFFE_CHAR_MECA(MODELE=MO2,
                      FORCE_ARETE=_F(GROUP_MA='L12',
                                      FZ=frep),);

ASSEMBLAGE(MODELE=MO2,
                CHAM_MATER=CHMAT2,
                CARA_ELEM=EP2,
                CHARGE=CL2,
                NUME_DDL=CO('NU2'),
                MATR_ASSE=(_F(MATRICE=CO('MATASS2'),
                              OPTION='RIGI_MECA',),
                           _F(MATRICE=CO('MATASM2'),
                              OPTION='MASS_MECA',),),);

MODE2=MODE_ITER_SIMULT(MATR_RIGI=MATASS2,
                       MATR_MASS=MATASM2,
                       CALC_FREQ=_F(OPTION='PLUS_PETITE',
                                    NMAX_FREQ=4,),);

RESU2A=MECA_STATIQUE(MODELE=MO2,
                CHAM_MATER=CHMAT2,
                CARA_ELEM=EP2,
               EXCIT=(
                      _F(CHARGE=CL2),
                      _F(CHARGE=CHME2A),
                      ),
                      )

RESU2A=CALC_CHAMP(reuse=RESU2A,RESULTAT=RESU2A,CONTRAINTE=('EFGE_ELNO'))




RESU2A=CALC_CHAMP(reuse=RESU2A,
                RESULTAT=RESU2A,
                CONTRAINTE='EFGE_NOEU',
                      )


# Test

TEST_RESU(RESU=_F(NUME_ORDRE=1,
                  GROUP_NO='A3',
                  REFERENCE='ANALYTIQUE',
                  RESULTAT=RESU2A,
                  NOM_CHAM='DEPL',
                  NOM_CMP='DZ',
                  VALE_CALC=-9.25920355E-05,
                  VALE_REFE=-9.2592592592592615E-05,
                  PRECISION=5.0000000000000001E-3,),
          )

TEST_RESU(RESU=_F(NUME_ORDRE=1,
                  GROUP_NO='A1',
                  REFERENCE='ANALYTIQUE',
                  RESULTAT=RESU2A,
                  NOM_CHAM='EFGE_NOEU',
                  NOM_CMP='QX',
                  VALE_CALC=-550.584167416,
                  VALE_REFE=-500.0,
                  PRECISION=0.14999999999999999,),
          )

TEST_RESU(RESU=_F(NUME_ORDRE=1,
                  GROUP_NO='A1',
                  REFERENCE='ANALYTIQUE',
                  RESULTAT=RESU2A,
                  NOM_CHAM='EFGE_NOEU',
                  NOM_CMP='MXX',
                  VALE_CALC= 5.00726513E+03,
                  VALE_REFE=5000.0,
                  PRECISION=3.0000000000000001E-3,),
          )

TEST_RESU(RESU=(_F(NUME_ORDRE=1,
                   PARA='FREQ',
                   RESULTAT=MODE2,
                   VALE_CALC=13.699999999999999,
                   TOLE_MACHINE=1.E-3,
                   CRITERE='RELATIF',
                   ),
                _F(NUME_ORDRE=2,
                   PARA='FREQ',
                   RESULTAT=MODE2,
                   VALE_CALC=66.650000000000006,
                   TOLE_MACHINE=1.E-3,
                   CRITERE='RELATIF',
                   ),
                _F(NUME_ORDRE=3,
                   PARA='FREQ',
                   RESULTAT=MODE2,
                   VALE_CALC=85.489999999999995,
                   TOLE_MACHINE=1.E-3,
                   CRITERE='RELATIF',
                   ),
                _F(NUME_ORDRE=4,
                   PARA='FREQ',
                   RESULTAT=MODE2,
                   VALE_CALC=100.09999999999999,
                   TOLE_MACHINE=1.E-3,
                   CRITERE='RELATIF',
                   ),
                ),
          )

# Sensibilite des resultats le long des aretes

# IMPR_RESU(RESU=_F(RESULTAT=RESU2A,GROUP_MA='L12',))
# IMPR_RESU(RESU=_F(RESULTAT=RESU2A,GROUP_MA='L14',))

FIN();
