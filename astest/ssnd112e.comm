# MODIF  DATE 10/09/2012   AUTEUR PROIX J-M.PROIX 
# TITRE : EFFET DE ROTATION DE RESEAU SUR UN CUBE MONOCRISTALLIN DD_CFC_IRRA
# ssnd112e.para = tps_job 120 mem_job 473Mo ncpus 1 liste_test S
#            CONFIGURATION MANAGEMENT OF EDF VERSION
# ======================================================================
# COPYRIGHT (C) 1991 - 2012  EDF R&D                  WWW.CODE-ASTER.ORG
# THIS PROGRAM IS FREE SOFTWARE; YOU CAN REDISTRIBUTE IT AND/OR MODIFY  
# IT UNDER THE TERMS OF THE GNU GENERAL PUBLIC LICENSE AS PUBLISHED BY  
# THE FREE SOFTWARE FOUNDATION; EITHER VERSION 2 OF THE LICENSE, OR     
# (AT YOUR OPTION) ANY LATER VERSION.                                                    
#                                                                       
# THIS PROGRAM IS DISTRIBUTED IN THE HOPE THAT IT WILL BE USEFUL, BUT   
# WITHOUT ANY WARRANTY; WITHOUT EVEN THE IMPLIED WARRANTY OF            
# MERCHANTABILITY OR FITNESS FOR A PARTICULAR PURPOSE. SEE THE GNU      
# GENERAL PUBLIC LICENSE FOR MORE DETAILS.                              
#                                                                       
# YOU SHOULD HAVE RECEIVED A COPY OF THE GNU GENERAL PUBLIC LICENSE     
# ALONG WITH THIS PROGRAM; IF NOT, WRITE TO EDF R&D CODE_ASTER,         
#    1 AVENUE DU GENERAL DE GAULLE, 92141 CLAMART CEDEX, FRANCE.        
# ======================================================================

DEBUT(CODE=_F(NOM='SSND112E',NIV_PUB_WEB='INTERNET',VISU_EFICAS='NON'),DEBUG=_F(SDVERI='OUI'));


import numpy as NP

E=173000.

NU = 0.3

MU = E/(2*(1.+NU))


TAU_F  = 20.
RHO_0  = 1.E6    # en mm**-2
RHOREF = 1.E6    # en mm**-2
# N      = 200.
N      = 50.
GAMMA0 = 1.E-3
ALPHA  = 0.35
BETA   = 2.54E-7     # 2.54 Angstrom
A      = 0.13
B      = 0.005
Y      = 2.5E-7  # 2.5 Angstrom

RHO_0 = RHO_0*BETA*BETA


RHO_LOOPS=RHO_0*2.
PHI_VOIDS=1.e-3



MAIL = LIRE_MAILLAGE();

MAIL = DEFI_GROUP(reuse = MAIL,
                  MAILLAGE = MAIL,
                  CREA_GROUP_MA=(_F(NOM='VOL' , TOUT='OUI', TYPE_MAILLE='3D',),
                                 ),
                                )

MAIL = MODI_MAILLAGE(reuse = MAIL,
                     MAILLAGE = MAIL,
                     ORIE_PEAU_3D=_F(GROUP_MA=('Z0','Z1',),),
                     );

TROISD = AFFE_MODELE(MAILLAGE = MAIL,
                     AFFE=(_F(TOUT='OUI',
                              PHENOMENE='MECANIQUE',
                            #  MODELISATION='3D_SI',
                              MODELISATION='3D',
                              ),
                           _F(GROUP_MA=('PX1',),
                              PHENOMENE='MECANIQUE',
                              MODELISATION='DIS_T',),
                           ),
                   );

ACIERDD = DEFI_MATERIAU(ELAS=_F(E=E,
                                NU=NU,
                                ALPHA=0.),
                        MONO_DD_CFC_IRRA=_F(TAU_F  = TAU_F,  # MPa
                                       Y      = Y      ,  # 2.5 Angstrom
                                       N      = N,
                                       GAMMA0 = GAMMA0,
                                       A      = A,
                                       B      = B,
                                       RHO_REF= RHOREF,    # en mm**-2
                                       ALPHA=ALPHA,
                                       BETA=BETA,          # 2.54 Angstrom
                                       H1      = 0.124,
                                       H2      = 0.625,
                                       H3      = 0.137,
                                       H4      = 0.122,
                                       H5      = 0.07,
                                       
                                     RHO_VOID=1.E3,
                                     PHI_LOOP=1.E-3,
                                     ALP_VOID=0.,
                                     ALP_LOOP=0.,
                                     RHO_SAT=RHO_0*2.,
                                     PHI_SAT=1.E-2,
                                     XI_IRRA=0.1,
                                     DZ_IRRA=0.2,
                                       
                                       
                                      ),
                       );

MAT=AFFE_MATERIAU(MAILLAGE=MAIL,
                  AFFE=_F(TOUT='OUI',
                          MATER=ACIERDD,),);

# DD_CFC
COMPORDD=DEFI_COMPOR(MONOCRISTAL=(_F(MATER=ACIERDD,
                                     ELAS='ELAS',
                                     ECOULEMENT='MONO_DD_CFC_IRRA',
                                     FAMI_SYST_GLIS='OCTAEDRIQUE',
                                    ),
                                 ),
                     );

TRAC=AFFE_CHAR_MECA(MODELE=TROISD,
                    DDL_IMPO=(
                              _F(GROUP_NO='ORIG', DX=0.0,DY=0.,DZ=0.),
                              _F(GROUP_MA='Z0', DZ=0.0,),
                              _F(GROUP_MA='Z1', DZ=1.0, ),
                              ),
                    INFO=1,
                   );
COEF=DEFI_FONCTION(NOM_PARA='INST',
                   VALE=(0.0,0.0,1.0,1.0,),
                   PROL_DROITE='LINEAIRE',
                   PROL_GAUCHE='LINEAIRE',
                   );

t1=0.0005
t2=0.002
tmax=0.2


LINSTDDE=DEFI_LIST_REEL(DEBUT=0.0,
                       INTERVALLE=(
                                   _F(JUSQU_A=t1,
                                      NOMBRE=50,),
                                  ),
                      );

LIS2DDE=DEFI_LIST_INST(INFO=1,
                        DEFI_LIST=_F(LIST_INST=LINSTDDE,
                                     METHODE='MANUEL',
                                     ),
                        ECHEC=_F(SUBD_NIVEAU=10,
                                 SUBD_PAS=10,
                                 ),
                        );

LINSTDD=DEFI_LIST_REEL(DEBUT=0.0,
                       INTERVALLE=(
                                   _F(JUSQU_A=t1,
                                      NOMBRE=5,),
                                   _F(JUSQU_A=t2,
                                      NOMBRE=5,),
                                   _F(JUSQU_A=tmax,
                                      NOMBRE=90,),
                                  ),
                      );


LIS2DD=DEFI_LIST_INST(INFO=1,
                        DEFI_LIST=_F(LIST_INST=LINSTDD,
                                     METHODE='MANUEL',
                                     ),
                        ECHEC=_F(SUBD_NIVEAU=10,
                                 SUBD_PAS=10,
                                 ),
                        );

# densites de dislocation initiales (cf zzzz130a)
nb_syst = 12

nvarsup=0

mode='gdef'

if mode=='hpp'  : nvarsup=0
if mode=='gdef' : nvarsup=9+9
if mode=='rota' : nvarsup=16

liste_var = tuple(['V' + str(i) for i in range(1, 6 + 3*nb_syst + 24+ 12+nvarsup + 3 + 1)])
liste_vale = 6*[0.0] + nb_syst*[RHO_0, 0.0, 0.0] +nb_syst*[RHO_LOOPS]  +nb_syst*[PHI_VOIDS]+(12+nvarsup + 3) *[0.0]

VAIN11= CREA_CHAMP(OPERATION = 'AFFE', TYPE_CHAM = 'ELGA_VARI_R', MODELE = TROISD,
                   AFFE=(_F(GROUP_MA = 'VOL', NOM_CMP = liste_var, VALE = liste_vale, ),
                         _F(GROUP_MA = 'PX1', NOM_CMP = 'V1', VALE = 0, ),
                        ),
                   );

NORME = FORMULE(VALE='sqrt(DX*DX+DY*DY+DZ*DZ)',
              NOM_PARA=('DX','DY','DZ',));

# Calcul des angles d'Euler correspondant a une orientation cristallographique donnee

h=-1
k=2
l=5

phi1=0
phi =NP.arccos(l / NP.sqrt( h*h + k*k + l*l) ) * 180. / NP.pi
phi2=NP.arctan2( h / NP.sqrt( h*h + k*k ) , k / NP.sqrt( h*h + k*k ) )* 180. / NP.pi

pena = 1.E4

ORIEN=AFFE_CARA_ELEM(MODELE=TROISD,
                     MASSIF=_F(GROUP_MA='VOL',ANGL_EULER=(phi1, phi, phi2),),
                     DISCRET=_F(GROUP_MA=('PX1',),
                                CARA='K_T_D_N',
                                VALE=(0.,pena,0.,),),
                     );


# premiere resolution : explicite. tes de SIMO_MIEHE + MONOCRISTAL + RUNGE_KUTTA

SOLEXPL=STAT_NON_LINE(MODELE = TROISD,
                    CHAM_MATER = MAT,
                    CARA_ELEM = ORIEN,
                    ETAT_INIT = _F(VARI=VAIN11,),
                    EXCIT=(_F(CHARGE=TRAC,
                              FONC_MULT=COEF,
                              ),
                          ),
                    COMP_INCR=(
                               _F(
                                  RELATION='MONOCRISTAL',COMPOR=COMPORDD,
                                  DEFORMATION='SIMO_MIEHE',
                                  ALGO_INTE='RUNGE_KUTTA',
                                  TOUT='OUI',),
                               _F(RELATION='ELAS',
                                  GROUP_MA=('PX1'),),
                              ),
                     INCREMENT=(_F(LIST_INST=LIS2DDE, INST_FIN=t1),),

                     NEWTON=(_F(REAC_ITER=0,REAC_INCR=0,PREDICTION='EXTRAPOLE'),),
                     CONVERGENCE=_F(ITER_GLOB_MAXI=20),
                     ARCHIVAGE=_F(LIST_INST=LINSTDD),

                     SUIVI_DDL=( _F(NOM_CMP    ='V7',
                                   NOM_CHAM   ='VARI_ELGA',
                                   GROUP_MA   ='VOL',
                                   EVAL_ELGA  ='MAX',
                                   EVAL_CHAM  ='MAX',),
                               _F(NOM_CMP    ='V31',
                                  NOM_CHAM   ='VARI_ELGA',
                                  GROUP_MA   ='VOL',
                                  EVAL_ELGA  ='MAX',
                                  EVAL_CHAM  ='MAX',),
                               _F(NOM_CMP    ='V40',
                                  NOM_CHAM   ='VARI_ELGA',
                                  GROUP_MA   ='VOL',
                                  EVAL_ELGA  ='MAX',
                                  EVAL_CHAM  ='MAX',),
                               _F(NOM_CMP    ='SIZZ',
                                  NOM_CHAM   ='SIEF_ELGA',
                                  GROUP_MA   ='VOL',
                                  EVAL_ELGA  ='MAX',
                                  EVAL_CHAM  ='MAX',),
                                 ),
                    );

# deuxieme resolution : implicite. test de SIMO_MIEHE + MONOCRISTAL + NEWTON
# pas de reprise car les variables internes ne correspondent pas tout a fait :
# FE puis FP pour l'implicite, FP puis FE pour l'explicite. A faire evoluer

SOLIMPN=STAT_NON_LINE(MODELE = TROISD,
                    ETAT_INIT = _F(VARI=VAIN11,),
                    CHAM_MATER = MAT,
                    CARA_ELEM = ORIEN,
                    EXCIT=(_F(CHARGE=TRAC,
                              FONC_MULT=COEF,
                              ),
                          ),
                    COMP_INCR=(
                               _F(
                                  RELATION='MONOCRISTAL',COMPOR=COMPORDD,
                                  DEFORMATION='SIMO_MIEHE',
                                  TOUT='OUI',),
                               _F(RELATION='ELAS',
                                  GROUP_MA=('PX1'),),
                              ),
                     INCREMENT=(_F(LIST_INST=LIS2DDE, INST_FIN=t1),),

                     NEWTON=(_F(REAC_ITER=1,PREDICTION='EXTRAPOLE'),),
                     CONVERGENCE=_F(ITER_GLOB_MAXI=20),
                     ARCHIVAGE=_F(LIST_INST=LINSTDD),

                     SUIVI_DDL=( _F(NOM_CMP    ='V7',
                                   NOM_CHAM   ='VARI_ELGA',
                                   GROUP_MA   ='VOL',
                                   EVAL_ELGA  ='MAX',
                                   EVAL_CHAM  ='MAX',),
                               _F(NOM_CMP    ='V31',
                                  NOM_CHAM   ='VARI_ELGA',
                                  GROUP_MA   ='VOL',
                                  EVAL_ELGA  ='MAX',
                                  EVAL_CHAM  ='MAX',),
                               _F(NOM_CMP    ='V40',
                                  NOM_CHAM   ='VARI_ELGA',
                                  GROUP_MA   ='VOL',
                                  EVAL_ELGA  ='MAX',
                                  EVAL_CHAM  ='MAX',),
                               _F(NOM_CMP    ='SIZZ',
                                  NOM_CHAM   ='SIEF_ELGA',
                                  GROUP_MA   ='VOL',
                                  EVAL_ELGA  ='MAX',
                                  EVAL_CHAM  ='MAX',),
                                 ),
                    );

# troisieme resolution : implicite. test de SIMO_MIEHE + MONOCRISTAL + NEWTON_PERT


SOLNL=STAT_NON_LINE(
                   # ETAT_INIT=_F(EVOL_NOLI=SOLNL),reuse=SOLNL,
                    ETAT_INIT = _F(VARI=VAIN11,),
                    MODELE = TROISD,
                    CHAM_MATER = MAT,
                    CARA_ELEM = ORIEN,
                    EXCIT=(_F(CHARGE=TRAC,
                              FONC_MULT=COEF,),),
                    COMP_INCR=(_F(
                                  RELATION='MONOCRISTAL',
                                  COMPOR=COMPORDD,
                                  DEFORMATION='SIMO_MIEHE',
                                  ITER_INTE_MAXI=100,
                                  ALGO_INTE='NEWTON_PERT',),
                               _F(RELATION='ELAS',
                                  GROUP_MA=('PX1'),),
                              ),
                     INCREMENT=(_F(LIST_INST=LIS2DD, INST_FIN=tmax),),

                     NEWTON=(_F(REAC_ITER=1,PREDICTION='EXTRAPOLE'),),

                     ARCHIVAGE=_F(LIST_INST=LINSTDD),

                     SUIVI_DDL=( _F(NOM_CMP    ='V7',
                                   NOM_CHAM   ='VARI_ELGA',
                                   GROUP_MA   ='VOL',
                                   EVAL_ELGA  ='MAX',
                                   EVAL_CHAM  ='MAX',),
                               _F(NOM_CMP    ='V31',
                                  NOM_CHAM   ='VARI_ELGA',
                                  GROUP_MA   ='VOL',
                                  EVAL_ELGA  ='MAX',
                                  EVAL_CHAM  ='MAX',),
                               _F(NOM_CMP    ='V40',
                                  NOM_CHAM   ='VARI_ELGA',
                                  GROUP_MA   ='VOL',
                                  EVAL_ELGA  ='MAX',
                                  EVAL_CHAM  ='MAX',),
                               _F(NOM_CMP    ='SIZZ',
                                  NOM_CHAM   ='SIEF_ELGA',
                                  GROUP_MA   ='VOL',
                                  EVAL_ELGA  ='MAX',
                                  EVAL_CHAM  ='MAX',),
                                 ),
                    );


SOLNL=CALC_CHAMP(reuse=SOLNL,RESULTAT=SOLNL,DEFORMATION=('EPSG_ELGA'))



nbnum=100
pas=20
ORD_MED = DEFI_LIST_ENTI(VALE = range(pas,nbnum+pas,pas),);

#IMPR_RESU(FORMAT='MED',RESU=_F(RESULTAT=SOLNL,LIST_ORDRE=ORD_MED,),);

#IMPR_RESU(RESU=_F(RESULTAT=SOLNL))

numpg=5

epsDIR=RECU_FONCTION(RESULTAT=SOLNL,
                   NOM_CHAM='EPSG_ELGA',
                   NOM_CMP='EPZZ',
                   MAILLE='CUBE',
                   POINT=numpg,
                   INTERPOL='LIN');

sigDIR=RECU_FONCTION(RESULTAT=SOLNL,
                   NOM_CHAM='SIEF_ELGA',
                   NOM_CMP='SIZZ',
                   MAILLE='CUBE',
                   POINT=numpg,
                   INTERPOL='LIN');

nom_cas='traction_cube-1_2_5'

DEFI_FICHIER(UNITE = 28,
             FICHIER = 'REPE_OUT/epdir_'+ nom_cas + '.dat');

IMPR_FONCTION(
            FORMAT='XMGRACE',
            PILOTE='',
            COURBE=(_F(FONCTION=epsDIR,
                       COULEUR= 0,
                       LEGENDE= 'Edir',),),
            UNITE=28,
            TITRE='Edir = f(INST)');

DEFI_FICHIER(UNITE = 28,
             ACTION = 'LIBERER');


DEFI_FICHIER(UNITE = 28,
                FICHIER = 'REPE_OUT/sigdir_'+ nom_cas + '.dat');

IMPR_FONCTION(
            FORMAT='XMGRACE',
            PILOTE='',
            COURBE=(_F(FONC_X=epsDIR,
                        FONC_Y=sigDIR,
                        COULEUR= 0,
                        LEGENDE= 'SIGdir',),),
            UNITE=28,
            TITRE='SIGdir = f(Edir)');

DEFI_FICHIER(UNITE = 28,
             ACTION = 'LIBERER');



gamma=[None]*13
rho=[None]*13

system=['', 'B4', 'B2', 'B5', 'D4', 'D1', 'D6', 'A2', 'A6', 'A3', 'C5', 'C3', 'C1']

DEFI_FICHIER(UNITE = 30,
             FICHIER = 'REPE_OUT/rho_eps_'+  nom_cas + '.dat');

DEFI_FICHIER(UNITE = 31,
             FICHIER = 'REPE_OUT/gamma_eps_'+ nom_cas + '.dat');

for i in range(1,13):


    gamma[i]=RECU_FONCTION(RESULTAT=SOLNL,
                   NOM_CHAM='VARI_ELGA',
                   MAILLE='CUBE',
                   POINT=numpg,
                   NOM_CMP='V'+str(8+3*(i-1)),
                           INTERPOL='LIN');

    rho[i]=RECU_FONCTION(RESULTAT=SOLNL,
                   NOM_CHAM='VARI_ELGA',
                   MAILLE='CUBE',
                   POINT=numpg,
                   NOM_CMP='V'+str(7+3*(i-1)),
                   INTERPOL='LIN');

    IMPR_FONCTION(
            FORMAT='XMGRACE',
            PILOTE='',
            LEGENDE_X='\\f{Symbol}e\\f{}\sll',
            LEGENDE_Y='\\f{Symbol}r',
            COURBE=(
                    _F(FONC_X=epsDIR,
                       FONC_Y=rho[i],
                       COULEUR = i,
                       MARQUEUR = i,
                       FREQ_MARQUEUR = 10,
                       LEGENDE= unicode(system[i],'iso-8859-1').encode('utf-8'),),),
            UNITE=30,);

    IMPR_FONCTION(
            FORMAT='XMGRACE',
            PILOTE='',
            LEGENDE_X='\\f{Symbol}e\\f{}\sll',
            LEGENDE_Y='\\f{Symbol}g',
            COURBE=(
                    _F(FONC_X=epsDIR,
                       FONC_Y=gamma[i],
                       COULEUR= i,
                       MARQUEUR = i,
                       FREQ_MARQUEUR = 10,
                       LEGENDE= unicode(system[i],'iso-8859-1').encode('utf-8'),),),
            UNITE=31,);

DEFI_FICHIER(UNITE = 30,
             ACTION = 'LIBERER');

DEFI_FICHIER(UNITE = 31,
             ACTION = 'LIBERER');

# Comparaison avec la modelisation C : HPP

# instant ou les deformations sont petites : modelisation A, B , C comparables

tdep=0.02

TEST_FONCTION(VALEUR=_F(FONCTION=epsDIR,
                        NOM_PARA='INST',
                        VALE_PARA=tdep,
                        VALE_REFE=2.02331E-02,
                        PRECISION=0.001,
                        REFERENCE='AUTRE_ASTER',),
                        );

TEST_FONCTION(VALEUR=_F(FONCTION=sigDIR,
                        NOM_PARA='INST',
                        VALE_PARA=tdep,
                        VALE_REFE=1.14125E+02,
                        PRECISION=0.011,
                        REFERENCE='AUTRE_ASTER',),
                        );
TEST_FONCTION(VALEUR=_F(FONCTION=rho[1],
                        NOM_PARA='INST',
                        VALE_PARA=tdep,
                        VALE_REFE=9.80852E-07,
                        PRECISION=0.005,
                        REFERENCE='AUTRE_ASTER',),
                        );

TEST_FONCTION(VALEUR=_F(FONCTION=gamma[1],
                        NOM_PARA='INST',
                        VALE_PARA=tdep,
                        VALE_REFE=3.85454E-02,
                        PRECISION=0.005,
                        REFERENCE='AUTRE_ASTER',),
                        );

TEST_FONCTION(VALEUR=_F(FONCTION=rho[9],
                        NOM_PARA='INST',
                        VALE_PARA=tdep,
                        VALE_REFE=1.07407E-07,
                        PRECISION=0.14,
                        REFERENCE='AUTRE_ASTER',),
                        );

TEST_FONCTION(VALEUR=_F(FONCTION=gamma[9],
                        NOM_PARA='INST',
                        VALE_PARA=tdep,
                        VALE_REFE=1.04944E-03 ,
                        PRECISION=0.33,
                        REFERENCE='AUTRE_ASTER',),
                        );

TEST_FONCTION(VALEUR=_F(FONCTION=rho[9],
                        NOM_PARA='INST',
                        VALE_PARA=tdep,
                        VALE_REFE=9.334E-08,
                        PRECISION=0.01,
                        REFERENCE='NON_REGRESSION',),
                        );

TEST_FONCTION(VALEUR=_F(FONCTION=gamma[9],
                        NOM_PARA='INST',
                        VALE_PARA=tdep,
                        VALE_REFE=7.101E-04,
                        PRECISION=0.01,
                        REFERENCE='NON_REGRESSION',),
                        );


# Comparaison avec la modelisation B : ROTA_RESEAU
# instant ou les deformations sont grandes

TEST_FONCTION(VALEUR=_F(FONCTION=epsDIR,
                        NOM_PARA='INST',
                        VALE_PARA=tmax,
                        VALE_REFE=0.22365,
                        PRECISION=0.001,
                        REFERENCE='AUTRE_ASTER',),

                        );
# ecart du aux differences de formulation

TEST_FONCTION(VALEUR=_F(FONCTION=sigDIR,
                        NOM_PARA='INST',
                        VALE_PARA=tmax,
                        VALE_REFE=320.153,
                        PRECISION=0.09,
                        REFERENCE='AUTRE_ASTER',),
                        );
TEST_FONCTION(VALEUR=_F(FONCTION=rho[1],
                        NOM_PARA='INST',
                        VALE_PARA=tmax,
                        VALE_REFE=1.731023E-05,
                        PRECISION=0.18,
                        REFERENCE='AUTRE_ASTER',),
                        );

TEST_FONCTION(VALEUR=_F(FONCTION=gamma[1],
                        NOM_PARA='INST',
                        VALE_PARA=tmax,
                        VALE_REFE=0.31346,
                        PRECISION=0.6,
                        REFERENCE='AUTRE_ASTER',),
                        );

# ce systeme n'evolue plus

TEST_FONCTION(VALEUR=_F(FONCTION=rho[9],
                        NOM_PARA='INST',
                        VALE_PARA=tmax,
                        VALE_REFE=8.370E-07,
                        PRECISION=0.06,
                        REFERENCE='AUTRE_ASTER',),
                        );

TEST_FONCTION(VALEUR=_F(FONCTION=gamma[9],
                        NOM_PARA='INST',
                        VALE_PARA=tmax,
                        VALE_REFE=0.01041,
                        PRECISION=0.07,
                        REFERENCE='AUTRE_ASTER',),
                        );

# systeme 12 active seulement en GDEF ou ROTA_RESEAU

TEST_FONCTION(VALEUR=_F(FONCTION=rho[12],
                        NOM_PARA='INST',
                        VALE_PARA=tmax,
                        VALE_REFE=1.719314E-05,
                        PRECISION=0.25,
                        REFERENCE='AUTRE_ASTER',),
                        );

TEST_FONCTION(VALEUR=_F(FONCTION=gamma[12],
                        NOM_PARA='INST',
                        VALE_PARA=tmax,
                        VALE_REFE=0.11118,
                        PRECISION=0.21,
                        REFERENCE='AUTRE_ASTER',),
                        );



# non regression

TEST_FONCTION(VALEUR=_F(FONCTION=sigDIR,
                        NOM_PARA='INST',
                        VALE_PARA=tmax,
                        VALE_REFE=292.9184,
                        REFERENCE='NON_REGRESSION',),
                        );
TEST_FONCTION(VALEUR=_F(FONCTION=rho[1],
                        NOM_PARA='INST',
                        VALE_PARA=tmax,
                        VALE_REFE=1.42490E-05 ,
                        REFERENCE='NON_REGRESSION',),
                        );

TEST_FONCTION(VALEUR=_F(FONCTION=gamma[1],
                        NOM_PARA='INST',
                        VALE_PARA=tmax,
                        VALE_REFE=0.297258,
                        REFERENCE='NON_REGRESSION',),
                        );

TEST_FONCTION(VALEUR=_F(FONCTION=rho[9],
                        NOM_PARA='INST',
                        VALE_PARA=tmax,
                        VALE_REFE=7.874723E-07,
                        REFERENCE='NON_REGRESSION',),
                        );

TEST_FONCTION(VALEUR=_F(FONCTION=gamma[9],
                        NOM_PARA='INST',
                        VALE_PARA=tmax,
                        VALE_REFE=9.811E-03,
                        PRECISION=0.01,
                        REFERENCE='NON_REGRESSION',),
                        );

TEST_FONCTION(VALEUR=_F(FONCTION=rho[12],
                        NOM_PARA='INST',
                        VALE_PARA=tmax,
                        VALE_REFE=1.30735E-05,
                        REFERENCE='NON_REGRESSION',),
                        );

TEST_FONCTION(VALEUR=_F(FONCTION=gamma[12],
                        NOM_PARA='INST',
                        VALE_PARA=tmax,
                        VALE_REFE=0.0884,
                        REFERENCE='NON_REGRESSION',),
                        );



SOLEXPL=CALC_CHAMP(reuse=SOLEXPL,RESULTAT=SOLEXPL,DEFORMATION=('EPSG_ELGA'))
SOLIMPN=CALC_CHAMP(reuse=SOLIMPN,RESULTAT=SOLIMPN,DEFORMATION=('EPSG_ELGA'))

#SOLNL  =CALC_CHAMP(reuse=SOLNL,  RESULTAT=SOLNL,  DEFORMATION=('EPSG_ELGA'))
#IMPR_RESU(RESU=_F(RESULTAT=SOLNL,VALE_MAX='OUI',VALE_MIN='OUI'))
#TABEXPL=CREA_TABLE(RESU=_F(RESULTAT=SOLEXPL,INST=t1,NOM_CHAM='VARI_ELGA',TOUT_CMP='OUI',TOUT='OUI'),)
#IMPR_TABLE(TABLE=TABEXPL)
#TABIMPN=CREA_TABLE(RESU=_F(RESULTAT=SOLNL,INST=tmax,NOM_CHAM='VARI_ELGA',TOUT_CMP='OUI',TOUT='OUI'),)
#IMPR_TABLE(TABLE=TABIMPN)



# test des resultats explicite et newton
tdep=t1

sigDIRE=RECU_FONCTION(RESULTAT=SOLEXPL,
                   NOM_CHAM='SIEF_ELGA',
                   NOM_CMP='SIZZ',
                   MAILLE='CUBE',
                   POINT=numpg,
                   INTERPOL='LIN');

epsDIRE=RECU_FONCTION(RESULTAT=SOLEXPL,
                   NOM_CHAM='EPSG_ELGA',
                   NOM_CMP='EPZZ',
                   MAILLE='CUBE',
                   POINT=numpg,
                   INTERPOL='LIN');

sigDIRN=RECU_FONCTION(RESULTAT=SOLIMPN,
                   NOM_CHAM='SIEF_ELGA',
                   NOM_CMP='SIZZ',
                   MAILLE='CUBE',
                   POINT=numpg,
                   INTERPOL='LIN');

epsDIRN=RECU_FONCTION(RESULTAT=SOLIMPN,
                   NOM_CHAM='EPSG_ELGA',
                   NOM_CMP='EPZZ',
                   MAILLE='CUBE',
                   POINT=numpg,
                   INTERPOL='LIN');

TEST_FONCTION(VALEUR=_F(FONCTION=epsDIRE,
                        NOM_PARA='INST',
                        VALE_PARA=tdep,
                        VALE_REFE=5.001250E-04,
                        PRECISION=0.001,
                        REFERENCE='AUTRE_ASTER',),
                        );

TEST_FONCTION(VALEUR=_F(FONCTION=sigDIRE,
                        NOM_PARA='INST',
                        VALE_PARA=tdep,
                        VALE_REFE=86.551696,
                        PRECISION=0.011,
                        REFERENCE='AUTRE_ASTER',),
                        );

TEST_FONCTION(VALEUR=_F(FONCTION=epsDIRN,
                        NOM_PARA='INST',
                        VALE_PARA=tdep,
                        VALE_REFE=5.001250E-04,
                        PRECISION=0.001,
                        REFERENCE='AUTRE_ASTER',),
                        );

TEST_FONCTION(VALEUR=_F(FONCTION=sigDIRN,
                        NOM_PARA='INST',
                        VALE_PARA=tdep,
                        VALE_REFE=86.551696,
                        PRECISION=0.011,
                        REFERENCE='AUTRE_ASTER',),
                        );


FIN()
