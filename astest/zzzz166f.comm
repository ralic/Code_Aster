# MODIF  DATE 06/07/2004   AUTEUR CIBHHLV L.VIVAN 
# TITRE CALCUL DE FLUX THERMIQUE (3D_DIAG)
#            CONFIGURATION MANAGEMENT OF EDF VERSION
# ======================================================================
# COPYRIGHT (C) 1991 - 2002  EDF R&D                  WWW.CODE-ASTER.ORG
# THIS PROGRAM IS FREE SOFTWARE; YOU CAN REDISTRIBUTE IT AND/OR MODIFY  
# IT UNDER THE TERMS OF THE GNU GENERAL PUBLIC LICENSE AS PUBLISHED BY  
# THE FREE SOFTWARE FOUNDATION; EITHER VERSION 2 OF THE LICENSE, OR     
# (AT YOUR OPTION) ANY LATER VERSION.                                                    
#                                                                       
# THIS PROGRAM IS DISTRIBUTED IN THE HOPE THAT IT WILL BE USEFUL, BUT   
# WITHOUT ANY WARRANTY; WITHOUT EVEN THE IMPLIED WARRANTY OF            
# MERCHANTABILITY OR FITNESS FOR A PARTICULAR PURPOSE. SEE THE GNU      
# GENERAL PUBLIC LICENSE FOR MORE DETAILS.                              
#                                                                       
# YOU SHOULD HAVE RECEIVED A COPY OF THE GNU GENERAL PUBLIC LICENSE     
# ALONG WITH THIS PROGRAM; IF NOT, WRITE TO EDF R&D CODE_ASTER,         
#    1 AVENUE DU GENERAL DE GAULLE, 92141 CLAMART CEDEX, FRANCE.        
# ======================================================================
#
# ----------------------------------------------------------------------
# CALCUL DE FLUX THERMIQUE
# MODELISATION : ELEMENTS THERMIQUES 3D_DIAG(HEXA8,PENTA6,TETRA4,PYRAM5)
# ----------------------------------------------------------------------
#
DEBUT( CODE=_F(  NOM = 'ZZZZ166F',NIV_PUB_WEB='INTERNET') )
#
PRE_GIBI()
#
MAIL=LIRE_MAILLAGE(VERI_MAIL=_F(VERIF='OUI'),)
#
MO=AFFE_MODELE(MAILLAGE=MAIL,
               AFFE=_F(TOUT = 'OUI',
                       PHENOMENE = 'THERMIQUE',
                       MODELISATION = '3D_DIAG'))
#
MAT=DEFI_MATERIAU(THER=_F(LAMBDA = 1.0,
                          RHO_CP = 0.0))
#
CHMAT=AFFE_MATERIAU(MAILLAGE=MAIL,
                    AFFE=_F(TOUT = 'OUI',
                            MATER = MAT,
                            TEMP_REF = 0.0))
#
#-----------------------------------------------------------------
# CHAMP DE TEMPERATURE LINEAIRE => FLUX CONSTANT
# ===============================================
FTEMPL = FORMULE(REEL="""(REEL:X,REEL:Y,REEL:Z) 
                 = 2.*X +3.*Y + 4.*Z   """)
#
CHTEMPL = CREA_CHAMP(OPERATION='AFFE',
                    TYPE_CHAM='NOEU_TEMP_F',
                    MAILLAGE=MAIL,
                    AFFE=_F(TOUT = 'OUI',
                            NOM_CMP = ('TEMP',),
                            VALE_F = (FTEMPL,))
                 )
#
RESUL = CREA_RESU(OPERATION='AFFE',
                 TYPE_RESU='EVOL_THER',
                 NOM_CHAM='TEMP',
                 AFFE=_F(CHAM_GD = CHTEMPL,
                         INST = 1.0)
                )
#
RESUL = CALC_ELEM(reuse=RESUL,
                 RESULTAT=RESUL,
                 MODELE=MO,
                 CHAM_MATER=CHMAT,
                 OPTION=('FLUX_ELGA_TEMP','FLUX_ELNO_TEMP',)
                )
#
# TEST TEMPERATURE :
TEST_RESU(RESU=(_F(RESULTAT=RESUL, INST=1., REFERENCE='ANALYTIQUE',
                   NOM_CHAM='TEMP', NOM_CMP='TEMP',
                   GROUP_NO='D1', PRECISION=1.0E-3, VALE=16.5),
#
                _F(RESULTAT=RESUL, INST=1., REFERENCE='ANALYTIQUE',
                   NOM_CHAM='TEMP', NOM_CMP='TEMP',
                   GROUP_NO='D2', PRECISION=1.0E-3, VALE=21.5),
#
                _F(RESULTAT=RESUL, INST=1., REFERENCE='ANALYTIQUE',
                   NOM_CHAM='TEMP', NOM_CMP='TEMP',
                   GROUP_NO='D3', PRECISION=1.0E-3, VALE=24.0),
#
                _F(RESULTAT=RESUL, INST=1., REFERENCE='ANALYTIQUE',
                   NOM_CHAM='TEMP', NOM_CMP='TEMP',
                   GROUP_NO='D4', PRECISION=1.0E-3, VALE=29.0))
          )
#
# TEST FLUX_ELGA_TEMP :
TEST_RESU(RESU=(_F(RESULTAT=RESUL, INST=1., REFERENCE='ANALYTIQUE',
                   NOM_CHAM='FLUX_ELGA_TEMP', NOM_CMP='FLUX',
                   MAILLE='M400', POINT=1,
                   PRECISION=1.0E-3, VALE=-2.),
                _F(RESULTAT=RESUL, INST=1., REFERENCE='ANALYTIQUE',
                   NOM_CHAM='FLUX_ELGA_TEMP', NOM_CMP='FLUY',
                   MAILLE='M400', POINT=1,
                   PRECISION=1.0E-3, VALE=-3.),
                _F(RESULTAT=RESUL, INST=1., REFERENCE='ANALYTIQUE',
                   NOM_CHAM='FLUX_ELGA_TEMP', NOM_CMP='FLUZ',
                   MAILLE='M400', POINT=1,
                   PRECISION=1.0E-3, VALE=-4.),
#
                _F(RESULTAT=RESUL, INST=1., REFERENCE='ANALYTIQUE',
                   NOM_CHAM='FLUX_ELGA_TEMP', NOM_CMP='FLUX',
                   MAILLE='M1200', POINT=1, 
                   PRECISION=1.0E-3, VALE=-2.),
                _F(RESULTAT=RESUL, INST=1., REFERENCE='ANALYTIQUE',
                   NOM_CHAM='FLUX_ELGA_TEMP', NOM_CMP='FLUY',
                   MAILLE='M1200', POINT=1,
                   PRECISION=1.0E-3, VALE=-3.),
                _F(RESULTAT=RESUL, INST=1., REFERENCE='ANALYTIQUE',
                   NOM_CHAM='FLUX_ELGA_TEMP', NOM_CMP='FLUZ',
                   MAILLE='M1200', POINT=1,
                   PRECISION=1.0E-3, VALE=-4.),
#
                _F(RESULTAT=RESUL, INST=1., REFERENCE='ANALYTIQUE',
                   NOM_CHAM='FLUX_ELGA_TEMP', NOM_CMP='FLUX',
                   MAILLE='M1795', POINT=1,
                   PRECISION=1.0E-3, VALE=-2.),
                _F(RESULTAT=RESUL, INST=1., REFERENCE='ANALYTIQUE',
                   NOM_CHAM='FLUX_ELGA_TEMP', NOM_CMP='FLUY',
                   MAILLE='M1795', POINT=1,
                   PRECISION=1.0E-3, VALE=-3.),
                _F(RESULTAT=RESUL, INST=1., REFERENCE='ANALYTIQUE',
                   NOM_CHAM='FLUX_ELGA_TEMP', NOM_CMP='FLUZ',
                   MAILLE='M1795', POINT=1,
                   PRECISION=1.0E-3, VALE=-4.),
#
                _F(RESULTAT=RESUL, INST=1., REFERENCE='ANALYTIQUE',
                   NOM_CHAM='FLUX_ELGA_TEMP', NOM_CMP='FLUX',
                   MAILLE='M1838', POINT=1,
                   PRECISION=1.0E-3, VALE=-2.),
                _F(RESULTAT=RESUL, INST=1., REFERENCE='ANALYTIQUE',
                   NOM_CHAM='FLUX_ELGA_TEMP', NOM_CMP='FLUY',
                   MAILLE='M1838', POINT=1,
                   PRECISION=1.0E-3, VALE=-3.),
                _F(RESULTAT=RESUL, INST=1., REFERENCE='ANALYTIQUE',
                   NOM_CHAM='FLUX_ELGA_TEMP', NOM_CMP='FLUZ',
                   MAILLE='M1838', POINT=1,
                   PRECISION=1.0E-3, VALE=-4.))
          )
#
# TEST FLUX_ELNO_TEMP :
TEST_RESU(RESU=(_F(RESULTAT=RESUL, INST=1., REFERENCE='ANALYTIQUE',
                   NOM_CHAM='FLUX_ELNO_TEMP', NOM_CMP='FLUX',
                   MAILLE='M400', GROUP_NO='D1',
                   PRECISION=1.0E-3, VALE=-2.),
                _F(RESULTAT=RESUL, INST=1., REFERENCE='ANALYTIQUE',
                   NOM_CHAM='FLUX_ELNO_TEMP', NOM_CMP='FLUY',
                   MAILLE='M400', GROUP_NO='D1',
                   PRECISION=1.0E-3, VALE=-3.),
                _F(RESULTAT=RESUL, INST=1., REFERENCE='ANALYTIQUE',
                   NOM_CHAM='FLUX_ELNO_TEMP', NOM_CMP='FLUZ',
                   MAILLE='M400', GROUP_NO='D1',
                   PRECISION=1.0E-3, VALE=-4.),
#
                _F(RESULTAT=RESUL, INST=1., REFERENCE='ANALYTIQUE',
                   NOM_CHAM='FLUX_ELNO_TEMP', NOM_CMP='FLUX',
                   MAILLE='M1200', GROUP_NO='D2', 
                   PRECISION=1.0E-3, VALE=-2.),
                _F(RESULTAT=RESUL, INST=1., REFERENCE='ANALYTIQUE',
                   NOM_CHAM='FLUX_ELNO_TEMP', NOM_CMP='FLUY',
                   MAILLE='M1200', GROUP_NO='D2', 
                   PRECISION=1.0E-3, VALE=-3.),
                _F(RESULTAT=RESUL, INST=1., REFERENCE='ANALYTIQUE',
                   NOM_CHAM='FLUX_ELNO_TEMP', NOM_CMP='FLUZ',
                   MAILLE='M1200', GROUP_NO='D2', 
                   PRECISION=1.0E-3, VALE=-4.),
#
                _F(RESULTAT=RESUL, INST=1., REFERENCE='ANALYTIQUE',
                   NOM_CHAM='FLUX_ELNO_TEMP', NOM_CMP='FLUX',
                   MAILLE='M1795', GROUP_NO='D3', 
                   PRECISION=1.0E-3, VALE=-2.),
                _F(RESULTAT=RESUL, INST=1., REFERENCE='ANALYTIQUE',
                   NOM_CHAM='FLUX_ELNO_TEMP', NOM_CMP='FLUY',
                   MAILLE='M1795', GROUP_NO='D3', 
                   PRECISION=1.0E-3, VALE=-3.),
                _F(RESULTAT=RESUL, INST=1., REFERENCE='ANALYTIQUE',
                   NOM_CHAM='FLUX_ELNO_TEMP', NOM_CMP='FLUZ',
                   MAILLE='M1795', GROUP_NO='D3', 
                   PRECISION=1.0E-3, VALE=-4.),
#
                _F(RESULTAT=RESUL, INST=1., REFERENCE='ANALYTIQUE',
                   NOM_CHAM='FLUX_ELNO_TEMP', NOM_CMP='FLUX',
                   MAILLE='M1838', GROUP_NO='D4', 
                   PRECISION=1.0E-3, VALE=-2.),
                _F(RESULTAT=RESUL, INST=1., REFERENCE='ANALYTIQUE',
                   NOM_CHAM='FLUX_ELNO_TEMP', NOM_CMP='FLUY',
                   MAILLE='M1838', GROUP_NO='D4', 
                   PRECISION=1.0E-3, VALE=-3.),
                _F(RESULTAT=RESUL, INST=1., REFERENCE='ANALYTIQUE',
                   NOM_CHAM='FLUX_ELNO_TEMP', NOM_CMP='FLUZ',
                   MAILLE='M1838', GROUP_NO='D4', 
                   PRECISION=1.0E-3, VALE=-4.))
          )
#
#
#-----------------------------------------------------------------
# CHAMP DE TEMPERATURE QUADRATIQUE => FLUX LINEAIRE
# ==================================================
FTEMPQ = FORMULE(REEL="""(REEL:X,REEL:Y,REEL:Z) 
                 = 2.*X*X +3.*Y*Y + 4.*Z*Z   """)
#
CHTEMPQ = CREA_CHAMP(OPERATION='AFFE',
                    TYPE_CHAM='NOEU_TEMP_F',
                    MAILLAGE=MAIL,
                    AFFE=_F(TOUT = 'OUI',
                            NOM_CMP = ('TEMP',),
                            VALE_F = (FTEMPQ,))
                 )
#
RESUQ = CREA_RESU(OPERATION='AFFE',
                 TYPE_RESU='EVOL_THER',
                 NOM_CHAM='TEMP',
                 AFFE=_F(CHAM_GD = CHTEMPQ,
                         INST = 1.0)
                )
#
RESUQ = CALC_ELEM(reuse=RESUQ,
                 RESULTAT=RESUQ,
                 MODELE=MO,
                 CHAM_MATER=CHMAT,
                 OPTION=('FLUX_ELGA_TEMP','FLUX_ELNO_TEMP',)
                )
#
# TEST TEMPERATURE :
TEST_RESU(RESU=(_F(RESULTAT=RESUQ, INST=1., REFERENCE='ANALYTIQUE',
                   NOM_CHAM='TEMP', NOM_CMP='TEMP',
                   GROUP_NO='D1', PRECISION=1.0E-3, VALE=35.25),
#
                _F(RESULTAT=RESUQ, INST=1., REFERENCE='ANALYTIQUE',
                   NOM_CHAM='TEMP', NOM_CMP='TEMP',
                   GROUP_NO='D2', PRECISION=1.0E-3, VALE=72.75),
#
                _F(RESULTAT=RESUQ, INST=1., REFERENCE='ANALYTIQUE',
                   NOM_CHAM='TEMP', NOM_CMP='TEMP',
                   GROUP_NO='D3', PRECISION=1.0E-3, VALE=91.5),
#
                _F(RESULTAT=RESUQ, INST=1., REFERENCE='ANALYTIQUE',
                   NOM_CHAM='TEMP', NOM_CMP='TEMP',
                   GROUP_NO='D4', PRECISION=1.0E-3, VALE=129.0))
          )
#
# TEST FLUX_ELNO_TEMP :
TEST_RESU(RESU=(_F(RESULTAT=RESUQ, INST=1., REFERENCE='ANALYTIQUE',
                   NOM_CHAM='FLUX_ELNO_TEMP', NOM_CMP='FLUX',
                   MAILLE='M400', GROUP_NO='D1',
                   PRECISION=2.5E-2, VALE=-10.),
                _F(RESULTAT=RESUQ, INST=1., REFERENCE='ANALYTIQUE',
                   NOM_CHAM='FLUX_ELNO_TEMP', NOM_CMP='FLUY',
                   MAILLE='M400', GROUP_NO='D1',
                   PRECISION=2.5E-2, VALE=-15.),
                _F(RESULTAT=RESUQ, INST=1., REFERENCE='ANALYTIQUE',
                   NOM_CHAM='FLUX_ELNO_TEMP', NOM_CMP='FLUZ',
                   MAILLE='M400', GROUP_NO='D1',
                   PRECISION=5.5E-2, VALE=-8.),
#
                _F(RESULTAT=RESUQ, INST=1., REFERENCE='ANALYTIQUE',
                   NOM_CHAM='FLUX_ELNO_TEMP', NOM_CMP='FLUX',
                   MAILLE='M1200', GROUP_NO='D2', 
                   PRECISION=1.5E-2, VALE=-20.),
                _F(RESULTAT=RESUQ, INST=1., REFERENCE='ANALYTIQUE',
                   NOM_CHAM='FLUX_ELNO_TEMP', NOM_CMP='FLUY',
                   MAILLE='M1200', GROUP_NO='D2', 
                   PRECISION=2.5E-2, VALE=-15.),
                _F(RESULTAT=RESUQ, INST=1., REFERENCE='ANALYTIQUE',
                   NOM_CHAM='FLUX_ELNO_TEMP', NOM_CMP='FLUZ',
                   MAILLE='M1200', GROUP_NO='D2', 
                   PRECISION=5.5E-2, VALE=-8.),
#
                _F(RESULTAT=RESUQ, INST=1., REFERENCE='ANALYTIQUE',
                   NOM_CHAM='FLUX_ELNO_TEMP', NOM_CMP='FLUX',
                   MAILLE='M1795', GROUP_NO='D3', 
                   PRECISION=4.5E-2, VALE=-10.),
                _F(RESULTAT=RESUQ, INST=1., REFERENCE='ANALYTIQUE',
                   NOM_CHAM='FLUX_ELNO_TEMP', NOM_CMP='FLUY',
                   MAILLE='M1795', GROUP_NO='D3', 
                   PRECISION=2.5E-2, VALE=-30.),
                _F(RESULTAT=RESUQ, INST=1., REFERENCE='ANALYTIQUE',
                   NOM_CHAM='FLUX_ELNO_TEMP', NOM_CMP='FLUZ',
                   MAILLE='M1795', GROUP_NO='D3', 
                   PRECISION=10.5E-2, VALE=-8.),
#
                _F(RESULTAT=RESUQ, INST=1., REFERENCE='ANALYTIQUE',
                   NOM_CHAM='FLUX_ELNO_TEMP', NOM_CMP='FLUX',
                   MAILLE='M1838', GROUP_NO='D4', 
                   PRECISION=2.5E-2, VALE=-20.),
                _F(RESULTAT=RESUQ, INST=1., REFERENCE='ANALYTIQUE',
                   NOM_CHAM='FLUX_ELNO_TEMP', NOM_CMP='FLUY',
                   MAILLE='M1838', GROUP_NO='D4', 
                   PRECISION=2.5E-2, VALE=-30.),
                _F(RESULTAT=RESUQ, INST=1., REFERENCE='ANALYTIQUE',
                   NOM_CHAM='FLUX_ELNO_TEMP', NOM_CMP='FLUZ',
                   MAILLE='M1838', GROUP_NO='D4', 
                   PRECISION=5.5E-2, VALE=-8.))
          )
#
FIN( )
#
