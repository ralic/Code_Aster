# MODIF  DATE 12/05/2009   AUTEUR PELLET J.PELLET 
# TITRE SOLLICITATION SISMIQUE D'UNE COLONNE DE SOL 
#  APRES CONSTRUCTION PAR COUCHES AVEC LOI DE HUJEUX
# wdnp101a.para = tps_job 700 mem_job 1000Mo mem_aster 80 ncpus 1 liste_test S
#            CONFIGURATION MANAGEMENT OF EDF VERSION
# ======================================================================
# COPYRIGHT (C) 1991 - 2008  EDF R&D                  WWW.CODE-ASTER.ORG
# THIS PROGRAM IS FREE SOFTWARE; YOU CAN REDISTRIBUTE IT AND/OR MODIFY  
# IT UNDER THE TERMS OF THE GNU GENERAL PUBLIC LICENSE AS PUBLISHED BY  
# THE FREE SOFTWARE FOUNDATION; EITHER VERSION 2 OF THE LICENSE, OR     
# (AT YOUR OPTION) ANY LATER VERSION.                                                    
#                                                                       
# THIS PROGRAM IS DISTRIBUTED IN THE HOPE THAT IT WILL BE USEFUL, BUT   
# WITHOUT ANY WARRANTY; WITHOUT EVEN THE IMPLIED WARRANTY OF            
# MERCHANTABILITY OR FITNESS FOR A PARTICULAR PURPOSE. SEE THE GNU      
# GENERAL PUBLIC LICENSE FOR MORE DETAILS.                              
#                                                                       
# YOU SHOULD HAVE RECEIVED A COPY OF THE GNU GENERAL PUBLIC LICENSE     
# ALONG WITH THIS PROGRAM; IF NOT, WRITE TO EDF R&D CODE_ASTER,         
#    1 AVENUE DU GENERAL DE GAULLE, 92141 CLAMART CEDEX, FRANCE.        
# ======================================================================

from Numeric import *


# Nombre de couches
# (dont la couche elastique correspondant au BEDROCK)
nbcouche  = 11    ;

UN        = 1.0   ;
ZERO      = 0.0   ;
P_PELOUSE = 1.E+2 ;

YOUNG = 1.E+9 ;          # [Pa]
NU    = 0.3   ;
RHO   = 2105  ;          # Valeur homogeneisee

K_EAU     = 2000.E+6 ;   # coefficient de compressibilite de l eau
INV_K_EAU = 1./K_EAU ;
#INV_K_EAU = 1.E-7 ;

# Parametres Hujeux

P0        =  -20.E+3 ;   # pression de consolidation initiale
PCO       = -250.E+3 ;   # pression critique
PREF      = -1.E+6   ;
R_ELA_DEV = 0.025    ;
R_ELA_ISO = .01      ;   # on desactive le mecanisme isotrope

vari_1        = [ZERO,ZERO,ZERO,ZERO,ZERO,ZERO,ZERO,ZERO,
                ZERO,ZERO,ZERO,ZERO,ZERO,ZERO,ZERO,ZERO,ZERO,ZERO,ZERO,ZERO] ;
vari_2        = [ZERO,ZERO,ZERO,ZERO,ZERO,ZERO,ZERO,ZERO,
                ZERO,ZERO,ZERO,ZERO,ZERO,ZERO,ZERO,ZERO,ZERO,ZERO,ZERO,ZERO];
vari_3        = [ZERO,ZERO,ZERO,ZERO,ZERO,ZERO,ZERO,ZERO,ZERO,ZERO,ZERO,ZERO,];
vari_cart_cc = [-PCO/2,ZERO,ZERO,ZERO,ZERO,ZERO,ZERO,ZERO,ZERO] ;

varico       = [ZERO,] ;


DEBUT(CODE=_F(NOM='WDNP101A', NIV_PUB_WEB='INTERNET',) );

VISCOLIQ = DEFI_CONSTANTE(VALE=0.001 );
DVISCOL  = DEFI_CONSTANTE(VALE=0.0   );
KINT     = DEFI_CONSTANTE(VALE=1.E-12);
# KINT correspond a une conductivite lambda =1E-9
#      soit a une permeabilite de K = 9.81E-6 m/s

MA=LIRE_MAILLAGE();

#IMPR_RESU(FORMAT='IDEAS',RESU=_F(MAILLAGE=MA,));

# Definition des differents modeles associes a chaque couche
MOD=[None]*(nbcouche-1);
U  =[None]*(nbcouche-1);
SIG=[None]*(nbcouche-1);
DEP=[None]*(nbcouche-1);
VAR=[None]*(nbcouche-1);
#T_DEP=[None]*nbcouche
#T_SIG=[None]*nbcouche
#T_VAR=[None]*nbcouche

# -->5: debut boucle for
list_group_ma=['ELEM0'];
list_group_m2=['ELEMS0'];
for n in range(nbcouche-1):

  list_group_ma.append('ELEM'+str(n+1));
  list_group_m2.append('ELEMS'+str(n+1));
  print '   n=',n,'; liste=',list_group_ma

  MOD[n] = AFFE_MODELE(MAILLAGE=MA,
                       AFFE=(
                            _F(GROUP_MA    =tuple(list_group_ma),
                               PHENOMENE   ='MECANIQUE',
                               MODELISATION='D_PLAN_HMS'),
                             ),
                        );

# <--5: fin boucle for

                    
#  -------------------------------------------------------------------
#  Definition du sol sature en eau ACTIF, affectation global materiau,
#  liste d instants
#  -------------------------------------------------------------------

# ---- COUCHE1 : ELASTIQUE TRES RIGIDE
MAT0=DEFI_MATERIAU(ELAS=_F(
                           E     = 5.0*YOUNG,
                           NU    = NU,
                           RHO   = RHO,
                           ALPHA = 0.0),
                   COMP_THM='LIQU_SATU',
                   THM_INIT=_F(PRE1 = 0.0,
                               PORO = 0.35),
                   THM_DIFFU=_F(RHO       = 2105.0,
                                BIOT_COEF = 1.0,
                                PESA_X    = 0.0,
                                PESA_Y    = -9.81,
                                PESA_Z    = 0.0,
                                PERM_IN   = KINT),
                   THM_LIQU=_F(RHO        = 1000.0,
                               UN_SUR_K   = INV_K_EAU,
                               VISC       = VISCOLIQ,
                               D_VISC_TEMP= DVISCOL));

# ---- COUCHES SUIVANTES : HUJEUX
MAT1=DEFI_MATERIAU(ELAS=_F(
                           E     = YOUNG,
                           NU    = NU,
                           RHO   = RHO,
                           ALPHA = 0.0),
                   HUJEUX=_F(N      = 0.89,
                            BETA    = 10.,
                            D       = 1.7,
                            B       = 1.,
                            PHI     = 21.,
                            ANGDIL  = 21.,
                            PCO     = PCO,
                            PREF    = PREF,
                            AMON    = 0.005,
                            ACYC    = 0.003,
                            # ACYC    = 0.005,
                            CMON    = 0.18,
                            # CCYC    = 0.18,
                            CCYC    = 0.1,
                            RD_ELA  = R_ELA_DEV,
                            RI_ELA  = R_ELA_ISO,
                            RHYS    = 0.1,
                            RMOB    = 0.5,
                            XM      = 2.,
                            RD_CYC  = R_ELA_DEV,
                            RI_CYC  = R_ELA_ISO,
                            DILA    = 1.0),
                   COMP_THM='LIQU_SATU',
                   THM_INIT=_F(PRE1 = 0.0,
                               PORO = 0.35),
                   THM_DIFFU=_F(RHO       = 2105.0,
                                BIOT_COEF = 1.0,
                                PESA_X    = 0.0,
                                PESA_Y    = -9.81,
                                PESA_Z    = 0.0,
                                PERM_IN   = KINT),
                   THM_LIQU=_F(RHO        = 1000.0,
                               UN_SUR_K   = INV_K_EAU,
                               VISC       = VISCOLIQ,
                               D_VISC_TEMP= DVISCOL));
                               
MAT_DYN=DEFI_MATERIAU(
# general inertial properties of the medium
                      ELAS=_F(E=0.0000001, NU=NU,
                              AMOR_ALPHA=0., AMOR_BETA=0.,
                              RHO=2105, ALPHA=0.0,),);
                              
MAT_DY0=DEFI_MATERIAU(
# general inertial properties of the medium
                      ELAS=_F(E=0.0000001, NU=NU,
                              AMOR_ALPHA=0., AMOR_BETA=0.,
                              RHO=0.0001, ALPHA=0.0,),);
                              
MAT_PAR=DEFI_MATERIAU(
# general mechanical properties of the rock
                      ELAS=_F(
                              E = 5.0*YOUNG, NU=NU,
                              RHO=2105, ALPHA=0.0,),);

AFFMAT1=AFFE_MATERIAU(MAILLAGE=MA,
                      AFFE=(_F(GROUP_MA=list_group_ma[1:nbcouche],
                              MATER=MAT1),
                            _F(GROUP_MA=list_group_ma[0],
                              MATER=MAT0),
                            _F(GROUP_MA=list_group_m2[0:nbcouche],
                              MATER=MAT_DY0),
                            _F(GROUP_MA='BAS',
                              MATER=MAT_PAR),
                           ),
                     );

PES=AFFE_CHAR_MECA(MODELE=MOD[nbcouche-2],
                   PESANTEUR=(9.81,0.0,-1.0,0.0));

CHPAR=AFFE_CHAR_MECA(MODELE=MOD[nbcouche-2],
                     DDL_IMPO=_F(GROUP_MA='BAS',
                                 DY=0.0));

TEMPS=DEFI_LIST_REEL(DEBUT=0.0,
                     INTERVALLE=(_F(JUSQU_A=2000000.0,
                                    NOMBRE=20,),
                                 _F(JUSQU_A=3000000.0,
                                    NOMBRE=20,),
                                 _F(JUSQU_A=4000000.0,
                                    NOMBRE=20,),
                                 _F(JUSQU_A=5000000.0,
                                    NOMBRE=20,),
                                 #_F(JUSQU_A=5050000.0,
                                 #   NOMBRE=20,),
                                 _F(JUSQU_A=6000000.0,
                                    NOMBRE=20,),
                                 #_F(JUSQU_A=6050000.0,
                                 #   NOMBRE=20,),
                                 _F(JUSQU_A=7000000.0,
                                    NOMBRE=20,),
                                 _F(JUSQU_A=8000000.0,
                                    NOMBRE=20,),
                                 _F(JUSQU_A=9000000.0,
                                    NOMBRE=20,),
                                 #_F(JUSQU_A=9050000.0,
                                 #   NOMBRE=20),
                                 _F(JUSQU_A=10000000.0,
                                    NOMBRE=20,),
                                 _F(JUSQU_A=11000000.0,
                                    NOMBRE=20)));

F_EVOL=DEFI_FONCTION(NOM_PARA='INST',
                     PROL_DROITE='LINEAIRE',
                     PROL_GAUCHE='CONSTANT',
                     VALE=(0.       , 0.,
                           1000000.0, 1.));

#        ----------------------------------
# INIT-  Pose couches 1 et 2 = 1ere couches
#        ----------------------------------


# Consditions aux limites en deplacement pour les premieres couches
n_couche=2

CHLAT=AFFE_CHAR_MECA(MODELE=MOD[0],
                     DDL_IMPO=(_F(GROUP_MA=('DR1','GA1'),
                                  DX=0.0),),
                     );

# Conditions hydrauliques
PHAUT=AFFE_CHAR_MECA(MODELE=MOD[0],
                     DDL_IMPO=_F(GROUP_MA='HA1',
                                 PRE1=0.0));

PBAS=AFFE_CHAR_MECA(MODELE=MOD[0],
                    DDL_IMPO=_F(GROUP_MA='HA0',
                                PRE1=19620.0));

SIEF=CREA_CHAMP(INFO=1,
                TYPE_CHAM='ELGA_SIEF_R',
                OPERATION='AFFE',
                MODELE=MOD[0],
                PROL_ZERO='OUI',
                AFFE=(_F(GROUP_MA=list_group_ma[1],
                        NOM_CMP=('SIXX','SIYY','SIZZ'),
                        VALE=(P0,P0,P0),),
                      _F(GROUP_MA=list_group_m2[1],
                        NOM_CMP =('SIXX','SIYY','SIZZ'),
                        VALE    =(ZERO,ZERO,ZERO),),
                      )
                 );

# Pas d Initialisation des contraintes
# Mise en place de la premiere couche et de la seconde couche simultanement = 1ere couche
# Etat initail du pb hydraulique
# On utilise une valeur de critere lache pour commencer a appliquer le
#   poids car la precision s ameliore ensuite 

U[0]=STAT_NON_LINE(MODELE=MOD[0],
                 CHAM_MATER=AFFMAT1,
                 EXCIT=(_F(CHARGE=PHAUT),
                        _F(CHARGE=CHPAR),
                        _F(CHARGE=CHLAT),
                        _F(CHARGE=PES)),
                 ETAT_INIT=_F(SIGM=SIEF),
                 COMP_INCR=(_F(RELATION='KIT_HM',
                               ITER_INTE_PAS=-10,
                               RELATION_KIT=('ELAS','LIQU_SATU','HYDR_UTIL'),
                               GROUP_MA=list_group_ma[0]),
                            _F(
                               ITER_INTE_MAXI=50,
                               ITER_INTE_PAS=-10,
                               RESI_INTE_RELA=1E-7,
                               RELATION='KIT_HM',
                               RELATION_KIT=('HUJEUX','LIQU_SATU','HYDR_UTIL'),
                               GROUP_MA=list_group_ma[1]),
                            ),
                 #RECH_LINEAIRE=_F( ),
                 INCREMENT=_F(LIST_INST=TEMPS,
                              INST_INIT=0,
                              INST_FIN=2000000.0,
                              SUBD_METHODE='UNIFORME',
                              SUBD_PAS=5,
                              SUBD_NIVEAU=10,),
                 ARCHIVAGE=_F(LIST_INST=TEMPS,),
                 NEWTON=_F(MATRICE='TANGENTE',
                           REAC_ITER=1),
                 CONVERGENCE=_F(ITER_GLOB_MAXI=6,RESI_GLOB_RELA=1E-6));

DEP[0]=CREA_CHAMP(TYPE_CHAM='NOEU_DEPL_R',
                OPERATION='EXTR',
                RESULTAT=U[0],
                NOM_CHAM='DEPL',
                INST=2000000.0,
                INFO=1,);

SIG[0]=CREA_CHAMP(INFO=1,
                TYPE_CHAM='ELGA_SIEF_R',
                OPERATION='EXTR',
                RESULTAT=U[0],
                NOM_CHAM='SIEF_ELGA',
                INST=2000000.0,);
                
VAR[0]=CREA_CHAMP(INFO=2,
                TYPE_CHAM='ELGA_VARI_R',
                OPERATION='EXTR',
                RESULTAT=U[0],
                NOM_CHAM='VARI_ELGA',
                INST=2000000.0,);

U[0]=CALC_ELEM(reuse=U[0],
               MODELE     = MOD[0],
               GROUP_MA=list_group_ma[0:2],
               CHAM_MATER = AFFMAT1,
               OPTION=('SIEF_ELNO_ELGA','VARI_ELNO_ELGA'),
               RESULTAT=U[0]);



#         -------------------------
# SUITE-  Pose couches 3 a nbcouche
#         -------------------------


## list_noeu_haut=list_no_later_dro[:2]

# -->10: Boucle sur la pose des couches 3 a nbcouche
for n in range(1,nbcouche-1):

    DETRUIRE(INFO=1,CONCEPT=_F(NOM=('CHLAT','PHAUT','SIEF',
                             'CART1','CART2','CART3',)));

    n_couche = n+2
    print ' > n_couche          =',n_couche


    # Deplacements lateraux nuls
    CHLAT=AFFE_CHAR_MECA(INFO=1,
                         MODELE=MOD[n],
                         DDL_IMPO=(_F(GROUP_MA=('GA'+str(n+1),'DR'+str(n+1)),
                                      DX=0.0),)
                         );

    # Pression hydraulique nulle en haut de la couche posee (numero n)
    PHAUT=AFFE_CHAR_MECA(INFO=1,
                         MODELE=MOD[n],
                         DDL_IMPO=_F(GROUP_MA='HA'+str(n+1),
                                     PRE1=0.0));

    SIEF=CREA_CHAMP(INFO=1,
                    TYPE_CHAM='ELGA_SIEF_R',
                    OPERATION='AFFE',
                    MODELE=MOD[n],
                    PROL_ZERO='OUI',
                    AFFE=_F(GROUP_MA=list_group_ma[n+1],
                            NOM_CMP =('SIXX','SIYY','SIZZ'),
                            VALE    =(P0,P0,P0)));
                            
                     

    print ' > list_group_ma =',list_group_ma[:n+1]
    print '   list_group_ma =',list_group_ma[n+1]


    # Initialisation des champs de deplacement et de contrainte dans les couches
    # deja calculees
    INIDEP=CREA_CHAMP(INFO=1,
                      TYPE_CHAM='NOEU_DEPL_R',
                      OPERATION='ASSE',
                      MODELE=MOD[n],
                      OPTION='DEPL',
                      PROL_ZERO='OUI',
                      ASSE=(_F(GROUP_MA=list_group_ma[:n+1],
                               CHAM_GD=DEP[n-1])));

    INISIG=CREA_CHAMP(INFO=1,
                      TYPE_CHAM='ELGA_SIEF_R',
                      OPERATION='ASSE',
                      MODELE=MOD[n],
                      PROL_ZERO='OUI',
                      ASSE=(_F(GROUP_MA=list_group_ma[n+1],
                               CHAM_GD=SIEF,
                               CUMUL='OUI',
                               COEF_R=1.0),
                            _F(GROUP_MA=list_group_ma[:n+1],
                               CHAM_GD=SIG[n-1],
                               CUMUL='OUI',
                               COEF_R=1.0),                 
                            ),
                      );

    CART1 = CREA_CHAMP(INFO = 1,
                   TYPE_CHAM='ELGA_NEUT_R',
                   OPERATION='AFFE',
                   MODELE=MOD[n],
                   PROL_ZERO='OUI',
                   AFFE=_F(GROUP_MA=list_group_ma[n+1],
                           NOM_CMP =('X1','X2','X3','X4','X5','X6','X7','X8','X9','X10','X11',
                                     'X12','X13','X14','X15','X16','X17','X18','X19','X20'),
                           VALE    =vari_1));

    CART2 = CREA_CHAMP(INFO = 1,
                   TYPE_CHAM='ELGA_NEUT_R',
                   OPERATION='AFFE',
                   MODELE=MOD[n],
                   PROL_ZERO='OUI',
                   AFFE=_F(GROUP_MA=list_group_ma[n+1],
                           NOM_CMP =('X1','X2','X3','X4','X5','X6','X7','X8','X9','X10','X11',
                                     'X12','X13','X14','X15','X16','X17','X18','X19','X20'),
                           VALE    =vari_2));

    CART3 = CREA_CHAMP(INFO = 1,
                   TYPE_CHAM='ELGA_NEUT_R',
                   OPERATION='AFFE',
                   MODELE=MOD[n],
                   PROL_ZERO='OUI',
                   AFFE=_F(GROUP_MA=list_group_ma[n+1],
                           NOM_CMP =('X1','X2','X3','X4','X5','X6','X7','X8','X9','X10','X11',
                                     'X12',),
                           VALE    =vari_3));
                           

    INIVAR=CREA_CHAMP(INFO=1,
                      TYPE_CHAM='ELGA_VARI_R',
                      OPERATION='ASSE',
                      MODELE=MOD[n],
                      PROL_ZERO='OUI',
                      ASSE=(_F(GROUP_MA=list_group_ma[:n+1],
                               CHAM_GD=VAR[n-1],
                               CUMUL='OUI',
                               COEF_R=1.0),
                            _F(GROUP_MA=list_group_ma[n+1],
                               CHAM_GD=CART1,
                               NOM_CMP =('X1','X2','X3','X4','X5','X6','X7','X8','X9','X10','X11',
                                     'X12','X13','X14','X15','X16','X17','X18','X19','X20'),
                               NOM_CMP_RESU=('V1','V2','V3','V4','V5','V6','V7','V8','V9','V10','V11',
                                             'V12','V13','V14','V15','V16','V17','V18','V19','V20'),
                               CUMUL='OUI',
                               COEF_R=1.0),
                            _F(GROUP_MA=list_group_ma[n+1],
                               CHAM_GD=CART2,
                               NOM_CMP =('X1','X2','X3','X4','X5','X6','X7','X8','X9','X10','X11',
                                     'X12','X13','X14','X15','X16','X17','X18','X19','X20',),
                               NOM_CMP_RESU=('V21','V22','V23','V24','V25','V26','V27','V28','V29','V30',
                                             'V31','V32','V33','V34','V35','V36','V37','V38','V39','V40'),
                               CUMUL='OUI',
                               COEF_R=1.0),
                            _F(GROUP_MA=list_group_ma[n+1],
                               CHAM_GD=CART3,
                               NOM_CMP =('X1','X2','X3','X4','X5','X6','X7','X8','X9','X10','X11','X12',),
                                     
                               NOM_CMP_RESU=('V41','V42','V43','V44','V45','V46','V47','V48',
                                             'V49','V50','V51','V52'),
                               CUMUL='OUI',
                               COEF_R=1.0),
                             ),
                         );

    t_init=(n+1)*1.E6
    t_fin =(n+2)*1.E6
    
# On utilise une valeur de critere lache pour commencer a appliquer le
#   poids car la precision s ameliore ensuite 

    U[n]=STAT_NON_LINE(MODELE=MOD[n],
                 CHAM_MATER=AFFMAT1,
                 EXCIT=(_F(CHARGE=PHAUT),
                        _F(CHARGE=CHPAR),
                        _F(CHARGE=CHLAT),
                        _F(CHARGE=PES)),
                 COMP_INCR=(_F(RELATION='KIT_HM',
                               ITER_INTE_PAS=-10,
                               RELATION_KIT=('ELAS','LIQU_SATU','HYDR_UTIL'),
                               GROUP_MA=list_group_ma[0]),
                            _F(ITER_INTE_MAXI=50,
                               ITER_INTE_PAS=-10,
                               RESI_INTE_RELA=1E-7,
                               RELATION='KIT_HM',
                               RELATION_KIT=('HUJEUX','LIQU_SATU','HYDR_UTIL'),
                               GROUP_MA=list_group_ma[1:n+2]),
                              ),
                 ETAT_INIT=_F(DEPL=INIDEP,
                              SIGM=INISIG,
                              VARI=INIVAR),
                 INCREMENT=_F(LIST_INST=TEMPS,
                              INST_INIT=t_init,
                              INST_FIN=t_fin,
                              SUBD_METHODE='UNIFORME',
                              SUBD_PAS=5,
                              SUBD_NIVEAU=10),
                 NEWTON=_F(MATRICE='TANGENTE',
                           REAC_ITER=1),
                 CONVERGENCE=_F(ITER_GLOB_MAXI=6,RESI_GLOB_RELA=1E-6));

    DETRUIRE(INFO=1,CONCEPT=_F(NOM='INIVAR'));
    DETRUIRE(INFO=1,CONCEPT=_F(NOM='INIDEP'));
    DETRUIRE(INFO=1,CONCEPT=_F(NOM='INISIG'));

    DEP[n]=CREA_CHAMP(TYPE_CHAM='NOEU_DEPL_R',
                      OPERATION='EXTR',
                      RESULTAT=U[n],
                      NOM_CHAM='DEPL',
                      INST = t_fin,
                      INFO=1,);

    SIG[n]=CREA_CHAMP(TYPE_CHAM='ELGA_SIEF_R',
                      OPERATION='EXTR',
                      RESULTAT=U[n],
                      NOM_CHAM='SIEF_ELGA',
                      INST = t_fin,
                      INFO=1,);

    VAR[n]=CREA_CHAMP(TYPE_CHAM='ELGA_VARI_R',
                OPERATION='EXTR',
                RESULTAT=U[n],
                NOM_CHAM='VARI_ELGA',
                INST = t_fin,
                INFO=1,);

    U[n]=CALC_ELEM(reuse=U[n],
                   GROUP_MA=list_group_ma[0:n+2],
                   OPTION=('SIEF_ELNO_ELGA','VARI_ELNO_ELGA'),
                   RESULTAT=U[n]);
                   
#    IMPR_RESU(RESU=_F(CHAM_GD=DEP[n]));
#    IMPR_RESU(RESU=_F(CHAM_GD=VAR[n]));
#    IMPR_RESU(RESU=_F(CHAM_GD=SIG[n]));


# <--10: fin boucle for

MOD9B = AFFE_MODELE(MAILLAGE=MA,
                       AFFE=(
                            _F(GROUP_MA    =list_group_ma[0:nbcouche],
                               PHENOMENE   ='MECANIQUE',
                               MODELISATION='D_PLAN_HMS'),
                            _F(GROUP_MA    =list_group_m2[0:nbcouche],
                               PHENOMENE   ='MECANIQUE',
                               MODELISATION='D_PLAN'),
                            _F(GROUP_MA    ='BAS',
                               PHENOMENE   ='MECANIQUE',
                               MODELISATION='D_PLAN_ABSO'),
                             ),
                        );
                                                

SIEFCO=CREA_CHAMP(INFO=1,
                    TYPE_CHAM='ELGA_SIEF_R',
                    OPERATION='AFFE',
                    MODELE=MOD9B,
                    PROL_ZERO='OUI',
                    AFFE=_F(GROUP_MA=list_group_m2[0:nbcouche],
                            NOM_CMP =('SIXX','SIYY','SIZZ'),
                            VALE    =(ZERO,ZERO,ZERO)));
                            
INISIG=CREA_CHAMP(INFO=1,
                      TYPE_CHAM='ELGA_SIEF_R',
                      OPERATION='ASSE',
                      MODELE=MOD9B,
                      PROL_ZERO='OUI',
                      ASSE=(_F(GROUP_MA=list_group_ma[0:nbcouche],
                               CHAM_GD=SIG[9],
                               CUMUL='OUI',
                               COEF_R=1.0),
                            _F(GROUP_MA=list_group_m2[0:nbcouche],
                               CHAM_GD=SIEFCO,
                               CUMUL='OUI',
                               COEF_R=1.0),
                               
                            ),
                      );
                            
CARTCO = CREA_CHAMP(INFO = 1,
                   TYPE_CHAM='ELGA_NEUT_R',
                   OPERATION='AFFE',
                   MODELE=MOD9B,
                   PROL_ZERO='OUI',
                   AFFE=_F(GROUP_MA=list_group_m2[0:nbcouche],
                           NOM_CMP =('X1',),
                           VALE    =varico));
                           
INIVAR=CREA_CHAMP(INFO=1,
                      TYPE_CHAM='ELGA_VARI_R',
                      OPERATION='ASSE',
                      MODELE=MOD9B,
                      PROL_ZERO='OUI',
                      ASSE=(_F(GROUP_MA=list_group_ma[0:nbcouche],
                               CHAM_GD=VAR[9],
                               CUMUL='OUI',
                               COEF_R=1.0),
                            _F(GROUP_MA=list_group_m2[0:nbcouche],
                               CHAM_GD=CARTCO,
                               NOM_CMP =('X1',),
                               NOM_CMP_RESU=('V1',),
                               CUMUL='OUI',
                               COEF_R=1.0),
                              )
                         );
                         
INIDEP=CREA_CHAMP(INFO=1,
                      TYPE_CHAM='NOEU_DEPL_R',
                      OPERATION='ASSE',
                      MODELE=MOD9B,
                      OPTION='DEPL',
                      PROL_ZERO='OUI',
                      ASSE=(_F(GROUP_MA=list_group_ma[0:nbcouche],
                               CHAM_GD=DEP[9]),
                           ),
                   );
                         
AFFMAT1B=AFFE_MATERIAU(MAILLAGE=MA,
                      AFFE=(_F(GROUP_MA=list_group_ma[1:nbcouche],
                              MATER=MAT1),
                            _F(GROUP_MA=list_group_ma[0],
                              MATER=MAT0),
                            _F(GROUP_MA=list_group_m2[0:nbcouche],
                              MATER=MAT_DYN),
                            _F(GROUP_MA='BAS',
                              MATER=MAT_PAR),
                           ),
                     );
                     
AFFMAT2=AFFE_MATERIAU(MAILLAGE=MA,
                      AFFE=(_F(GROUP_MA=list_group_ma[0:nbcouche],
                              MATER=MAT_DY0),
                            _F(GROUP_MA=list_group_m2[0:nbcouche],
                              MATER=MAT_DYN),
                            _F(GROUP_MA='BAS',
                              MATER=MAT_PAR),
                           ),
                     );
AFFMAT2B=AFFE_MATERIAU(MAILLAGE=MA,
                      AFFE=(_F(GROUP_MA=list_group_ma[0:nbcouche],
                              MATER=MAT_DY0),
                            _F(GROUP_MA=list_group_m2[0],
                              MATER=MAT0),
                            _F(GROUP_MA=list_group_m2[1:nbcouche],
                              MATER=MAT1),
                            _F(GROUP_MA='BAS',
                              MATER=MAT_PAR),
                           ),
                     );
                     

BO_CONH0=AFFE_CHAR_MECA(MODELE=MOD9B,
                        DDL_IMPO=(
                                  _F(GROUP_NO='BAS',
                                     # DX=0., 
                                     DY=0.,
                                      ),
                                  _F(GROUP_NO='FREESURF',
                                     PRE1=0.,),
                                  ),
                       LIAISON_UNIF=(
                                  _F(GROUP_NO='BAS',
                                     DDL=('DX'), 
                                     ),
                                    ),
                       LIAISON_GROUP=             
                                (_F(GROUP_NO_1='LAT_LEFT',
                                    GROUP_NO_2='LAT_RIGH',
                                    DDL_1=('DX',),
                                    DDL_2=('DX',),
                                    COEF_MULT_1 = 1.,
                                    COEF_MULT_2 = -1.,
                                    COEF_IMPO = 0.,),
                                 _F(GROUP_NO_1='LAT_LEFT',
                                    GROUP_NO_2='LAT_RIGH',
                                    DDL_1=('DY',),
                                    DDL_2=('DY',),
                                    COEF_MULT_1 = 1.,
                                    COEF_MULT_2 = -1.,
                                    COEF_IMPO = 0.,),
                                 _F(GROUP_NO_1='LAT_LEFD',
                                    GROUP_NO_2='LAT_RIGD',
                                    DDL_1=('PRE1',),
                                    DDL_2=('PRE1',),
                                    COEF_MULT_1 = 1.,
                                    COEF_MULT_2 = -1.,
                                    COEF_IMPO = 0.,),
                                    ),
                        );
                        
BO_CONHM=AFFE_CHAR_MECA(MODELE=MOD9B,
                        DDL_IMPO=(_F(GROUP_NO='BAS',
                                     DX=0., DY=0.,),
                                  _F(GROUP_NO='FREESURF',
                                     PRE1=0.,),
                                  ),
                       LIAISON_GROUP=             
                                (_F(GROUP_NO_1='LAT_LEFT',
                                    GROUP_NO_2='LAT_RIGH',
                                    DDL_1=('DX',),
                                    DDL_2=('DX',),
                                    COEF_MULT_1 = 1.,
                                    COEF_MULT_2 = -1.,
                                    COEF_IMPO = 0.,),
                                 _F(GROUP_NO_1='LAT_LEFT',
                                    GROUP_NO_2='LAT_RIGH',
                                    DDL_1=('DY',),
                                    DDL_2=('DY',),
                                    COEF_MULT_1 = 1.,
                                    COEF_MULT_2 = -1.,
                                    COEF_IMPO = 0.,),
                                 _F(GROUP_NO_1='LAT_LEFD',
                                    GROUP_NO_2='LAT_RIGD',
                                    DDL_1=('PRE1',),
                                    DDL_2=('PRE1',),
                                    COEF_MULT_1 = 1.,
                                    COEF_MULT_2 = -1.,
                                    COEF_IMPO = 0.,),
                                    ),
                        );
TI_LI_IN=DEFI_LIST_REEL(DEBUT=-1.e-6, INTERVALLE=_F(JUSQU_A=0.,
                                                 NOMBRE=1,),);
MOD9_M = AFFE_MODELE(MAILLAGE=MA,
                       AFFE=(
                            _F(GROUP_MA    =list_group_ma[0:nbcouche],
                               PHENOMENE   ='MECANIQUE',
                               MODELISATION='D_PLAN'),
                            _F(GROUP_MA    =list_group_m2[0:nbcouche],
                               PHENOMENE   ='MECANIQUE',
                               MODELISATION='D_PLAN'),
                            _F(GROUP_MA    ='BAS',
                               PHENOMENE   ='MECANIQUE',
                               MODELISATION='D_PLAN_ABSO'),
                             ),
                        );
                        
                    
MACRO_MATR_ASSE(MODELE=MOD9_M, 
                CHAM_MATER=AFFMAT1,
                NUME_DDL=CO('NUM9M'),
                MATR_ASSE=(_F(MATRICE=CO('rigiM'),
                             OPTION='RIGI_MECA',),
                           _F(MATRICE=CO('massM'),
                             OPTION='MASS_MECA',),
                           ),
               );
               
MACRO_MATR_ASSE(MODELE=MOD9_M, 
                CHAM_MATER=AFFMAT2,
                NUME_DDL=CO('NUM9M2'),
                MATR_ASSE=(_F(MATRICE=CO('rigiM2'),
                             OPTION='RIGI_MECA',),
                           _F(MATRICE=CO('massM2'),
                             OPTION='MASS_MECA',),
                           ),
               );
                    
PESAY=CALC_CHAR_SEISME(  MATR_MASS=massM,   DIRECTION=( 0., 1.0, 0.,),
                              MONO_APPUI='OUI' );
                           
NUM9B = NUME_DDL( MODELE=MOD9B,CHARGE=BO_CONH0, );
                                                            
VAPESA1=CREA_CHAMP(TYPE_CHAM='NOEU_DEPL_R',
                    OPERATION='ASSE',
                    NUME_DDL=NUM9B,
                    MAILLAGE=MA,
                    ASSE=(
                    _F(GROUP_MA=list_group_ma[0:nbcouche],
                       CHAM_GD=DEP[9],
                       CUMUL='OUI',
                       COEF_R=0.0,),
                   _F(GROUP_MA=list_group_m2[0:nbcouche],
                       CHAM_GD=PESAY,
                       CUMUL='OUI',
                       COEF_R=1.0,),
                          ),
                   );
                   
CHVPESA1 = AFFE_CHAR_MECA(MODELE=MOD9B, VECT_ASSE=VAPESA1);

FOC = DEFI_CONSTANTE( VALE=9.81) ;

FOC2 = DEFI_CONSTANTE( VALE=9.81001) ;
                        

U9B=STAT_NON_LINE(MODELE=MOD9B,
                 CHAM_MATER=AFFMAT1B,
                 EXCIT=(_F(CHARGE=BO_CONH0),
                        _F(CHARGE=CHVPESA1, FONC_MULT=FOC,)),
                 COMP_INCR=(_F(RELATION='KIT_HM',
                               ITER_INTE_PAS=-10,
                               RELATION_KIT=('ELAS','LIQU_SATU','HYDR_UTIL'),
                               GROUP_MA=list_group_ma[0]),
                            _F(ITER_INTE_MAXI=50,
                               ITER_INTE_PAS=-10,
                               RESI_INTE_RELA=1E-7,
                               RELATION='KIT_HM',
                               RELATION_KIT=('HUJEUX','LIQU_SATU','HYDR_UTIL'),
                               GROUP_MA=list_group_ma[1:nbcouche]),
                            _F(RELATION='ELAS',
                               DEFORMATION='PETIT',
                               GROUP_MA=list_group_m2[0:nbcouche],
                               PARM_THETA=0.57,),
                            _F(RELATION='ELAS',
                               DEFORMATION='PETIT',
                               GROUP_MA=('BAS',),
                               PARM_THETA=0.57,),
                               ),
                 SOLVEUR=_F(RENUM='METIS',
                            STOP_SINGULIER='NON',
                            METHODE='MULT_FRONT',
                            NPREC=15,
                            SYME='NON'),
                 ETAT_INIT=_F(DEPL=INIDEP,
                              SIGM=INISIG,
                              VARI=INIVAR),
                 INCREMENT=_F(LIST_INST=TI_LI_IN,
                              SUBD_METHODE='UNIFORME',
                              SUBD_PAS=10,
                              SUBD_NIVEAU=10),
                 NEWTON=_F(MATRICE='TANGENTE',
                           REAC_ITER=1),
                 CONVERGENCE=_F(ITER_GLOB_MAXI=6,RESI_GLOB_RELA=1E-6));
                 
# IMPR_RESU(RESU=_F(RESULTAT=U9B));

MONOX=CALC_CHAR_SEISME(  MATR_MASS=massM2,   DIRECTION=( 1., 0.0, 0.,),
                              MONO_APPUI='OUI' );
                           
                                                            
VAMONO=CREA_CHAMP(TYPE_CHAM='NOEU_DEPL_R',
                    OPERATION='ASSE',
                    NUME_DDL=NUM9B,
                    MAILLAGE=MA,
                    # MODELE=MOD9B,
                    ASSE=(
                    _F(GROUP_MA=list_group_ma[0:nbcouche],
                       CHAM_GD=DEP[9],
                       CUMUL='OUI',
                       COEF_R=0.0,),
                   _F(GROUP_MA=list_group_m2[0:nbcouche],
                       CHAM_GD=MONOX,
                       CUMUL='OUI',
                       COEF_R=1.0,),
                          ),
                   );
                   
CHVMONO = AFFE_CHAR_MECA(MODELE=MOD9B, VECT_ASSE=VAMONO);

# SEISMIC SIGNAL Friuli_GEFDYN : FONC_MULT=ACCELE
INCLUDE(UNITE=90, INFO=1,);

T000 = 0.;
T_END = 4. ;
pas_gro = 0.0100;
pas_fin = 0.0010;
pas_hfin = 0.001;
pas_tfin = 0.000005;

# Instant list devoted to seism

L_INSTh=DEFI_LIST_REEL(DEBUT=T000,
                       INTERVALLE=_F(JUSQU_A=T_END,
                                     PAS=pas_hfin,),);

L_ARCH=DEFI_LIST_REEL(DEBUT=T000,
                      INTERVALLE=_F(JUSQU_A=T_END,
                                    PAS=pas_gro,),);
                                    
L_COMB=DEFI_LIST_REEL(DEBUT=T000,
                      INTERVALLE=_F(JUSQU_A=T_END,
                                    PAS=pas_gro,),);
                                                             

MATR0=CALC_MATR_ELEM(OPTION='RIGI_MECA',
                   MODELE=MOD9B,
                   CHAM_MATER=AFFMAT2B,
                   CHARGE=BO_CONH0,);
                   
NU=NUME_DDL(MATR_RIGI=MATR0,);

LIST=DEFI_LIST_REEL(DEBUT=0.0,
                    INTERVALLE=_F(JUSQU_A=pas_tfin,
                                  NOMBRE=1,),);
                                  
# On utilise une valeur de critere lache car on accepte tout champ de 
#   deplacement solution 

U9B=STAT_NON_LINE(reuse=U9B, 
                 MODELE=MOD9B,
                 CHAM_MATER=AFFMAT1B,
                 EXCIT=(_F(CHARGE=BO_CONH0),
                        _F(CHARGE=CHVPESA1, FONC_MULT=FOC2,),
                        _F(CHARGE=CHVMONO, FONC_MULT=ACCELE,),
                        ),
                 COMP_INCR=(_F(RELATION='KIT_HM',
                               ITER_INTE_PAS=-10,
                               RELATION_KIT=('ELAS','LIQU_SATU','HYDR_UTIL'),
                               GROUP_MA=list_group_ma[0]),
                            _F(ITER_INTE_MAXI=50,
                               ITER_INTE_PAS=-10,
                               RESI_INTE_RELA = 1E-7,
                               RELATION='KIT_HM',
                               RELATION_KIT=('HUJEUX','LIQU_SATU','HYDR_UTIL'),
                               GROUP_MA=list_group_ma[1:nbcouche]),
                            _F(RELATION='ELAS',
                               DEFORMATION='PETIT',
                               GROUP_MA=list_group_m2[0:nbcouche],
                               PARM_THETA=0.57,),
                            _F(RELATION='ELAS',
                               DEFORMATION='PETIT',
                               GROUP_MA=('BAS',),
                               PARM_THETA=0.57,),
                               ),
                 SOLVEUR=_F(RENUM='METIS',
                            STOP_SINGULIER='NON',
                            METHODE='MULT_FRONT',
                            NPREC=15,
                            SYME='NON'),
                 ETAT_INIT=_F(EVOL_NOLI=U9B,
                              INST=0.0,PRECISION=1.E-6,),
                 INCREMENT=_F(
                              LIST_INST=LIST, 
                              PRECISION=1.E-8,
                              INST_FIN=pas_tfin, 
                              SUBD_METHODE='AUCUNE',),
                 ARCHIVAGE=_F(
                               PAS_ARCH = 1,
                                      ),                              
                 NEWTON=_F(MATRICE='TANGENTE',
                           REAC_ITER=1),
                 CONVERGENCE=_F(ITER_GLOB_MAXI=10,RESI_GLOB_RELA=1E-6,
                                ARRET='OUI',),
                 INFO=1,
                 );                    
                    
                    
U0=CREA_CHAMP(TYPE_CHAM='NOEU_DEPL_R',
                OPERATION='EXTR',
                RESULTAT=U9B,
                NOM_CHAM='DEPL',
                INST=0.0,
                INFO=1,);
                
UT=CREA_CHAMP(TYPE_CHAM='NOEU_DEPL_R',
                OPERATION='EXTR',
                RESULTAT=U9B,
                NOM_CHAM='DEPL',
                INST=pas_tfin,
                INFO=1,);                
                
                
DU=CREA_CHAMP(TYPE_CHAM='NOEU_DEPL_R',
                    OPERATION='ASSE',
                    NUME_DDL=NU,
                    MAILLAGE=MA,
                    ASSE=(
                    _F(TOUT='OUI',
                       CHAM_GD=UT,
                       CUMUL='OUI',
                       COEF_R=1.0,),
                    _F(TOUT='OUI',
                       CHAM_GD=U0,
                       CUMUL='OUI',
                       COEF_R=-1.0,),                       
                          ),
                   );
                   
                                                      

SIGP=CREA_CHAMP(TYPE_CHAM='ELGA_SIEF_R',
                OPERATION='EXTR',
                RESULTAT=U9B,
                NOM_CHAM='SIEF_ELGA',
                INST=0.0,
                INFO=1,);
                
                
VARIP=CREA_CHAMP(TYPE_CHAM='ELGA_VARI_R',
                OPERATION='EXTR',
                RESULTAT=U9B,
                NOM_CHAM='VARI_ELGA',
                INST=0.0,
                INFO=1,);
                
                   

                                  
CONT=CALCUL(OPTION=('COMPORTEMENT','FORC_INT_ELEM','MATR_TANG_ELEM'),
                 MODELE=MOD9B,
                 CHAM_MATER=AFFMAT1B,
                 EXCIT=(_F(CHARGE=BO_CONH0),
                        _F(CHARGE=CHVPESA1, FONC_MULT=FOC2,),
                        _F(CHARGE=CHVMONO, FONC_MULT=ACCELE,),
                        ),
                 COMP_INCR=(_F(RELATION='KIT_HM',
                               ITER_INTE_PAS=-10,
                               RELATION_KIT=('ELAS','LIQU_SATU','HYDR_UTIL'),
                               GROUP_MA=list_group_ma[0]),
                            _F(ITER_INTE_MAXI=50,
                               ITER_INTE_PAS=-10,
                               RESI_INTE_RELA=1E-7,
                               RELATION='KIT_HM',
                               RELATION_KIT=('HUJEUX','LIQU_SATU','HYDR_UTIL'),
                               GROUP_MA=list_group_ma[1:nbcouche]),
                            _F(RELATION='ELAS',
                               DEFORMATION='PETIT',
                               GROUP_MA=list_group_m2[0:nbcouche],
                               PARM_THETA=0.57,),
                            _F(RELATION='ELAS',
                               DEFORMATION='PETIT',
                               GROUP_MA=('BAS',),
                               PARM_THETA=0.57,),
                               ),
            INCREMENT=_F(LIST_INST=LIST,
                         NUME_ORDRE=1),
            DEPL=U0,
            INCR_DEPL=DU,
            SIGM=SIGP,
            VARI=VARIP,
            INFO=1,);

MATR=EXTR_TABLE(TYPE_RESU='MATR_ELEM_DEPL_R',
                 TABLE=CONT,
                 NOM_PARA='NOM_SD',
                 FILTRE=_F(NOM_PARA='NOM_OBJET',
                           VALE_K='MATR_ELEM'),);
                 
                   
MATM=CALC_MATR_ELEM(OPTION='MASS_MECA',
                   MODELE=MOD9B,
                   CHAM_MATER=AFFMAT1B,
                   CHARGE=BO_CONH0,);
                   
MATASM=ASSE_MATRICE(MATR_ELEM=MATM, NUME_DDL=NU,);

MATASR=ASSE_MATRICE(MATR_ELEM=MATR, NUME_DDL=NU, SYME='OUI',);

IMPR_CO(CHAINE='MATASR             .LIME');

                                                                             
MODET=MACRO_MODE_MECA(MATR_A=MATASR, MATR_B=MATASM,
                       NMAX_ITER_SOREN=80,
                       CALC_FREQ=_F(
                                    FREQ=(-0.1,15.,40.,68.,
                                          ),
                                    DIM_SOUS_ESPACE=78,),  
                       VERI_MODE=_F(STOP_ERREUR='NON'),
                       IMPRESSION=_F(),
                       );
                       
                       
BAMODA=DEFI_BASE_MODALE( RITZ=( _F( MODE_MECA = MODET),
                               ),
                         NUME_REF=NU);
                         
NDDLGENE = NUME_DDL_GENE( BASE= BAMODA,
                          STOCKAGE= 'PLEIN',);
                          
                            
RIGIGEN=PROJ_MATR_BASE(  BASE=BAMODA,  NUME_DDL_GENE=NDDLGENE,
                            MATR_ASSE=MATASR );

MASSGEN=PROJ_MATR_BASE(  BASE=BAMODA,  NUME_DDL_GENE=NDDLGENE,
                            MATR_ASSE=MATASM );
                            
                            
modgen=MODE_ITER_SIMULT(MATR_A=RIGIGEN, MATR_B=MASSGEN,
                       CALC_FREQ=_F(
                                    OPTION='BANDE',
                                    FREQ=(-0.1,215.),
                                    ),
                       VERI_MODE=_F(STOP_ERREUR='NON',),
                         );
                         
                         
RESPHY=REST_GENE_PHYS(    RESU_GENE=modgen,
                          NOM_CHAM='DEPL',
                          TOUT_ORDRE='OUI'
                                        );
                                        
RESMOD=DEFI_BASE_MODALE( 
                   RITZ=( 
                         _F( MODE_MECA=RESPHY,NMAX_MODE = 99),
                        ),
                        NUME_REF=NU);
                        
MODEP = NORM_MODE(MODE=RESMOD, NORME='TRAN_ROTA', 
                  MASSE=MATASM, RAIDE=MATASR,
                  );
                                         
                       
                      
U9B2=DYNA_NON_LINE(
                 MODELE=MOD9B,
                 CHAM_MATER=AFFMAT1B,
                 EXCIT=(_F(CHARGE=BO_CONH0),
                        _F(CHARGE=CHVPESA1, FONC_MULT=FOC,),
                        _F(CHARGE=CHVMONO, FONC_MULT=ACCELE,),
                        ),
                 COMP_INCR=(_F(RELATION='KIT_HM',
                               ITER_INTE_PAS=-10,
                               RELATION_KIT=('ELAS','LIQU_SATU','HYDR_UTIL'),
                               GROUP_MA=list_group_ma[0]),
                            _F(ITER_INTE_MAXI=50,
                               ITER_INTE_PAS=-10,
                               RESI_INTE_RELA=1E-7,
                               RELATION='KIT_HM',
                               RELATION_KIT=('HUJEUX','LIQU_SATU','HYDR_UTIL'),
                               GROUP_MA=list_group_ma[1:nbcouche]),
                            _F(RELATION='ELAS',
                               DEFORMATION='PETIT',
                               GROUP_MA=list_group_m2[0:nbcouche],
                               PARM_THETA=0.57,),
                            _F(RELATION='ELAS',
                               DEFORMATION='PETIT',
                               GROUP_MA=('BAS',),
                               PARM_THETA=0.57,),
                               ),
                 SOLVEUR=_F(RENUM='METIS',
                            STOP_SINGULIER='NON',
                            METHODE='MULT_FRONT',
                            NPREC=15,
                            SYME='NON'),
                 PROJ_MODAL=_F(MODE_MECA = MODEP),                
                 ETAT_INIT=_F(EVOL_NOLI=U9B,
                              INST=0.0,PRECISION=1.E-6,),
                 INCREMENT=_F(
                              LIST_INST=L_INSTh, 
                              PRECISION=1.E-6,
                              SUBD_METHODE='UNIFORME',
                              SUBD_PAS=2,
                              SUBD_NIVEAU=20),
                 ARCHIVAGE=_F(
                               LIST_INST=L_ARCH,
                                      ),                              
                 SCHEMA_TEMPS=_F(SCHEMA='TCHAMWA',
                                 FORMULATION='ACCELERATION',
                                 PHI=1.17,STOP_CFL='NON',),
                 );                                                        
                                    
                                    
ACC_R1X=RECU_FONCTION(  RESULTAT=U9B2,
                        TITRE='ACC_R1X',
                        NOM_CHAM='ACCE',
                        NOM_CMP='DX',
                        NOEUD='N1',
                        PROL_DROITE='CONSTANT',
                        PROL_GAUCHE='CONSTANT',
                        INTERPOL='LIN',);
                        
ACC_R47X=RECU_FONCTION( RESULTAT=U9B2,
                        TITRE='ACC_R47X',
                        NOM_CHAM='ACCE',
                        NOM_CMP='DX',
                        NOEUD='N47',
                        PROL_DROITE='CONSTANT',
                        PROL_GAUCHE='CONSTANT',
                        INTERPOL='LIN',);
 
                         
ACC_A1X=CALC_FONCTION( LIST_PARA=L_COMB,
                       COMB=(  _F( FONCTION = ACC_R1X, COEF = 1.),
                               _F( FONCTION = ACCELE, COEF = 1.),),
                      );
                      
ACC_A47X=CALC_FONCTION( LIST_PARA=L_COMB,
                       COMB=(  _F( FONCTION = ACC_R47X, COEF = 1.),
                               _F( FONCTION = ACCELE, COEF = 1.),),
                      );
                      


TAB_INF1 = INFO_FONCTION(RMS = _F(FONCTION = ACC_A47X,INST_INIT=2.80,
                                    INST_FIN = 2.88, ))                                                   
TAB_INF2 = INFO_FONCTION(RMS = _F(FONCTION = ACC_A47X,INST_INIT=3.06,
                                    INST_FIN = 3.14, ))                                                   
TAB_INF3 = INFO_FONCTION(RMS = _F(FONCTION = ACC_A47X,INST_INIT=3.47,
                                    INST_FIN = 3.55, ))                                                   

TEST_TABLE(TABLE=TAB_INF1,NOM_PARA='RMS',
           VALE = 1.836,PRECISION = 0.01,
           REFERENCE = 'NON_REGRESSION')
TEST_TABLE(TABLE=TAB_INF1,NOM_PARA='RMS',
           VALE = 1.836,PRECISION = 0.01,
           REFERENCE = 'AUTRE_ASTER')
TEST_TABLE(TABLE=TAB_INF2,NOM_PARA='RMS',
           VALE = 1.362,PRECISION = 0.01,
           REFERENCE = 'NON_REGRESSION')
TEST_TABLE(TABLE=TAB_INF3,NOM_PARA='RMS',
           VALE = 2.290,PRECISION = 0.01,
           REFERENCE = 'NON_REGRESSION')


SPOSCI = CALC_FONCTION(SPEC_OSCI=_F(FONCTION=ACC_A47X,
                                 NORME=9.81, ),);


MAXSP = INFO_FONCTION(MAX = _F(FONCTION = SPOSCI,))   

TEST_TABLE(TABLE=MAXSP,
           NOM_PARA = 'FREQ',
           TYPE_TEST = 'MAX',
           VALE      = 2.45,
           PRECISION = 0.01,
           REFERENCE = 'NON_REGRESSION',);

FIN( );

