# MODIF  DATE 13/01/2011   AUTEUR PELLET J.PELLET 
# TITRE : EPROUVETTE ENTAILLE EN VISCOPLASTICITE
#            CONFIGURATION MANAGEMENT OF EDF VERSION
# ======================================================================
# COPYRIGHT (C) 1991 - 2011  EDF R&D                  WWW.CODE-ASTER.ORG
# THIS PROGRAM IS FREE SOFTWARE; YOU CAN REDISTRIBUTE IT AND/OR MODIFY  
# IT UNDER THE TERMS OF THE GNU GENERAL PUBLIC LICENSE AS PUBLISHED BY  
# THE FREE SOFTWARE FOUNDATION; EITHER VERSION 2 OF THE LICENSE, OR     
# (AT YOUR OPTION) ANY LATER VERSION.                                                    
#                                                                       
# THIS PROGRAM IS DISTRIBUTED IN THE HOPE THAT IT WILL BE USEFUL, BUT   
# WITHOUT ANY WARRANTY; WITHOUT EVEN THE IMPLIED WARRANTY OF            
# MERCHANTABILITY OR FITNESS FOR A PARTICULAR PURPOSE. SEE THE GNU      
# GENERAL PUBLIC LICENSE FOR MORE DETAILS.                              
#                                                                       
# YOU SHOULD HAVE RECEIVED A COPY OF THE GNU GENERAL PUBLIC LICENSE     
# ALONG WITH THIS PROGRAM; IF NOT, WRITE TO EDF R&D CODE_ASTER,         
#    1 AVENUE DU GENERAL DE GAULLE, 92141 CLAMART CEDEX, FRANCE.        
# ======================================================================
#        MODELISATION AXIS_SI
#====================================================================

DEBUT(CODE=_F( NOM = 'SSNA113A',NIV_PUB_WEB='INTERNET'));
 
PRE_GIBI();

MAIL = LIRE_MAILLAGE();


MAIL = DEFI_GROUP ( reuse = MAIL,
                 MAILLAGE = MAIL,
                 CREA_GROUP_NO=(_F( GROUP_MA = 'SYME',),              
                                _F( GROUP_MA = 'EFFO',),
                                _F( GROUP_MA = 'LIG',),
                                _F( GROUP_MA = 'NOTCH'),),);

MO=AFFE_MODELE(MAILLAGE=MAIL,
               VERIF='MAILLE',
               AFFE=_F(GROUP_MA='STOT',
                       PHENOMENE='MECANIQUE',
                       MODELISATION='AXIS_SI',),);

#xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx#
# Courbe Sigma=f(epsilon_totale) du CEA
#xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx#

SIGM_F = DEFI_FONCTION ( NOM_PARA = 'EPSI',
                          VALE = (
                                  0.002409731, 477.1267177,
                                  0.010088627, 512.5481424,
                                  0.020280218, 550.4832447,
                                  0.030431091, 580.3560802,
                                  0.040551839, 604.2641624,
                                  0.050650258, 623.7511615,
                                  0.060732087, 639.9532866,
                                  0.07080155,  653.7069759,
                                  0.080861758, 665.6281229,
                                  0.090915002, 676.1703617,
                                  0.100962969, 685.6679458,
                                  0.111006906, 694.3672945,
                                  0.121047728, 702.4501998,
                                  0.131086116, 710.0509006,
                                  0.138111812, 715.1387392,
                                  0.141122569, 717.2686429,
                                  0.151157459, 724.1769214,
                                  0.201315999, 755.5677203,
                                  0.301585802, 808.9887868,
                                  0.401811696, 853.7159011,
                                  0.502001836, 891.3634826,
                                  0.602161926, 923.0614179,
                                  0.702296719, 949.7503941,
                                  0.802410212, 972.221955,
                                  0.90250577,  991.1425412,
                                  1.002586229, 1007.073281,),
                                  PROL_DROITE = 'LINEAIRE',);

MA_EPR = DEFI_MATERIAU( ELAS=_F(E=2.15E5,
                                NU=0.3,
                                ALPHA=0.0,),
                        TRACTION=_F(SIGM=SIGM_F,),
                        VISC_SINH = _F( SIGM_0 = 6176,
                                         EPSI_0 = 3.31131121483E13,
                                         M = 6.76,),
                        ROUSSELIER = _F( D = 0.0001,
                                         SIGM_1 = 1575.,
                                         PORO_INIT = 0.000000005,),);


CM = AFFE_MATERIAU ( MAILLAGE = MAIL,
              AFFE = (_F( TOUT = 'OUI',
                          MATER = MA_EPR,),),);

CH=AFFE_CHAR_MECA(MODELE= MO,
                  DDL_IMPO=_F(GROUP_NO='LIG',
                              DY=0.0,),); 

CHT=AFFE_CHAR_MECA(MODELE= MO,
                   DDL_IMPO=_F(GROUP_NO='EFFO',
                                 DY=1.,),);                               

# PREMIER CALCUL : VITESSE RAPIDE 10E3 s-1
# ------------------------------------------------------------

IFIN = 0.001;

FCT_R=DEFI_FONCTION(NOM_PARA='INST',
                    VALE=(0.0,0.0,IFIN,1.0),
                    PROL_DROITE='EXCLU',
                    PROL_GAUCHE='EXCLU',);
 
L_INST_R=DEFI_LIST_REEL(DEBUT=0.0,
                      INTERVALLE=(_F(JUSQU_A=IFIN,
                                     NOMBRE=500,),),);

L_ARCH_R=DEFI_LIST_REEL(DEBUT=0.0,
                        INTERVALLE=_F(JUSQU_A=IFIN,
                                      NOMBRE=20,),);                                    

UR = STAT_NON_LINE (
          MODELE = MO, 
          CHAM_MATER = CM,
          EXCIT =(_F(CHARGE = CH,),
                  _F(CHARGE = CHT,
                     FONC_MULT = FCT_R),),
          COMP_INCR = _F(RELATION = 'VISC_ISOT_TRAC',
                         RESI_INTE_RELA=1.E-09,
                         ITER_INTE_MAXI=10, 
                         DEFORMATION = 'SIMO_MIEHE',),
          INCREMENT = _F(LIST_INST = L_INST_R,),
          ARCHIVAGE = _F(LIST_INST = L_ARCH_R,),
          NEWTON=_F(REAC_INCR=1,
                    MATRICE='TANGENTE',
                    REAC_ITER=1,),);

UR = CALC_ELEM ( reuse = UR,
                 OPTION = ('SIEF_ELNO',
                           'VARI_ELNO_ELGA',),
                 RESULTAT = UR,);
                 

UR = CALC_NO (  reuse = UR,
                RESULTAT   = UR,
                OPTION = 'REAC_NODA',);
# DEUXIEME CALCUL : VITESSE LENTE 10E(-3) s-1
# ------------------------------------------------------------

IFIN = 1000. ;

FCT_L=DEFI_FONCTION(NOM_PARA='INST',
                    VALE=(0.0,0.0,IFIN,1.0),
                    PROL_DROITE='EXCLU',
                    PROL_GAUCHE='EXCLU',);
 
L_INST_L=DEFI_LIST_REEL(DEBUT=0.0,
                      INTERVALLE=(_F(JUSQU_A=IFIN,
                                     NOMBRE=400,),),);

L_ARCH_L=DEFI_LIST_REEL(DEBUT=0.0,
                        INTERVALLE=_F(JUSQU_A=IFIN,
                                      NOMBRE=20,),);                                    

UL = STAT_NON_LINE (
          MODELE = MO, 
          CHAM_MATER = CM,
          EXCIT =(_F(CHARGE = CH,),
                  _F(CHARGE = CHT,
                     FONC_MULT = FCT_L),),
          COMP_INCR = _F(RELATION = 'VISC_ISOT_TRAC',
                         RESI_INTE_RELA=1.E-09,
                         ITER_INTE_MAXI=10, 
                         DEFORMATION = 'SIMO_MIEHE',),
          INCREMENT = _F(LIST_INST = L_INST_L,),
          ARCHIVAGE = _F(LIST_INST = L_ARCH_L,),
          NEWTON=_F(REAC_INCR=1,
                    MATRICE='TANGENTE',
                    REAC_ITER=1,),);

UL = CALC_ELEM ( reuse = UL,
                 OPTION = ('SIEF_ELNO',
                           'VARI_ELNO_ELGA',),
                 RESULTAT = UL,);
                 

UL = CALC_NO (  reuse = UL,
                RESULTAT   = UL,
                OPTION = 'REAC_NODA',);
                                
                
#-----------------------------------------------------------
# DEPOUILLEMENT DES RESULTATS
# ----------------------------------------------------------

CONTR_R  =  POST_RELEVE_T (
               ACTION = _F(GROUP_NO = 'NO_ENT',
                           INTITULE= 'Contraction diametrale',
                           RESULTAT = UR,
                           NOM_CHAM = 'DEPL',
                           NOM_CMP = 'DX',
                           OPERATION= 'EXTRACTION',),);

EFFORT_R =  POST_RELEVE_T (
              ACTION = _F(GROUP_NO= 'EFFO',
                          INTITULE= 'force',
                          RESULTAT=  UR,
                          NOM_CHAM = 'REAC_NODA',
                          RESULTANTE = ('DY'),
                          OPERATION= 'EXTRACTION',),);
                          
# IMPR_TABLE ( FORMAT = 'TABLEAU',
#              TABLE = EFFORT_R,
#              NOM_PARA=('INST','DY'));
# 
# IMPR_TABLE ( FORMAT = 'TABLEAU',
#              TABLE = CONTR_R,
#              NOM_PARA=('INST','DX'));

TEST_TABLE( TABLE=EFFORT_R,
            NOM_PARA='DY',
            FILTRE=_F(NOM_PARA = 'NUME_ORDRE', VALE_I = 1),
            VALE = 3.43132E+03,
            PRECISION=1.0E-2,
            REFERENCE='AUTRE_ASTER'
           )
TEST_TABLE( TABLE=CONTR_R,
            NOM_PARA='DX',
            FILTRE=_F(NOM_PARA = 'NUME_ORDRE', VALE_I = 1),
            VALE = -8.04110E-03,
            PRECISION=1.0E-2,
            REFERENCE='AUTRE_ASTER'
           )
TEST_TABLE( TABLE=EFFORT_R,
            NOM_PARA='DY',
            FILTRE=_F(NOM_PARA = 'NUME_ORDRE', VALE_I = 10),
            VALE =3.93495E+03,
            PRECISION=1.0E-2,
            REFERENCE='AUTRE_ASTER'
           )
TEST_TABLE( TABLE=CONTR_R,
            NOM_PARA='DX',
            FILTRE=_F(NOM_PARA = 'NUME_ORDRE', VALE_I = 10),
            VALE = -4.06758E-01,
            PRECISION=1.0E-2,
            REFERENCE='AUTRE_ASTER'
           )
TEST_TABLE( TABLE=EFFORT_R,
            NOM_PARA='DY',
            FILTRE=_F(NOM_PARA = 'NUME_ORDRE', VALE_I = 20),
            VALE =  3.17328E+03,
            PRECISION=1.0E-2,
            REFERENCE='AUTRE_ASTER'
           )
TEST_TABLE( TABLE=CONTR_R,
            NOM_PARA='DX',
            FILTRE=_F(NOM_PARA = 'NUME_ORDRE', VALE_I = 20),
            VALE =-8.89457E-01,
            PRECISION=1.0E-2,
            REFERENCE='AUTRE_ASTER'
           )

CONTR_L  =  POST_RELEVE_T (
               ACTION = _F(GROUP_NO = 'NO_ENT',
                           INTITULE= 'Contraction diametrale',
                           RESULTAT = UL,
                           NOM_CHAM = 'DEPL',
                           NOM_CMP = 'DX',
                           OPERATION= 'EXTRACTION',),);

EFFORT_L =  POST_RELEVE_T (
              ACTION = _F(GROUP_NO= 'EFFO',
                          INTITULE= 'force',
                          RESULTAT=  UL,
                          NOM_CHAM = 'REAC_NODA',
                          RESULTANTE = ('DY'),
                          OPERATION= 'EXTRACTION',),);
                          
# IMPR_TABLE ( FORMAT = 'TABLEAU',
#              TABLE = EFFORT_L,
#              NOM_PARA=('INST','DY'));
# 
# IMPR_TABLE ( FORMAT = 'TABLEAU',
#              TABLE = CONTR_L,
#              NOM_PARA=('INST','DX'));

TEST_TABLE( TABLE=EFFORT_L,
            NOM_PARA='DY',
            FILTRE=_F(NOM_PARA = 'NUME_ORDRE', VALE_I = 1),
            VALE = 2.86423E+03,
            PRECISION=1.0E-2,
            REFERENCE='AUTRE_ASTER'
           )
TEST_TABLE( TABLE=CONTR_L,
            NOM_PARA='DX',
            FILTRE=_F(NOM_PARA = 'NUME_ORDRE', VALE_I = 1),
            VALE = -1.52635E-02,
            PRECISION=1.0E-2,
            REFERENCE='AUTRE_ASTER'
           )
TEST_TABLE( TABLE=EFFORT_L,
            NOM_PARA='DY',
            FILTRE=_F(NOM_PARA = 'NUME_ORDRE', VALE_I = 10),
            VALE =3.36223E+03,
            PRECISION=1.0E-2,
            REFERENCE='AUTRE_ASTER'
           )
TEST_TABLE( TABLE=CONTR_L,
            NOM_PARA='DX',
            FILTRE=_F(NOM_PARA = 'NUME_ORDRE', VALE_I = 10),
            VALE = -4.19637E-01,
            PRECISION=1.0E-2,
            REFERENCE='AUTRE_ASTER'
           )
TEST_TABLE( TABLE=EFFORT_L,
            NOM_PARA='DY',
            FILTRE=_F(NOM_PARA = 'NUME_ORDRE', VALE_I = 20),
            VALE =  2.73903E+03,
            PRECISION=1.0E-2,
            REFERENCE='AUTRE_ASTER'
           )
TEST_TABLE( TABLE=CONTR_L,
            NOM_PARA='DX',
            FILTRE=_F(NOM_PARA = 'NUME_ORDRE', VALE_I = 20),
            VALE =-9.14404E-01,
            PRECISION=1.0E-2,
            REFERENCE='AUTRE_ASTER'
           )

FIN();
