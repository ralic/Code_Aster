# MODIF  DATE 10/05/2004   AUTEUR KANIT T.KANIT 
# TITRE COMPORTEMENTS ELASTOVISCOPLASTIQUES MONOCRISTALLINS
#            CONFIGURATION MANAGEMENT OF EDF VERSION
# ======================================================================
# COPYRIGHT (C) 1991 - 2004  EDF R&D                  WWW.CODE-ASTER.ORG
# THIS PROGRAM IS FREE SOFTWARE; YOU CAN REDISTRIBUTE IT AND/OR MODIFY  
# IT UNDER THE TERMS OF THE GNU GENERAL PUBLIC LICENSE AS PUBLISHED BY  
# THE FREE SOFTWARE FOUNDATION; EITHER VERSION 2 OF THE LICENSE, OR     
# (AT YOUR OPTION) ANY LATER VERSION.                                                    
#                                                                       
# THIS PROGRAM IS DISTRIBUTED IN THE HOPE THAT IT WILL BE USEFUL, BUT   
# WITHOUT ANY WARRANTY; WITHOUT EVEN THE IMPLIED WARRANTY OF            
# MERCHANTABILITY OR FITNESS FOR A PARTICULAR PURPOSE. SEE THE GNU      
# GENERAL PUBLIC LICENSE FOR MORE DETAILS.                              
#                                                                       
# YOU SHOULD HAVE RECEIVED A COPY OF THE GNU GENERAL PUBLIC LICENSE     
# ALONG WITH THIS PROGRAM; IF NOT, WRITE TO EDF R&D CODE_ASTER,         
#    1 AVENUE DU GENERAL DE GAULLE, 92141 CLAMART CEDEX, FRANCE.        
# ======================================================================

DEBUT(CODE=_F(NOM='SSNV172A',NIV_PUB_WEB='INTERNET',),);

CUBE=LIRE_MAILLAGE();

TROISD=AFFE_MODELE(MAILLAGE=CUBE,
                   AFFE    =_F(TOUT        ='OUI',
                               PHENOMENE   ='MECANIQUE',
                               MODELISATION='3D',),);

TFIN=1.5

NUMFIN=101

LINST=DEFI_LIST_REEL(DEBUT     =0.0,
                     INTERVALLE=(_F(JUSQU_A=0.87,
                                    NOMBRE =1,),
                                 _F(JUSQU_A=TFIN,
                                    NOMBRE =100,),),);
                                    
TRAC=AFFE_CHAR_MECA(MODELE      =TROISD,
                    DDL_IMPO    =(_F(NOEUD='NO4',
                                     DX   =0.0,
                                     DY   =0.0,),
                                  _F(NOEUD='NO8',
                                     DX   =0.0,
                                     DY   =0.0,
                                     DZ   =0.0,),
                                  _F(NOEUD='NO2',
                                     DX   =0.0,),
                                  _F(NOEUD='NO6',
                                     DX   =0.0,),),
                    FORCE_NODALE=(_F(NOEUD=('NO3','NO7',),
                                     FX   =35.0,),
                                  _F(NOEUD=('NO1','NO5',),
                                     FX   =35.0,),),);
                                     
COEF=DEFI_FONCTION(NOM_PARA   ='INST',
                   VALE       =(0.0,0.0,1.0,1.0,),
                   PROL_DROITE='LINEAIRE',
                   PROL_GAUCHE='LINEAIRE',);
                                                                     
ORIEN=AFFE_CARA_ELEM(MODELE=TROISD,
                     MASSIF=_F(GROUP_MA= 'TOUT',
                               ANGL_REP= (30.,0.,0.,),),);

ACIER=DEFI_MATERIAU(ELAS      =_F(E =145200.0,
                                  NU=0.3,),
                    ECOU_PLAS1=_F(TYPE_PARA='ECOU_PLAS',
                                  C        =40.,
                                  ),
                    ECRO_ISOT1=_F(TYPE_PARA='ECRO_ISOT',
                                  R_0      =75.5,
                                  B        =19.34,
                                  Q        =9.77,  
                                  H        =0.,
                                  ),
                    ECRO_CINE2=_F(TYPE_PARA='ECRO_CINE',
                                  D        =36.68,
                                  GM       =10.,
                                  PM       =1.5,
                                  C        =1.,
                                  ),);
                                    
                                    
MAT=AFFE_MATERIAU(MAILLAGE=CUBE,
                  AFFE    =_F(TOUT ="OUI",
                              MATER=ACIER,),);

        
COMPORT=DEFI_COMPOR(MONOCRISTAL=(_F(MATER         =ACIER,
                                    ECOULEMENT    ="ECOU_PLAS1",
                                    ECRO_ISOT     ="ECRO_ISOT1",
                                    ECRO_CINE     ="ECRO_CINE2",
                                    ELAS          ="ELAS",
                                    FAMI_SYST_GLIS='OCTAEDRIQUE',),),);
                                   

SOLNL=STAT_NON_LINE(MODELE     =TROISD,
                    CARA_ELEM  =ORIEN,
                    CHAM_MATER =MAT,
                    EXCIT      =(_F(CHARGE     =TRAC,
                                    FONC_MULT  =COEF,
                                    TYPE_CHARGE='FIXE_CSTE',),),
                    COMP_INCR  =(_F(RELATION   ='MONOCRISTAL',
                                    COMPOR     =COMPORT,
                                    DEFORMATION='PETIT',
                                    TOUT       ='OUI',),),
                    INCREMENT  =(_F(LIST_INST    =LINST,NUME_INST_FIN=NUMFIN,
                                    SUBD_PAS     =4,
                                    SUBD_PAS_MINI=0.000001,),),
                    NEWTON     =(_F(PREDICTION='EXTRAPOL',
                                    MATRICE   ='ELASTIQUE',
                                    REAC_ITER =0,),),
                    CONVERGENCE=(_F(RESI_GLOB_RELA=1e-06,
                                    ITER_GLOB_MAXI=100,
                                    RESI_INTE_RELA=1e-06,
                                    ITER_INTE_MAXI=100,
                                    ITER_INTE_PAS =-4,
                                    RESO_INTE     ='RUNGE_KUTTA_2',),),);
                                    
SOLNL=CALC_ELEM(reuse =SOLNL,
                MODELE=TROISD,
                CHAM_MATER=MAT,
                RESULTAT=SOLNL,
                OPTION=('EPSI_ELGA_DEPL','EPSP_ELGA',),); 
                
TEST_RESU(RESU=(_F(RESULTAT=SOLNL,
                   INST=TFIN,
                   NOM_CHAM='SIEF_ELGA',
                   NOM_CMP='SIXX',
                   MAILLE='MA1',
                   POINT=1,
                   VALE=-2.1E+02 ,
                   REFERENCE='ANALYTIQUE',
                   ),
                _F(RESULTAT=SOLNL,
                   INST=TFIN,
                   NOM_CHAM='EPSI_ELGA_DEPL',
                   NOM_CMP='EPXX',
                   MAILLE='MA1',
                   POINT=1,
                   REFERENCE='AUTRE_ASTER',
                   VALE=-1.44628E-03,),
                _F(RESULTAT=SOLNL,
                   INST=TFIN,
                   NOM_CHAM='EPSI_ELGA_DEPL',
                   NOM_CMP='EPYY',
                   MAILLE='MA1',
                   POINT=1,
                   REFERENCE='AUTRE_ASTER',
                   VALE=4.33884E-04 ,),
                _F(RESULTAT=SOLNL,
                   INST=TFIN,
                   NOM_CHAM='EPSP_ELGA',
                   NOM_CMP='EPYY',
                   MAILLE='MA1',
                   POINT=1,
                   REFERENCE='AUTRE_ASTER',
                   VALE=-5.42101E-20,),
                   ),);
                   
ACIER2=DEFI_MATERIAU(ELAS      =_F(E =145200.0,
                                  NU=0.3,),
                    ECOU_VISC2=_F(TYPE_PARA='ECOU_VISC',
                                  N        =10.,
                                  K        =40.,
                                  C        =0.,
                                  D        =10.,
                                  A        =1.,
                                  ),
                    ECRO_ISOT1=_F(TYPE_PARA='ECRO_ISOT',
                                  R_0      =75.5,
                                  B        =19.34,
                                  Q        =9.77,  
                                  H        =0.,
                                  ),
                    ECRO_CINE2=_F(TYPE_PARA='ECRO_CINE',
                                  D        =36.68,
                                  GM       =10.,
                                  PM       =1.5,
                                  C        =1.,
                                  ),);
                                    
MAT2=AFFE_MATERIAU(MAILLAGE=CUBE,
                  AFFE    =_F(TOUT ="OUI",
                              MATER=ACIER2,),);

COMPORT2=DEFI_COMPOR(MONOCRISTAL=(_F(MATER         =ACIER2,
                                    ECOULEMENT    ="ECOU_VISC2",
                                    ECRO_ISOT     ="ECRO_ISOT1",
                                    ECRO_CINE     ="ECRO_CINE2",
                                    ELAS          ="ELAS",
                                    FAMI_SYST_GLIS='OCTAEDRIQUE',),),);
                                   
SOLNL2=STAT_NON_LINE(MODELE     =TROISD,
                    CARA_ELEM  =ORIEN,
                    CHAM_MATER =MAT2,
                    EXCIT      =(_F(CHARGE     =TRAC,
                                    FONC_MULT  =COEF,
                                    TYPE_CHARGE='FIXE_CSTE',),),
                    COMP_INCR  =(_F(RELATION   ='MONOCRISTAL',
                                    COMPOR     =COMPORT2,
                                    DEFORMATION='PETIT',
                                    TOUT       ='OUI',),),
                    INCREMENT  =(_F(LIST_INST    =LINST,NUME_INST_FIN=NUMFIN,
                                    SUBD_PAS     =4,
                                    SUBD_PAS_MINI=0.000001,),),
                    NEWTON     =(_F(PREDICTION='EXTRAPOL',
                                    MATRICE   ='ELASTIQUE',
                                    REAC_ITER =0,),),
                    CONVERGENCE=(_F(RESI_GLOB_RELA=1e-06,
                                    ITER_GLOB_MAXI=100,
                                    RESI_INTE_RELA=1e-06,
                                    ITER_INTE_MAXI=100,
                                    ITER_INTE_PAS =-4,
                                    RESO_INTE     ='RUNGE_KUTTA_2',),),);
                                    
SOLNL2=CALC_ELEM(reuse =SOLNL2,
                MODELE=TROISD,
                CHAM_MATER=MAT2,
                RESULTAT=SOLNL2,
                OPTION=('EPSI_ELGA_DEPL','EPSP_ELGA',),); 
                
TEST_RESU(RESU=(_F(RESULTAT=SOLNL2,
                   INST=TFIN,
                   NOM_CHAM='SIEF_ELGA',
                   NOM_CMP='SIXX',
                   MAILLE='MA1',
                   POINT=1,
                   VALE=-2.1E+02 ,
                   REFERENCE='ANALYTIQUE',
                   ),
                _F(RESULTAT=SOLNL2,
                   INST=TFIN,
                   NOM_CHAM='EPSI_ELGA_DEPL',
                   NOM_CMP='EPXX',
                   MAILLE='MA1',
                   POINT=1,
                   REFERENCE='AUTRE_ASTER',
                   VALE=-1.89435E-03,),
                _F(RESULTAT=SOLNL2,
                   INST=TFIN,
                   NOM_CHAM='EPSI_ELGA_DEPL',
                   NOM_CMP='EPYY',
                   MAILLE='MA1',
                   POINT=1,
                   REFERENCE='AUTRE_ASTER',
                   VALE=5.03200E-04 ,),
                _F(RESULTAT=SOLNL2,
                   INST=TFIN,
                   NOM_CHAM='EPSP_ELGA',
                   NOM_CMP='EPYY',
                   MAILLE='MA1',
                   POINT=1,
                   REFERENCE='AUTRE_ASTER',
                   VALE=6.95598E-05,),
                   ),);
                   
ACIER3=DEFI_MATERIAU(ELAS      =_F(E =145200.0,
                                  NU=0.3,),
                    ECOU_VISC3=_F(TYPE_PARA='ECOU_VISC',
                                  K        =40.,
                                  TAUMU    =10.,
                                  GAMMA0   =10.,
                                  V        =1.,
                                  ),
                    ECRO_ISOT1=_F(TYPE_PARA='ECRO_ISOT',
                                  R_0      =75.5,
                                  B        =19.34,
                                  Q        =9.77,  
                                  H        =0.,
                                  ),
                    ECRO_CINE2=_F(TYPE_PARA='ECRO_CINE',
                                  D        =36.68,
                                  GM       =10.,
                                  PM       =1.5,
                                  C        =1.,
                                  ),);
                                                                             
MAT3=AFFE_MATERIAU(MAILLAGE=CUBE,
                  AFFE    =_F(TOUT ="OUI",
                              MATER=ACIER3,),);

COMPORT3=DEFI_COMPOR(MONOCRISTAL=(_F(MATER         =ACIER3,
                                    ECOULEMENT    ="ECOU_VISC3",
                                    ECRO_ISOT     ="ECRO_ISOT1",
                                    ECRO_CINE     ="ECRO_CINE2",
                                    ELAS          ="ELAS",
                                    FAMI_SYST_GLIS='OCTAEDRIQUE',),),);
                                   
SOLNL3=STAT_NON_LINE(MODELE     =TROISD,
                    CARA_ELEM  =ORIEN,
                    CHAM_MATER =MAT3,
                    EXCIT      =(_F(CHARGE     =TRAC,
                                    FONC_MULT  =COEF,
                                    TYPE_CHARGE='FIXE_CSTE',),),
                    COMP_INCR  =(_F(RELATION   ='MONOCRISTAL',
                                    COMPOR     =COMPORT3,
                                    DEFORMATION='PETIT',
                                    TOUT       ='OUI',),),
                    INCREMENT  =(_F(LIST_INST    =LINST,NUME_INST_FIN=NUMFIN,
                                    SUBD_PAS     =4,
                                    SUBD_PAS_MINI=0.000001,),),
                    NEWTON     =(_F(PREDICTION='EXTRAPOL',
                                    MATRICE   ='ELASTIQUE',
                                    REAC_ITER =0,),),
                    CONVERGENCE=(_F(RESI_GLOB_RELA=1e-06,
                                    ITER_GLOB_MAXI=100,
                                    RESI_INTE_RELA=1e-06,
                                    ITER_INTE_MAXI=100,
                                    ITER_INTE_PAS =-4,
                                    RESO_INTE     ='RUNGE_KUTTA_2',),),);
                                    
SOLNL3=CALC_ELEM(reuse =SOLNL3,
                MODELE=TROISD,
                CHAM_MATER=MAT3,
                RESULTAT=SOLNL3,
                OPTION=('EPSI_ELGA_DEPL','EPSP_ELGA',),); 
                
TEST_RESU(RESU=(_F(RESULTAT=SOLNL3,
                   INST=TFIN,
                   NOM_CHAM='SIEF_ELGA',
                   NOM_CMP='SIXX',
                   MAILLE='MA1',
                   POINT=1,
                   VALE=-2.1E+02 ,
                   REFERENCE='ANALYTIQUE',
                   ),
                _F(RESULTAT=SOLNL3,
                   INST=TFIN,
                   NOM_CHAM='EPSI_ELGA_DEPL',
                   NOM_CMP='EPXX',
                   MAILLE='MA1',
                   POINT=1,
                   REFERENCE='AUTRE_ASTER',
                   VALE=-1.44628E-03,),
                _F(RESULTAT=SOLNL3,
                   INST=TFIN,
                   NOM_CHAM='EPSI_ELGA_DEPL',
                   NOM_CMP='EPYY',
                   MAILLE='MA1',
                   POINT=1,
                   REFERENCE='AUTRE_ASTER',
                   VALE=4.33884E-04 ,),
                _F(RESULTAT=SOLNL3,
                   INST=TFIN,
                   NOM_CHAM='EPSP_ELGA',
                   NOM_CMP='EPYY',
                   MAILLE='MA1',
                   POINT=1,
                   REFERENCE='AUTRE_ASTER',
                   VALE=-5.42101E-20,),
                   ),);
                   
ACIER4=DEFI_MATERIAU(ELAS      =_F(E =145200.0,
                                  NU=0.3,),
                    ECOU_PLAS1=_F(TYPE_PARA='ECOU_PLAS',
                                  C        =40.,
                                  ),
                    ECRO_ISOT1=_F(TYPE_PARA='ECRO_ISOT',
                                  R_0      =75.5,
                                  B        =19.34,
                                  Q        =9.77,  
                                  H        =0.,
                                  ),
                    ECRO_CINE2=_F(TYPE_PARA='ECRO_CINE',
                                  D        =36.68,
                                  GM       =10.,
                                  PM       =1.5,
                                  C        =1.,
                                  ),);
                                                                                           
MAT4=AFFE_MATERIAU(MAILLAGE=CUBE,
                  AFFE    =_F(TOUT ="OUI",
                              MATER=ACIER4,),);
        
COMPORT4=DEFI_COMPOR(MONOCRISTAL=(_F(MATER         =ACIER4,
                                    ECOULEMENT    ="ECOU_PLAS1",
                                    ECRO_ISOT     ="ECRO_ISOT1",
                                    ECRO_CINE     ="ECRO_CINE2",
                                    ELAS          ="ELAS",
                                    FAMI_SYST_GLIS='BASAL',),),);
                                   
SOLNL4=STAT_NON_LINE(MODELE     =TROISD,
                    CARA_ELEM  =ORIEN,
                    CHAM_MATER =MAT4,
                    EXCIT      =(_F(CHARGE     =TRAC,
                                    FONC_MULT  =COEF,
                                    TYPE_CHARGE='FIXE_CSTE',),),
                    COMP_INCR  =(_F(RELATION   ='MONOCRISTAL',
                                    COMPOR     =COMPORT4,
                                    DEFORMATION='PETIT',
                                    TOUT       ='OUI',),),
                    INCREMENT  =(_F(LIST_INST    =LINST,NUME_INST_FIN=NUMFIN,
                                    SUBD_PAS     =4,
                                    SUBD_PAS_MINI=0.000001,),),
                    NEWTON     =(_F(PREDICTION='EXTRAPOL',
                                    MATRICE   ='ELASTIQUE',
                                    REAC_ITER =0,),),
                    CONVERGENCE=(_F(RESI_GLOB_RELA=1e-06,
                                    ITER_GLOB_MAXI=100,
                                    RESI_INTE_RELA=1e-06,
                                    ITER_INTE_MAXI=100,
                                    ITER_INTE_PAS =-4,
                                    RESO_INTE     ='RUNGE_KUTTA_2',),),);
                                    
SOLNL4=CALC_ELEM(reuse =SOLNL4,
                MODELE=TROISD,
                CHAM_MATER=MAT4,
                RESULTAT=SOLNL4,
                OPTION=('EPSI_ELGA_DEPL','EPSP_ELGA',),); 
                
TEST_RESU(RESU=(_F(RESULTAT=SOLNL4,
                   INST=TFIN,
                   NOM_CHAM='SIEF_ELGA',
                   NOM_CMP='SIXX',
                   MAILLE='MA1',
                   POINT=1,
                   VALE=-2.1E+02 ,
                   REFERENCE='ANALYTIQUE',
                   ),
                _F(RESULTAT=SOLNL4,
                   INST=TFIN,
                   NOM_CHAM='EPSI_ELGA_DEPL',
                   NOM_CMP='EPXX',
                   MAILLE='MA1',
                   POINT=1,
                   REFERENCE='AUTRE_ASTER',
                   VALE=-1.44628E-03,),
                _F(RESULTAT=SOLNL4,
                   INST=TFIN,
                   NOM_CHAM='EPSI_ELGA_DEPL',
                   NOM_CMP='EPYY',
                   MAILLE='MA1',
                   POINT=1,
                   REFERENCE='AUTRE_ASTER',
                   VALE=4.33884E-04 ,),
                _F(RESULTAT=SOLNL4,
                   INST=TFIN,
                   NOM_CHAM='EPSP_ELGA',
                   NOM_CMP='EPYY',
                   MAILLE='MA1',
                   POINT=1,
                   REFERENCE='AUTRE_ASTER',
                   VALE=-5.42101E-20,),
                   ),);
                   
ACIER5=DEFI_MATERIAU(ELAS      =_F(E =145200.0,
                                  NU=0.3,),
                    ECOU_PLAS1=_F(TYPE_PARA='ECOU_PLAS',
                                  C        =40.,
                                  ),
                    ECRO_ISOT1=_F(TYPE_PARA='ECRO_ISOT',
                                  R_0      =75.5,
                                  B        =19.34,
                                  Q        =9.77,  
                                  H        =0.,
                                  ),
                    ECRO_CINE2=_F(TYPE_PARA='ECRO_CINE',
                                  D        =36.68,
                                  GM       =10.,
                                  PM       =1.5,
                                  C        =1.,
                                  ),);
                                    
MAT5=AFFE_MATERIAU(MAILLAGE=CUBE,
                  AFFE    =_F(TOUT ="OUI",
                              MATER=ACIER5,),);

COMPORT5=DEFI_COMPOR(MONOCRISTAL=(_F(MATER         =ACIER5,
                                    ECOULEMENT    ="ECOU_PLAS1",
                                    ECRO_ISOT     ="ECRO_ISOT1",
                                    ECRO_CINE     ="ECRO_CINE2",
                                    ELAS          ="ELAS",
                                    FAMI_SYST_GLIS='CUBIQUE',),),);
                                   
SOLNL5=STAT_NON_LINE(MODELE     =TROISD,
                    CARA_ELEM  =ORIEN,
                    CHAM_MATER =MAT5,
                    EXCIT      =(_F(CHARGE     =TRAC,
                                    FONC_MULT  =COEF,
                                    TYPE_CHARGE='FIXE_CSTE',),),
                    COMP_INCR  =(_F(RELATION   ='MONOCRISTAL',
                                    COMPOR     =COMPORT5,
                                    DEFORMATION='PETIT',
                                    TOUT       ='OUI',),),
                    INCREMENT  =(_F(LIST_INST    =LINST,NUME_INST_FIN=NUMFIN,
                                    SUBD_PAS     =4,
                                    SUBD_PAS_MINI=0.000001,),),
                    NEWTON     =(_F(PREDICTION='EXTRAPOL',
                                    MATRICE   ='ELASTIQUE',
                                    REAC_ITER =0,),),
                    CONVERGENCE=(_F(RESI_GLOB_RELA=1e-06,
                                    ITER_GLOB_MAXI=100,
                                    RESI_INTE_RELA=1e-06,
                                    ITER_INTE_MAXI=100,
                                    ITER_INTE_PAS =-4,
                                    RESO_INTE     ='RUNGE_KUTTA_2',),),);
                                    
SOLNL5=CALC_ELEM(reuse =SOLNL5,
                MODELE=TROISD,
                CHAM_MATER=MAT5,
                RESULTAT=SOLNL5,
                OPTION=('EPSI_ELGA_DEPL','EPSP_ELGA',),); 
                
TEST_RESU(RESU=(_F(RESULTAT=SOLNL5,
                   INST=TFIN,
                   NOM_CHAM='SIEF_ELGA',
                   NOM_CMP='SIXX',
                   MAILLE='MA1',
                   POINT=1,
                   VALE=-2.1E+02 ,
                   REFERENCE='ANALYTIQUE',
                   ),
                _F(RESULTAT=SOLNL5,
                   INST=TFIN,
                   NOM_CHAM='EPSI_ELGA_DEPL',
                   NOM_CMP='EPXX',
                   MAILLE='MA1',
                   POINT=1,
                   REFERENCE='AUTRE_ASTER',
                   VALE=-1.44628E-03,),
                _F(RESULTAT=SOLNL5,
                   INST=TFIN,
                   NOM_CHAM='EPSI_ELGA_DEPL',
                   NOM_CMP='EPYY',
                   MAILLE='MA1',
                   POINT=1,
                   REFERENCE='AUTRE_ASTER',
                   VALE=4.33884E-04 ,),
                _F(RESULTAT=SOLNL5,
                   INST=TFIN,
                   NOM_CHAM='EPSP_ELGA',
                   NOM_CMP='EPYY',
                   MAILLE='MA1',
                   POINT=1,
                   REFERENCE='AUTRE_ASTER',
                   VALE=-5.42101E-20,),
                   ),);
                   
ACIER6=DEFI_MATERIAU(ELAS      =_F(E =145200.0,
                                  NU=0.3,),
                    ECOU_PLAS1=_F(TYPE_PARA='ECOU_PLAS',
                                  C        =40.,
                                  ),
                    ECRO_ISOT1=_F(TYPE_PARA='ECRO_ISOT',
                                  R_0      =75.5,
                                  B        =19.34,
                                  Q        =9.77,  
                                  H        =0.,
                                  ),
                    ECRO_CINE2=_F(TYPE_PARA='ECRO_CINE',
                                  D        =36.68,
                                  GM       =10.,
                                  PM       =1.5,
                                  C        =1.,
                                  ),);
                                    
MAT6=AFFE_MATERIAU(MAILLAGE=CUBE,
                  AFFE    =_F(TOUT ="OUI",
                              MATER=ACIER6,),);

COMPORT6=DEFI_COMPOR(MONOCRISTAL=(_F(MATER         =ACIER6,
                                    ECOULEMENT    ="ECOU_PLAS1",
                                    ECRO_ISOT     ="ECRO_ISOT1",
                                    ECRO_CINE     ="ECRO_CINE2",
                                    ELAS          ="ELAS",
                                    FAMI_SYST_GLIS='MACLAGE',),),);
                                   
SOLNL6=STAT_NON_LINE(MODELE     =TROISD,
                    CARA_ELEM  =ORIEN,
                    CHAM_MATER =MAT6,
                    EXCIT      =(_F(CHARGE     =TRAC,
                                    FONC_MULT  =COEF,
                                    TYPE_CHARGE='FIXE_CSTE',),),
                    COMP_INCR  =(_F(RELATION   ='MONOCRISTAL',
                                    COMPOR     =COMPORT6,
                                    DEFORMATION='PETIT',
                                    TOUT       ='OUI',),),
                    INCREMENT  =(_F(LIST_INST    =LINST,NUME_INST_FIN=NUMFIN,
                                    SUBD_PAS     =4,
                                    SUBD_PAS_MINI=0.000001,),),
                    NEWTON     =(_F(PREDICTION='EXTRAPOL',
                                    MATRICE   ='ELASTIQUE',
                                    REAC_ITER =0,),),
                    CONVERGENCE=(_F(RESI_GLOB_RELA=1e-06,
                                    ITER_GLOB_MAXI=100,
                                    RESI_INTE_RELA=1e-06,
                                    ITER_INTE_MAXI=100,
                                    ITER_INTE_PAS =-4,
                                    RESO_INTE     ='RUNGE_KUTTA_2',),),);
                                    
SOLNL6=CALC_ELEM(reuse =SOLNL6,
                MODELE=TROISD,
                CHAM_MATER=MAT6,
                RESULTAT=SOLNL6,
                OPTION=('EPSI_ELGA_DEPL','EPSP_ELGA',),); 
                
TEST_RESU(RESU=(_F(RESULTAT=SOLNL6,
                   INST=TFIN,
                   NOM_CHAM='SIEF_ELGA',
                   NOM_CMP='SIXX',
                   MAILLE='MA1',
                   POINT=1,
                   VALE=-2.1E+02 ,
                   REFERENCE='ANALYTIQUE',
                   ),
                _F(RESULTAT=SOLNL6,
                   INST=TFIN,
                   NOM_CHAM='EPSI_ELGA_DEPL',
                   NOM_CMP='EPXX',
                   MAILLE='MA1',
                   POINT=1,
                   REFERENCE='AUTRE_ASTER',
                   VALE=-1.44628E-03,),
                _F(RESULTAT=SOLNL6,
                   INST=TFIN,
                   NOM_CHAM='EPSI_ELGA_DEPL',
                   NOM_CMP='EPYY',
                   MAILLE='MA1',
                   POINT=1,
                   REFERENCE='AUTRE_ASTER',
                   VALE=4.33884E-04 ,),
                _F(RESULTAT=SOLNL6,
                   INST=TFIN,
                   NOM_CHAM='EPSP_ELGA',
                   NOM_CMP='EPYY',
                   MAILLE='MA1',
                   POINT=1,
                   REFERENCE='AUTRE_ASTER',
                   VALE=-5.42101E-20,),
                   ),);
                   

FIN();
