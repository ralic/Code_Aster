# MODIF  DATE 30/05/2007   AUTEUR COURTOIS M.COURTOIS 
# TITRE POUTRE CANTILEVER . VALIDATION DE LA METHODE ARLEQUIN
#            CONFIGURATION MANAGEMENT OF EDF VERSION
# ======================================================================
# COPYRIGHT (C) 1991 - 2007  EDF R&D                  WWW.CODE-ASTER.ORG
# THIS PROGRAM IS FREE SOFTWARE; YOU CAN REDISTRIBUTE IT AND/OR MODIFY  
# IT UNDER THE TERMS OF THE GNU GENERAL PUBLIC LICENSE AS PUBLISHED BY  
# THE FREE SOFTWARE FOUNDATION; EITHER VERSION 2 OF THE LICENSE, OR     
# (AT YOUR OPTION) ANY LATER VERSION.                                                    
#                                                                       
# THIS PROGRAM IS DISTRIBUTED IN THE HOPE THAT IT WILL BE USEFUL, BUT   
# WITHOUT ANY WARRANTY; WITHOUT EVEN THE IMPLIED WARRANTY OF            
# MERCHANTABILITY OR FITNESS FOR A PARTICULAR PURPOSE. SEE THE GNU      
# GENERAL PUBLIC LICENSE FOR MORE DETAILS.                              
#                                                                       
# YOU SHOULD HAVE RECEIVED A COPY OF THE GNU GENERAL PUBLIC LICENSE     
# ALONG WITH THIS PROGRAM; IF NOT, WRITE TO EDF R&D CODE_ASTER,         
#    1 AVENUE DU GENERAL DE GAULLE, 92141 CLAMART CEDEX, FRANCE.        
# ======================================================================


# RACCORD 3D-COQUE (DKT)

DEBUT(  CODE=_F(  NOM = 'SSLP104C',NIV_PUB_WEB='INTERNET') );

# CARACTERISTIQUES
                      
force = 1000000.0;

epais = 1.0;

young = 200000000000.0;

hauteur = 2.0;

long = 10.0;

inertie = hauteur*epais*epais*epais/12;

#

PRE_GMSH();

MAIL=LIRE_MAILLAGE();

MAIL=DEFI_GROUP(reuse =MAIL,
                MAILLAGE=MAIL,
                CREA_GROUP_NO=(_F(GROUP_MA='GM53',),
                               _F(GROUP_MA='GM54',),),);

MOD=AFFE_MODELE(MAILLAGE=MAIL,
                AFFE=(_F(GROUP_MA=('GM1000','GM101','GM50',),
                         PHENOMENE='MECANIQUE',
                         MODELISATION='3D',),
                      _F(GROUP_MA=('GM100','GM53','GM51',),
                         PHENOMENE='MECANIQUE',
                         MODELISATION='DKT',),),);

MATER=DEFI_MATERIAU(ELAS=_F(E=young,
                            NU=0.3,),);

CHMATER=AFFE_MATERIAU(MAILLAGE=MAIL,
                      AFFE=_F(TOUT='OUI',
                              MATER=MATER,),);

CARA=AFFE_CARA_ELEM(MODELE=MOD,
                    COQUE=_F(GROUP_MA='GM100',
                             EPAIS=epais,),);

EFFORT=AFFE_CHAR_MECA(MODELE=MOD,
                      FORCE_ARETE=_F(GROUP_MA='GM51',
                                     FZ=-force,),);

ENCAST=AFFE_CHAR_MECA(MODELE=MOD,
                      DDL_IMPO=_F(GROUP_MA='GM101',
                                  LIAISON='ENCASTRE',),);

ARLQ=AFFE_CHAR_MECA(MODELE=MOD,INFO=1,
                    ARLEQUIN=_F(GROUP_MA_1='GM1000',
                                GROUP_MA_2='GM100',
                                CARA_ELEM=CARA,
                                COLLAGE='GROUP_MA_2',
                                POIDS_FIN=0.9999,),);

# ON EST EN RENUM MDA CAR PLANTAGE EN METIS (2 JANVIER 2006)

RESU=MECA_STATIQUE(MODELE=MOD,
                   CHAM_MATER=CHMATER,
                   CARA_ELEM=CARA,
                     SOLVEUR=_F(RENUM='MDA',
                                METHODE='MULT_FRONT',),                   
                   EXCIT=(_F(CHARGE=ARLQ,),
                          _F(CHARGE=EFFORT,),
                          _F(CHARGE=ENCAST,),),);
                          

# RESULTATS DU CALCUL

RESU=CALC_ELEM(reuse =RESU,
               RESULTAT=RESU,
               OPTION=('SIGM_ELNO_DEPL','EQUI_ELNO_SIGM',),);

RESU=CALC_NO(reuse =RESU,
             RESULTAT=RESU,
             OPTION=('EQUI_NOEU_SIGM','SIGM_NOEU_DEPL',),);


# FLECHE MAXI
# Solution theorique         
X = 9.42857              
fxtheo = -1*(force*hauteur/2./young/inertie*(long*X*X-X*X*X/3))
 
DPL_2D=POST_RELEVE_T(ACTION=_F(INTITULE='DEPL_2D',
                               
                               GROUP_NO='GM53',
                               RESULTAT=RESU,
                               NOM_CHAM='DEPL',
                               NOM_CMP='DZ',
                               OPERATION='EXTRACTION',),);

IMPR_TABLE(TABLE=DPL_2D)

  
TEST_TABLE(TABLE=DPL_2D,
           NOM_PARA='DZ',
           FILTRE = _F(NOM_PARA='COOR_X',VALE=X),
           VALE = fxtheo,
           REFERENCE= 'ANALYTIQUE',
           CRITERE = 'RELATIF',
           PRECISION = 0.02,);

TEST_TABLE(TABLE=DPL_2D,
           NOM_PARA='DZ',
           FILTRE = _F(NOM_PARA='COOR_X',VALE=X),
           VALE = -1.7942266587517E-02,
           REFERENCE= 'NON_REGRESSION',
           VERSION = '9.0.4',
           CRITERE = 'RELATIF',
           PRECISION = 2E-6,);
              
# CONTRAINTE DE TRACTION SIXX en suivant Z et X
# Solution theorique  
X = 3.00000E+00 
Z = 8.88889E-01            
sixxth = force*hauteur*(long-X)*(Z-epais/2.)/inertie
            
                   
SIXX_Z=POST_RELEVE_T(ACTION=_F(INTITULE='SIXX',
                               GROUP_NO='GM54',
                               RESULTAT=RESU,
                               NOM_CHAM='SIGM_NOEU_DEPL',
                               NOM_CMP='SIXX',
                               OPERATION='EXTRACTION',),);

IMPR_TABLE(TABLE=SIXX_Z)

TEST_TABLE(TABLE=SIXX_Z,
           FILTRE = _F(NOM_PARA='COOR_Z',VALE=Z),
           NOM_PARA='SIXX',
           VALE = sixxth,
           REFERENCE= 'ANALYTIQUE',
           CRITERE = 'RELATIF',
           PRECISION = 0.14,);

TEST_TABLE(TABLE=SIXX_Z,
           FILTRE = _F(NOM_PARA='COOR_Z',VALE=Z),
           NOM_PARA='SIXX',
           VALE = 3.7065127737457E+07,
           REFERENCE= 'NON_REGRESSION',
           VERSION = '9.0.4',
           CRITERE = 'RELATIF',
           PRECISION = 0.00005,);
           
           
# L INSTANT EST EGAL A LA VALEUR DE LA TRACTION SUR HAUT

F_DEPL=DEFI_FONCTION(NOM_PARA='INST',
                     VALE=(0.0,0.0,
                           1.0,1.0,),);
                     
# DISCRETISATION EN TEMPS

L_INST=DEFI_LIST_REEL(DEBUT=0.0,
                      INTERVALLE=(_F(JUSQU_A=1.0,
                                     NOMBRE=1,),
                                  ),);

# ON EST EN RENUM MDA CAR PLANTAGE EN METIS (2 JANVIER 2006)

RESUNL=STAT_NON_LINE(MODELE=MOD,
                   CHAM_MATER=CHMATER,
                   CARA_ELEM = CARA,
                     SOLVEUR=_F(RENUM='MDA',
                                METHODE='MULT_FRONT',),                   
                   EXCIT=(_F(CHARGE=ENCAST,),
                          _F(CHARGE=EFFORT,
                             FONC_MULT=F_DEPL,),
                          _F(CHARGE=ARLQ,),),
                   COMP_INCR=_F(RELATION='ELAS',),
                   INCREMENT=_F(LIST_INST=L_INST),
                   NEWTON=_F(REAC_INCR=1,
                             REAC_ITER=1,),
                   ARCHIVAGE=_F(LIST_INST=L_INST,),);           

#### POST-TRAITEMENT

RESUNL=CALC_ELEM(reuse =RESUNL,
               RESULTAT=RESUNL,
               OPTION=('SIEF_ELNO_ELGA',),);

RESUNL=CALC_NO(reuse =RESUNL,
             RESULTAT=RESUNL,
             OPTION=('SIEF_NOEU_ELGA',),);


DPL_2DN=POST_RELEVE_T(ACTION=_F(INTITULE='DEPL_2D',
                                INST = 1.0,
                               GROUP_NO='GM53',
                               RESULTAT=RESUNL,
                               NOM_CHAM='DEPL',
                               NOM_CMP='DZ',
                               OPERATION='EXTRACTION',),);

IMPR_TABLE(TABLE=DPL_2DN)

X = 9.42857 

TEST_TABLE(TABLE=DPL_2DN,
           NOM_PARA='DZ',
           FILTRE = _F(NOM_PARA='COOR_X',VALE=X),
           VALE = -1.7942266587487E-02,
           REFERENCE= 'NON_REGRESSION',
           VERSION = '9.0.4',
           CRITERE = 'RELATIF',
           PRECISION = 2E-6,);

TEST_TABLE(TABLE=DPL_2DN,
           NOM_PARA='DZ',
           FILTRE = _F(NOM_PARA='COOR_X',VALE=X),
           VALE = -1.7942266587517E-02,
           REFERENCE= 'AUTRE_ASTER',
           CRITERE = 'RELATIF',
           PRECISION = 2E-6,);

SIXX_ZN=POST_RELEVE_T(ACTION=_F(INTITULE='SIXX',
                               INST = 1.0,
                               GROUP_NO='GM54',
                               RESULTAT=RESUNL,
                               NOM_CHAM='SIEF_NOEU_ELGA',
                               NOM_CMP='SIXX',
                               OPERATION='EXTRACTION',),);

IMPR_TABLE(TABLE=SIXX_ZN)
 
Z = 8.88889E-01

TEST_TABLE(TABLE=SIXX_ZN,
           FILTRE = _F(NOM_PARA='COOR_Z',VALE=Z),
           NOM_PARA='SIXX',
           VALE = 3.7065127737379E+07,
           REFERENCE= 'NON_REGRESSION',
           VERSION = '9.0.4',
           CRITERE = 'RELATIF',
           PRECISION = 0.00005,);
           
TEST_TABLE(TABLE=SIXX_ZN,
           FILTRE = _F(NOM_PARA='COOR_Z',VALE=Z),
           NOM_PARA='SIXX',
           VALE = 3.7065127737457E+07,
           REFERENCE= 'AUTRE_ASTER',
           CRITERE = 'RELATIF',
           PRECISION = 0.00005,);           

FIN();
