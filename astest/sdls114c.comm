# MODIF  DATE 20/10/2011   AUTEUR SELLENET N.SELLENET 
# TITRE CALCUL DES FACTEURS D INTENSITE DES CONTRAINTES POUR UNE MODE PROPRE
# sdls114c.para = tps_job 240 mem_job 256Mo liste_test S
#            CONFIGURATION MANAGEMENT OF EDF VERSION
# ======================================================================
# COPYRIGHT (C) 1991 - 2011  EDF R&D                  WWW.CODE-ASTER.ORG
# THIS PROGRAM IS FREE SOFTWARE; YOU CAN REDISTRIBUTE IT AND/OR MODIFY  
# IT UNDER THE TERMS OF THE GNU GENERAL PUBLIC LICENSE AS PUBLISHED BY  
# THE FREE SOFTWARE FOUNDATION; EITHER VERSION 2 OF THE LICENSE, OR     
# (AT YOUR OPTION) ANY LATER VERSION.                                                    
#                                                                       
# THIS PROGRAM IS DISTRIBUTED IN THE HOPE THAT IT WILL BE USEFUL, BUT   
# WITHOUT ANY WARRANTY; WITHOUT EVEN THE IMPLIED WARRANTY OF            
# MERCHANTABILITY OR FITNESS FOR A PARTICULAR PURPOSE. SEE THE GNU      
# GENERAL PUBLIC LICENSE FOR MORE DETAILS.                              
#                                                                       
# YOU SHOULD HAVE RECEIVED A COPY OF THE GNU GENERAL PUBLIC LICENSE     
# ALONG WITH THIS PROGRAM; IF NOT, WRITE TO EDF R&D CODE_ASTER,         
#    1 AVENUE DU GENERAL DE GAULLE, 92141 CLAMART CEDEX, FRANCE.        
# ======================================================================

DEBUT(CODE=_F( NOM = 'SDLS114c',NIV_PUB_WEB='INTERNET',VISU_EFICAS='NON'))

# MODELISATION D : X-FEM 2D

# DEFINITION DES PARAMETRES DU CALCUL
n_mode = 15
tau = 0.01
t_fin = 0.013
pas = 2.5E-7

M = LIRE_MAILLAGE(FORMAT='MED',);

M=DEFI_GROUP(reuse =M,
                    MAILLAGE=M,
                    CREA_GROUP_NO=_F(GROUP_MA='COT_INF',),);
                    
#----------------------------------------------
#                   MODELE ET FISSURE
#----------------------------------------------

MODELEIN=AFFE_MODELE(MAILLAGE=M,
                     AFFE=(_F(GROUP_MA='SURF',
                              PHENOMENE='MECANIQUE',
                              MODELISATION='C_PLAN',),
                           _F(GROUP_MA=('COT_INF','COT_SUP',),
                              PHENOMENE='MECANIQUE',
                              MODELISATION='C_PLAN',),
                              ),
                              );

M=MODI_MAILLAGE(reuse =M,
                MAILLAGE=M,
                ORIE_PEAU_2D=_F(GROUP_MA=('COT_SUP','COT_INF',),),);



FISS=DEFI_FISS_XFEM(MODELE=MODELEIN,
                    DEFI_FISS=_F(FORM_FISS ='SEGMENT',
                                 PFON_ORIG  =(0.051 ,0.05,0.0),
                                 PFON_EXTR  =(0.045,0.05,0.0),
                                 ),
                    GROUP_MA_ENRI='SURF',
                    TYPE_ENRI_FOND='GEOMETRIQUE',
                    INFO=1,);


MO=MODI_MODELE_XFEM(MODELE_IN=MODELEIN,
                         FISSURE=FISS,
                         INFO=1,);
                                             


#----------------------------------------------
#                   MATERIAU
#----------------------------------------------
                 
MA=DEFI_MATERIAU(ELAS=_F(E=200.0E+9,
                         NU=0.3,
                         ALPHA = 0.,
                         RHO=7800,),);

CM=AFFE_MATERIAU(MAILLAGE=M,
                 AFFE=_F(TOUT='OUI',
                         MATER=MA,
                         ),);  
                         
#----------------------------------------------
#                   CHARGEMENTS
#----------------------------------------------

BLOCAGE=AFFE_CHAR_MECA(MODELE=MO,
                       DDL_IMPO=(_F(GROUP_MA='COT_SUP',
                                    DX = 0,),
                                 _F(GROUP_MA='COT_SUP',
                                    DY = 0,),),
                      );

CHAR=AFFE_CHAR_MECA(MODELE=MO,
                    FORCE_NODALE=_F(GROUP_NO='COT_INF',
                                  FX=-1000,), 
                    );   

                                    
#################################
#  CONSTRUCTION DES MATRICES
#################################

MRIGI=CALC_MATR_ELEM(OPTION='RIGI_MECA',
                     MODELE=MO,
                     CHAM_MATER=CM,
                     CHARGE=BLOCAGE);

MMASSE=CALC_MATR_ELEM(OPTION='MASS_MECA',
                      MODELE=MO,
                      CHAM_MATER=CM,
                      CHARGE=BLOCAGE,);

NUM=NUME_DDL(MODELE= MO,
             CHARGE=(BLOCAGE,CHAR),);

RIG_ASS=ASSE_MATRICE(MATR_ELEM=MRIGI,
                     NUME_DDL=NUM,);

MA_ASS=ASSE_MATRICE(MATR_ELEM=MMASSE,
                    NUME_DDL=NUM,);


##################################
#  CALCUL DES MODES PROPRES ET DES K_MODAUX
##################################

MODE=MODE_ITER_SIMULT(MATR_A=RIG_ASS,
                      MATR_B=MA_ASS,
                      CALC_FREQ=_F(NMAX_FREQ=n_mode,),);


MODE=NORM_MODE(reuse=MODE,
               MODE=MODE,
               NORME='MASS_GENE',);
               
GLMO1 = CALC_G(  RESULTAT=MODE,
                 OPTION='K_G_MODA',
                 THETA=_F( FISSURE=FISS,
                                   R_INF=0.25E-4,
                                   R_SUP=0.75E-4,
                                   ),
                         );
IMPR_TABLE(TABLE=GLMO1); 

#######################################################                       
# VALEUR REFERENCE de K1 (K_G_MODA)
#######################################################                         

# la reference est obtenue par fissure maillee (SDLS114A)

TEST_TABLE(TABLE=GLMO1,
           NOM_PARA='K1',
           FILTRE=_F(NOM_PARA = 'NUME_MODE',
                      VALE_I = 1),  
           VALE=-1.898E+10,
           PRECISION=0.0012,
           REFERENCE = 'AUTRE_ASTER',
             ); 
                                               
TEST_TABLE(TABLE=GLMO1,
           NOM_PARA='K1',
           FILTRE=_F(NOM_PARA = 'NUME_MODE',
                      VALE_I = 2),  
           VALE=-1.152E+11,
           PRECISION=0.015,
           REFERENCE = 'AUTRE_ASTER',
             );   

FIN();
