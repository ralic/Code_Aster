# MODIF  DATE 21/02/2011   AUTEUR ABBAS M.ABBAS 
# RESPONSABLE JMBHH01 J.M.PROIX
# TITRE CLAQUAGE  CALOTTE CYLINDRIQUE SHB8  
# ssns101a.para = tps_job 100 mem_job 128Mo ncpus 1 liste_test S
#            CONFIGURATION MANAGEMENT OF EDF VERSION
# ======================================================================
# COPYRIGHT (C) 1991 - 2011  EDF R&D                  WWW.CODE-ASTER.ORG
# THIS PROGRAM IS FREE SOFTWARE; YOU CAN REDISTRIBUTE IT AND/OR MODIFY  
# IT UNDER THE TERMS OF THE GNU GENERAL PUBLIC LICENSE AS PUBLISHED BY  
# THE FREE SOFTWARE FOUNDATION; EITHER VERSION 2 OF THE LICENSE, OR     
# (AT YOUR OPTION) ANY LATER VERSION.                                                    
#                                                                       
# THIS PROGRAM IS DISTRIBUTED IN THE HOPE THAT IT WILL BE USEFUL, BUT   
# WITHOUT ANY WARRANTY; WITHOUT EVEN THE IMPLIED WARRANTY OF            
# MERCHANTABILITY OR FITNESS FOR A PARTICULAR PURPOSE. SEE THE GNU      
# GENERAL PUBLIC LICENSE FOR MORE DETAILS.                              
#                                                                       
# YOU SHOULD HAVE RECEIVED A COPY OF THE GNU GENERAL PUBLIC LICENSE     
# ALONG WITH THIS PROGRAM; IF NOT, WRITE TO EDF R&D CODE_ASTER,         
#    1 AVENUE DU GENERAL DE GAULLE, 92141 CLAMART CEDEX, FRANCE.        
# ======================================================================
# ELEMENT SHB8PS - A.COMBESCURE - S.BAGUET -INSA LYON 2003


DEBUT(CODE=_F(NOM='SSNS101A',NIV_PUB_WEB='INTERNET',VISU_EFICAS='OUI',));

PRE_GIBI();

MAIL=LIRE_MAILLAGE();

MAIL=MODI_MAILLAGE(reuse =MAIL,
                   MAILLAGE=MAIL,
                   ORIE_SHB=_F(GROUP_MA='GEOTOT',),);
#
#
#


MAIL=DEFI_GROUP(reuse =MAIL,
                MAILLAGE=MAIL,
                CREA_GROUP_NO=(_F(GROUP_MA='SU0',),
                               _F(GROUP_MA='L31290',),
                               _F(GROUP_MA='SUSUP',),),);

MODMECA=AFFE_MODELE(MAILLAGE=MAIL,
                    AFFE=_F(TOUT='OUI',
                            PHENOMENE='MECANIQUE',
                            MODELISATION='SHB8',),);


TRAC=DEFI_FONCTION(NOM_PARA='EPSI',
                   VALE=(1.e-03,3.102,
                         0.1   ,33.5,
                         1.    ,150,
                         ),);

MAT=DEFI_MATERIAU(ELAS=_F(E=3102.75,
                          NU=0.3,),
                  TRACTION=_F(SIGM=TRAC,),
                  );


CHM=AFFE_MATERIAU(MAILLAGE=MAIL,
                  AFFE=_F(TOUT='OUI',
                          MATER=MAT,),);

CHARGT=AFFE_CHAR_MECA(MODELE=MODMECA,
                      DDL_IMPO=(_F(GROUP_MA='SU0',
                                   DY=0.0,),
                                _F(GROUP_MA='L31290',
                                   DX=0.0,),
                                _F(GROUP_MA='L31290',
                                   DY=0.0,),
                                _F(GROUP_MA='L31290',
                                   DZ=0.0,),
                                _F(GROUP_MA='SUSUP',
                                   DZ=0.0,),),
                      FORCE_NODALE=_F(GROUP_NO='P2',
                                      FX=-0.25,),);



D_FONC=DEFI_FONCTION(NOM_PARA='INST',
                     VALE=(0.0,0.0,10000.0,10000.0,),);


LISTPILO=DEFI_LIST_REEL(DEBUT=0.0,
                        INTERVALLE=_F(JUSQU_A=45,
                                      NOMBRE=45,),);


NONLIN=STAT_NON_LINE(MODELE=MODMECA,
                     CHAM_MATER=CHM,
                     EXCIT=_F(CHARGE=CHARGT,
                              TYPE_CHARGE='FIXE_PILO',),
                     COMP_INCR=_F(RELATION='ELAS',
                                  DEFORMATION='GROT_GDEP',
                                  TOUT='OUI',),
                     INCREMENT=_F(LIST_INST=LISTPILO,),
                     NEWTON=_F(REAC_ITER=0,),
                     PILOTAGE=_F(TYPE='DDL_IMPO',
                                 COEF_MULT=-1.0,
                                 GROUP_NO='P2',
                                 NOM_CMP='DX',),
                     CONVERGENCE=_F(RESI_GLOB_RELA=1e-08,
                                    ITER_GLOB_MAXI=25,),);

NONLIN=CALC_ELEM(reuse=NONLIN, RESULTAT=NONLIN,
                    OPTION=('SIEF_ELNO','SIEQ_ELGA','SIEQ_ELNO'),
                    );
                    
                    
TABDX=POST_RELEVE_T(ACTION=_F(INTITULE='F',
                              GROUP_NO='P2',
                              RESULTAT=NONLIN,
                              NOM_CHAM='DEPL',
                              TOUT_ORDRE='OUI',
                              NOM_CMP='DX',
                              OPERATION='EXTRACTION',),);


TABDX=CALC_TABLE(reuse =TABDX,
               TABLE=TABDX,
               ACTION=(_F(
                          OPERATION = 'FILTRE',
                          NOM_PARA  = 'NUME_ORDRE',
                          CRIT_COMP = 'GT',
                          VALE    = 0,
                         ),),); 
                         
FDX=RECU_FONCTION(TABLE=TABDX,INTERPOL='LIN',
                  PARA_X='INST',
                  PARA_Y='DX',);

LISTEXTR=DEFI_LIST_REEL(DEBUT=1.0,
                        INTERVALLE=_F(JUSQU_A=45,
                                      NOMBRE=44,),);

FETA=RECU_FONCTION(RESULTAT=NONLIN,
                   INTERPOL='LIN',
                   PROL_GAUCHE='CONSTANT',
                   LIST_INST       =LISTEXTR,
                   NOM_PARA_RESU='ETA_PILOTAGE',);


            
TEST_FONCTION(VALEUR=(
_F(FONCTION=FETA,REFERENCE='ANALYTIQUE', PRECISION = 0.08,
            VALE_PARA = 8.63300E-01,VALE_REFE=4.18993E+02 ),
_F(FONCTION=FETA,REFERENCE='ANALYTIQUE', PRECISION = 0.08,
            VALE_PARA = 6.98600E+00,VALE_REFE=2.39906E+03 ),
_F(FONCTION=FETA,REFERENCE='ANALYTIQUE', PRECISION = 0.08,
            VALE_PARA = 1.42000E+01,VALE_REFE=3.88289E+03 ),
_F(FONCTION=FETA,REFERENCE='ANALYTIQUE', PRECISION = 0.08,
            VALE_PARA = 2.56900E+01,VALE_REFE=2.27680E+03 ),
            ),) # solution de reference HEXA20
          
HEXA=DEFI_FONCTION(NOM_PARA='INST',INTERPOL='LIN',PROL_DROITE='CONSTANT',PROL_GAUCHE='CONSTANT',
                   VALE=(
  8.63300E-01 ,   4.18993E+02,
  1.28900E+00 ,   5.31761E+02,
  1.71200E+00 ,   6.96816E+02,
  2.13400E+00 ,   8.57929E+02,
  2.55300E+00 ,   1.01032E+03,
  2.97000E+00 ,   1.16198E+03,
  3.38400E+00 ,   1.30321E+03,
  3.79600E+00 ,   1.44302E+03,
  4.20500E+00 ,   1.57723E+03,
  4.61100E+00 ,   1.70593E+03,
  5.01500E+00 ,   1.83369E+03,
  5.41500E+00 ,   1.95225E+03,
  5.81200E+00 ,   2.06992E+03,
  6.20700E+00 ,   2.18304E+03,
  6.59800E+00 ,   2.29147E+03,
  6.98600E+00 ,   2.39906E+03,
  7.37100E+00 ,   2.49919E+03,
  7.75300E+00 ,   2.59828E+03,
  8.13100E+00 ,   2.69411E+03,
  8.50600E+00 ,   2.78499E+03,
  8.87800E+00 ,   2.87515E+03,
  9.24700E+00 ,   2.96048E+03,
  9.61200E+00 ,   3.04288E+03,
  9.97400E+00 ,   3.12460E+03,
  1.03300E+01 ,   3.19946E+03,
  1.06900E+01 ,   3.27473E+03,
  1.10400E+01 ,   3.34722E+03,
  1.13900E+01 ,   3.41434E+03,
  1.17400E+01 ,   3.48147E+03,
  1.20800E+01 ,   3.54519E+03,
  1.23700E+01 ,   3.59543E+03,
  1.26000E+01 ,   3.63527E+03,
  1.28300E+01 ,   3.67511E+03,
  1.30600E+01 ,   3.71371E+03,
  1.32900E+01 ,   3.74880E+03,
  1.35200E+01 ,   3.78389E+03,
  1.37500E+01 ,   3.81898E+03,
  1.39700E+01 ,   3.85255E+03,
  1.42000E+01 ,   3.88289E+03,
  1.44200E+01 ,   3.91124E+03,
  1.46300E+01 ,   3.93830E+03,
  1.48500E+01 ,   3.96665E+03,
  1.50600E+01 ,   3.99203E+03,
  1.52800E+01 ,   4.01423E+03,
  1.54900E+01 ,   4.03543E+03,
  1.56900E+01 ,   4.05561E+03,
  1.59000E+01 ,   4.07680E+03,
  1.61100E+01 ,   4.09431E+03,
  1.63100E+01 ,   4.10778E+03,
  1.65100E+01 ,   4.12125E+03,
  1.67200E+01  ,  4.13540E+03,
  1.69200E+01 ,   4.14887E+03,
  1.71300E+01 ,   4.15771E+03,
  1.73300E+01 ,   4.16303E+03,
  1.75400E+01 ,   4.16861E+03,
  1.77800E+01 ,   4.17500E+03,
  1.80400E+01 ,   4.17993E+03,
  1.83300E+01 ,   4.17325E+03,
  2.01600E+01 ,   4.05087E+03,
  2.01900E+01 ,   4.04631E+03,
  2.03300E+01 ,   4.02501E+03,
  2.04400E+01 ,   4.00828E+03,
  2.05500E+01 ,   3.99155E+03,
  2.06700E+01 ,   3.97330E+03,
  2.08000E+01 ,   3.95352E+03,
  2.09300E+01 ,   3.93375E+03,
  2.10700E+01 ,   3.90709E+03,
  2.12000E+01 ,   3.87737E+03,
  2.13300E+01 ,   3.84764E+03,
  2.14500E+01 ,   3.82020E+03,
  2.15800E+01 ,   3.79048E+03,
  2.17100E+01 ,   3.76075E+03,
  2.18300E+01 ,   3.73331E+03,
  2.19600E+01 ,   3.70358E+03,
  2.21100E+01 ,   3.66079E+03,
  2.22500E+01 ,   3.61797E+03,
  2.24000E+01 ,   3.57209E+03,
  2.25400E+01 ,   3.52926E+03,
  2.26800E+01 ,   3.48644E+03,
  2.28300E+01 ,   3.44056E+03,
  2.29700E+01 ,   3.39773E+03,
  2.31000E+01 ,   3.35111E+03,
  2.32400E+01 ,   3.29868E+03,
  2.33800E+01 ,   3.24625E+03,
  2.35400E+01 ,   3.18633E+03,
  2.37000E+01 ,   3.12641E+03,
  2.38700E+01 ,   3.06275E+03,
  2.40200E+01 ,   3.00556E+03,
  2.41800E+01 ,   2.93752E+03,
  2.43400E+01 ,   2.86947E+03,
  2.45000E+01  ,  2.80143E+03,
  2.46500E+01 ,   2.73764E+03,
  2.48100E+01 ,   2.66959E+03,
  2.49600E+01 ,   2.60580E+03,
  2.51400E+01 ,   2.52549E+03,
  2.53300E+01 ,   2.43958E+03,
  2.55100E+01 ,   2.35819E+03,
  2.56900E+01 ,   2.27680E+03,
                        ),);
                         
IMPR_FONCTION(UNITE=8,
            FORMAT='TABLEAU',
            COURBE=(_F(FONCTION=HEXA,),
                    _F(FONCTION=FETA,),),);


DIFF=CALC_FONCTION(COMB=(
                          _F(  FONCTION = FETA, COEF =  1.), 
                          _F(  FONCTION = HEXA, COEF = -1.), 
                          ) )

IMPR_FONCTION(UNITE=8,
            FORMAT='TABLEAU',
            COURBE=(_F(FONCTION=DIFF,),),);
                    
MAXHEXA=INFO_FONCTION( MAX=_F(  FONCTION = HEXA)    )

IMPR_TABLE(TABLE=MAXHEXA)

# LA TOLERANCE IMPOSEE DANS LE TEST_FONCTION EST DE 55.. CETTE VALEUR CORRESPOND AU MAXIMUM
# DE LA FONCTION HEXA MULTIPLIEE PAR 0.02.

# COMPARAISON A LA SOLUTION HEXA

TEST_FONCTION(VALEUR=(
_F(FONCTION=DIFF,REFERENCE='SOURCE_EXTERNE', VALE_PARA = 2.00000E+00,VALE_REFE=0.,PRECISION=200.,CRITERE='ABSOLU',),
_F(FONCTION=DIFF,REFERENCE='SOURCE_EXTERNE', VALE_PARA = 3.00000E+00,VALE_REFE=0.,PRECISION=200.,CRITERE='ABSOLU',),
_F(FONCTION=DIFF,REFERENCE='SOURCE_EXTERNE', VALE_PARA = 4.00000E+00,VALE_REFE=0.,PRECISION=200.,CRITERE='ABSOLU',),
_F(FONCTION=DIFF,REFERENCE='SOURCE_EXTERNE', VALE_PARA = 5.00000E+00,VALE_REFE=0.,PRECISION=200.,CRITERE='ABSOLU',),
_F(FONCTION=DIFF,REFERENCE='SOURCE_EXTERNE', VALE_PARA = 6.00000E+00,VALE_REFE=0.,PRECISION=200.,CRITERE='ABSOLU',),
_F(FONCTION=DIFF,REFERENCE='SOURCE_EXTERNE', VALE_PARA = 7.00000E+00,VALE_REFE=0.,PRECISION=200.,CRITERE='ABSOLU',),
_F(FONCTION=DIFF,REFERENCE='SOURCE_EXTERNE', VALE_PARA = 8.00000E+00,VALE_REFE=0.,PRECISION=200.,CRITERE='ABSOLU',),
_F(FONCTION=DIFF,REFERENCE='SOURCE_EXTERNE', VALE_PARA = 9.00000E+00,VALE_REFE=0.,PRECISION=200.,CRITERE='ABSOLU',),
_F(FONCTION=DIFF,REFERENCE='SOURCE_EXTERNE', VALE_PARA = 1.00000E+01,VALE_REFE=0.,PRECISION=200.,CRITERE='ABSOLU',),
_F(FONCTION=DIFF,REFERENCE='SOURCE_EXTERNE', VALE_PARA = 1.10000E+01,VALE_REFE=0.,PRECISION=200.,CRITERE='ABSOLU',),
_F(FONCTION=DIFF,REFERENCE='SOURCE_EXTERNE', VALE_PARA = 1.20000E+01,VALE_REFE=0.,PRECISION=200.,CRITERE='ABSOLU',),
_F(FONCTION=DIFF,REFERENCE='SOURCE_EXTERNE', VALE_PARA = 1.30000E+01,VALE_REFE=0.,PRECISION=200.,CRITERE='ABSOLU',),
_F(FONCTION=DIFF,REFERENCE='SOURCE_EXTERNE', VALE_PARA = 1.40000E+01,VALE_REFE=0.,PRECISION=200.,CRITERE='ABSOLU',),
_F(FONCTION=DIFF,REFERENCE='SOURCE_EXTERNE', VALE_PARA = 1.50000E+01,VALE_REFE=0.,PRECISION=200.,CRITERE='ABSOLU',),
_F(FONCTION=DIFF,REFERENCE='SOURCE_EXTERNE', VALE_PARA = 1.60000E+01,VALE_REFE=0.,PRECISION=200.,CRITERE='ABSOLU',),
_F(FONCTION=DIFF,REFERENCE='SOURCE_EXTERNE', VALE_PARA = 1.70000E+01,VALE_REFE=0.,PRECISION=200.,CRITERE='ABSOLU',),
_F(FONCTION=DIFF,REFERENCE='SOURCE_EXTERNE', VALE_PARA = 1.80000E+01,VALE_REFE=0.,PRECISION=200.,CRITERE='ABSOLU',),
_F(FONCTION=DIFF,REFERENCE='SOURCE_EXTERNE', VALE_PARA = 1.90000E+01,VALE_REFE=0.,PRECISION=200.,CRITERE='ABSOLU',),
_F(FONCTION=DIFF,REFERENCE='SOURCE_EXTERNE', VALE_PARA = 2.00000E+01,VALE_REFE=0.,PRECISION=200.,CRITERE='ABSOLU',),
            ),)
            
# RECHERCHE DE LA VALEUR MAXIMUM DE LA VALEUR ABSOLUE DE LA FONCTION HEXA

ABSHEXA = CALC_FONCTION( ABS=_F(  FONCTION = HEXA)    )
MXHEXA  = INFO_FONCTION( MAX=_F(  FONCTION = ABSHEXA)    )
IMPR_TABLE(TABLE=MXHEXA)

# RECHERCHE DE LA VALEUR MAXIMUM DE LA VALEUR ABSOLUE DE LA DIFFERENCE 
# ENTRE LA FONCTION HEXA ET LA FONCTION FETA (RESULTAT DES CALCULS ASTER)

ABSDIFF  = CALC_FONCTION( ABS=_F(  FONCTION = DIFF)    )
MXDIFF   = INFO_FONCTION( MAX=_F(  FONCTION = ABSDIFF)    )
IMPR_TABLE(TABLE=MXDIFF)

TEST_TABLE(TABLE=MXHEXA,
           FILTRE=(_F(NOM_PARA='FONCTION',VALE_K='ABSHEXA'),
                   _F(NOM_PARA='TYPE',    VALE_K='MAXI',),),
           NOM_PARA='TOUTRESU',
           VALE=4180.,
           PRECISION=0.001,
           REFERENCE='ANALYTIQUE',);

TEST_TABLE(TABLE=MXDIFF,
           FILTRE=(_F(NOM_PARA='FONCTION',VALE_K='ABSDIFF'),
                   _F(NOM_PARA='TYPE',    VALE_K='MAXI',),),
           NOM_PARA='ETA_PILO',
           VALE=2733.,
           PRECISION=0.001,
           REFERENCE='ANALYTIQUE',);

# ON TRACE LES COURBES RESULTATS ASTER ET HEXA 

#IMPR_FONCTION(
#    FORMAT    = 'XMGRACE',
#    PILOTE    = 'INTERACTIF',
#    LEGENDE_X = 'Instant',
#    LEGENDE_Y = 'FORCE',
#    BORNE_X   = (0.,50.),
#    BORNE_Y   = (-1000., 5000.),
#    GRILLE_X  = 5.,
#    GRILLE_Y  = 1000.,
#    COURBE=(_F(FONCTION=FETA,LEGENDE='ASTER'),
#            _F(FONCTION=HEXA,LEGENDE='HEXA')))


FIN()

