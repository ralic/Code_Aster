# MODIF  DATE 24/05/2004   AUTEUR GALENNE E.GALENNE 
# TITRE PLAQUE FISSUREE EN TRACTION (CALCUL DES DERIVEES DE G)
#            CONFIGURATION MANAGEMENT OF EDF VERSION
# ======================================================================
# COPYRIGHT (C) 1991 - 2004  EDF R&D                  WWW.CODE-ASTER.ORG
# THIS PROGRAM IS FREE SOFTWARE; YOU CAN REDISTRIBUTE IT AND/OR MODIFY  
# IT UNDER THE TERMS OF THE GNU GENERAL PUBLIC LICENSE AS PUBLISHED BY  
# THE FREE SOFTWARE FOUNDATION; EITHER VERSION 2 OF THE LICENSE, OR     
# (AT YOUR OPTION) ANY LATER VERSION.                                                    
#                                                                       
# THIS PROGRAM IS DISTRIBUTED IN THE HOPE THAT IT WILL BE USEFUL, BUT   
# WITHOUT ANY WARRANTY; WITHOUT EVEN THE IMPLIED WARRANTY OF            
# MERCHANTABILITY OR FITNESS FOR A PARTICULAR PURPOSE. SEE THE GNU      
# GENERAL PUBLIC LICENSE FOR MORE DETAILS.                              
#                                                                       
# YOU SHOULD HAVE RECEIVED A COPY OF THE GNU GENERAL PUBLIC LICENSE     
# ALONG WITH THIS PROGRAM; IF NOT, WRITE TO EDF R&D CODE_ASTER,         
#    1 AVENUE DU GENERAL DE GAULLE, 92141 CLAMART CEDEX, FRANCE.        
# ======================================================================
# CONTRAINTES PLANES
#
DEBUT(CODE=_F( NOM = 'SSLP101F',NIV_PUB_WEB='INTERNET'))

MA=LIRE_MAILLAGE(  )

MO=AFFE_MODELE(  MAILLAGE=MA, 
                               AFFE=_F( TOUT = 'OUI',
                                     PHENOMENE = 'MECANIQUE',
                                     MODELISATION = 'C_PLAN'))

YOUNG = DEFI_PARA_SENSI(VALE=200000.)
FORC =    DEFI_PARA_SENSI(VALE=1.)
PRES =    DEFI_PARA_SENSI(VALE=1.)
ZERO =    DEFI_CONSTANTE(VALE=0.)
NU =    DEFI_CONSTANTE(VALE=0.3)

MAT=DEFI_MATERIAU(ELAS_FO=_F(  E = YOUNG, NU = NU, RHO=1., ))

CHMAT=AFFE_MATERIAU(  MAILLAGE=MA,
                           AFFE=_F(  TOUT = 'OUI',MATER = MAT))

#-----------------------------------------------------------------------
# CHARGEMENT FORCE CONTOUR
#-----------------------------------------------------------------------
CH =AFFE_CHAR_MECA_F(  MODELE=MO,DDL_IMPO=( 
                                 _F(  GROUP_NO = 'GRNM5', DY = ZERO),
                                 _F(  NOEUD = 'N451', DX = ZERO)),
                      FORCE_CONTOUR=_F(  GROUP_MA = 'GRMA1', FY = FORC))

#-----------------------------------------------------------------------

CHAMDEPL=MECA_STATIQUE(   MODELE=MO,   CHAM_MATER=CHMAT, 
                          SENSIBILITE = (YOUNG,FORC), 
                              EXCIT=_F( CHARGE = CH ))

CHAMDEPL=CALC_ELEM(reuse=CHAMDEPL,RESULTAT=CHAMDEPL,   MODELE=MO,
              CHAM_MATER=CHMAT,
              EXCIT=_F( CHARGE = CH),
              OPTION=('EPSI_ELGA_DEPL',),)

CHAMDEPL=CALC_ELEM(reuse=CHAMDEPL,RESULTAT=CHAMDEPL,   MODELE=MO,
              CHAM_MATER=CHMAT,
              SENSIBILITE = (YOUNG,FORC), 
              EXCIT=_F( CHARGE = CH),
              OPTION=('EPSI_ELGA_DEPL','SIEF_ELGA_DEPL',),)

DEP=CREA_CHAMP(  OPERATION='EXTR', TYPE_CHAM='NOEU_DEPL_R',
                 NOM_CHAM='DEPL', RESULTAT=CHAMDEPL,
                         NUME_ORDRE=1 )

THETA1=CALC_THETA(      MODELE=MO,
                        THETA_2D=_F(  NOEUD = 'N668', MODULE = 1.,
                                            R_INF = 22.04078,
                                            R_SUP = 30.),
                       DIRECTION=( 1., 0., 0.,))

THETA2=CALC_THETA(    MODELE=MO,
                      THETA_2D=_F(  NOEUD = 'N668', MODULE = 1.,
                                 R_SUP = 22.04078,
                                 R_INF = 15.3061094),
                       DIRECTION=( 1., 0., 0.,))

FOND=DEFI_FOND_FISS( MAILLAGE=MA,
                          FOND_FISS=_F( NOEUD = 'N668'),
                       NORMALE=(0., 1., 0.,))

G1=CALC_G_THETA_T(         MODELE=MO,
                             DEPL=DEP,
                            THETA=THETA1,
                           EXCIT=_F(CHARGE=CH,),
                        SYME_CHAR='SYME',
                        COMP_ELAS=_F( RELATION = 'ELAS',
                                   DEFORMATION = 'PETIT'),
                       CHAM_MATER=CHMAT )

DGE1=CALC_G_THETA_T(         MODELE=MO,
                          RESULTAT=CHAMDEPL,
                            THETA=THETA1,
                           EXCIT=_F(CHARGE=CH,),
                        SENSIBILITE = (YOUNG,), 
                        SYME_CHAR='SYME',
                        COMP_ELAS=_F( RELATION = 'ELAS',
                                   DEFORMATION = 'PETIT'),
                       CHAM_MATER=CHMAT )

TEST_TABLE(            TABLE=DGE1,
                       SENSIBILITE = (YOUNG,),
                      REFERENCE='ANALYTIQUE',
                       NOM_PARA='G',
                       VALE=-1.15E-8,
                      PRECISION=5.E-3     )

DGF1=CALC_G_THETA_T(         MODELE=MO,
                          RESULTAT=CHAMDEPL,
                            THETA=THETA1,
                           EXCIT=_F(CHARGE=CH,),
                        SENSIBILITE = (FORC,), 
                        SYME_CHAR='SYME',
                        COMP_ELAS=_F( RELATION = 'ELAS',
                                   DEFORMATION = 'PETIT'),
                       CHAM_MATER=CHMAT )

TEST_TABLE(            TABLE=DGF1,
                       SENSIBILITE = (FORC,),
                      REFERENCE='ANALYTIQUE',
                       NOM_PARA='G',
                       VALE=4.6E-3,
                      PRECISION=5.E-3     )

G2=CALC_G_THETA_T(         MODELE=MO,
                             DEPL=DEP,
                            THETA=THETA2,
                           EXCIT=_F(CHARGE=CH,),
                        SYME_CHAR='SYME',
                        COMP_ELAS=_F( RELATION = 'ELAS',
                                   DEFORMATION = 'PETIT'),
                       CHAM_MATER=CHMAT )

DGE2=CALC_G_THETA_T(         MODELE=MO,
                          RESULTAT=CHAMDEPL,
                            THETA=THETA2,
                           EXCIT=_F(CHARGE=CH,),
                        SENSIBILITE = (YOUNG,), 
                        SYME_CHAR='SYME',
                        COMP_ELAS=_F( RELATION = 'ELAS',
                                   DEFORMATION = 'PETIT'),
                       CHAM_MATER=CHMAT )

TEST_TABLE(            TABLE=DGE2,
                       SENSIBILITE = (YOUNG,),
                      REFERENCE='ANALYTIQUE',
                       NOM_PARA='G',
                       VALE=-1.15E-8,
                      PRECISION=5.E-3     )

DGF2=CALC_G_THETA_T(         MODELE=MO,
                          RESULTAT=CHAMDEPL,
                            THETA=THETA2,
                           EXCIT=_F(CHARGE=CH,),
                        SENSIBILITE = (FORC,), 
                        SYME_CHAR='SYME',
                        COMP_ELAS=_F( RELATION = 'ELAS',
                                   DEFORMATION = 'PETIT'),
                       CHAM_MATER=CHMAT )

TEST_TABLE(            TABLE=DGF2,
                       SENSIBILITE = (FORC,),
                      REFERENCE='ANALYTIQUE',
                       NOM_PARA='G',
                       VALE=4.6E-3,
                      PRECISION=5.E-3     )
#-----------------------------------------------------------------------
# CHARGEMENT PRESSION
#-----------------------------------------------------------------------
CHP =AFFE_CHAR_MECA_F(  MODELE=MO,DDL_IMPO=( 
                                 _F(  GROUP_NO = 'GRNM5', DY = ZERO),
                                 _F(  NOEUD = 'N451', DX = ZERO)),
                        PRES_REP=_F(  GROUP_MA = 'GRMA4', PRES =PRES ) )

#-----------------------------------------------------------------------

CHAMDEP=MECA_STATIQUE(   MODELE=MO,   CHAM_MATER=CHMAT, 
                          SENSIBILITE = (YOUNG,PRES), 
                              EXCIT=_F( CHARGE = CHP ))

CHAMDEP=CALC_ELEM(reuse=CHAMDEP,RESULTAT=CHAMDEP,   MODELE=MO,
              CHAM_MATER=CHMAT,
              EXCIT=_F( CHARGE = CHP),
              OPTION=('EPSI_ELGA_DEPL',),)

CHAMDEP=CALC_ELEM(reuse=CHAMDEP,RESULTAT=CHAMDEP,   MODELE=MO,
              CHAM_MATER=CHMAT,
              SENSIBILITE = (YOUNG,PRES), 
              EXCIT=_F( CHARGE = CHP),
              OPTION=('EPSI_ELGA_DEPL','SIEF_ELGA_DEPL',),)

DEPL=CREA_CHAMP(  OPERATION='EXTR', TYPE_CHAM='NOEU_DEPL_R',
                 NOM_CHAM='DEPL', RESULTAT=CHAMDEP,
                         NUME_ORDRE=1 )

G1P=CALC_G_THETA_T(         MODELE=MO,
                             DEPL=DEPL,
                            THETA=THETA1,
                         EXCIT=_F(CHARGE=CHP,),
                        SYME_CHAR='SYME',
                        COMP_ELAS=_F( RELATION = 'ELAS',
                                   DEFORMATION = 'PETIT'),
                       CHAM_MATER=CHMAT )

DGE1P=CALC_G_THETA_T(         MODELE=MO,
                          RESULTAT=CHAMDEP,
                            THETA=THETA1,
                         EXCIT=_F(CHARGE=CHP,),
                        SENSIBILITE = (YOUNG,), 
                        SYME_CHAR='SYME',
                        COMP_ELAS=_F( RELATION = 'ELAS',
                                   DEFORMATION = 'PETIT'),
                       CHAM_MATER=CHMAT )


TEST_TABLE(            TABLE=DGE1P,
                       SENSIBILITE = (YOUNG,),
                      REFERENCE='ANALYTIQUE',
                       NOM_PARA='G',
                       VALE=-1.15E-8,
                      PRECISION=5.E-3     )

DGF1P=CALC_G_THETA_T(         MODELE=MO,
                          RESULTAT=CHAMDEP,
                            THETA=THETA1,
                         EXCIT=_F(CHARGE=CHP,),
                        SENSIBILITE = (PRES,), 
                        SYME_CHAR='SYME',
                        COMP_ELAS=_F( RELATION = 'ELAS',
                                   DEFORMATION = 'PETIT'),
                       CHAM_MATER=CHMAT )


TEST_TABLE(            TABLE=DGF1P,
                       SENSIBILITE = (PRES,),
                      REFERENCE='ANALYTIQUE',
                       NOM_PARA='G',
                       VALE=4.6E-3,
                      PRECISION=5.E-3     )

G2P=CALC_G_THETA_T(         MODELE=MO,
                             DEPL=DEPL,
                            THETA=THETA2,
                          EXCIT=_F( CHARGE=CHP,),
                        SYME_CHAR='SYME',
                        COMP_ELAS=_F( RELATION = 'ELAS',
                                   DEFORMATION = 'PETIT'),
                       CHAM_MATER=CHMAT )


DGE2P=CALC_G_THETA_T(         MODELE=MO,
                          RESULTAT=CHAMDEP,
                            THETA=THETA2,
                         EXCIT=_F(  CHARGE=CHP),
                        SENSIBILITE = (YOUNG,), 
                        SYME_CHAR='SYME',
                        COMP_ELAS=_F( RELATION = 'ELAS',
                                   DEFORMATION = 'PETIT'),
                       CHAM_MATER=CHMAT )


TEST_TABLE(            TABLE=DGE2P,
                       SENSIBILITE = (YOUNG,),
                      REFERENCE='ANALYTIQUE',
                       NOM_PARA='G',
                       VALE=-1.15E-8,
                      PRECISION=5.E-3     )

DGF2P=CALC_G_THETA_T(         MODELE=MO,
                          RESULTAT=CHAMDEP,
                            THETA=THETA2,
                            EXCIT=_F(CHARGE=CHP,),
                        SENSIBILITE = (PRES,), 
                        SYME_CHAR='SYME',
                        COMP_ELAS=_F( RELATION = 'ELAS',
                                   DEFORMATION = 'PETIT'),
                       CHAM_MATER=CHMAT )


TEST_TABLE(            TABLE=DGF2P,
                       SENSIBILITE = (PRES,),
                      REFERENCE='ANALYTIQUE',
                       NOM_PARA='G',
                       VALE=4.6E-3,
                      PRECISION=5.E-3     )

FIN(  )
