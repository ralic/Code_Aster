# MODIF  DATE 28/01/2008   AUTEUR PELLET J.PELLET 
# TITRE PREDICTION D'AMORCAGE PAR LE CRITERE ENERGETIQUE GP EN 2D
#            CONFIGURATION MANAGEMENT OF EDF VERSION
# ======================================================================
# COPYRIGHT (C) 1991 - 2007  EDF R&D                  WWW.CODE-ASTER.ORG
# THIS PROGRAM IS FREE SOFTWARE; YOU CAN REDISTRIBUTE IT AND/OR MODIFY
# IT UNDER THE TERMS OF THE GNU GENERAL PUBLIC LICENSE AS PUBLISHED BY
# THE FREE SOFTWARE FOUNDATION; EITHER VERSION 2 OF THE LICENSE, OR
# (AT YOUR OPTION) ANY LATER VERSION.
#
# THIS PROGRAM IS DISTRIBUTED IN THE HOPE THAT IT WILL BE USEFUL, BUT
# WITHOUT ANY WARRANTY; WITHOUT EVEN THE IMPLIED WARRANTY OF
# MERCHANTABILITY OR FITNESS FOR A PARTICULAR PURPOSE. SEE THE GNU
# GENERAL PUBLIC LICENSE FOR MORE DETAILS.
#
# YOU SHOULD HAVE RECEIVED A COPY OF THE GNU GENERAL PUBLIC LICENSE
# ALONG WITH THIS PROGRAM; IF NOT, WRITE TO EDF R&D CODE_ASTER,
#    1 AVENUE DU GENERAL DE GAULLE, 92141 CLAMART CEDEX, FRANCE.
# ======================================================================
# RESPONSABLE WADIER Y.WADIER

DEBUT(CODE=_F( NOM = 'HSNA103A',NIV_PUB_WEB='INTERNET',VISU_EFICAS='NON'),);
#
# PREDICTION DE L'INSTANT D'AMORCAGE (D'APRES GP CRITIQUE IDENTIFIEES)
# SUR UNE GEOMETRIE AXISYMETRIQUE DE CUVE FISSUREE
# SOUMIS A UN TRANSITOIRE THERMIQUE ET UNE PRESSION INTERNE + EFFET DE FOND
#

PRE_GIBI();

MAIL=LIRE_MAILLAGE();

MAIL=DEFI_GROUP(reuse =MAIL,
                MAILLAGE=MAIL,
                CREA_GROUP_NO=(_F(GROUP_MA='LINT',),
                               _F(GROUP_MA='LEXT',),
                               _F(GROUP_MA='LINF',),
                               _F(GROUP_MA='LSUP',),),);

#-------------------------------------------------------------------
#----------------   AFFECTATION MODELE THERMIQUE    ----------------
#-------------------------------------------------------------------

MO_THER=AFFE_MODELE(MAILLAGE=MAIL,
                    AFFE=_F(TOUT='OUI',
                            PHENOMENE='THERMIQUE',
                            MODELISATION='AXIS',),);

#----------------------------------------------------------------------
#---------------- DONNEES THERMIQUE ACIER  -------------------
#----------------------------------------------------------------------

LAMBDA_T=DEFI_FONCTION(NOM_PARA='TEMP',
                       VALE=
                       (-40.0, 0.05093,
                       -30.0, 0.04697,
                       -20.0, 0.04535,
                       -10.0, 0.04442,
                       0.0, 0.04418,
                       10.0, 0.04395,
                       20.0, 0.04395,
                       30.0, 0.04442,
                       40.0, 0.04488,
                       50.0, 0.04558,
                       60.0, 0.04628,
                       70.0, 0.04953,
                       80.0, 0.05395,
                       90.0, 0.05162,
                       100.0, 0.04767,
                       110.0, 0.05232,
                       120.0, 0.05581,
                       130.0, 0.05767,
                       140.0, 0.05581,
                       150.0, 0.05255,
                       160.0, 0.04930,
                       170.0, 0.04753,
                       180.0, 0.04721,
                       190.0, 0.04860,
                       200.0, 0.05116,
                       210.0, 0.05418,
                       220.0, 0.05674,
                       230.0, 0.05720,
                       240.0, 0.05451,
                       250.0, 0.05162,
                       260.0, 0.04907,
                       270.0, 0.04595,
                       280.0, 0.04618,
                       290.0, 0.05144,
                       300.0, 0.05916,
                       ),
                       PROL_DROITE='CONSTANT',
                       PROL_GAUCHE='CONSTANT',);

RHO_CP_T=DEFI_FONCTION(NOM_PARA='TEMP',
                       VALE=
                       (-50.0, 3.799E-3,
                       0.0, 4.064E-3,
                       20.0, 4.134E-3,
                       50.0, 4.274E-3,
                       100.0, 4.469E-3,
                       150.0, 4.672E-3,
                       200.0, 4.711E-3,
                       250.0, 4.438E-3,
                       300.0, 3.799E-3,
                       ),
                       PROL_DROITE='CONSTANT',
                       PROL_GAUCHE='CONSTANT',);

MAT_THE=DEFI_MATERIAU(THER_NL=_F(LAMBDA=LAMBDA_T,
                                 RHO_CP=RHO_CP_T,),);

#----------------------------------------------------------------------
# AFFECTATION DES PROPRIETES THERMIQUE
# ----------------------------------------------------------------------

CHMAT=AFFE_MATERIAU(MAILLAGE=MAIL,
                    AFFE=(_F(GROUP_MA='SCYL',
                             MATER=MAT_THE,
                             ),),);

#----------------------------------------------------------------------
# CHARGEMENT THERMIQUE
# ----------------------------------------------------------------------

T_INT=DEFI_FONCTION(NOM_PARA='INST',
                    VALE=
                    (0.0, 289.5,
                     0.64, 289.5,
                     0.86, 284.6,
                     1.03, 221.9,
                     1.52, 62.7,
                     2.01, 56.6,
                     2.51, 52.9,
                     3.00, 51.0,
                     3.50, 47.8,
                     4.05, 45.3,
                     4.54, 44.1,
                     5.04, 43.4,
                     8.11, 41.4,
                     11.52, 38.3,
                     15.03, 36.3,
                     20.03, 35.1,
                     30.03, 33.6,
                     50.02, 32.9,
                     71.91, 31.9,
                     93.88, 31.7,
                     121.34, 31.6,
                     143.31, 31.3,
                     159.79, 31.3,
                     170.77, 31.2,
                     181.76, 31.2,
                     192.74, 31.3,
                     203.73, 31.1,
                     253.16, 31.4,
                     302.59, 31.7,
                     352.03, 32.0,
                     401.46, 32.5,
                     450.89, 32.5,
                     500.33, 32.7,
                     599.19, 32.9,
                     604.68, 33.1,
                     703.55, 33.7,
                     802.42, 34.0,
                     901.56, 34.4,
                     1000.86, 34.7,
                    ),
                    PROL_DROITE='CONSTANT',
                    PROL_GAUCHE='CONSTANT',);

H_INT=DEFI_FONCTION(NOM_PARA='INST',
                       VALE=
                       (
                       0.0, 0.E-6,
                       0.2, 0.E-6,
                       0.4, 0.E-6,
                       0.6, 0.E-6,
                       0.8, 500.E-6,
                       1.2, 1000.E-6,
                       3.0, 1500.E-6,
                       6.5, 3000.E-6,
                       10.0, 6200.E-6,
                       50.0, 7500.E-6,
                       75.0, 11000.E-6,
                       100.0, 15000.E-6,
                       150.0, 16000.E-6,
                       ),
                       PROL_DROITE='CONSTANT',
                       PROL_GAUCHE='CONSTANT',);

T_EXT=DEFI_CONSTANTE(VALE=20.0,);

H_EXT=DEFI_CONSTANTE(VALE=0.0,);

CHA_THER=AFFE_CHAR_THER_F(MODELE=MO_THER,
                          ECHANGE=(_F(GROUP_MA='LEXT',
                                      COEF_H=H_EXT,
                                      TEMP_EXT=T_EXT,),
                                   _F(GROUP_MA='LINT',
                                      COEF_H=H_INT,
                                      TEMP_EXT=T_INT,),),);

#----------------------------------------------------------------------
# DEFINITION D'UNE RAMPE ET D'UNE LISTE D'INSTANTS
# ----------------------------------------------------------------------

LINST=DEFI_LIST_REEL(DEBUT=0.0,
                     INTERVALLE=(_F(JUSQU_A=2.0,
                                    NOMBRE=10,),
                                 _F(JUSQU_A=5.0,
                                    NOMBRE=3,),
                                 _F(JUSQU_A=50.0,
                                    NOMBRE=15,),
                                 _F(JUSQU_A=100.0,
                                    NOMBRE=20,),
                                 _F(JUSQU_A=850.0,
                                    NOMBRE=20,),
                                 _F(JUSQU_A=1030.0,
                                    NOMBRE=12,),
                                 _F(JUSQU_A=1200.0,
                                   NOMBRE=17,),
                                ),
                     );

LARCH=DEFI_LIST_REEL(DEBUT=0.2,
                     INTERVALLE=(_F(JUSQU_A=2.0,
                                    NOMBRE=9,),
                                 _F(JUSQU_A=5.0,
                                    NOMBRE=3,),
                                 _F(JUSQU_A=50.0,
                                    NOMBRE=15,),
                                 _F(JUSQU_A=100.0,
                                    NOMBRE=20,),
                                 _F(JUSQU_A=850.0,
                                    NOMBRE=20,),
                                 _F(JUSQU_A=1030.0,
                                    NOMBRE=12,),
                                 _F(JUSQU_A=1200.0,
                                   NOMBRE=17,),
                                ),
                     );
#----------------------------------------------------------------------
#---------------  RESOLUTION   ------------------
#----------------------------------------------------------------------

THERMIK=THER_NON_LINE(MODELE=MO_THER,
                      CHAM_MATER=CHMAT,
                      EXCIT=_F(CHARGE=CHA_THER,),
                      INCREMENT=_F(LIST_INST=LINST,),
                      ARCHIVAGE=_F(LIST_INST=LARCH,),
                      ETAT_INIT=_F(VALE=289.5,),
                      CONVERGENCE=_F(RESI_GLOB_RELA=1.0E-06,),);

THERMIK2 = EXTR_RESU(RESULTAT=THERMIK,
                    ARCHIVAGE=_F(LIST_INST=LARCH,),
                    );

#----------------------------------------------------------------------
#----------------  AFFECTATION MODELE MECANIQUE    --------------------
#----------------------------------------------------------------------

MO_MECA = AFFE_MODELE(MAILLAGE=MAIL,
               AFFE=_F(TOUT='OUI',
                       PHENOMENE='MECANIQUE',
                       MODELISATION='AXIS',),);

MAIL = DEFI_GROUP ( reuse = MAIL,
                    MAILLAGE      = MAIL,
                    CREA_GROUP_NO =(
                                   _F ( NOM      = 'NOESUP',
                                       GROUP_MA = 'LSUP', ),

                                   _F ( NOM      = 'NOEINF',
                                       GROUP_MA = 'LINF', ),
                                     ),
                                    );

MAIL = MODI_MAILLAGE(reuse =MAIL,
                   MAILLAGE=MAIL,
                   ORIE_PEAU_2D=(_F( GROUP_MA = 'LSUP',),
                                 _F( GROUP_MA = 'LINT',),),
                   );

#----------------------------------------------------------------------
# DEFINITION & AFFECTATION DES PROPRIETES MECANIQUES
#----------------------------------------------------------------------

YOUNG = DEFI_FONCTION ( NOM_PARA    = 'TEMP',
                        VALE        = (
                                           23., 220200.0,
                                         100.0, 214100.0,
                                         180.0, 206500.0,
                                         300.0, 205000.0, ), );


NU = DEFI_CONSTANTE ( VALE = 0.3, );


ALPHA = DEFI_FONCTION  ( NOM_PARA    = 'TEMP',
                            VALE        = (
                                         0.000E+00, 1.140E-05,
                                         1.000E+01, 1.150E-05,
                                         2.000E+01, 1.156E-05,
                                         3.000E+01, 1.160E-05,
                                         4.000E+01, 1.170E-05,
                                         5.000E+01, 1.180E-05,
                                         6.000E+01, 1.190E-05,
                                         7.000E+01, 1.190E-05,
                                         8.000E+01, 1.200E-05,
                                         9.000E+01, 1.210E-05,
                                         1.000E+02, 1.210E-05,
                                         1.100E+02, 1.220E-05,
                                         1.200E+02, 1.220E-05,
                                         1.300E+02, 1.230E-05,
                                         1.400E+02, 1.230E-05,
                                         1.500E+02, 1.240E-05,
                                         1.600E+02, 1.250E-05,
                                         1.700E+02, 1.250E-05,
                                         1.800E+02, 1.260E-05,
                                         1.900E+02, 1.260E-05,
                                         2.000E+02, 1.270E-05,
                                         2.100E+02, 1.270E-05,
                                         2.200E+02, 1.280E-05,
                                         2.300E+02, 1.280E-05,
                                         2.400E+02, 1.290E-05,
                                         2.500E+02, 1.290E-05,
                                         ),
                            PROL_DROITE = 'LINEAIRE',
                            PROL_GAUCHE = 'LINEAIRE', );



# ECROUISSAGE ISOTROPE NON LINEAIRE



CT_23 = DEFI_FONCTION ( NOM_PARA = 'EPSI',
                            VALE = (
0.00434654,     855.9222268,
0.006014974,    910.4599555,
0.007862112,    931.797171,
0.010757925,    949.0551424,
0.014221395,    961.578204,
0.017791783,    971.9294353,
0.022185081,    984.4905114,
0.028276427,    1001.471414,
0.035811061,    1019.316952,
0.04373072,     1035.194221,
0.051452332,    1048.650972,
0.058982804,    1060.757,
0.066852716,    1070.207138,
                                ),
                            PROL_DROITE = 'CONSTANT',
                            PROL_GAUCHE = 'LINEAIRE',);

CT_100 = DEFI_FONCTION ( NOM_PARA = 'EPSI',
                            VALE = (
0.003439678,    740.6632663,
0.004628373,    842.148772,
0.00607988,     876.3117064,
0.007654628,    895.2063119,
0.010417548,    911.0718694,
0.014178015,    925.022448,
0.017543214,    935.2135771,
0.021942493,    945.6948965,
0.027416704,    960.732311,
0.033866984,    975.8041996,
0.040205805,    988.2450325,
0.046616375,    1000.143035,
0.052903597,    1010.004051,
0.058235889,    1017.5664,
                            ),
                            PROL_DROITE = 'CONSTANT',
                            PROL_GAUCHE = 'LINEAIRE',);


CT_180 = DEFI_FONCTION ( NOM_PARA = 'EPSI',
                            VALE = (
0.003517805,    757.4699504,
0.004684809,    824.0113073,
0.006144782,    860.2699635,
0.008034933,    882.1596942,
0.01091719,     897.2825266,
0.014242098,    911.895256,
0.017244456,    922.2778349,
0.020804086,    931.4681604,
0.025396755,    943.0898357,
0.030522415,    954.7613776,
0.036394608,    968.8987176,
0.043101634,    980.6600888,
0.049733529,    992.3982518,
0.057071966,    1002.619204,
                            ),
                            PROL_DROITE = 'CONSTANT',
                            PROL_GAUCHE = 'LINEAIRE',);


CT_300 = DEFI_FONCTION ( NOM_PARA = 'EPSI',
                            VALE = (
0.003899686,    752.4084432,
0.006058212,    839.0678844,
0.007710795,    866.9491608,
0.010249296,    885.5196,
0.014199705,    901.713589,
0.018138498,    912.4207501,
0.023019995,    928.0189803,
0.028623413,    936.8352848,
0.034338623,    948.5593249,
0.040005021,    958.5707197,
0.045730249,    965.278307,
0.051311744,    970.2389532,
0.056285811,    977.4996,
                            ),
                            PROL_DROITE = 'CONSTANT',
                            PROL_GAUCHE = 'LINEAIRE',);


SIGM = DEFI_NAPPE ( NOM_PARA    = 'TEMP',

                        PARA        = (  23.0,
                                        100.0,
                                        180.0,
                                        300.0, ),

                        FONCTION    = ( CT_23,
                                        CT_100,
                                        CT_180,
                                        CT_300,),
                        PROL_DROITE = 'LINEAIRE',
                        PROL_GAUCHE = 'LINEAIRE', );


MAT_M = DEFI_MATERIAU (
                 ELAS_FO  =_F (
                      E              = YOUNG,
                      NU             = NU,
                      ALPHA          = ALPHA,
                      TEMP_DEF_ALPHA = 20.0,
                              ),
                 TRACTION =_F ( SIGM = SIGM ,),
                         );

CHMAT_M=AFFE_MATERIAU(MAILLAGE=MAIL,
                    AFFE=(_F(GROUP_MA='SCYL',
                             MATER    = MAT_M ),),
                    AFFE_VARC=_F( TOUT='OUI',EVOL=THERMIK,
                        NOM_VARC='TEMP',NOM_CHAM='TEMP',
                        VALE_REF = 289.5),);


#----------------------------------------------------------------------
# CHARGEMENT ET CONDITIONS LIMITES
# ----------------------------------------------------------------------

# FORCE A APPLIQUER SUR LA SURFACE SUPERIEURE

F = DEFI_FONCTION ( NOM_PARA    = 'INST',
                       VALE        = (    0., 2.1,
                                        400., 2.1,
                                        1033.12 , 2.1,
                                        1186.85, 5.322,
                                        1188.90, 5.39, ),
                       PROL_DROITE = 'CONSTANT',
                       PROL_GAUCHE = 'CONSTANT', );

# COEFFICIENTS FORCE ET EFFET DE FOND

RINT =  40.;
REXT =  80.;
COEF = 1.E6/(3.14*(RINT*RINT-REXT*REXT));
COEF2 = RINT*RINT/(RINT*RINT-REXT*REXT);


# PRESSION INTERNE

PINT = DEFI_FONCTION ( NOM_PARA    = 'INST',
                       VALE        = (   0. ,  0.,
                                         5. ,  3.5,
                                        900.,  3.5,
                                        901.,  0.,
                                         ),
                       PROL_DROITE = 'CONSTANT',
                       PROL_GAUCHE = 'CONSTANT', );

# FONCTION COMBINEE FORCE+EFFET DE FOND

PF = CALC_FONCTION (
         COMB        = (
                         _F ( FONCTION = PINT,
                              COEF     = COEF2, ),
                         _F ( FONCTION = F,
                              COEF     = COEF, ),
                              ),
         INTERPOL    = 'LIN',
         PROL_DROITE = 'CONSTANT',
         PROL_GAUCHE = 'CONSTANT',
                     );

ZERO = DEFI_FONCTION ( NOM_PARA    = 'INST',
                       VALE        = (  0.,  0.,
                                       10.,  0. ),
                       PROL_DROITE = 'CONSTANT',
                       PROL_GAUCHE = 'CONSTANT' )


# CHARGEMENT MECANIQUE

CH_MECA = AFFE_CHAR_MECA_F ( MODELE        = MO_MECA,

                           PRES_REP      =(
                                         _F ( GROUP_MA = 'LINT',
                                              PRES     = PINT ),

                                         _F ( GROUP_MA = 'LSUP',
                                              PRES     = PF  )),
                          );

# CONDITIONS AUX LIMITES

CLIM = AFFE_CHAR_MECA_F ( MODELE        = MO_MECA,

                           DDL_IMPO      =(
                                         _F ( GROUP_NO = 'NOEINF',
                                              DY       = ZERO  )),

                           LIAISON_UNIF  =(
                                         _F ( GROUP_NO = 'NOESUP',
                                              DDL      = 'DY'  )),

                           );


#----------------------------------------------------------------------
#---------------  RESOLUTION   ------------------
#----------------------------------------------------------------------

SIG = STAT_NON_LINE (
  MODELE      = MO_MECA,
  CHAM_MATER  = CHMAT_M,
  EXCIT       =(
                 _F ( CHARGE         = CH_MECA, ),
                 _F ( CHARGE         = CLIM, ), ),

  COMP_INCR   =_F (   RELATION       = 'VMIS_ISOT_TRAC',
                      DEFORMATION    = 'PETIT',
                      TOUT           = 'OUI',  ),

  INCREMENT   =_F (   LIST_INST      = LINST ),

  CONVERGENCE =_F (   ITER_GLOB_MAXI = 10,
                      RESI_GLOB_RELA = 1.E-6, ),

  NEWTON      =_F (   MATRICE        = 'TANGENTE',
                      REAC_ITER      = 1, ),
                    );

FIN ();
