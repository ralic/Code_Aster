# MODIF  DATE 29/12/2009   AUTEUR ABBAS M.ABBAS 
# TITRE FISSURATION INTERFACE 3D PLAN (HEXA20), LOI CZM_FAT_MIX
# ssnp118k.para = tps_job 60 mem_job 32Mo ncpus 1 liste_test S
#            CONFIGURATION MANAGEMENT OF EDF VERSION
# ======================================================================
# COPYRIGHT (C) 1991 - 2009  EDF R&D                  WWW.CODE-ASTER.ORG
# THIS PROGRAM IS FREE SOFTWARE; YOU CAN REDISTRIBUTE IT AND/OR MODIFY  
# IT UNDER THE TERMS OF THE GNU GENERAL PUBLIC LICENSE AS PUBLISHED BY  
# THE FREE SOFTWARE FOUNDATION; EITHER VERSION 2 OF THE LICENSE, OR     
# (AT YOUR OPTION) ANY LATER VERSION.                                                    
#                                                                       
# THIS PROGRAM IS DISTRIBUTED IN THE HOPE THAT IT WILL BE USEFUL, BUT   
# WITHOUT ANY WARRANTY; WITHOUT EVEN THE IMPLIED WARRANTY OF            
# MERCHANTABILITY OR FITNESS FOR A PARTICULAR PURPOSE. SEE THE GNU      
# GENERAL PUBLIC LICENSE FOR MORE DETAILS.                              
#                                                                       
# YOU SHOULD HAVE RECEIVED A COPY OF THE GNU GENERAL PUBLIC LICENSE     
# ALONG WITH THIS PROGRAM; IF NOT, WRITE TO EDF R&D CODE_ASTER,         
#    1 AVENUE DU GENERAL DE GAULLE, 92141 CLAMART CEDEX, FRANCE.        
# ======================================================================

DEBUT(CODE=_F( NOM = 'SSNP118K',NIV_PUB_WEB='INTERNET',VISU_EFICAS='OUI'),)


tfin=11
nbpas=5*tfin
nbarch=nbpas

Gc = 0.9
Sc = 9
young  = 100
dc = 2*Gc/Sc

val_inf = 0.0
val_sup = 1
ampl=0.094

MA=LIRE_MAILLAGE( )


MO=AFFE_MODELE(
          
                MAILLAGE=MA,
                VERIF='MAILLE',
                  
                AFFE= (
                _F( 
                        MAILLE = ('CUBE','DROITE'),
                        PHENOMENE = 'MECANIQUE',
                        MODELISATION = '3D'
                     ),
                 _F(
                   MAILLE = 'CUBEDEG',
                   PHENOMENE = 'MECANIQUE',
                   MODELISATION = '3D_INTERFACE'
                   )
                 )
              )
              

MAT=DEFI_MATERIAU(
              
     ELAS=_F( 
              E =  young,
              NU = 0.0),
     RUPT_FRAG = _F(
                     GC = Gc,
                     SIGM_C = Sc,
                     PENA_LAGR = 100,
                     RIGI_GLIS = 10,    
                    )
            )


CM=AFFE_MATERIAU(
              
               MAILLAGE=MA,
               AFFE=_F( 
                       TOUT = 'OUI',
                       MATER = MAT),
              )
              
# AFFECTATION DES ANGLES D'EULER : POSITION DE LA FISSURE DANS LE REPERE GLOBAL
              
ORIEN_FI=AFFE_CARA_ELEM(MODELE=MO,
                     MASSIF=(
           _F(MAILLE='CUBEDEG',ANGL_EULER=(30,0,0)),         
                                 ));
                                 

LIAISON=AFFE_CHAR_MECA(
  MODELE=MO,
  FACE_IMPO= (
    _F(MAILLE='GAUCHE2', DX=0, DY=0, DZ=0 ),
    )
  )

# CHARGEMENT MODE I PUR
TRAC_N=AFFE_CHAR_MECA(
  MODELE=MO,
  FACE_IMPO= (
    _F(MAILLE='DROITE', DX=ampl*0.86602540378444 , DY= ampl*0.5), 
    )
  )


L_INST=DEFI_LIST_REEL(

                     DEBUT   = -1.,
     INTERVALLE=(
      _F( JUSQU_A = 0,       NOMBRE = 1 ),
      _F( JUSQU_A = tfin,    NOMBRE = nbpas ),
      )
     )
     
INS_ARCH=DEFI_LIST_REEL(

                     DEBUT   = -1.,
     INTERVALLE=(
      _F( JUSQU_A = 0,       NOMBRE = 1 ),
      _F( JUSQU_A = tfin,    NOMBRE = nbarch ),
      )
     )

a = []
for i in xrange(1001) :
  a.extend((2*i,val_inf,2*i+1,val_sup))

FCT = DEFI_FONCTION(
  NOM_PARA = 'INST',
  VALE     = a
  )
 
DEFLIST =DEFI_LIST_INST(DEFI_LIST=_F(LIST_INST =L_INST ),
                        ECHEC=_F(SUBD_METHODE = 'UNIFORME',
                                 SUBD_PAS     = 4,
                                 SUBD_COEF_PAS_1 = 0.01,
                                 SUBD_NIVEAU  = 5,
                                ),)

  
#----------------------------------------------------------------------------------  
# CALCUL AVEC CHARGEMENT EN MODE I AVEC LOI CZM_FAT_MIX
#-----------------------------------------------------------------------------------

U_FAT=STAT_NON_LINE( 
  MODELE     = MO,
  CHAM_MATER = CM,
  CARA_ELEM  = ORIEN_FI,
  EXCIT      = (
    _F(CHARGE = LIAISON),
    _F(CHARGE = TRAC_N, FONC_MULT = FCT),
  ),
  COMP_INCR  = (
          _F(RELATION = 'CZM_FAT_MIX',MAILLE = 'CUBEDEG', ),
          _F(RELATION = 'ELAS',       MAILLE = 'CUBE',),
          ),               
  INCREMENT = _F(
    LIST_INST    = DEFLIST,
    INST_FIN     = tfin,
    ),
  CONVERGENCE = _F(
    RESI_REFE_RELA = 1.E-6,
    SIGM_REFE      = Sc,
    DEPL_REFE      = dc,
    ITER_GLOB_MAXI = 5,
    ),
  SOLVEUR = _F(METHODE = 'MUMPS', PCENT_PIVOT = 100),
  NEWTON     = _F(MATRICE = 'TANGENTE', REAC_ITER=1),
  ARCHIVAGE = _F(LIST_INST = INS_ARCH),
  )

#---------------------------------------------------------------------------------- 
# TESTS CALCUL MODE I AVEC LOI CZM_FAT_MIX
#-----------------------------------------------------------------------------------



TEST_RESU(
  RESU = (
    _F(
      REFERENCE = 'ANALYTIQUE',
      RESULTAT  = U_FAT,
      NOM_CHAM  = 'SIEF_ELGA',
      NOM_CMP   = 'SIXX',
      VALE      = 6.05826,
      MAILLE    = 'CUBE',
      POINT     = 1,
      INST      = 3.0000E+00,
      ),
    )
  )


TEST_RESU(
  RESU = (
    _F(
      REFERENCE = 'ANALYTIQUE',
      RESULTAT  = U_FAT,
      NOM_CHAM  = 'SIEF_ELGA',
      NOM_CMP   = 'SIGN',
      VALE      = 1.45221,
      MAILLE    = 'CUBEDEG', 
      POINT     = 1,
      INST      = 9.0,
      ),
    )
  )

TEST_RESU(
  RESU = (
    _F(
      REFERENCE = 'ANALYTIQUE',
      RESULTAT  = U_FAT,
      NOM_CHAM  = 'DEPL',
      NOM_CMP   = 'SIGN',
      VALE      = 1.45221,
      NOEUD    = 'NS17',
      INST      = 9.0,
      ),
    )
  )
  
TEST_RESU(
  RESU = (
    _F(
      REFERENCE = 'ANALYTIQUE',
      RESULTAT  = U_FAT,
      NOM_CHAM  = 'SIEF_ELGA',
      NOM_CMP   = 'SITX',
      VALE      = 0.0,
      CRITERE   = 'ABSOLU',
      MAILLE    = 'CUBEDEG',
      POINT     = 1,
      INST      = 7.0,
      ),
    )
  )


TEST_RESU(
  RESU = (
    _F(
      REFERENCE = 'ANALYTIQUE',
      RESULTAT  = U_FAT,
      NOM_CHAM  = 'VARI_ELGA',
      NOM_CMP   = 'V1',
      VALE      = 2.04959E-02,
      MAILLE    = 'CUBEDEG',
      POINT     = 1,
      INST      = 3.0,
      ),
    )
  )

TEST_RESU(
  RESU = (
    _F(
      REFERENCE = 'ANALYTIQUE',
      RESULTAT  = U_FAT,
      NOM_CHAM  = 'VARI_ELGA',
      NOM_CMP   = 'V4',
      VALE      = 1.94457E-01,
      MAILLE    = 'CUBEDEG',
      POINT     = 2,
      INST      = 3.0,
      ),
    )
  )

 
FIN(FORMAT_HDF='OUI')


