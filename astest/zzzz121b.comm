# MODIF  DATE 12/11/2003   AUTEUR CIBHHLV L.VIVAN 
# TITRE COUPLAGE ASTER_HOMARD - CAS TRIDIMENSIONNEL
#            CONFIGURATION MANAGEMENT OF EDF VERSION
# ======================================================================
# COPYRIGHT (C) 1991 - 2001  EDF R&D                  WWW.CODE-ASTER.ORG
# THIS PROGRAM IS FREE SOFTWARE; YOU CAN REDISTRIBUTE IT AND/OR MODIFY
# IT UNDER THE TERMS OF THE GNU GENERAL PUBLIC LICENSE AS PUBLISHED BY
# THE FREE SOFTWARE FOUNDATION; EITHER VERSION 2 OF THE LICENSE, OR   
# (AT YOUR OPTION) ANY LATER VERSION.                                 
#
# THIS PROGRAM IS DISTRIBUTED IN THE HOPE THAT IT WILL BE USEFUL, BUT 
# WITHOUT ANY WARRANTY; WITHOUT EVEN THE IMPLIED WARRANTY OF          
# MERCHANTABILITY OR FITNESS FOR A PARTICULAR PURPOSE. SEE THE GNU    
# GENERAL PUBLIC LICENSE FOR MORE DETAILS.                            
#
# YOU SHOULD HAVE RECEIVED A COPY OF THE GNU GENERAL PUBLIC LICENSE   
# ALONG WITH THIS PROGRAM; IF NOT, WRITE TO EDF R&D CODE_ASTER,       
#    1 AVENUE DU GENERAL DE GAULLE, 92141 CLAMART CEDEX, FRANCE.      
# ======================================================================
# RESPONSABLE GNICOLAS G.NICOLAS
# Attention :ceci est un test de non regression et non pas d'evaluation
# de l'adaptation de maillage.
# . Information
# . 2 adaptations
# . Sans mise a jour de champs
# . Cas 3D
# . Elements POI1, TRIA6, TETRA10
# . GROUP_NO, GROUP_MA
#
#
DEBUT(CODE=_F( NOM = 'ZZZZ121B',NIV_PUB_WEB='INTERNET'))
#
# 1. DEFINITION DES MATERIAUX
#
MATER1=DEFI_MATERIAU( 
           ELAS=_F(  E = 180000., NU = 0.30, ALPHA = 15.E-6, RHO = 7700.) )
#
MATER2=DEFI_MATERIAU( 
           ELAS=_F(  E = 220000., NU = 0.33, ALPHA = 16.E-6, RHO = 8300.) )
#
# 2. LECTURE DU MAILLAGE ET TEST DE LA MACRO SUR L'INFORMATION
#
MZERO=LIRE_MAILLAGE(VERI_MAIL=_F(VERIF='NON'), )

#
MACR_INFO_MAIL(
              MAILLAGE=MZERO,
              QUALITE='OUI',
              INTERPENETRATION='OUI',
              CONNEXITE='OUI',
              TAILLE='OUI',
              NOMBRE='OUI'
               )

#
# 3. CALCUL SUR LE MAILLAGE ZERO
# 3.1. MODELE MECANIQUE
#
MODEZERO=AFFE_MODELE(    MAILLAGE=MZERO,
                           AFFE=_F(  TOUT = 'OUI', PHENOMENE = 'MECANIQUE',
                                  MODELISATION = '3D') )

#
# 3.2. MISE EN PLACE DES MATERIAUX
#
MATEZERO=AFFE_MATERIAU(    MAILLAGE=MZERO,AFFE=(
       _F(  GROUP_MA = 'MOITIE1',  MATER = MATER1, TEMP_REF = 20.),
       _F(  GROUP_MA = 'MOITIE2',  MATER = MATER2, TEMP_REF = 20.))
                         )

#
# 3.3. LES GRANDEURS GLOBALES
#
MCGZERO=POST_ELEM(    MODELE=MODEZERO,   CHAM_MATER=MATEZERO,
   MASS_INER=_F(  GROUP_MA = ( 'MOITIE1', 'MOITIE2', ), TOUT = 'OUI'),
  TITRE='MASSE, CENTRE DE GRAVITE ET INERTIE DE LA STRUCTURE'
                    )

#
IMPR_TABLE(   TABLE=MCGZERO )

#
# 3.4. CHARGEMENTS
#
CHARZERO=AFFE_CHAR_MECA(    MODELE=MODEZERO,
     PESANTEUR=(  9.81,  0.,  0.,   -1., ),
    FORCE_FACE=_F(  GROUP_MA = 'Z_1',  FZ = 78480.),DDL_IMPO=(
      _F(  GROUP_NO = 'ORIGINE',  DX = 0.,   DY = 0.,   DZ = 0.), 
      _F(  GROUP_NO = 'I',  DY = 0.,   DZ = 0.),
      _F(  GROUP_NO = 'J',  DZ = 0.))
                          )

#
# 3.5. RESOLUTION
#
RESUZERO=MECA_STATIQUE(         MODELE=MODEZERO,
                              CHAM_MATER=MATEZERO,
                                   EXCIT=_F(  CHARGE = CHARZERO)
                         )

#
# 3.6. CALCUL DE L'INDICATEUR D'ERREUR
#
RESUZERO=CALC_ELEM( reuse=RESUZERO,   RESULTAT=RESUZERO,
                MODELE=MODEZERO,
               CHAM_MATER=MATEZERO,
                    EXCIT=_F(  CHARGE = CHARZERO),
              OPTION=( 'SIGM_ELNO_DEPL', 
                       'ERRE_ELGA_NORE', )
                      )

#
# 3.7. IMPRESSIONS POUR CREER LA BASE DU CAS-TEST HOMARD med_3d_cube_d2 A L'ITERATION 0
#
###IMPR_RESU ( RESU=_F(MAILLAGE=MZERO, IMPR_COOR='OUI') )
###IMPR_RESU ( RESU=_F( FORMAT='MED',RESULTAT=RESUZERO, NOM_CHAM='ERRE_ELGA_NORE',NOM_CMP='ERREST' ) ) ;
###IMPR_RESU ( RESU=_F( RESULTAT=RESUZERO ) ) ;
#
# 4. ADAPTATION DU MAILLAGE DE ZERO VERS UN
#
MACR_ADAP_MAIL(
              LANGUE = 'ANGLAIS' ,
              ADAPTATION=_F( 
                       LIBRE = 'RAFFINEMENT',
                       MAILLAGE_N = MZERO,
                       MAILLAGE_NP1 = CO("MUN"),
                       RESULTAT_N = RESUZERO,
                       INDICATEUR = 'ERRE_ELGA_NORE',
                       NOM_CMP_INDICA = 'ERREST' ,
                       CRIT_RAFF_REL = 0.9),
              QUALITE='OUI',
              INTERPENETRATION='NON'
               )
###IMPR_RESU ( RESU=_F(MAILLAGE=MUN, IMPR_COOR='OUI') )
#
# 5. CALCUL SUR LE MAILLAGE UN
# 5.1. MODELE MECANIQUE
#
MODEUN=AFFE_MODELE(    MAILLAGE=MUN,
                           AFFE=_F(  TOUT = 'OUI', PHENOMENE = 'MECANIQUE',
                                  MODELISATION = '3D') )

#
# 5.2. MISE EN PLACE DES MATERIAUX
#
MATEUN=AFFE_MATERIAU(    MAILLAGE=MUN,AFFE=(
       _F(  GROUP_MA = 'MOITIE1',  MATER = MATER1, TEMP_REF = 20.),
       _F(  GROUP_MA = 'MOITIE2',  MATER = MATER2, TEMP_REF = 20.))
                       )

#
# 5.3. LES GRANDEURS GLOBALES
#
MCGUN=POST_ELEM(    MODELE=MODEUN,   CHAM_MATER=MATEUN,
   MASS_INER=_F(  GROUP_MA = ( 'MOITIE1', 'MOITIE2', ), TOUT = 'OUI'),
  TITRE='MASSE, CENTRE DE GRAVITE ET INERTIE DE LA STRUCTURE'
                    )

#
IMPR_TABLE(   TABLE=MCGUN )

#
# 5.4. CHARGEMENTS
#
CHARUN=AFFE_CHAR_MECA(    MODELE=MODEUN,
     PESANTEUR=(  9.81,  0.,  0.,   -1., ),
    FORCE_FACE=_F(  GROUP_MA = 'Z_1',  FZ = 78480.),DDL_IMPO=(
      _F(  GROUP_NO = 'ORIGINE',  DX = 0.,   DY = 0.,   DZ = 0.),
      _F(  GROUP_NO = 'I',  DY = 0.,   DZ = 0.),
      _F(  GROUP_NO = 'J',  DZ = 0.))
                        )

#
# 5.5. RESOLUTION
#
RESUUN=MECA_STATIQUE(         MODELE=MODEUN,
                            CHAM_MATER=MATEUN,
                                 EXCIT=_F(  CHARGE = CHARUN)
                       )

#
# 5.6. CALCUL DE L'INDICATEUR D'ERREUR
#
RESUUN=CALC_ELEM( reuse=RESUUN,   RESULTAT=RESUUN,
                MODELE=MODEUN,
               CHAM_MATER=MATEUN,
                    EXCIT=_F(  CHARGE = CHARUN),
              OPTION=( 'SIGM_ELNO_DEPL', 
                       'ERRE_ELGA_NORE', )
                    )

#
# 5.7. IMPRESSIONS POUR CREER LA BASE DU CAS-TEST HOMARD med_3d_cube_d2 A L'ITERATION 1
#
###IMPR_RESU ( RESU=_F( FORMAT='MED',RESULTAT=RESUUN, NOM_CHAM='ERRE_ELGA_NORE',NOM_CMP='ERREST' ) ) ;
###IMPR_RESU ( RESU=_F( RESULTAT=RESUUN ) ) ;
#
# 6. TEST DE NON REGRESSION
#
TEST_RESU(RESU=(
       _F(  RESULTAT = RESUUN, NUME_ORDRE = 1,
            NOM_CHAM = 'DEPL',    GROUP_NO = 'OPPOSE',
            CRITERE = 'RELATIF',  PRECISION = 1.E-5,
            NOM_CMP = 'DX',       VALE =  2.66755E-02, 
            REFERENCE = 'NON_REGRESSION', VERSION = '7.01.09'),
       _F(  RESULTAT = RESUUN, NUME_ORDRE = 1,
            NOM_CHAM = 'DEPL',    GROUP_NO = 'OPPOSE',
            CRITERE = 'RELATIF',  PRECISION = 2.5E-6,
            NOM_CMP = 'DY',       VALE =  1.658803E-01, 
            REFERENCE = 'NON_REGRESSION', VERSION = '7.01.09'),
       _F(  RESULTAT = RESUUN, NUME_ORDRE = 1,
            NOM_CHAM = 'DEPL',    GROUP_NO = 'OPPOSE',
            CRITERE = 'RELATIF',  PRECISION = 1.E-5,
            NOM_CMP = 'DZ',       VALE = -6.575036E-02, 
            REFERENCE = 'NON_REGRESSION', VERSION = '7.01.09'))
          )

#
# 7. ADAPTATION DU MAILLAGE DE UN VERS DEUX
#
MACR_ADAP_MAIL(
              ADAPTATION=_F( 
                       LIBRE = 'RAFF_DERA',
                       MAILLAGE_N = MUN,
                       MAILLAGE_NP1 = CO("MDEUX"),
                       RESULTAT_N = RESUUN,
                       INDICATEUR = 'ERRE_ELGA_NORE',
                       NOM_CMP_INDICA = 'ERREST' ,
                       CRIT_RAFF_REL = 0.9,
                       NIVE_MAX = 8,
                       CRIT_DERA_REL = 0.25,
                       NIVE_MIN = 0),
              QUALITE='OUI',
              INTERPENETRATION='NON'
               )
###IMPR_RESU ( RESU=_F(MAILLAGE=MDEUX, IMPR_COOR='OUI') )
#
# 8. CALCUL SUR LE MAILLAGE DEUX
# 8.1. MODELE MECANIQUE
#
MODEDEUX=AFFE_MODELE(    MAILLAGE=MDEUX,
                           AFFE=_F(  TOUT = 'OUI', PHENOMENE = 'MECANIQUE',
                                  MODELISATION = '3D') )

#
# 8.2. MISE EN PLACE DES MATERIAUX
#
MATEDEUX=AFFE_MATERIAU(    MAILLAGE=MDEUX,AFFE=(
       _F(  GROUP_MA = 'MOITIE1',  MATER = MATER1, TEMP_REF = 20.),
       _F(  GROUP_MA = 'MOITIE2',  MATER = MATER2, TEMP_REF = 20.))
                         )

#
# 8.3. LES GRANDEURS GLOBALES
#
MCGDEUX=POST_ELEM(    MODELE=MODEDEUX,   CHAM_MATER=MATEDEUX,
   MASS_INER=_F(  GROUP_MA = ( 'MOITIE1', 'MOITIE2', ), TOUT = 'OUI'),
  TITRE='MASSE, CENTRE DE GRAVITE ET INERTIE DE LA STRUCTURE'
                    )

#
IMPR_TABLE(   TABLE=MCGDEUX )

#
# 8.4. CHARGEMENTS
#
CHARDEUX=AFFE_CHAR_MECA(    MODELE=MODEDEUX,
     PESANTEUR=(  9.81,  0.,  0.,   -1., ),
    FORCE_FACE=_F(  GROUP_MA = 'Z_1',  FZ = 78480.),DDL_IMPO=(
      _F(  GROUP_NO = 'ORIGINE',  DX = 0.,   DY = 0.,   DZ = 0.),
      _F(  GROUP_NO = 'I',  DY = 0.,   DZ = 0.),
      _F(  GROUP_NO = 'J',  DZ = 0.))
                          )

#
# 8.5. RESOLUTION
#
RESUDEUX=MECA_STATIQUE(         MODELE=MODEDEUX,
                              CHAM_MATER=MATEDEUX,
                                   EXCIT=_F(  CHARGE = CHARDEUX)
                         )
#
# 9. TEST DE NON REGRESSION
#
TEST_RESU(RESU=(
       _F(  RESULTAT = RESUDEUX, NUME_ORDRE = 1,
            NOM_CHAM = 'DEPL',    GROUP_NO = 'OPPOSE',
            CRITERE = 'RELATIF',  PRECISION = 1.E-5,
            NOM_CMP = 'DX',       VALE =  9.195670E-02, 
            REFERENCE = 'NON_REGRESSION', VERSION = '7.01.09'),
       _F(  RESULTAT = RESUDEUX, NUME_ORDRE = 1,
            NOM_CHAM = 'DEPL',    GROUP_NO = 'OPPOSE',
            CRITERE = 'RELATIF',  PRECISION = 1.E-5,
            NOM_CMP = 'DY',       VALE =  3.511732E-01, 
            REFERENCE = 'NON_REGRESSION', VERSION = '7.01.09'),
       _F(  RESULTAT = RESUDEUX, NUME_ORDRE = 1,
            NOM_CHAM = 'DEPL',    GROUP_NO = 'OPPOSE',
            CRITERE = 'RELATIF',  PRECISION = 1.E-5,
            NOM_CMP = 'DZ',       VALE = -2.510371E-01, 
            REFERENCE = 'NON_REGRESSION', VERSION = '7.01.09'))
          )

#
FIN( )
