# TITRE PLAQUE FISSUREE EN THERMOELASTICITE (CALCUL DE G,K1,K2)
# ======================================================================
# COPYRIGHT (C) 1991 - 2013  EDF R&D                  WWW.CODE-ASTER.ORG
# THIS PROGRAM IS FREE SOFTWARE; YOU CAN REDISTRIBUTE IT AND/OR MODIFY
# IT UNDER THE TERMS OF THE GNU GENERAL PUBLIC LICENSE AS PUBLISHED BY
# THE FREE SOFTWARE FOUNDATION; EITHER VERSION 2 OF THE LICENSE, OR
# (AT YOUR OPTION) ANY LATER VERSION.
#
# THIS PROGRAM IS DISTRIBUTED IN THE HOPE THAT IT WILL BE USEFUL, BUT
# WITHOUT ANY WARRANTY; WITHOUT EVEN THE IMPLIED WARRANTY OF
# MERCHANTABILITY OR FITNESS FOR A PARTICULAR PURPOSE. SEE THE GNU
# GENERAL PUBLIC LICENSE FOR MORE DETAILS.
#
# YOU SHOULD HAVE RECEIVED A COPY OF THE GNU GENERAL PUBLIC LICENSE
# ALONG WITH THIS PROGRAM; IF NOT, WRITE TO EDF R&D CODE_ASTER,
#    1 AVENUE DU GENERAL DE GAULLE, 92141 CLAMART CEDEX, FRANCE.
# ======================================================================
#

DEBUT(CODE=_F(NIV_PUB_WEB='INTERNET'),DEBUG=_F(SDVERI='OUI'))

MA=LIRE_MAILLAGE(FORMAT='MED',   )

# -------------------------------------------------------------- #
#                       DEBUT DU THERMIQUE                       #
# -------------------------------------------------------------- #

MOTH=AFFE_MODELE(         MAILLAGE=MA,
                            VERIF='MAILLE',
                              AFFE=_F(  TOUT = 'OUI',
                                      PHENOMENE = 'THERMIQUE',
                                      MODELISATION = 'PLAN') )

MATH=DEFI_MATERIAU(         THER=_F(  RHO_CP = 0.,
                                     LAMBDA = 1.0))

CMTH=AFFE_MATERIAU(       MAILLAGE=MA,
                                AFFE=_F(  TOUT = 'OUI',
                                       MATER = MATH) )

CHTH=AFFE_CHAR_THER(       MODELE=MOTH,TEMP_IMPO=(
                         _F( GROUP_NO = 'GRNM1',TEMP = -100.),
                         _F( GROUP_NO = 'GRNM3',TEMP = 100.)) )

METH=CALC_MATR_ELEM(         MODELE=MOTH,
                               CHARGE=CHTH,
                           CHAM_MATER=CMTH,
                              OPTION='RIGI_THER')

VETH=CALC_VECT_ELEM(        CHARGE=CHTH,
                              OPTION='CHAR_THER' )

NUTH=NUME_DDL(           MATR_RIGI=METH )

KTH=ASSE_MATRICE(        MATR_ELEM=METH,
                            NUME_DDL=NUTH )

FTH=ASSE_VECTEUR(        VECT_ELEM=VETH,
                            NUME_DDL=NUTH )

KTH=FACTORISER(     reuse=KTH,     MATR_ASSE=KTH  )

TEMP=RESOUDRE(           MATR=KTH,
                             CHAM_NO=FTH          )

# -------------------------------------------------------------- #
#                       FIN DU THERMIQUE                         #
# -------------------------------------------------------------- #

MO=AFFE_MODELE(            MAILLAGE=MA,
                                 VERIF='MAILLE',
                                AFFE=_F(  TOUT = 'OUI',
                                       PHENOMENE = 'MECANIQUE',
                                       MODELISATION = 'D_PLAN'))

MAT=DEFI_MATERIAU(            ELAS=_F(  E = 20000.,
                                       NU = 0.3,
                                       ALPHA = 0.000005) )

CM=AFFE_MATERIAU(        MAILLAGE=MA,
                    AFFE=_F(  TOUT = 'OUI', MATER = MAT ),
                    AFFE_VARC=_F(NOM_VARC='TEMP',TOUT='OUI',CHAM_GD=TEMP,VALE_REF=0.),
                                  )

CH=AFFE_CHAR_MECA(           MODELE=MO,
                         #TEMP_CALCULEE=TEMP,
                         DDL_IMPO=(
                              _F(  GROUP_NO = 'GRNM2', DY = 0.),
                              _F(  NOEUD = 'N695', DX = 0.),
                              _F(  GROUP_NO = 'GRNM4', DY = 0.)))

ME=CALC_MATR_ELEM(         MODELE=MO,
                              CHARGE=CH,
                          CHAM_MATER=CM,
                             OPTION='RIGI_MECA'   )

VE=CALC_VECT_ELEM(         CHARGE=CH,
                          CHAM_MATER=CM,
                             OPTION='CHAR_MECA'   )

NU=NUME_DDL(            MATR_RIGI=ME           )

K=ASSE_MATRICE(        MATR_ELEM=ME,
                            NUME_DDL=NU )

F=ASSE_VECTEUR(        VECT_ELEM=VE,
                            NUME_DDL=NU )

K=FACTORISER(      reuse=K,     MATR_ASSE=K  )

DEP=RESOUDRE(           MATR=K,
                             CHAM_NO=F  )

RESU=CREA_RESU(  OPERATION='AFFE',
                 TYPE_RESU='EVOL_ELAS',
                 NOM_CHAM='DEPL',
                      AFFE=_F(  CHAM_GD = DEP,
                                INST=0.,
                                MODELE=MO,
                                CHAM_MATER = CM)     )

THETA1=CALC_THETA(      MODELE=MO,
                        THETA_2D=_F( NOEUD = 'N3',
                                  MODULE = 1.0,
                                  R_INF = 10.,
                                  R_SUP = 40.),
                      DIRECTION=(1.,0.,0.,))

THETA2=CALC_THETA(      MODELE=MO,
                        THETA_2D=_F( NOEUD = 'N3',
                                  MODULE = 1.0,
                                  R_INF = 15.,
                                  R_SUP = 45.),
                      DIRECTION=(1.,0.,0.,))

THETA3=CALC_THETA(      MODELE=MO,
                        THETA_2D=_F( NOEUD = 'N3',
                                  MODULE = 1.0,
                                  R_INF = 5.0,
                                  R_SUP = 47.),
                      DIRECTION=(1.,0.,0.,))

THETA4=CALC_THETA(      MODELE=MO,
                        THETA_2D=_F( NOEUD = 'N3',
                                  MODULE = 1.0,
                                  R_INF = 3.0,
                                  R_SUP = 48.),
                      DIRECTION=(1.,0.,0.,))

FOND=DEFI_FOND_FISS( MAILLAGE=MA,
                     FOND_FISS=_F( NOEUD = 'N3'),
                     SYME='OUI',
                     LEVRE_SUP=_F(MAILLE='M388'))
G1=CALC_G(
                 RESULTAT=RESU,
                 THETA=_F(THETA=THETA1,SYME='OUI'),
                 EXCIT=_F(CHARGE=CH,),)

GK1=CALC_G(        RESULTAT=RESU,
                   THETA=_F(R_INF = 10.,
                              R_SUP = 40.,
                              DIRECTION=(1.,0.,0.,),
                              FOND_FISS=FOND),
                    EXCIT=_F(CHARGE=CH,),
                    OPTION='CALC_K_G')

G2=CALC_G(        RESULTAT=RESU,
                  THETA=_F(THETA=THETA2,SYME='OUI'),
                  EXCIT=_F(CHARGE=CH,),)

GK2=CALC_G(          RESULTAT=RESU,
                     THETA=_F(R_INF = 15.,
                              R_SUP = 45.,
                              DIRECTION=(1.,0.,0.,),
                              FOND_FISS=FOND),
                    EXCIT=_F(CHARGE=CH,),
                    OPTION='CALC_K_G')

G3=CALC_G(         RESULTAT=RESU,
                   THETA=_F(THETA=THETA3,SYME='OUI'),
                   EXCIT=_F(CHARGE=CH,),)

GK3=CALC_G(          RESULTAT=RESU,
                     THETA=_F(R_INF = 5.0,
                              R_SUP = 47.,
                              DIRECTION=(1.,0.,0.,),
                              FOND_FISS=FOND),
                     EXCIT=_F(CHARGE=CH,),
                     OPTION='CALC_K_G')

G4=CALC_G(        RESULTAT=RESU,
                  NUME_ORDRE=1,
                  THETA=_F(THETA=THETA4,SYME='OUI'),
                  EXCIT=_F(CHARGE=CH,),)

GK4=CALC_G(         RESULTAT=RESU,
                    NUME_ORDRE=1,
                    THETA=_F(R_INF = 3.0,
                              R_SUP = 48.,
                              DIRECTION=(1.,0.,0.,),
                              FOND_FISS=FOND),
                    EXCIT=_F(CHARGE=CH,),
                    OPTION='CALC_K_G')


GK5=CALC_G(         RESULTAT=RESU,
                    NUME_ORDRE=1,
                    THETA=_F( DIRECTION=(1.,0.,0.,),
                              FOND_FISS=FOND),
                    EXCIT=_F(CHARGE=CH,),
                    OPTION='CALC_K_G')


TEST_TABLE(PRECISION=0.080000000000000002,
           VALE_CALC=0.36020343269238,
           VALE_REFE=0.38985999999999998,
           REFERENCE='NON_DEFINI',
           NOM_PARA='G',
           TABLE=G1,)

TEST_TABLE(PRECISION=0.080000000000000002,
           VALE_CALC=0.36020230308301,
           VALE_REFE=0.38985999999999998,
           REFERENCE='NON_DEFINI',
           NOM_PARA='G',
           TABLE=GK1,)

TEST_TABLE(PRECISION=0.080000000000000002,
           VALE_CALC=0.35963657553284,
           VALE_REFE=0.38985999999999998,
           REFERENCE='NON_DEFINI',
           NOM_PARA='G_IRWIN',
           TABLE=GK1,)

TEST_TABLE(PRECISION=0.040000000000000001,
           VALE_CALC=88.905008639342,
           VALE_REFE=92.566000000000003,
           REFERENCE='NON_DEFINI',
           NOM_PARA='K1',
           TABLE=GK1,)

TEST_TABLE(CRITERE='ABSOLU',
           VALE_CALC=0.0E+00,

           NOM_PARA='K2',
           TABLE=GK1,)

TEST_TABLE(PRECISION=0.080000000000000002,
           VALE_CALC=0.36011509770040,
           VALE_REFE=0.38985999999999998,
           REFERENCE='NON_DEFINI',
           NOM_PARA='G',
           TABLE=G2,)

TEST_TABLE(PRECISION=0.080000000000000002,
           VALE_CALC=0.36014406182239,
           VALE_REFE=0.38985999999999998,
           REFERENCE='NON_DEFINI',
           NOM_PARA='G',
           TABLE=GK2,)

TEST_TABLE(PRECISION=0.080000000000000002,
           VALE_CALC=0.35958185368000,
           VALE_REFE=0.38985999999999998,
           REFERENCE='NON_DEFINI',
           NOM_PARA='G_IRWIN',
           TABLE=GK2,)

TEST_TABLE(PRECISION=0.040000000000000001,
           VALE_CALC=88.898244544405,
           VALE_REFE=92.566000000000003,
           REFERENCE='NON_DEFINI',
           NOM_PARA='K1',
           TABLE=GK2,)

TEST_TABLE(CRITERE='ABSOLU',
           VALE_CALC=0.0E+00,

           NOM_PARA='K2',
           TABLE=GK2,)

TEST_TABLE(PRECISION=0.080000000000000002,
           VALE_CALC=0.36014431210364,
           VALE_REFE=0.38985999999999998,
           REFERENCE='NON_DEFINI',
           NOM_PARA='G',
           TABLE=G3,)

TEST_TABLE(PRECISION=0.080000000000000002,
           VALE_CALC=0.36019436285420,
           VALE_REFE=0.38985999999999998,
           REFERENCE='NON_DEFINI',
           NOM_PARA='G',
           TABLE=GK3,)

TEST_TABLE(PRECISION=0.080000000000000002,
           VALE_CALC=0.35961445842933,
           VALE_REFE=0.38985999999999998,
           REFERENCE='NON_DEFINI',
           NOM_PARA='G_IRWIN',
           TABLE=GK3,)

TEST_TABLE(PRECISION=0.040000000000000001,
           VALE_CALC=88.902274835767,
           VALE_REFE=92.566000000000003,
           REFERENCE='NON_DEFINI',
           NOM_PARA='K1',
           TABLE=GK3,)

TEST_TABLE(CRITERE='ABSOLU',
           VALE_CALC=0.0E+00,

           NOM_PARA='K2',
           TABLE=GK3,)

TEST_TABLE(PRECISION=0.080000000000000002,
           VALE_CALC=0.36184454261395,
           VALE_REFE=0.38985999999999998,
           REFERENCE='NON_DEFINI',
           NOM_PARA='G',
           TABLE=GK5,)

TEST_TABLE(PRECISION=0.080000000000000002,
           VALE_CALC=0.36135763242241,
           VALE_REFE=0.38985999999999998,
           REFERENCE='NON_DEFINI',
           NOM_PARA='G_IRWIN',
           TABLE=GK5,)

TEST_TABLE(PRECISION=0.040000000000000001,
           VALE_CALC=89.117484184113,
           VALE_REFE=92.566000000000003,
           REFERENCE='NON_DEFINI',
           NOM_PARA='K1',
           TABLE=GK5,)

TEST_TABLE(CRITERE='ABSOLU',
           VALE_CALC=0.0E+00,

           NOM_PARA='K2',
           TABLE=GK5,)

FIN( )
#
