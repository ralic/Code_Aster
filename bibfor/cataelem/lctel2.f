      SUBROUTINE LCTEL2()
C            CONFIGURATION MANAGEMENT OF EDF VERSION
C MODIF CATAELEM  DATE 09/11/2012   AUTEUR DELMAS J.DELMAS 
C ======================================================================
C COPYRIGHT (C) 1991 - 2012  EDF R&D                  WWW.CODE-ASTER.ORG
C THIS PROGRAM IS FREE SOFTWARE; YOU CAN REDISTRIBUTE IT AND/OR MODIFY
C IT UNDER THE TERMS OF THE GNU GENERAL PUBLIC LICENSE AS PUBLISHED BY
C THE FREE SOFTWARE FOUNDATION; EITHER VERSION 2 OF THE LICENSE, OR
C (AT YOUR OPTION) ANY LATER VERSION.
C
C THIS PROGRAM IS DISTRIBUTED IN THE HOPE THAT IT WILL BE USEFUL, BUT
C WITHOUT ANY WARRANTY; WITHOUT EVEN THE IMPLIED WARRANTY OF
C MERCHANTABILITY OR FITNESS FOR A PARTICULAR PURPOSE. SEE THE GNU
C GENERAL PUBLIC LICENSE FOR MORE DETAILS.
C
C YOU SHOULD HAVE RECEIVED A COPY OF THE GNU GENERAL PUBLIC LICENSE
C ALONG WITH THIS PROGRAM; IF NOT, WRITE TO EDF R&D CODE_ASTER,
C    1 AVENUE DU GENERAL DE GAULLE, 92141 CLAMART CEDEX, FRANCE.
C ======================================================================
C ----------------------------------------------------------------------
C     BUT : AJOUTER AUX OBJETS RESULTANTS DE LA LECTURE DES CATALOGUES
C      L'OBJET '&CATA.TE.TAILLMAX'   S V I
C           V(I_TE) : NOMBRE MAXI DE TERMES DANS UNE MATRICE ELEMENTAIRE
C                     POUR L'ELEMENT I_TE
C      L'OBJET '&CATA.TE.NBLIGCOL'
C      L'OBJET '&CATA.TE.OPTTE'
C
C ----------------------------------------------------------------------
      IMPLICIT NONE
      INCLUDE 'jeveux.h'

      CHARACTER*32 JEXNUM,JEXNOM
      CHARACTER*24 NOMOLO
      CHARACTER*16 NOMTE
      CHARACTER*8 KBID
      INTEGER NBTE,NBOP,NBGD,IATAMX,NBMOLO,IMOLO,JNBLIG,IAMOLO
      INTEGER N,IOPTTE,IOP,ITE,JOPTTE,JOPTT2

      CALL JEMARQ()

      CALL JELIRA('&CATA.TE.NOMTE'   ,'NOMMAX',NBTE,KBID)
      CALL JELIRA('&CATA.OP.NOMOPT'   ,'NOMMAX',NBOP,KBID)
      CALL JELIRA('&CATA.GD.NOMGD'   ,'NOMMAX',NBGD,KBID)
      CALL JELIRA('&CATA.TE.NOMMOLOC','NOMMAX',NBMOLO,KBID)




C     OBJET .TAILLMAX :
C     -------------------
      CALL WKVECT('&CATA.TE.TAILLMAX','G V I',NBTE,IATAMX)
      DO 1, IMOLO=1,NBMOLO
        CALL JEVEUO(JEXNUM('&CATA.TE.MODELOC',IMOLO),'L',IAMOLO)
        IF (ZI(IAMOLO-1+1).EQ.5) THEN
          CALL JENUNO(JEXNUM('&CATA.TE.NOMMOLOC',IMOLO),NOMOLO)
          NOMTE= NOMOLO(1:16)
          CALL JENONU(JEXNOM('&CATA.TE.NOMTE',NOMTE),ITE)
          ZI(IATAMX-1+ITE)=MAX(ZI(IATAMX-1+ITE),ZI(IAMOLO-1+3))
        END IF
 1    CONTINUE


C     OBJET .NBLIGCOL :
C     -------------------
      CALL WKVECT('&CATA.TE.NBLIGCOL','G V I',6,JNBLIG)
      ZI(JNBLIG-1+1)=NBOP
      ZI(JNBLIG-1+2)=NBTE
      ZI(JNBLIG-1+3)=NBTE
      ZI(JNBLIG-1+4)=NBGD
      ZI(JNBLIG-1+5)=NBTE
      ZI(JNBLIG-1+6)=NBGD


C     OBJET .OPTTE :
C     -------------------
      CALL JEVEUO('&CATA.TE.OPTT2','L',JOPTT2)
      CALL JELIRA('&CATA.TE.OPTT2','LONMAX',N,KBID)
      CALL WKVECT('&CATA.TE.OPTTE','G V I',NBTE*NBOP,JOPTTE)
      DO 2,IOPTTE=1,N/2
         IOP=ZI(JOPTT2-1+2*(IOPTTE-1)+1)
         ITE=ZI(JOPTT2-1+2*(IOPTTE-1)+2)
         IF ( IOP .EQ. 0 .OR. ITE .EQ. 0 ) GOTO 2
         ZI(JOPTTE-1+(ITE-1)*NBOP+IOP)=IOPTTE
 2    CONTINUE
      CALL JEDETR('&CATA.TE.OPTT2')



      CALL JEDEMA()
      END
