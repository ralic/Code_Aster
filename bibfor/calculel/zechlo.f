      SUBROUTINE ZECHLO(OPT,TE)
      IMPLICIT NONE

C            CONFIGURATION MANAGEMENT OF EDF VERSION
C MODIF CALCULEL  DATE 13/06/2012   AUTEUR COURTOIS M.COURTOIS 
C RESPONSABLE                            VABHHTS J.PELLET
C ======================================================================
C COPYRIGHT (C) 1991 - 2012  EDF R&D                  WWW.CODE-ASTER.ORG
C THIS PROGRAM IS FREE SOFTWARE; YOU CAN REDISTRIBUTE IT AND/OR MODIFY
C IT UNDER THE TERMS OF THE GNU GENERAL PUBLIC LICENSE AS PUBLISHED BY
C THE FREE SOFTWARE FOUNDATION; EITHER VERSION 2 OF THE LICENSE, OR
C (AT YOUR OPTION) ANY LATER VERSION.
C
C THIS PROGRAM IS DISTRIBUTED IN THE HOPE THAT IT WILL BE USEFUL, BUT
C WITHOUT ANY WARRANTY; WITHOUT EVEN THE IMPLIED WARRANTY OF
C MERCHANTABILITY OR FITNESS FOR A PARTICULAR PURPOSE. SEE THE GNU
C GENERAL PUBLIC LICENSE FOR MORE DETAILS.
C
C YOU SHOULD HAVE RECEIVED A COPY OF THE GNU GENERAL PUBLIC LICENSE
C ALONG WITH THIS PROGRAM; IF NOT, WRITE TO EDF R&D CODE_ASTER,
C    1 AVENUE DU GENERAL DE GAULLE, 92141 CLAMART CEDEX, FRANCE.
C ======================================================================
      INCLUDE 'jeveux.h'
      INTEGER OPT,TE
C ----------------------------------------------------------------------
C     BUT:
C      METTRE LES CHAMPS LOCAUX DE SORTIE A ZERO ENTRE 2 GRELS

C ----------------------------------------------------------------------
      COMMON /CAII02/IAOPTT,LGCO,IAOPMO,ILOPMO,IAOPNO,ILOPNO,IAOPDS,
     &       IAOPPA,NPARIO,NPARIN,IAMLOC,ILMLOC,IADSGD
      INTEGER        NBGR,IGR,NBELGR,JCTEAT,LCTEAT,IAWLOC,IAWLO2,IAWTYP
      COMMON /CAII06/NBGR,IGR,NBELGR,JCTEAT,LCTEAT,IAWLOC,IAWLO2,IAWTYP
      COMMON /CAII04/IACHII,IACHIK,IACHIX
      COMMON /CAII07/IACHOI,IACHOK
      INTEGER EVFINI,CALVOI,JREPE,JPTVOI,JELVOI
      COMMON /CAII19/EVFINI,CALVOI,JREPE,JPTVOI,JELVOI

C     VARIABLES LOCALES:
C     ------------------
      INTEGER NBPARA
      CHARACTER*8 NOPARA
      INTEGER NP,IPAR
      INTEGER LGGREL,I,IACHII,IACHIK,IACHIX,IACHLO,IACHOI,IACHOK
      INTEGER IADSGD,IAMLOC,IAOPDS,IAOPMO,IAOPNO,IAOPPA
      INTEGER IAOPTT,ILMLOC
      INTEGER ILOPMO,ILOPNO,INDIK8,IPARG,LGCO,NPARIN,NPARIO
      CHARACTER*1 TYPSCA
      CHARACTER*8 NOMPAR
      INTEGER DEBUGR

C DEB-------------------------------------------------------------------

C     -- SI CALVOI==1 : IL N'Y A RIEN A FAIRE CAR LES CHAMPS LOCAUX
C        VIENNENT D'ETRE ALLOUES ET SONT DONC DEJA A ZERO.
      IF (CALVOI.EQ.1) GOTO 9999


      NP = NBPARA(OPT,TE,'OUT')
      DO 40 IPAR = 1,NP
        NOMPAR = NOPARA(OPT,TE,'OUT',IPAR)

        IPARG = INDIK8(ZK8(IAOPPA),NOMPAR,1,NPARIO)
        IACHLO=ZI(IAWLOC-1+3*(IPARG-1)+1)
        IF (IACHLO.EQ.-1) GO TO 40

        TYPSCA = ZK8(IAWTYP-1+IPARG) (1:1)
        CALL ASSERT(TYPSCA.EQ.'R'.OR.TYPSCA.EQ.'C'.OR.TYPSCA.EQ.'I')

        LGGREL=ZI(IAWLO2-1+5*(NBGR*(IPARG-1)+IGR-1)+4)
        DEBUGR=ZI(IAWLO2-1+5*(NBGR*(IPARG-1)+IGR-1)+5)
        CALL ASSERT(DEBUGR.EQ.1)


        IF (TYPSCA.EQ.'R') THEN
          DO 10 I = 1,LGGREL
            ZR(IACHLO-1+I) = 0.0D0
   10     CONTINUE
        ELSE IF (TYPSCA.EQ.'C') THEN
          DO 20 I = 1,LGGREL
            ZC(IACHLO-1+I) = DCMPLX(0.D0,0.D0)
   20     CONTINUE
        ELSE IF (TYPSCA.EQ.'I') THEN
          DO 30 I = 1,LGGREL
            ZI(IACHLO-1+I) = 0
   30     CONTINUE
        END IF

   40 CONTINUE

 9999 CONTINUE
      END
