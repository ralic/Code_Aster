      SUBROUTINE UTEST2(CHAM19,NOMAIL,NONOEU,NUPO,NUSP,IVARI,NOCMP,
     &              NBREF,TBTXT,REFI,REFR,REFC,TYPRES,EPSI,CRIT,IFIC,
     &              SSIGNE)
      IMPLICIT NONE
      INTEGER NBREF,REFI(NBREF),NUPO,IVARI,IFIC,NUSP
      REAL*8 REFR(NBREF),EPSI
      CHARACTER*(*) CHAM19,NOMAIL,NONOEU,TYPRES,NOCMP,CRIT,SSIGNE
      CHARACTER*16 TBTXT(2)
      COMPLEX*16 REFC(NBREF)
C ----------------------------------------------------------------------
C MODIF CALCULEL  DATE 03/07/2012   AUTEUR PELLET J.PELLET 
C ======================================================================
C            CONFIGURATION MANAGEMENT OF EDF VERSION
C COPYRIGHT (C) 1991 - 2012  EDF R&D                  WWW.CODE-ASTER.ORG
C THIS PROGRAM IS FREE SOFTWARE; YOU CAN REDISTRIBUTE IT AND/OR MODIFY
C IT UNDER THE TERMS OF THE GNU GENERAL PUBLIC LICENSE AS PUBLISHED BY
C THE FREE SOFTWARE FOUNDATION; EITHER VERSION 2 OF THE LICENSE, OR
C (AT YOUR OPTION) ANY LATER VERSION.
C
C THIS PROGRAM IS DISTRIBUTED IN THE HOPE THAT IT WILL BE USEFUL, BUT
C WITHOUT ANY WARRANTY; WITHOUT EVEN THE IMPLIED WARRANTY OF
C MERCHANTABILITY OR FITNESS FOR A PARTICULAR PURPOSE. SEE THE GNU
C GENERAL PUBLIC LICENSE FOR MORE DETAILS.
C
C YOU SHOULD HAVE RECEIVED A COPY OF THE GNU GENERAL PUBLIC LICENSE
C ALONG WITH THIS PROGRAM; IF NOT, WRITE TO EDF R&D CODE_ASTER,
C    1 AVENUE DU GENERAL DE GAULLE, 92141 CLAMART CEDEX, FRANCE.
C ======================================================================
C ----------------------------------------------------------------------
C IN  : CHAM19 : NOM DU CHAM_ELEM DONT ON DESIRE VERIFIER 1 COMPOSANTE
C IN  : NOMAIL : NOM DE LA MAILLE A TESTER
C IN  : NONOEU : NOM D'UN NOEUD (POUR LES CHAM_ELEM "AUX NOEUDS").
C                 (SI CE NOM EST BLANC : ON UTILISE NUPO)
C IN  : NUPO   : NUMERO DU POINT A TESTER SUR LA MAILLE NOMAIL
C IN  : NUSP   : NUMERO DU SOUS_POINT A TESTER SUR LA MAILLE NOMAIL
C                (SI NUSP=0 : IL N'Y A PAS DE SOUS-POINT)
C IN  : IVARI   : NUMERO DE LA CMP (POUR VARI_R)
C IN  : NOCMP  : NOM DU DDL A TESTER SUR LE POINT NUPO
C IN  : NBREF  : NOMBRE DE VALEURS DE REFERENCE
C IN  : TBTXT  : (1)=REFERENCE, (2)=LEGENDE
C IN  : REFR   : VALEUR REELLE ATTENDUE SUR LE DDL DU POINT.
C IN  : REFC   : VALEUR COMPLEXE ATTENDUE SUR LE DDL DU POINT.
C IN  : CRIT   : 'RELATIF' OU 'ABSOLU'(PRECISION RELATIVE OU ABSOLUE).
C IN  : EPSI   : PRECISION ESPEREE
C IN  : IFIC   : NUMERO LOGIQUE DU FICHIER DE SORTIE
C OUT : IMPRESSION SUR LISTING
C ----------------------------------------------------------------------
      INTEGER VALI,IBID,IE,IER
      REAL*8 VALR
      COMPLEX*16 VALC
      CHARACTER*8 NOMMA
C     ------------------------------------------------------------------

C-----------------------------------------------------------------------
C-----------------------------------------------------------------------
      CALL DISMOI('F','NOM_MAILLA',CHAM19,'CHAM_ELEM',IBID,NOMMA,IE)

      CALL UTCH19(CHAM19,NOMMA,NOMAIL,NONOEU,NUPO,NUSP,IVARI,NOCMP,
     &            TYPRES,VALR,VALC,IER)
      IF (IER.NE.0) THEN
        WRITE (IFIC,*) 'NOOK '
      ELSE
        CALL UTITES(TBTXT(1),TBTXT(2),TYPRES,NBREF,REFI,REFR,REFC,
     &            VALI,VALR,VALC,EPSI,CRIT,IFIC,SSIGNE)
      END IF

      END
