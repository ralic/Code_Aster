      SUBROUTINE UTCMP1(NOMGD,MCFAC,IOCC,NOMCMP,IVARI)
      IMPLICIT   NONE
      INTEGER IOCC
      CHARACTER*8 NOMGD,NOMCMP
      CHARACTER*(*) MCFAC
C ----------------------------------------------------------------------
C            CONFIGURATION MANAGEMENT OF EDF VERSION
C MODIF CALCULEL  DATE 21/09/2011   AUTEUR COURTOIS M.COURTOIS 
C ======================================================================
C COPYRIGHT (C) 1991 - 2011  EDF R&D                  WWW.CODE-ASTER.ORG
C THIS PROGRAM IS FREE SOFTWARE; YOU CAN REDISTRIBUTE IT AND/OR MODIFY
C IT UNDER THE TERMS OF THE GNU GENERAL PUBLIC LICENSE AS PUBLISHED BY
C THE FREE SOFTWARE FOUNDATION; EITHER VERSION 2 OF THE LICENSE, OR
C (AT YOUR OPTION) ANY LATER VERSION.
C
C THIS PROGRAM IS DISTRIBUTED IN THE HOPE THAT IT WILL BE USEFUL, BUT
C WITHOUT ANY WARRANTY; WITHOUT EVEN THE IMPLIED WARRANTY OF
C MERCHANTABILITY OR FITNESS FOR A PARTICULAR PURPOSE. SEE THE GNU
C GENERAL PUBLIC LICENSE FOR MORE DETAILS.
C
C YOU SHOULD HAVE RECEIVED A COPY OF THE GNU GENERAL PUBLIC LICENSE
C ALONG WITH THIS PROGRAM; IF NOT, WRITE TO EDF R&D CODE_ASTER,
C    1 AVENUE DU GENERAL DE GAULLE, 92141 CLAMART CEDEX, FRANCE.
C ======================================================================

C  BUT : SCRUTER LE MOT CLE NOM_CMP ET RENDRE LE NOM DE LA CMP
C        SI LA GRANDEUR EST VARI_R, RENDRE EGALEMENT LE NUMERO (N) DE VN
C  ATTENTION : IL NE FAUT UTILISER CETTE ROUTINE QUE SI LE MOT CLE
C              NOM_CMP N'ATTEND QU'UNE SEULE VALEUR.

C  ARGUMENTS :
C  -----------
C  NOMGD  IN  K8 : NOM DE LA GRANDEUR CONCERNEE
C  MCFAC  IN  K* : NOM DU MOT CLE FACTEUR A SCRUTER
C  IOCC   IN  I  : NUMERO DE L'OCCURRENCE DE MCFAC
C  NOMCMP OUT K8 : NOM DE LA COMPOSANTE TROUVEE DERRIERE MCFAC/NOM_CMP
C  IVARI  OUT I  : NUMERO DE LA VARIABLE INTERNE SI NOMGD='VARI_R'
C                  0 SINON

C ----------------------------------------------------------------------
      INTEGER IBID,N2,IRET,IVARI
      CHARACTER*24 VALK(2)
      INTEGER      IARG
C     ------------------------------------------------------------------

      CALL GETVTX(MCFAC,'NOM_CMP',IOCC,IARG,1,NOMCMP,N2)
      CALL ASSERT(N2.EQ.1)


      IF (NOMGD.EQ.'VARI_R') THEN
C     ------------------------------
        CALL LXLIIS(NOMCMP(2:8),IBID,IRET)
        IVARI=IBID

        IF ((NOMCMP(1:1).NE.'V').OR.(IRET.NE.0)) THEN
          VALK (1) = NOMCMP
          VALK (2) = 'VARI_R'
          CALL U2MESG('F', 'CALCULEL6_49',2,VALK,0,0,0,0.D0)
        END IF

C     -- SI GRANDEUR /= VARI_R :
C     --------------------------
      ELSE
        IVARI=0
      END IF

      END
