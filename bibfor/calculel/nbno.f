      INTEGER FUNCTION NBNO(MODE)
      IMPLICIT NONE
C
C            CONFIGURATION MANAGEMENT OF EDF VERSION
C MODIF CALCULEL  DATE 09/11/2012   AUTEUR DELMAS J.DELMAS 
C ======================================================================
C COPYRIGHT (C) 1991 - 2012  EDF R&D                  WWW.CODE-ASTER.ORG
C THIS PROGRAM IS FREE SOFTWARE; YOU CAN REDISTRIBUTE IT AND/OR MODIFY
C IT UNDER THE TERMS OF THE GNU GENERAL PUBLIC LICENSE AS PUBLISHED BY
C THE FREE SOFTWARE FOUNDATION; EITHER VERSION 2 OF THE LICENSE, OR
C (AT YOUR OPTION) ANY LATER VERSION.
C
C THIS PROGRAM IS DISTRIBUTED IN THE HOPE THAT IT WILL BE USEFUL, BUT
C WITHOUT ANY WARRANTY; WITHOUT EVEN THE IMPLIED WARRANTY OF
C MERCHANTABILITY OR FITNESS FOR A PARTICULAR PURPOSE. SEE THE GNU
C GENERAL PUBLIC LICENSE FOR MORE DETAILS.
C
C YOU SHOULD HAVE RECEIVED A COPY OF THE GNU GENERAL PUBLIC LICENSE
C ALONG WITH THIS PROGRAM; IF NOT, WRITE TO EDF R&D CODE_ASTER,
C    1 AVENUE DU GENERAL DE GAULLE, 92141 CLAMART CEDEX, FRANCE.
C ======================================================================
C ---------------------------------------------------------------------
C     BUT: TROUVER LE NOMBRE DE NOEUDS ASSOCIES A UN MODE_LOCAL
C     DE TYPE CHAM_NO, VECTEUR, OU MATRICE .
C
C     IN:  MODE : MODE_LOCAL
C     OUT: NBNO : NOMBRE DE NOEUDS
C
C
C ---------------------------------------------------------------------
      INCLUDE 'jeveux.h'

      CHARACTER*32 JEXNUM
      INTEGER MODE,M1,M2,N1,N2
C
C     FONCTIONS JEVEUX
C
C
C
C
C-----------------------------------------------------------------------
      INTEGER IADM ,IADM1 ,IADM2 ,ISCHN ,ISMAT
C-----------------------------------------------------------------------
      CALL JEMARQ()
      ISMAT = 0
      ISCHN = 0
      CALL JEVEUO(JEXNUM('&CATA.TE.MODELOC',MODE),'L',IADM)
C
      IF (ZI(IADM).EQ.4) THEN
      ELSE IF (ZI(IADM).EQ.5) THEN
         ISMAT = 1
      ELSE IF (ZI(IADM).EQ.2) THEN
         ISCHN = 1
      ELSE
         CALL U2MESS('F','CALCULEL3_81')
      END IF
C
      IF (ISCHN.EQ.1) THEN
         NBNO = ZI(IADM-1+4)
         IF (NBNO.GT.10000) NBNO = NBNO - 10000
         GO TO 9999
      END IF
C
      M1 = ZI(IADM+3)
      CALL JEVEUO(JEXNUM('&CATA.TE.MODELOC',M1),'L',IADM1)
      N1 = ZI(IADM1+3)
      N1 = ABS(N1)
      IF (N1.GT.10000) THEN
         N1 = N1 - 10000
      END IF
C
      IF (ISMAT.EQ.1) THEN
         M2 = ZI(IADM+4)
         CALL JEVEUO(JEXNUM('&CATA.TE.MODELOC',M2),'L',IADM2)
         N2 = ZI(IADM2+3)
         N2 = ABS(N2)
         IF (N2.GT.10000) THEN
            N2 = N2 - 10000
         END IF
         IF (N1.NE.N2) THEN
            CALL U2MESS('F','CALCULEL3_82')
         END IF
      END IF
      NBNO = N1
 9999 CONTINUE
      CALL JEDEMA()
      END
