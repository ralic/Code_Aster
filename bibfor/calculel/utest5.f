      SUBROUTINE UTEST5(CHAM19,NOMAIL,NOCMP,
     &           TBTXT,REFI,REFR,REFC,TYPRES,EPSI,CRIT,IFIC)
      IMPLICIT NONE
      INTEGER REFI,IFIC
      REAL*8 REFR,EPSI
      CHARACTER*(*) CHAM19,NOMAIL,TYPRES,NOCMP,CRIT
      CHARACTER*16 TBTXT(2)
      COMPLEX*16 REFC
C RESPONSABLE PELLET J.PELLET
C ----------------------------------------------------------------------
C            CONFIGURATION MANAGEMENT OF EDF VERSION
C MODIF CALCULEL  DATE 03/07/2012   AUTEUR PELLET J.PELLET 
C ======================================================================
C COPYRIGHT (C) 1991 - 2012  EDF R&D                  WWW.CODE-ASTER.ORG
C THIS PROGRAM IS FREE SOFTWARE; YOU CAN REDISTRIBUTE IT AND/OR MODIFY  
C IT UNDER THE TERMS OF THE GNU GENERAL PUBLIC LICENSE AS PUBLISHED BY  
C THE FREE SOFTWARE FOUNDATION; EITHER VERSION 2 OF THE LICENSE, OR     
C (AT YOUR OPTION) ANY LATER VERSION.                                   
C                                                                       
C THIS PROGRAM IS DISTRIBUTED IN THE HOPE THAT IT WILL BE USEFUL, BUT   
C WITHOUT ANY WARRANTY; WITHOUT EVEN THE IMPLIED WARRANTY OF            
C MERCHANTABILITY OR FITNESS FOR A PARTICULAR PURPOSE. SEE THE GNU      
C GENERAL PUBLIC LICENSE FOR MORE DETAILS.                              
C                                                                       
C YOU SHOULD HAVE RECEIVED A COPY OF THE GNU GENERAL PUBLIC LICENSE     
C ALONG WITH THIS PROGRAM; IF NOT, WRITE TO EDF R&D CODE_ASTER,         
C   1 AVENUE DU GENERAL DE GAULLE, 92141 CLAMART CEDEX, FRANCE.         
C ======================================================================
C ----------------------------------------------------------------------
C IN  : CHAM19 : NOM DE LA CARTE DONT ON DESIRE VERIFIER 1 COMPOSANTE
C IN  : NOMAIL : NOM DE LA MAILLE A TESTER
C IN  : NOCMP  : NOM DU DDL A TESTER
C IN  : TBTXT  : (1)=REFERENCE, (2)=LEGENDE
C IN  : REFR   : VALEUR REELLE ATTENDUE
C IN  : REFI   : VALEUR REELLE ATTENDUE
C IN  : REFC   : VALEUR COMPLEXE ATTENDUE
C IN  : CRIT   : 'RELATIF' OU 'ABSOLU'(PRECISION RELATIVE OU ABSOLUE).
C IN  : EPSI   : PRECISION ESPEREE
C IN  : IFIC   : NUMERO LOGIQUE DU FICHIER DE SORTIE
C OUT : IMPRESSION SUR LISTING
C ----------------------------------------------------------------------
      INTEGER VALI,IBID,IE,IER
      REAL*8 VALR
      COMPLEX*16 VALC
      CHARACTER*8 NOMMA
      CHARACTER*3  SSIGNE
      CHARACTER*4 TYCH
C     ------------------------------------------------------------------
      CALL DISMOI('F','TYPE_CHAMP',CHAM19,'CHAMP',IBID,TYCH,IE)
      IF (TYCH.NE.'CART') CALL U2MESK('F','CALCULEL3_90',1,CHAM19)

      CALL DISMOI('F','NOM_MAILLA',CHAM19,'CARTE',IBID,NOMMA,IE)

      CALL UTCHCA(CHAM19,NOMMA,NOMAIL,NOCMP,TYPRES,VALR,VALI,VALC,IER)
      IF (IER.NE.0) THEN
        WRITE (IFIC,*) 'NOOK '
      ELSE
        SSIGNE='NON'
        CALL UTITES(TBTXT(1),TBTXT(2),TYPRES,1,REFI,REFR,REFC,
     &            VALI,VALR,VALC,EPSI,CRIT,IFIC,SSIGNE)
      END IF

      END
