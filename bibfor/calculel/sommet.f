      SUBROUTINE SOMMET(PANNOE,DIME  ,PAN   ,NSOM  ,CSOM  )

C            CONFIGURATION MANAGEMENT OF EDF VERSION
C MODIF CALCULEL  DATE 09/01/2007   AUTEUR ABBAS M.ABBAS 
C ======================================================================
C COPYRIGHT (C) 1991 - 2002  EDF R&D                  WWW.CODE-ASTER.ORG
C THIS PROGRAM IS FREE SOFTWARE; YOU CAN REDISTRIBUTE IT AND/OR MODIFY
C IT UNDER THE TERMS OF THE GNU GENERAL PUBLIC LICENSE AS PUBLISHED BY
C THE FREE SOFTWARE FOUNDATION; EITHER VERSION 2 OF THE LICENSE, OR
C (AT YOUR OPTION) ANY LATER VERSION.
C
C THIS PROGRAM IS DISTRIBUTED IN THE HOPE THAT IT WILL BE USEFUL, BUT
C WITHOUT ANY WARRANTY; WITHOUT EVEN THE IMPLIED WARRANTY OF
C MERCHANTABILITY OR FITNESS FOR A PARTICULAR PURPOSE. SEE THE GNU
C GENERAL PUBLIC LICENSE FOR MORE DETAILS.
C
C YOU SHOULD HAVE RECEIVED A COPY OF THE GNU GENERAL PUBLIC LICENSE
C ALONG WITH THIS PROGRAM; IF NOT, WRITE TO EDF R&D CODE_ASTER,
C    1 AVENUE DU GENERAL DE GAULLE, 92141 CLAMART CEDEX, FRANCE.
C
C
C ======================================================================
C RESPONSABLE ABBAS M.ABBAS
C
      IMPLICIT NONE
      INTEGER DIME
      INTEGER NSOM
      INTEGER PANNOE(DIME,*)
      REAL*8  PAN(DIME+2,*)
      REAL*8  CSOM(DIME,*)
C      
C ----------------------------------------------------------------------
C
C CONSTRUCTION DE BOITES ENGLOBANTES POUR UN GROUPE DE MAILLES
C
C COORDONNEES DES SOMMETS DU CONVEXE ENGLOBANT D'UNE MAILLE 
C
C ----------------------------------------------------------------------
C 
C     
C IN  PANNOE : PANS TOUCHANT LES NOEUDS PRINCIPAUX DE 
C              LA MAILLE (CF PANNO)
C IN  DIME   : DIMENSION DE L'ESPACE
C IN  PAN    : EQUATION DES PANS DU CONVEXE (CF BOITE)
C IN  NSOM   : NOMBRE DE NOEUDS PRINCIPAUX DE LA MAILLE
C OUT CSOM   : COORD. SOMMETS DU CONVEXE (X1,Y1,[Z1],X2,...)
C
C ----------------------------------------------------------------------
C
      INTEGER ISOM,J,K,L,IRET
      REAL*8  A(3,3),DET
C
C ----------------------------------------------------------------------
C
      DO 10 ISOM = 1, NSOM
        DO 20 J = 1, DIME
          L = PANNOE(J,ISOM)
          DO 30 K = 1, DIME
            A(K,J) = PAN(K,L)
 30       CONTINUE
          CSOM(J,ISOM) = -PAN(DIME+1,L)
 20     CONTINUE
        CALL MGAUSS('TFVP',A,CSOM(1,ISOM),3,DIME,1,DET,IRET)
 10   CONTINUE

      END
