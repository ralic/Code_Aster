      SUBROUTINE PMFMCF(IP,NBGF,NBFIB,NUGF,SDCOMP,
     &                  CRIT,OPTION,
     &                  INSTAM,INSTAP,
     &                  ICDMAT,NBVALC,
     &                  DEFAM,DEFAP,
     &                  VARIM,VARIMP,
     &                  CONTM,DEFM,DEFP,
     &                  EPSM,
     &                  MODF,SIGF,VARIP,ISECAN,CODRET)

C            CONFIGURATION MANAGEMENT OF EDF VERSION
C            CONFIGURATION MANAGEMENT OF EDF VERSION
C MODIF ELEMENTS  DATE 16/10/2007   AUTEUR SALMONA L.SALMONA 
C ======================================================================
C COPYRIGHT (C) 1991 - 2001  EDF R&D                  WWW.CODE-ASTER.ORG
C THIS PROGRAM IS FREE SOFTWARE; YOU CAN REDISTRIBUTE IT AND/OR MODIFY
C IT UNDER THE TERMS OF THE GNU GENERAL PUBLIC LICENSE AS PUBLISHED BY
C THE FREE SOFTWARE FOUNDATION; EITHER VERSION 2 OF THE LICENSE, OR
C (AT YOUR OPTION) ANY LATER VERSION.
C
C THIS PROGRAM IS DISTRIBUTED IN THE HOPE THAT IT WILL BE USEFUL, BUT
C WITHOUT ANY WARRANTY; WITHOUT EVEN THE IMPLIED WARRANTY OF
C MERCHANTABILITY OR FITNESS FOR A PARTICULAR PURPOSE. SEE THE GNU
C GENERAL PUBLIC LICENSE FOR MORE DETAILS.
C
C YOU SHOULD HAVE RECEIVED A COPY OF THE GNU GENERAL PUBLIC LICENSE
C ALONG WITH THIS PROGRAM; IF NOT, WRITE TO EDF R&D CODE_ASTER,
C    1 AVENUE DU GENERAL DE GAULLE, 92141 CLAMART CEDEX, FRANCE.
C ======================================================================
C TOLE CRP_21
      IMPLICIT NONE
      INTEGER IP,NBGF,NBFIB,NBVALC,NUGF(*),ICDMAT,ISECAN
      CHARACTER*16 SDCOMP(*),OPTION
      REAL*8 VARIM(*),VARIMP(*),VARIP(*),CONTM(*),DEFM(*),DEFP(*)
      REAL*8 CRIT(*),INSTAM,INSTAP,DEFAP(*),DEFAM(*),EPSM
      REAL*8 SIGF(*),MODF(*)
      INTEGER IG,NGF,NBFIG,I,IRET,IRET1,IRET2
      INTEGER IDCIPV,IDCIPC,IDECC,IDECV,ICP
      INTEGER IPOSV,IPOSC
      INTEGER CODRET,CODREP
C     ------------------------------------------------------------------

        CODREP=0
C  BOUCLE SUR LES GROUPES DE FIBRE
        IDCIPC=(NBFIB+6)*(IP-1)
        IDCIPV=NBVALC*IDCIPC
        IDECC=1
        IDECV=1
        DO 510 IG=1,NBGF
C NUMERO DU GROUPE DE FIBRE
          NGF=NUGF(IG)
          ICP=(NGF-1)*6
C NOMBRE DE FIBRES DE CE GROUPE
          READ(SDCOMP(ICP+6),'(I16)')NBFIG

C ---     AIGUILLAGE SUIVANT COMPORTEMENT
C         POUR AVOIR MODULE ET CONTRAINTE SUR CHAQUE FIBRE
C ---   ATTENTION POSITION DU POINTEUR CONTRAINTE ET VARIABLES INTERNES
          IPOSV= IDECV + IDCIPV
          IPOSC= IDECC + IDCIPC

          CALL PMFCOM(IP,OPTION,SDCOMP(ICP+2),CRIT,
     &             NBFIG,
     &             INSTAM,INSTAP,
     &             2,NBFIG,
     &             ICDMAT,NBVALC,
     &             DEFAM,DEFAP,
     &             VARIM(IPOSV),VARIMP(IPOSV),
     &             CONTM(IPOSC),DEFM(IDECC),DEFP(IDECC),
     &             EPSM,
     &             MODF(IDECC),SIGF(IDECC),
     &             VARIP(IPOSV),ISECAN,CODREP)
          IF (CODREP.NE.0) CODRET=CODREP
          IDECC=IDECC+NBFIG
          IDECV=IDECV+NBVALC*NBFIG
C --- FIN BOUCLE GROUPES DE FIBRES$
 510    CONTINUE

 1000 FORMAT(6(D10.4,2X))

      END
