      SUBROUTINE TE0365(OPTION,NOMTE )
C
C            CONFIGURATION MANAGEMENT OF EDF VERSION
C MODIF ELEMENTS  DATE 04/07/2011   AUTEUR DESOZA T.DESOZA 
C ======================================================================
C COPYRIGHT (C) 1991 - 2011  EDF R&D                  WWW.CODE-ASTER.ORG
C THIS PROGRAM IS FREE SOFTWARE; YOU CAN REDISTRIBUTE IT AND/OR MODIFY
C IT UNDER THE TERMS OF THE GNU GENERAL PUBLIC LICENSE AS PUBLISHED BY
C THE FREE SOFTWARE FOUNDATION; EITHER VERSION 2 OF THE LICENSE, OR
C (AT YOUR OPTION) ANY LATER VERSION.
C
C THIS PROGRAM IS DISTRIBUTED IN THE HOPE THAT IT WILL BE USEFUL, BUT
C WITHOUT ANY WARRANTY; WITHOUT EVEN THE IMPLIED WARRANTY OF
C MERCHANTABILITY OR FITNESS FOR A PARTICULAR PURPOSE. SEE THE GNU
C GENERAL PUBLIC LICENSE FOR MORE DETAILS.
C
C YOU SHOULD HAVE RECEIVED A COPY OF THE GNU GENERAL PUBLIC LICENSE
C ALONG WITH THIS PROGRAM; IF NOT, WRITE TO EDF R&D CODE_ASTER,
C    1 AVENUE DU GENERAL DE GAULLE, 92141 CLAMART CEDEX, FRANCE.
C ======================================================================
C RESPONSABLE ABBAS M.ABBAS
C
      IMPLICIT      NONE
      CHARACTER*16  OPTION,NOMTE
C
C ----------------------------------------------------------------------
C
C  CALCUL DES SECONDS MEMBRES DE CONTACT ET DE FROTTEMENT DE COULOMB STD
C        AVEC LA METHODE CONTINUE
C
C  OPTION : 'CHAR_MECA_CONT' (CALCUL DU SECOND MEMBRE DE CONTACT)
C           'CHAR_MECA_FROT' (CALCUL DU SECOND MEMBRE DE
C                              FROTTEMENT STANDARD )
C
C  ENTREES  ---> OPTION : OPTION DE CALCUL
C           ---> NOMTE  : NOM DU TYPE ELEMENT
C 
C --------- DEBUT DECLARATIONS NORMALISEES  JEVEUX ---------------------
C
      INTEGER ZI
      COMMON /IVARJE/ZI(1)
      REAL*8 ZR
      COMMON /RVARJE/ZR(1)
      COMPLEX*16 ZC
      COMMON /CVARJE/ZC(1)
      LOGICAL ZL
      COMMON /LVARJE/ZL(1)
      CHARACTER*8 ZK8
      CHARACTER*16 ZK16
      CHARACTER*24 ZK24
      CHARACTER*32 ZK32
      CHARACTER*80 ZK80
      COMMON /KVARJE/ZK8(1),ZK16(1),ZK24(1),ZK32(1),ZK80(1)
C
C --------- FIN  DECLARATIONS  NORMALISEES  JEVEUX ---------------------
C
      INTEGER      IDDL
      INTEGER      NNE,NNM,NNL
      INTEGER      NDDL,NDIM,NBCPS,NBDM
      INTEGER      JVECT
      INTEGER      TYPBAR,TYPRAC,NDEXFR
      REAL*8       TAU1(3),TAU2(3)
      REAL*8       NORM(3),MPROJT(3,3)
      REAL*8       RESE(3),NRESE
      REAL*8       WPG,JACOBI
      REAL*8       COEFFF,LAMBDA
      REAL*8       COEFCS,COEFCP,COEFCR
      REAL*8       COEFFR,COEFFS,COEFFP
      REAL*8       JEU,JEUSUP
      REAL*8       DELTAT,BETA,GAMMA,THETA
      REAL*8       DLAGRC,DLAGRF(2),DVITE(3)
      REAL*8       KAPPAN,KAPPAV,ASPERI
      REAL*8       PRFUSU,CWEAR
      CHARACTER*8  TYPMAE,TYPMAM
      CHARACTER*9  PHASEP
      LOGICAL      LAXIS,LELTF
      LOGICAL      LFROTT,LCOMPL
      LOGICAL      LPENAC,LPENAF
      LOGICAL      LOPTF,LUSURE,LDYNA,LFOVIT,LCONT
      LOGICAL      LASPE,LADHE
      LOGICAL      DEBUG
      REAL*8       FFE(9),FFM(9),FFL(9)
C
      REAL*8       VECTCC(9)
      REAL*8       VECTFF(18)
      REAL*8       VECTEE(27),VECTMM(27)
      REAL*8       VTMP(81)
C
      CHARACTER*24 TYPELT
C
C ----------------------------------------------------------------------
C
      CALL JEMARQ()
C
C --- INITIALISATIONS
C
      CALL VECINI(81,0.D0,VTMP  )
      CALL VECINI( 9,0.D0,VECTCC)
      CALL VECINI(18,0.D0,VECTFF)
      CALL VECINI(27,0.D0,VECTEE)
      CALL VECINI(27,0.D0,VECTMM)
      DEBUG  = .FALSE.
C
C --- TYPE DE MAILLE DE CONTACT
C
      TYPELT = 'POIN_ELEM'
      LOPTF  = OPTION.EQ.'CHAR_MECA_FROT'
C
C --- PREPARATION DES CALCULS - INFOS SUR LA MAILLE DE CONTACT
C
      CALL MMELEM(NOMTE ,NDIM  ,NDDL  ,TYPMAE,NNE   ,
     &            TYPMAM,NNM   ,NNL   ,NBCPS ,NBDM  ,
     &            LAXIS ,LELTF )
C
C --- PREPARATION DES CALCULS - LECTURE DES COEFFICIENTS
C
      CALL MMMLCF(COEFFF,COEFCR,COEFCS,COEFCP,COEFFR,
     &            COEFFS,COEFFP,LPENAC,LPENAF)
C
C --- PREPARATION DES CALCULS - LECTURE FONCTIONNALITES AVANCEES
C
      CALL MMMLAV(LCOMPL,LFROTT,LUSURE,LDYNA ,LFOVIT,
     &            ASPERI,KAPPAN,KAPPAV,DELTAT,BETA  ,
     &            GAMMA ,THETA ,PRFUSU,CWEAR ,JEUSUP,
     &            NDEXFR,TYPBAR,TYPRAC)
C
C --- PREPARATION DES DONNEES
C
      IF (TYPELT.EQ.'POIN_ELEM') THEN
C
C ----- CALCUL DES QUANTITES
C
        CALL MMVPPE(TYPMAE,TYPMAM,NDIM  ,NNE   ,NNM   ,
     &              NNL   ,NBDM  ,DELTAT,BETA  ,GAMMA ,
     &              LAXIS ,LDYNA ,LCOMPL,LFOVIT,TYPBAR,
     &              TYPRAC,PRFUSU,JEUSUP,FFE   ,FFM   ,
     &              FFL   ,NORM  ,TAU1  ,TAU2  ,MPROJT,
     &              JACOBI,WPG   ,JEU   ,DLAGRC,DLAGRF,
     &              DVITE )
C
C ----- STATUTS
C
        CALL MMMSTA(NDIM  ,LELTF ,LPENAF,LOPTF ,DVITE ,
     &              DLAGRF,COEFFR,COEFFP,COEFFF,TAU1  ,
     &              TAU2  ,MPROJT,LCONT ,LASPE ,LADHE ,
     &              LAMBDA,RESE  ,NRESE )
C
C ----- PHASE DE CALCUL
C
        CALL MMMPHA(LOPTF ,LCONT ,LASPE ,LADHE ,TYPBAR,
     &              TYPRAC,NDEXFR,LPENAC,LPENAF,PHASEP)
C       
      ELSE
        CALL ASSERT(.FALSE.)
      ENDIF
C
C --- CALCUL FORME FORTE
C
      IF (TYPELT.EQ.'POIN_ELEM') THEN
        CALL MMVFPE(PHASEP,NDIM  ,NNE   ,NNM   ,NORM  ,
     &              TAU1  ,TAU2  ,MPROJT,WPG   ,FFE   ,
     &              FFM   ,JACOBI,JEU   ,COEFCP,COEFFP,
     &              LAMBDA,COEFFF,DLAGRC,DLAGRF,DVITE ,
     &              RESE  ,NRESE ,VECTEE,VECTMM)
      ELSE
        CALL ASSERT(.FALSE.)
      ENDIF
C
C --- CALCUL FORME FAIBLE
C
      IF (TYPELT.EQ.'POIN_ELEM') THEN
        CALL MMVAPE(PHASEP,LELTF ,NDIM  ,NNL   ,NBCPS ,
     &              COEFCP,COEFCS,COEFFP,COEFFS,COEFFF,
     &              FFL   ,WPG   ,JEU   ,JACOBI,LAMBDA,
     &              TAU1  ,TAU2  ,MPROJT,DLAGRC,DLAGRF ,
     &              DVITE ,RESE  ,VECTCC,VECTFF)
C
      ELSE
        CALL ASSERT(.FALSE.)
      ENDIF
C
C --- CALCULS - FONCTIONNALITES AVANCEES
C

C
C --- MODIFICATIONS EXCLUSION/BARSOUM/RACCORD
C
      CALL MMMVEX(NNL   ,NBCPS ,TYPBAR,TYPRAC,NDEXFR,
     &            VECTCC,VECTFF)
C
C --- ASSEMBLAGE FINAL
C
      CALL MMMVAS(NDIM  ,NNE   ,NNM   ,NNL   ,NBDM  ,
     &            NBCPS ,VECTEE,VECTMM,VECTCC,VECTFF,
     &            VTMP)
C
C --- RECUPERATION DES VECTEURS 'OUT' (A REMPLIR => MODE ECRITURE)
C
      CALL JEVECH('PVECTUR','E',JVECT )
C
C --- RECOPIE VALEURS FINALES
C
      DO 60 IDDL = 1,NDDL
        ZR(JVECT-1+IDDL) = VTMP(IDDL)
        IF (DEBUG) THEN
          IF (VTMP(IDDL).NE.0.D0) THEN
            WRITE(6,*) 'TE0365: ',IDDL,VTMP(IDDL)
          ENDIF
        ENDIF
60    CONTINUE
C
      CALL JEDEMA()
      END
