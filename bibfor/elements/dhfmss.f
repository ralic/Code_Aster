      SUBROUTINE DHFMSS(IND,VECTT,DVECTT,DHSFM,DHSS)
C            CONFIGURATION MANAGEMENT OF EDF VERSION
C MODIF ELEMENTS  DATE 17/12/2007   AUTEUR DESROCHES X.DESROCHES 
C ======================================================================
C COPYRIGHT (C) 1991 - 2007  EDF R&D                  WWW.CODE-ASTER.ORG
C THIS PROGRAM IS FREE SOFTWARE; YOU CAN REDISTRIBUTE IT AND/OR MODIFY  
C IT UNDER THE TERMS OF THE GNU GENERAL PUBLIC LICENSE AS PUBLISHED BY  
C THE FREE SOFTWARE FOUNDATION; EITHER VERSION 2 OF THE LICENSE, OR     
C (AT YOUR OPTION) ANY LATER VERSION.                                   
C                                                                       
C THIS PROGRAM IS DISTRIBUTED IN THE HOPE THAT IT WILL BE USEFUL, BUT   
C WITHOUT ANY WARRANTY; WITHOUT EVEN THE IMPLIED WARRANTY OF            
C MERCHANTABILITY OR FITNESS FOR A PARTICULAR PURPOSE. SEE THE GNU      
C GENERAL PUBLIC LICENSE FOR MORE DETAILS.                              
C                                                                       
C YOU SHOULD HAVE RECEIVED A COPY OF THE GNU GENERAL PUBLIC LICENSE     
C ALONG WITH THIS PROGRAM; IF NOT, WRITE TO EDF R&D CODE_ASTER,         
C   1 AVENUE DU GENERAL DE GAULLE, 92141 CLAMART CEDEX, FRANCE.         
C ======================================================================
C ======================================================================
C
C  CE PROGRAMME EST LA DERIVEE PAR RAPPORT A L'EPAISSEUR DE HFMSS
C
      IMPLICIT REAL*8 (A-H,O-Z)
      INTEGER IND
      REAL*8 VECTT(3,3),DVECTT(3,3)
      REAL*8 DHFM(3,6),DHS(2,6),DHSFM(3,9),DHSS(2,9)
C
C     CONSTRUCTION DE  DHFM  :  (3,6) AUX X PTS D'INTEGRATION
C                                        X= REDUIT OU NORMAL
C     (DANS L'EXPRESSION DE DHFM, PAS DE COMPOSANTES VECTT(3,K))
C
      DHFM(1,1)=2.D0*VECTT(1,1)*DVECTT(1,1)
      DHFM(1,2)=2.D0*VECTT(1,2)*DVECTT(1,2)
      DHFM(1,3)=2.D0*VECTT(1,3)*DVECTT(1,3)
      DHFM(1,4)=VECTT(1,1)*DVECTT(1,2)+DVECTT(1,1)*VECTT(1,2)
      DHFM(1,5)=VECTT(1,1)*DVECTT(1,3)+DVECTT(1,1)*VECTT(1,3)
      DHFM(1,6)=VECTT(1,2)*DVECTT(1,3)+DVECTT(1,2)*VECTT(1,3)
C
      DHFM(2,1)=2.D0*VECTT(2,1)*DVECTT(2,1)
      DHFM(2,2)=2.D0*VECTT(2,2)*DVECTT(2,2)
      DHFM(2,3)=2.D0*VECTT(2,3)*DVECTT(2,3)
      DHFM(2,4)=VECTT(2,1)*DVECTT(2,2)+DVECTT(2,1)*VECTT(2,2)
      DHFM(2,5)=VECTT(2,1)*DVECTT(2,3)+DVECTT(2,1)*VECTT(2,3)
      DHFM(2,6)=VECTT(2,2)*DVECTT(2,3)+DVECTT(2,2)*VECTT(2,3)
C
      DHFM(3,1)=2*VECTT(1,1)*DVECTT(2,1)+2*DVECTT(1,1)*VECTT(2,1)
      DHFM(3,2)=2*VECTT(1,2)*DVECTT(2,2)+2*DVECTT(1,2)*VECTT(2,2)
      DHFM(3,3)=2*VECTT(1,3)*DVECTT(2,3)+2*DVECTT(1,3)*VECTT(2,3)
      DHFM(3,4)=VECTT(2,1)*DVECTT(1,2)+DVECTT(2,1)*VECTT(1,2)
      DHFM(3,4)=DHFM(3,4)+VECTT(1,1)*DVECTT(2,2)+DVECTT(1,1)*VECTT(2,2)
      DHFM(3,5)=VECTT(2,1)*DVECTT(1,3)+DVECTT(2,1)*VECTT(1,3)
      DHFM(3,5)=DHFM(3,5)+VECTT(1,1)*DVECTT(2,3)+DVECTT(1,1)*VECTT(2,3)
      DHFM(3,6)=VECTT(2,2)*DVECTT(1,3)+DVECTT(2,2)*VECTT(1,3)
      DHFM(3,6)=DHFM(3,6)+VECTT(1,2)*DVECTT(2,3)+DVECTT(1,2)*VECTT(2,3)
C
C     CONSTRUCTION DE LA MATRICE DHFM * S : (3,9) AUX X PTS DE GAUSS
C
      DHSFM(1,1)=DHFM(1,1)
      DHSFM(1,2)=DHFM(1,4)
      DHSFM(1,3)=DHFM(1,5)
      DHSFM(1,4)=DHFM(1,4)
      DHSFM(1,5)=DHFM(1,2)
      DHSFM(1,6)=DHFM(1,6)
      DHSFM(1,7)=DHFM(1,5)
      DHSFM(1,8)=DHFM(1,6)
      DHSFM(1,9)=DHFM(1,3)
C
      DHSFM(2,1)=DHFM(2,1)
      DHSFM(2,2)=DHFM(2,4)
      DHSFM(2,3)=DHFM(2,5)
      DHSFM(2,4)=DHFM(2,4)
      DHSFM(2,5)=DHFM(2,2)
      DHSFM(2,6)=DHFM(2,6)
      DHSFM(2,7)=DHFM(2,5)
      DHSFM(2,8)=DHFM(2,6)
      DHSFM(2,9)=DHFM(2,3)
C
      DHSFM(3,1)=DHFM(3,1)
      DHSFM(3,2)=DHFM(3,4)
      DHSFM(3,3)=DHFM(3,5)
      DHSFM(3,4)=DHFM(3,4)
      DHSFM(3,5)=DHFM(3,2)
      DHSFM(3,6)=DHFM(3,6)
      DHSFM(3,7)=DHFM(3,5)
      DHSFM(3,8)=DHFM(3,6)
      DHSFM(3,9)=DHFM(3,3)
C
      IF (IND.EQ.1) THEN
C
C     CONSTRUCTION DE DHS  :  (2,6) AUX PTS D'INTEGRATION REDUITS
C
      DHS(1,1)=2*DVECTT(1,1)*VECTT(3,1)
      DHS(1,2)=2*DVECTT(1,2)*VECTT(3,2)
      DHS(1,3)=2*DVECTT(1,3)*VECTT(3,3)
      DHS(1,4)=VECTT(3,2)*DVECTT(1,1)+VECTT(3,1)*DVECTT(1,2)
      DHS(1,5)=DVECTT(1,1)*VECTT(3,3)+VECTT(3,1)*DVECTT(1,3)
      DHS(1,6)=VECTT(3,3)*DVECTT(1,2)+DVECTT(1,3)*VECTT(3,2)
C
      DHS(2,1)=2*DVECTT(2,1)*VECTT(3,1)
      DHS(2,2)=2*DVECTT(2,2)*VECTT(3,2)
      DHS(2,3)=2*VECTT(3,3)*DVECTT(2,3)
      DHS(2,4)=DVECTT(2,1)*VECTT(3,2)+VECTT(3,1)*DVECTT(2,2)
      DHS(2,5)=DVECTT(2,1)*VECTT(3,3)+VECTT(3,1)*DVECTT(2,3)
      DHS(2,6)=DVECTT(2,2)*VECTT(3,3)+DVECTT(2,3)*VECTT(3,2)
C
C     CONSTRUCTION DE LA MATRICE DHS * S : (2,9) AUX PTS
C     D'INTEGRATION REDUITS
      DHSS(1,1)=DHS(1,1)
      DHSS(1,2)=DHS(1,4)
      DHSS(1,3)=DHS(1,5)
      DHSS(1,4)=DHS(1,4)
      DHSS(1,5)=DHS(1,2)
      DHSS(1,6)=DHS(1,6)
      DHSS(1,7)=DHS(1,5)
      DHSS(1,8)=DHS(1,6)
      DHSS(1,9)=DHS(1,3)
C
      DHSS(2,1)=DHS(2,1)
      DHSS(2,2)=DHS(2,4)
      DHSS(2,3)=DHS(2,5)
      DHSS(2,4)=DHS(2,4)
      DHSS(2,5)=DHS(2,2)
      DHSS(2,6)=DHS(2,6)
      DHSS(2,7)=DHS(2,5)
      DHSS(2,8)=DHS(2,6)
      DHSS(2,9)=DHS(2,3)
C
      ENDIF
      END
