      SUBROUTINE NMNOLI(RESULT, COMPOR, PARTPS, CRITNL, DERNIE,
     &                  DEPMOI, SIGMOI, VARMOI, VARDEM, LAGDEM,
     &                  CMD,    VITPLU, ACCPLU, NBMODS, DEPENT,
     &                  VITENT, ACCENT)

C            CONFIGURATION MANAGEMENT OF EDF VERSION
C MODIF ALGORITH  DATE 10/10/2001   AUTEUR ADBHHVV V.CANO 
C ======================================================================
C COPYRIGHT (C) 1991 - 2001  EDF R&D                  WWW.CODE-ASTER.ORG
C THIS PROGRAM IS FREE SOFTWARE; YOU CAN REDISTRIBUTE IT AND/OR MODIFY
C IT UNDER THE TERMS OF THE GNU GENERAL PUBLIC LICENSE AS PUBLISHED BY
C THE FREE SOFTWARE FOUNDATION; EITHER VERSION 2 OF THE LICENSE, OR   
C (AT YOUR OPTION) ANY LATER VERSION.                                 
C
C THIS PROGRAM IS DISTRIBUTED IN THE HOPE THAT IT WILL BE USEFUL, BUT 
C WITHOUT ANY WARRANTY; WITHOUT EVEN THE IMPLIED WARRANTY OF          
C MERCHANTABILITY OR FITNESS FOR A PARTICULAR PURPOSE. SEE THE GNU    
C GENERAL PUBLIC LICENSE FOR MORE DETAILS.                            
C
C YOU SHOULD HAVE RECEIVED A COPY OF THE GNU GENERAL PUBLIC LICENSE   
C ALONG WITH THIS PROGRAM; IF NOT, WRITE TO EDF R&D CODE_ASTER,       
C    1 AVENUE DU GENERAL DE GAULLE, 92141 CLAMART CEDEX, FRANCE.      
C ======================================================================
C RESPONSABLE ADBHHVV V.CANO

      IMPLICIT NONE
      INTEGER       DERNIE, NBMODS
      CHARACTER*8  RESULT
      CHARACTER*16 CMD
      CHARACTER*19 PARTPS, CRITNL
      CHARACTER*24 COMPOR
      CHARACTER*24 VITPLU ,ACCPLU, DEPENT, VITENT, ACCENT

C ----------------------------------------------------------------------
C          STAT_NON_LINE : PREPARATION DE LA SD EVOL_NOLI
C ----------------------------------------------------------------------
C
C IN  RESULT K8  NOM DU CONCEPT RESULTAT
C IN  COMPOR K24 COMPORTEMENT
C IN  PARTPS K19 SD DISC_INST
C IN  CRITNL K19 INFORMATIONS RELATIVES A LA CONVERGENCE
C IN  DERNIE  I  NUMERO DU DERNIER NUMERO ARCHIVE (OU 0 SI NOUVEAU)
C IN  DEPMOI K24 DEPLACEMENT DE L'ETAT INITIAL
C IN  SIGMOI K24 CONTRAINTES DE L'ETAT INITIAL
C IN  VARMOI K24 VARIABLES INTERNES DE L'ETAT INITIAL
C IN  VARDEM K24 VARIABLES NON LOCALES DE L'ETAT INITIAL
C IN  LAGDEM K24 MULTIPLICATEURS DE LAGRANGE NON LOCAUX INITIAUX
C ----------------------------------------------------------------------

      INTEGER NUMARC, DINUAR
      CHARACTER*19 K19BID
      CHARACTER*24 VALINI(8), K24BLA
      CHARACTER*24 DEPMOI, SIGMOI, VARMOI, VARDEM, LAGDEM

      DATA K24BLA /' '/
C ----------------------------------------------------------------------



C -- NOUVEAU CONCEPT

      IF (DERNIE .EQ. 0) THEN

C      CREATION DE LA SD EVOL_NOLI
        CALL RSCRSD (RESULT,'EVOL_NOLI',100)
        NUMARC = DINUAR(PARTPS)

C      ARCHIVAGE DE L'ETAT INITIAL
        IF (NUMARC.EQ.0) THEN
          CALL AGGLOM (DEPMOI, SIGMOI, VARMOI, K24BLA,
     &                 VARDEM, LAGDEM, K24BLA, K24BLA, 6, VALINI)
          CALL NMIMPR('IMPR','ARCH_INIT',' ',0.D0,0)
          CALL NMARCH(RESULT, 0     , PARTPS, .TRUE., COMPOR,
     &                CRITNL, VALINI, K19BID,
     &                CMD,VITPLU,ACCPLU,NBMODS,DEPENT,VITENT,
     &                ACCENT)
        END IF


C -- CONCEPT REENTRANT

      ELSE

C      SUPPRESSION DES NUMEROS D'ARCHIVAGE A ECRASER
        NUMARC = DINUAR(PARTPS)
        CALL RSRUSD (RESULT, NUMARC)

      END IF

      END
