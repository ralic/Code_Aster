      SUBROUTINE CALFLU(CHAMNO,MODELE,MATE,NU,VECTAS,ND,NR,NV,OPT)
      IMPLICIT REAL*8  (A-H,O-Z)
      INTEGER                                        NR,ND,NV
      CHARACTER*(*)    CHAMNO,MODELE,MATE,NU,VECTAS,          OPT
C----------------------------------------------------------------------
C            CONFIGURATION MANAGEMENT OF EDF VERSION
C MODIF ALGORITH  DATE 25/03/2008   AUTEUR REZETTE C.REZETTE 
C ======================================================================
C COPYRIGHT (C) 1991 - 2001  EDF R&D                  WWW.CODE-ASTER.ORG
C THIS PROGRAM IS FREE SOFTWARE; YOU CAN REDISTRIBUTE IT AND/OR MODIFY
C IT UNDER THE TERMS OF THE GNU GENERAL PUBLIC LICENSE AS PUBLISHED BY
C THE FREE SOFTWARE FOUNDATION; EITHER VERSION 2 OF THE LICENSE, OR   
C (AT YOUR OPTION) ANY LATER VERSION.                                 
C
C THIS PROGRAM IS DISTRIBUTED IN THE HOPE THAT IT WILL BE USEFUL, BUT 
C WITHOUT ANY WARRANTY; WITHOUT EVEN THE IMPLIED WARRANTY OF          
C MERCHANTABILITY OR FITNESS FOR A PARTICULAR PURPOSE. SEE THE GNU    
C GENERAL PUBLIC LICENSE FOR MORE DETAILS.                            
C
C YOU SHOULD HAVE RECEIVED A COPY OF THE GNU GENERAL PUBLIC LICENSE   
C ALONG WITH THIS PROGRAM; IF NOT, WRITE TO EDF R&D CODE_ASTER,       
C    1 AVENUE DU GENERAL DE GAULLE, 92141 CLAMART CEDEX, FRANCE.      
C ======================================================================
C----------------------------------------------------------------------
C 
C------- CALCUL DES VECTEURS ASSEMBLES DE FLUX FLUIDES
C
C----------------------------------------------------------------------
C  IN  : K19 : CHAMNO : CHAMP AUX NOEUDS DE DEPL_R
C  IN  : K1  : OPT    : CARACTERE RELATIF A L OPTION CHOISIE
C  IN  : K8  : MODELE : MODELE FLUIDE
C  IN  : K24 : MATE   : MATERIAU THERMIQUE (PRIS POUR LE FLUIDE)
C  IN  : K14 : NU     : NUMEROTATION DES DDLS FLUIDES
C  OUT : K19 : VECTAS : CHAMNO DE FLUX FLUIDE
C  OUT : I   : ND,NR,NV : LONGUEURS DES .DESC, .REFE, .VALE
C------------------------------------------------------------------
      INTEGER       IBID
      REAL*8        R8BID
      CHARACTER*1   K1BID
      CHARACTER*24  VE
C------------------------------------------------------------------
C
C     --- CALCUL DU VECTEUR ELEMENTAIRE DE FLUX ---
C
      VE ='&&CALFLU.VE'
      CALL VECTFL(OPT,MODELE,' ',MATE,CHAMNO(1:19),R8BID,VE)
C
C     --- ASSEMBLAGE DU VECTEUR ELEMENTAIRE DE FLUX SUR LA
C                       NUMEROTATION NU DU MODELE THERMIQUE ---
C
      CALL ASSVEC('V',VECTAS,1,VE(1:19),1.0D0,NU,' ','ZERO',1)
      CALL JEDETR(VE)
C
      CALL JELIRA(VECTAS(1:19)//'.DESC','LONMAX',ND,K1BID)
      CALL JELIRA(VECTAS(1:19)//'.REFE','LONMAX',NR,K1BID)
      CALL JELIRA(VECTAS(1:19)//'.VALE','LONMAX',NV,K1BID)
C
      END
