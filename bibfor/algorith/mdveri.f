      SUBROUTINE MDVERI ()
      IMPLICIT REAL*8 (A-H,O-Z)
C ----------------------------------------------------------------------
C            CONFIGURATION MANAGEMENT OF EDF VERSION
C MODIF ALGORITH  DATE 16/01/2002   AUTEUR DURAND C.DURAND 
C ======================================================================
C COPYRIGHT (C) 1991 - 2001  EDF R&D                  WWW.CODE-ASTER.ORG
C THIS PROGRAM IS FREE SOFTWARE; YOU CAN REDISTRIBUTE IT AND/OR MODIFY
C IT UNDER THE TERMS OF THE GNU GENERAL PUBLIC LICENSE AS PUBLISHED BY
C THE FREE SOFTWARE FOUNDATION; EITHER VERSION 2 OF THE LICENSE, OR   
C (AT YOUR OPTION) ANY LATER VERSION.                                 
C
C THIS PROGRAM IS DISTRIBUTED IN THE HOPE THAT IT WILL BE USEFUL, BUT 
C WITHOUT ANY WARRANTY; WITHOUT EVEN THE IMPLIED WARRANTY OF          
C MERCHANTABILITY OR FITNESS FOR A PARTICULAR PURPOSE. SEE THE GNU    
C GENERAL PUBLIC LICENSE FOR MORE DETAILS.                            
C
C YOU SHOULD HAVE RECEIVED A COPY OF THE GNU GENERAL PUBLIC LICENSE   
C ALONG WITH THIS PROGRAM; IF NOT, WRITE TO EDF R&D CODE_ASTER,       
C    1 AVENUE DU GENERAL DE GAULLE, 92141 CLAMART CEDEX, FRANCE.      
C ======================================================================
C
C     VERIFICATION DE PREMIER NIVEAU
C ----------------------------------------------------------------------
C
      INTEGER       I,NBCHOC,NBREDE,NBREVI,NBVAL
      CHARACTER*8   NOMRES,METHOD,AMOGEN,K8BID,OUINON
      CHARACTER*16  TYPRES,NOMCMD
C
C-----------------------------------------------------------------------
C
      CALL GETRES(NOMRES,TYPRES,NOMCMD)
      CALL GETVTX(' ','METHODE' ,0,1,1,METHOD,N1)
C
      CALL GETVID(' ','AMOR_GENE',0,1,1,AMOGEN,NAGEN)
      CALL GETVR8(' ','AMOR_REDUIT',0,1,0,R8BID,NARED)
      IF (NAGEN.NE.0 .AND. METHOD.EQ.'DEVOGE') THEN
        CALL UTMESS('E',NOMCMD,'ALGORITHME DE DEVOGE: DEVELOPPEMENT'//
     +                         ' "AMOR_GENE" NON IMPLANTE.')
      ENDIF
      IF (NAGEN.EQ.0 .AND. NARED.EQ.0 .AND. METHOD(1:4).EQ.'ITMI') THEN
        CALL UTMESS('E',NOMCMD,'ALGORITHME ITMI : IL FAUT RENSEIGNER '//
     &              'OBLIGATOIREMENT L''UN OU L''AUTRE DES MOTS CLES '//
     &              '<AMOR_REDUIT>, <AMOR_GENE>')
      ENDIF
C
      IF (METHOD(1:4).EQ.'ITMI') THEN
        CALL GETVID(' ','BASE_ELAS_FLUI',0,1,0,K8BID,NBASFL)
        IF (NBASFL.EQ.0) THEN
          CALL UTMESS('E',NOMCMD,'ALGORITHME ITMI : IL FAUT '//
     &         'RENSEIGNER OBLIGATOIREMENT LES MOTS-CLES '//
     &         '<BASE_ELAS_FLUI> ET <NUME_VITE_FLUI> POUR DEFINIR '//
     &         'UNE BASE MODALE SOUS ECOULEMENT')
        ENDIF
C
        CALL GETVR8('INCREMENT','PAS',1,1,0,R8BID,NPAS)
        IF (NPAS.EQ.0) THEN
          CALL UTMESS('E',NOMCMD,'ALGORITHME ITMI : IL FAUT '//
     &         'RENSEIGNER OBLIGATOIREMENT LE MOT CLE <PAS> , I.E. '//
     &         'DONNER LA VALEUR DU PAS DE TEMPS INITIAL')
        ENDIF
C
        CALL GETVTX(' ','ETAT_STAT',0,1,1,OUINON,IBID)
        IF (OUINON(1:3).EQ.'OUI') THEN
          CALL GETVR8(' ','TS_REG_ETAB',0,1,0,R8BID,NTS)
          IF (NTS.EQ.0) THEN
            CALL UTMESS('E',NOMCMD,'ALGORITHME ITMI : LORSQUE L ON '//
     &           'AFFECTE "OUI" A <ETAT_STAT>, IL FAUT RENSEIGNER '//
     &           '<TS_REG_ETAB>')
          ENDIF
        ENDIF
C
C
        CALL GETVTX('CHOC','SOUS_STRUC_1',1,1,0,K8BID,N1)
        IF (N1.NE.0) THEN
           CALL UTMESS('E','MDVERI','CALCUL NON-LINEAIRE PAR '//
     &                 'SOUS-STRUCTURATION, OPTION <SOUS_STRUC_1>, '//
     &                 'NON IMPLANTE DANS LA METHODE ITMI.')
        ENDIF
        CALL GETVID('CHOC','NOEUD_2',1,1,0,K8BID,N1)
        IF (N1.NE.0) THEN
           CALL UTMESS('E','MDVERI',' L''OPTION <NOEUD_2> N''EST '//
     &                 'PAS IMPLANTEE DANS LA LA METHODE ITMI.')
        ENDIF
        CALL GETVTX('CHOC','SOUS_STRUC_2',1,1,0,K8BID,N1)
        IF (N1.NE.0) THEN
           CALL UTMESS('E','MDVERI','CALCUL NON-LINEAIRE PAR '//
     &                 'SOUS-STRUCTURATION, OPTION <SOUS_STRUC_2>, '//
     &                 'NON IMPLANTE DANS LA METHODE ITMI.')
        ENDIF
C
      ENDIF
C
      CALL GETFAC('RELA_EFFO_DEPL',NBREDE)
      IF ( NBREDE .NE. 0 ) THEN
        IF ( METHOD .EQ. 'NEWMARK' ) THEN
         CALL UTMESS('E',NOMCMD,'ALGORITHME DE NEWMARK: DEVELOPPEMENT'//
     +               ' "RELA_EFFO_DEPL" NON IMPLANTE.')
        ENDIF
      ENDIF
C
      CALL GETFAC('RELA_EFFO_VITE',NBREVI)
      IF ( NBREVI .NE. 0 ) THEN
        IF ( METHOD .EQ. 'NEWMARK' ) THEN
         CALL UTMESS('E',NOMCMD,'ALGORITHME DE NEWMARK: DEVELOPPEMENT'//
     +               ' "RELA_EFFO_VITE" NON IMPLANTE.')
        ENDIF
      ENDIF
C
      CALL GETFAC('CHOC',NBCHOC)
      IF (NBCHOC.NE.0) THEN
         IF (METHOD.EQ.'NEWMARK') THEN
           CALL UTMESS('E',NOMCMD,'ALGORITHME DE NEWMARK: DEVELOPPEMENT'
     +               //' "CHOC" NON IMPLANTE.')
         ENDIF
C
      ENDIF
C
      CALL GETFAC('EXCIT',NBEXC)
      KF = 0
      DO 20 I=1,NBEXC
        CALL GETVID('EXCIT','VECT_GENE',I,1,0,K8BID,NM)
        IF (NM .NE. 0) THEN
          KF = KF+1
        ENDIF
 20   CONTINUE
      IF (KF.NE.0 .AND. METHOD(1:4).EQ.'ITMI') THEN
        CALL UTMESS('E',NOMCMD, 'MAUVAISE DEFINITION DE L EXCITATION '//
     +                 ' MOT CLE : VECT_GENE NON AUTORISE POUR ITMI .')
      ENDIF
C
      END
