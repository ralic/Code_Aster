      SUBROUTINE NMAFFI(FONACT,NIVEAU,SDCONV,SDIMPR,SDERRO,
     &                  NOMBCL)
C
C            CONFIGURATION MANAGEMENT OF EDF VERSION
C MODIF ALGORITH  DATE 02/04/2012   AUTEUR ABBAS M.ABBAS 
C ======================================================================
C COPYRIGHT (C) 1991 - 2012  EDF R&D                  WWW.CODE-ASTER.ORG
C THIS PROGRAM IS FREE SOFTWARE; YOU CAN REDISTRIBUTE IT AND/OR MODIFY  
C IT UNDER THE TERMS OF THE GNU GENERAL PUBLIC LICENSE AS PUBLISHED BY  
C THE FREE SOFTWARE FOUNDATION; EITHER VERSION 2 OF THE LICENSE, OR     
C (AT YOUR OPTION) ANY LATER VERSION.                                   
C                                                                       
C THIS PROGRAM IS DISTRIBUTED IN THE HOPE THAT IT WILL BE USEFUL, BUT   
C WITHOUT ANY WARRANTY; WITHOUT EVEN THE IMPLIED WARRANTY OF            
C MERCHANTABILITY OR FITNESS FOR A PARTICULAR PURPOSE. SEE THE GNU      
C GENERAL PUBLIC LICENSE FOR MORE DETAILS.                              
C                                                                       
C YOU SHOULD HAVE RECEIVED A COPY OF THE GNU GENERAL PUBLIC LICENSE     
C ALONG WITH THIS PROGRAM; IF NOT, WRITE TO EDF R&D CODE_ASTER,         
C   1 AVENUE DU GENERAL DE GAULLE, 92141 CLAMART CEDEX, FRANCE.         
C ======================================================================
C RESPONSABLE ABBAS M.ABBAS
C
      IMPLICIT     NONE
      CHARACTER*4  NOMBCL
      CHARACTER*24 SDIMPR,SDERRO,SDCONV
      INTEGER      FONACT(*),NIVEAU
C
C ----------------------------------------------------------------------
C
C ROUTINE MECA_NON_LINE (ALGORITHME)
C
C AFFICHAGES PENDANT UNE BOUCLE
C
C ----------------------------------------------------------------------
C
C
C IN  NIVEAU : INDICATEUR D'UTILISATION DE LA BOUCLE DE POINT FIXE
C                  0     ON N'UTILISE PAS CETTE BOUCLE
C                  3     BOUCLE GEOMETRIE
C                  2     BOUCLE SEUILS DE FROTTEMENT
C                  1     BOUCLE CONTRAINTES ACTIVES
C IN  FONACT : FONCTIONNALITES ACTIVEES (VOIR NMFONC)
C IN  SDIMPR : SD AFFICHAGE
C IN  SDERRO : GESTION DES ERREURS
C IN  NOMBCL : NOM DE LA BOUCLE
C               'NEWT' - BOUCLE DE NEWTON
C               'FIXE' - BOUCLE DE POINT FIXE
C               'INST' - BOUCLE SUR LES PAS DE TEMPS
C
C --- DEBUT DECLARATIONS NORMALISEES JEVEUX ----------------------------
C
      INTEGER            ZI
      COMMON  / IVARJE / ZI(1)
      REAL*8             ZR
      COMMON  / RVARJE / ZR(1)
      COMPLEX*16         ZC
      COMMON  / CVARJE / ZC(1)
      LOGICAL            ZL
      COMMON  / LVARJE / ZL(1)
      CHARACTER*8        ZK8
      CHARACTER*16                ZK16
      CHARACTER*24                          ZK24
      CHARACTER*32                                    ZK32
      CHARACTER*80                                              ZK80
      COMMON  / KVARJE / ZK8(1) , ZK16(1) , ZK24(1) , ZK32(1) , ZK80(1)
C
C --- FIN DECLARATIONS NORMALISEES JEVEUX ------------------------------
C
      CHARACTER*16 K16BLA
      LOGICAL      LERRNE,LERRFI,LERRIN,LCRITL
      LOGICAL      CVNEWT,CVINST
      LOGICAL      LTABL,MAXREL,MAXNOD
      LOGICAL      ISFONC,LBOUCL,LEXPL
C
C ----------------------------------------------------------------------
C
      CALL JEMARQ()
C
C --- INITIALISATIONS
C
      K16BLA = ' '
      LTABL  = .FALSE.
C
C --- FONCTIONNALITES ACTIVEES
C
      LBOUCL = ISFONC(FONACT,'BOUCLE_EXTERNE')
      LEXPL  = ISFONC(FONACT,'EXPLICITE')
C
C --- CONVERGENCES
C
      CALL NMLECV(SDERRO,'NEWT',CVNEWT)
      CALL NMLECV(SDERRO,'INST',CVINST)
      CALL NMERGE(SDERRO,'RESI_MAXR',MAXREL)
      CALL NMERGE(SDERRO,'RESI_MAXN',MAXNOD)
      CALL NMERGE(SDERRO,'INTE_NPHY',LCRITL)
C
C --- AFFICHAGES DES MARQUES DANS LES COLONNES
C
      CALL NMAFFM(NIVEAU,SDERRO,SDIMPR,NOMBCL)
C
C --- ERREURS
C
      CALL NMLTEV(SDERRO,'ERRI','NEWT',LERRNE)
      CALL NMLTEV(SDERRO,'ERRI','FIXE',LERRFI)
      CALL NMLTEV(SDERRO,'ERRI','INST',LERRIN)
C
C --- DOIT-ON IMPRIMER LA LIGNE DU TABLEAU ?
C
      IF (NOMBCL.EQ.'NEWT') THEN
        IF (CVNEWT) THEN
          IF (LBOUCL) THEN
            LTABL = .FALSE.
          ELSE
            LTABL = .TRUE.
          ENDIF
        ELSE
          LTABL = .TRUE.
        ENDIF
      ELSEIF (NOMBCL.EQ.'FIXE') THEN
        IF (LBOUCL)      LTABL = .TRUE.
        IF (.NOT.CVNEWT) LTABL = .FALSE.
      ELSEIF (NOMBCL.EQ.'INST') THEN
        LTABL = .FALSE.
      ENDIF
C
C --- AFFICHAGE LIGNE DU TABLEAU DE CONVERGENCE
C
      IF (LTABL) THEN
        CALL NMIMPR(SDIMPR,'TABL',' ',K16BLA,0.D0,0)
        IF (CVNEWT.AND..NOT.(LERRNE.OR.LERRFI)) THEN
          CALL NMIMPR(SDIMPR,'IMPR','LIGNE',' ',0.D0,0)
        ENDIF
      ENDIF
C
C --- AFFICHAGE DE L'ERREUR
C
      IF (NOMBCL.EQ.'FIXE') THEN
        IF (LERRFI) THEN
          CALL NMIMPR(SDIMPR,'IMPR','LIGNE',' ',0.D0,0)
          CALL NMERIM(SDERRO)
        ENDIF
      ELSEIF (NOMBCL.EQ.'NEWT') THEN
        IF (LERRNE) THEN
          CALL NMIMPR(SDIMPR,'IMPR','LIGNE',' ',0.D0,0)
          CALL NMERIM(SDERRO)
        ENDIF
      ELSEIF (NOMBCL.EQ.'INST') THEN
        IF (LERRIN) THEN
          CALL NMERIM(SDERRO)
        ENDIF
      ENDIF
C
C --- AFFICHAGE RECAP CONVERGENCE
C
      IF (CVINST.AND..NOT.LEXPL) THEN
        CALL U2MESS('I','MECANONLINE6_60')
        IF (MAXNOD) THEN
          CALL U2MESS('I','MECANONLINE6_61')
        ENDIF
        IF (MAXREL) THEN
          CALL U2MESS('I','MECANONLINE6_62')
        ENDIF
        CALL NMIMPS(SDCONV,SDIMPR)
      ENDIF
C
      CALL JEDEMA()
      END
