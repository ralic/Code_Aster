      SUBROUTINE  NUMMOD ( NUGENE, MODMEC )
      IMPLICIT    NONE
      CHARACTER*8          MODMEC
      CHARACTER*14         NUGENE
C-----------------------------------------------------------------------
C            CONFIGURATION MANAGEMENT OF EDF VERSION
C MODIF ALGORITH  DATE 28/02/2006   AUTEUR VABHHTS J.PELLET 
C ======================================================================
C COPYRIGHT (C) 1991 - 2001  EDF R&D                  WWW.CODE-ASTER.ORG
C THIS PROGRAM IS FREE SOFTWARE; YOU CAN REDISTRIBUTE IT AND/OR MODIFY
C IT UNDER THE TERMS OF THE GNU GENERAL PUBLIC LICENSE AS PUBLISHED BY
C THE FREE SOFTWARE FOUNDATION; EITHER VERSION 2 OF THE LICENSE, OR
C (AT YOUR OPTION) ANY LATER VERSION.
C
C THIS PROGRAM IS DISTRIBUTED IN THE HOPE THAT IT WILL BE USEFUL, BUT
C WITHOUT ANY WARRANTY; WITHOUT EVEN THE IMPLIED WARRANTY OF
C MERCHANTABILITY OR FITNESS FOR A PARTICULAR PURPOSE. SEE THE GNU
C GENERAL PUBLIC LICENSE FOR MORE DETAILS.
C
C YOU SHOULD HAVE RECEIVED A COPY OF THE GNU GENERAL PUBLIC LICENSE
C ALONG WITH THIS PROGRAM; IF NOT, WRITE TO EDF R&D CODE_ASTER,
C    1 AVENUE DU GENERAL DE GAULLE, 92141 CLAMART CEDEX, FRANCE.
C ======================================================================
C***********************************************************************
C    G. JACQUART     DATE 1995
C-----------------------------------------------------------------------
C    BUT: < NUMEROTATION GENERALISEE >
C
C    DETERMINER LA NUMEROTATION GENERALISEE A PARTIR D'UN MODE_MECA
C    OU D'UN MODE_GENE
C    LA NUMEROTATION SERA PAR DEFAUT PLEINE
C
C NUGENE /I/ : NOM K14 DU NUME_DDL_GENE
C MODMEC /I/ : NOM K8 DU MODE_MECA OU DU MODE_GENE
C-----------------------------------------------------------------------
C
      INTEGER      IBID, N1, NBVECT, NBMODE
      REAL*8       RBID
      COMPLEX*16   CBID
      CHARACTER*8  K8B, TYPROF
C-----------------------------------------------------------------------
C
      CALL JEMARQ()
C
      CALL GETVIS ( ' ', 'NB_VECT' , 1,1,1, NBVECT, N1 )
      CALL GETVTX ( ' ', 'STOCKAGE', 1,1,1, TYPROF, N1 )
C
C-----RECUPERATION DU NB DE MODES DU CONCEPT MODE_MECA OU MODE_GENE
C
      CALL RSORAC ( MODMEC, 'LONUTI', IBID, RBID, K8B, CBID, RBID,
     +                                            K8B, NBMODE, 1, N1 )
C
C-----TEST NBVECT A UTILISER / NBMODE
C
      IF ( NBVECT .LE. NBMODE ) THEN
         NBMODE = NBVECT
      ELSE
         CALL UTMESS('I','NUMMOD',
     +                'NOMBRE DE VECTEURS DEMANDE TROP GRAND ON PREND '
     +                //'TOUS LES MODES DU CONCEPT MODE_MECA ')
      ENDIF
C
      CALL  NUMMO1 (NUGENE, MODMEC, NBMODE, TYPROF )
C
      CALL JEDEMA()
      END
