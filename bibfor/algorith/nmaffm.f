      SUBROUTINE NMAFFM(NIVEAU,SDERRO,SDIMPR,NOMBCL)
C
C            CONFIGURATION MANAGEMENT OF EDF VERSION
C MODIF ALGORITH  DATE 25/06/2012   AUTEUR ABBAS M.ABBAS 
C ======================================================================
C COPYRIGHT (C) 1991 - 2012  EDF R&D                  WWW.CODE-ASTER.ORG
C THIS PROGRAM IS FREE SOFTWARE; YOU CAN REDISTRIBUTE IT AND/OR MODIFY
C IT UNDER THE TERMS OF THE GNU GENERAL PUBLIC LICENSE AS PUBLISHED BY
C THE FREE SOFTWARE FOUNDATION; EITHER VERSION 2 OF THE LICENSE, OR
C (AT YOUR OPTION) ANY LATER VERSION.
C
C THIS PROGRAM IS DISTRIBUTED IN THE HOPE THAT IT WILL BE USEFUL, BUT
C WITHOUT ANY WARRANTY; WITHOUT EVEN THE IMPLIED WARRANTY OF
C MERCHANTABILITY OR FITNESS FOR A PARTICULAR PURPOSE. SEE THE GNU
C GENERAL PUBLIC LICENSE FOR MORE DETAILS.
C
C YOU SHOULD HAVE RECEIVED A COPY OF THE GNU GENERAL PUBLIC LICENSE
C ALONG WITH THIS PROGRAM; IF NOT, WRITE TO EDF R&D CODE_ASTER,
C   1 AVENUE DU GENERAL DE GAULLE, 92141 CLAMART CEDEX, FRANCE.
C ======================================================================
C RESPONSABLE ABBAS M.ABBAS
C
      IMPLICIT     NONE
      INCLUDE 'jeveux.h'
      INTEGER      NIVEAU
      CHARACTER*4  NOMBCL
      CHARACTER*24 SDIMPR,SDERRO
C
C ----------------------------------------------------------------------
C
C ROUTINE MECA_NON_LINE (ALGORITHME)
C
C AFFICHAGE DES MARQUES DANS LES COLONNES
C
C ----------------------------------------------------------------------
C
C
C IN  NIVEAU : INDICATEUR D'UTILISATION DE LA BOUCLE DE POINT FIXE
C                  0     ON N'UTILISE PAS CETTE BOUCLE
C                  3     BOUCLE GEOMETRIE
C                  2     BOUCLE SEUILS DE FROTTEMENT
C                  1     BOUCLE CONTRAINTES ACTIVES
C IN  SDERRO : SD GESTION DES ERREURS
C IN  SDIMPR : SD AFFICHAGE
C IN  NOMBCL : NOM DE LA BOUCLE
C               'RESI' - BOUCLE SUR LES RESIDUS D'EQUILIBRE
C               'NEWT' - BOUCLE DE NEWTON
C               'FIXE' - BOUCLE DE POINT FIXE
C               'INST' - BOUCLE SUR LES PAS DE TEMPS
C               'CALC' - CALCUL
C
C ----------------------------------------------------------------------
C
      LOGICAL      DVRELA,DVMAXI,DVREFE,DVCOMP
      LOGICAL      DVPFIX,DVFIXC,DVFIXF,DVFIXG,DVFROT,DVCONT,DVGEOM
      LOGICAL      DVDEBO,CVPILO
      LOGICAL      CVNEWT,LERRNE
      LOGICAL      ERCTCG,ERCTCF,ERCTCC
      CHARACTER*16 DEBORS
      REAL*8       R8BID
      INTEGER      IBID
C
C ----------------------------------------------------------------------
C
      CALL JEMARQ()
C
C --- EVENEMENTS
C
      DEBORS = ' DE BORST...    '
      CALL NMERGE(SDERRO,'DIVE_CTCC',DVCONT)
      CALL NMERGE(SDERRO,'DIVE_DEBO',DVDEBO)
      CALL NMERGE(SDERRO,'DIVE_RELA',DVRELA)
      CALL NMERGE(SDERRO,'DIVE_MAXI',DVMAXI)
      CALL NMERGE(SDERRO,'DIVE_REFE',DVREFE)
      CALL NMERGE(SDERRO,'DIVE_COMP',DVCOMP)
      CALL NMERGE(SDERRO,'DIVE_FROT',DVFROT)
      CALL NMERGE(SDERRO,'DIVE_GEOM',DVGEOM)
      CALL NMERGE(SDERRO,'DIVE_PFIX',DVPFIX)
      CALL NMERGE(SDERRO,'DIVE_FIXG',DVFIXG)
      CALL NMERGE(SDERRO,'DIVE_FIXF',DVFIXF)
      CALL NMERGE(SDERRO,'DIVE_FIXC',DVFIXC)
      CALL NMERGE(SDERRO,'CONV_PILO',CVPILO)
      CALL NMLECV(SDERRO,'NEWT',CVNEWT)
      CALL NMLTEV(SDERRO,'ERRI','NEWT',LERRNE)
      CALL NMERGE(SDERRO,'ERRE_CTCG',ERCTCG)
      CALL NMERGE(SDERRO,'ERRE_CTCF',ERCTCF)
      CALL NMERGE(SDERRO,'ERRE_CTCC',ERCTCC)
C
C --- MISE A JOUR DES MARQUES DANS LES COLONNES
C
      IF (NOMBCL.EQ.'NEWT') THEN
        CALL IMPSDM(SDIMPR,'RESI_RELA',' ')
        CALL IMPSDM(SDIMPR,'RESI_MAXI',' ')
        CALL IMPSDM(SDIMPR,'RESI_REFE',' ')
        CALL IMPSDM(SDIMPR,'RESI_COMP',' ')
        IF (DVRELA) CALL IMPSDM(SDIMPR,'RESI_RELA','X')
        IF (DVMAXI) CALL IMPSDM(SDIMPR,'RESI_MAXI','X')
        IF (DVREFE) CALL IMPSDM(SDIMPR,'RESI_REFE','X')
        IF (DVCOMP) CALL IMPSDM(SDIMPR,'RESI_COMP','X')
        CALL IMPSDM(SDIMPR,'GEOM_NEWT',' ')
        CALL IMPSDM(SDIMPR,'FROT_NEWT',' ')
        CALL IMPSDM(SDIMPR,'CONT_NEWT',' ')
        CALL IMPSDM(SDIMPR,'PILO_COEF',' ')
        CALL IMPSDM(SDIMPR,'CTCD_NBIT',' ')
        IF (DVGEOM) CALL IMPSDM(SDIMPR,'GEOM_NEWT','X')
        IF (DVFROT) CALL IMPSDM(SDIMPR,'FROT_NEWT','X')
        IF (DVCONT) CALL IMPSDM(SDIMPR,'CONT_NEWT','X')
        IF (CVPILO) CALL IMPSDM(SDIMPR,'PILO_COEF','B')
        IF (DVPFIX) CALL IMPSDM(SDIMPR,'CTCD_NBIT','X')
        CALL IMPSDM(SDIMPR,'ITER_NUME','X')
        IF (CVNEWT) CALL IMPSDM(SDIMPR,'ITER_NUME',' ')
        IF (LERRNE) CALL IMPSDM(SDIMPR,'ITER_NUME','E')
        CALL IMPSDM(SDIMPR,'BOUC_GEOM','X')
        CALL IMPSDM(SDIMPR,'BOUC_FROT','X')
        CALL IMPSDM(SDIMPR,'BOUC_CONT','X')
        IF (DVDEBO) CALL IMPSDR(SDIMPR,'DEBORST  ',DEBORS,R8BID ,IBID  )
      ELSEIF (NOMBCL.EQ.'FIXE') THEN
        CALL IMPSDM(SDIMPR,'BOUC_GEOM','X')
        CALL IMPSDM(SDIMPR,'BOUC_FROT','X')
        CALL IMPSDM(SDIMPR,'BOUC_CONT','X')
        IF (.NOT.DVFIXG) THEN
          CALL IMPSDM(SDIMPR,'BOUC_GEOM',' ')
        ENDIF
        IF (NIVEAU.EQ.1) THEN
          IF (DVFIXF.OR.DVFIXC) THEN
            CALL IMPSDM(SDIMPR,'BOUC_GEOM','X')
          ENDIF
        ENDIF
        IF ((.NOT.DVFIXF).AND.(NIVEAU.EQ.3)) THEN
          CALL IMPSDM(SDIMPR,'BOUC_FROT',' ')
        ENDIF
        IF ((.NOT.DVFIXC).AND.(NIVEAU.EQ.2)) THEN
          CALL IMPSDM(SDIMPR,'BOUC_CONT',' ')
        ENDIF
        IF (ERCTCG) CALL IMPSDM(SDIMPR,'BOUC_GEOM','E')
        IF (ERCTCF) CALL IMPSDM(SDIMPR,'BOUC_FROT','E')
        IF (ERCTCC) CALL IMPSDM(SDIMPR,'BOUC_CONT','E')
      ENDIF
C
      CALL JEDEMA()
      END
