      SUBROUTINE ELIMCO(CHAR  ,NOMA  ,NOMO  ,INDQUA,NZOCO ,
     &                  NSUCO ,NMACO ,NNOCO ,NNOQUA)
C
C            CONFIGURATION MANAGEMENT OF EDF VERSION
C MODIF MODELISA  DATE 13/10/2008   AUTEUR ABBAS M.ABBAS 
C ======================================================================
C COPYRIGHT (C) 1991 - 2001  EDF R&D                  WWW.CODE-ASTER.ORG
C THIS PROGRAM IS FREE SOFTWARE; YOU CAN REDISTRIBUTE IT AND/OR MODIFY
C IT UNDER THE TERMS OF THE GNU GENERAL PUBLIC LICENSE AS PUBLISHED BY
C THE FREE SOFTWARE FOUNDATION; EITHER VERSION 2 OF THE LICENSE, OR
C (AT YOUR OPTION) ANY LATER VERSION.
C
C THIS PROGRAM IS DISTRIBUTED IN THE HOPE THAT IT WILL BE USEFUL, BUT
C WITHOUT ANY WARRANTY; WITHOUT EVEN THE IMPLIED WARRANTY OF
C MERCHANTABILITY OR FITNESS FOR A PARTICULAR PURPOSE. SEE THE GNU
C GENERAL PUBLIC LICENSE FOR MORE DETAILS.
C
C YOU SHOULD HAVE RECEIVED A COPY OF THE GNU GENERAL PUBLIC LICENSE
C ALONG WITH THIS PROGRAM; IF NOT, WRITE TO EDF R&D CODE_ASTER,
C    1 AVENUE DU GENERAL DE GAULLE, 92141 CLAMART CEDEX, FRANCE.
C ======================================================================
C RESPONSABLE ABBAS M.ABBAS
C
      IMPLICIT     NONE
      CHARACTER*8  CHAR
      CHARACTER*8  NOMA,NOMO
      INTEGER      INDQUA
      INTEGER      NZOCO,NSUCO,NMACO,NNOCO,NNOQUA
C      
C ----------------------------------------------------------------------
C
C ROUTINE CONTACT (METHODES MAILLEES - LECTURE DONNEES)
C
C ELIMINATION AU SEIN DE CHAQUE SURFACE DE CONTACT POTENTIELLE DES
C NOEUDS ET MAILLES REDONDANTS. MODIFICATION DES POINTEURS ASSOCIES.
C      
C ----------------------------------------------------------------------
C
C 
C IN  CHAR   : NOM UTILISATEUR DU CONCEPT DE CHARGE
C IN  NOMA   : NOM DU MAILLAGE
C IN  NOMO   : NOM DU MODELE
C IN  INDQUA : VAUT 0 LORSQUE L'ON DOIT TRAITER LES NOEUDS MILIEUX
C                     A PART
C              VAUT 1 LORSQUE L'ON DOIT TRAITER LES NOEUDS MILIEUX
C                     NORMALEMENT
C IN  NZOCO  : NOMBRE DE ZONES DE CONTACT
C IN  NSUCO  : NOMBRE TOTAL DE SURFACES DE CONTACT
C I/O NMACO  : NOMBRE TOTAL DE MAILLES DES SURFACES
C I/O NNOCO  : NOMBRE TOTAL DE NOEUDS DES SURFACES
C OUT NNOQUA : NOMBRE TOTAL DE NOEUDS QUADRATIQUES DES SURFACES
C
C -------------- DEBUT DECLARATIONS NORMALISEES JEVEUX -----------------
C
      INTEGER ZI
      COMMON /IVARJE/ZI(1)
      REAL*8 ZR
      COMMON /RVARJE/ZR(1)
      COMPLEX*16 ZC
      COMMON /CVARJE/ZC(1)
      LOGICAL ZL
      COMMON /LVARJE/ZL(1)
      CHARACTER*8 ZK8
      CHARACTER*16 ZK16
      CHARACTER*24 ZK24
      CHARACTER*32 ZK32
      CHARACTER*80 ZK80
      COMMON /KVARJE/ZK8(1),ZK16(1),ZK24(1),ZK32(1),ZK80(1)
C
C ---------------- FIN DECLARATIONS NORMALISEES JEVEUX -----------------
C
      INTEGER      NNOCO0,NMACO0
      CHARACTER*24 DEFICO  
      CHARACTER*24 POINSM,LISTMA
      CHARACTER*24 POINSN,LISTNO        
      CHARACTER*24 FORMCO
      INTEGER      JFORM      
      INTEGER      FORM,IZONE      
C
C ----------------------------------------------------------------------
C
      CALL JEMARQ()
C
C --- LECTURE DES STRUCTURES DE DONNEES DE CONTACT
C 
      DEFICO = CHAR(1:8)//'.CONTACT'
      FORMCO = DEFICO(1:16)//'.FORMCO'             
      CALL JEVEUO(FORMCO,'L',JFORM)
C
C --- TYPE DE FORMULATION (DISCRETE/CONTINUE/XFEM)
C
      IZONE  = 1      
      FORM   = ZI(JFORM-1+IZONE)           
C
C --- NOMBRE INITIAL
C 
      NMACO0 = NMACO
      NNOCO0 = NNOCO 
      NNOQUA = 0      
C
C --- REPERAGE DES MAILLES REDONDANTES 
C   
      LISTMA = '&&ELIMCO.TRAVMA'
      POINSM = '&&ELIMCO.ELIMMA'     
      CALL CFLEMA(DEFICO,NSUCO  ,NMACO0,LISTMA,POINSM,
     &            NMACO )
C
C --- MISE A JOUR DE LA LISTE DES MAILLES APRES ELIMINATION
C 
      IF (NMACO0.NE.NMACO) THEN    
        CALL CFMEMA(DEFICO,NSUCO  ,NMACO0,LISTMA,POINSM,
     &              NMACO )
      ENDIF
      CALL JEDETR(LISTMA)
      CALL JEDETR(POINSM)  
C
C --- REPERAGE DES NOEUDS REDONDANTS 
C   
      LISTNO = '&&ELIMCO.TRAVNO'
      POINSN = '&&ELIMCO.ELIMNO'     
      CALL CFLENO(DEFICO,NSUCO  ,NNOCO0,LISTNO,POINSN,
     &            NNOCO )
C
C --- MISE A JOUR DE LA LISTE DES NOEUDS APRES ELIMINATION
C     
      IF (NNOCO0.NE.NNOCO) THEN
        CALL CFMENO(DEFICO,NSUCO  ,NNOCO0,LISTNO,POINSN,
     &              NNOCO ) 
      ENDIF
      CALL JEDETR(LISTNO)
      CALL JEDETR(POINSN) 
C
C --- TRAITEMENT MOT-CLEFS SPECIFIQUES FORMULATION DISCRETE
C     
      IF (FORM.EQ.1) THEN          
C
C --- CAS DES COQUES 3D (ON REPERE LE NOEUD MILIEU DES TRIA7/QUAD9)
C
        NNOCO0 = NNOCO
        CALL CFLECQ(NOMA  ,NOMO  ,DEFICO,NSUCO  ,NNOCO0,
     &              LISTNO,POINSN,NNOCO )
C
C --- MISE A JOUR DE LA LISTE DES NOEUDS APRES ELIMINATION
C     
        CALL CFMENO(DEFICO,NSUCO  ,NNOCO0,LISTNO,POINSN,
     &              NNOCO ) 
        CALL JEDETR(LISTNO)
        CALL JEDETR(POINSN)
C
C --- CAS DES QUAD8
C
        IF (INDQUA.EQ.0) THEN
          NNOCO0 = NNOCO
          CALL CFLEQ8(NOMA  ,DEFICO,NSUCO,NNOCO0,LISTNO,
     &              POINSN,NNOCO ,NNOQUA)
C
C --- MISE A JOUR DE LA LISTE DES NOEUDS APRES ELIMINATION
C     
          IF (NNOQUA.NE.0) THEN       
            CALL CFMENO(DEFICO,NSUCO  ,NNOCO0,LISTNO,POINSN,
     &                  NNOCO ) 
          ENDIF
          CALL JEDETR(LISTNO)
          CALL JEDETR(POINSN) 
        ENDIF    
      ENDIF  
C
      CALL JEDEMA()
      END
