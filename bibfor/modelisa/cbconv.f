      SUBROUTINE CBCONV(CHAR)
C            CONFIGURATION MANAGEMENT OF EDF VERSION
C MODIF MODELISA  DATE 21/09/2011   AUTEUR COURTOIS M.COURTOIS 
C ======================================================================
C COPYRIGHT (C) 1991 - 2011  EDF R&D                  WWW.CODE-ASTER.ORG
C THIS PROGRAM IS FREE SOFTWARE; YOU CAN REDISTRIBUTE IT AND/OR MODIFY
C IT UNDER THE TERMS OF THE GNU GENERAL PUBLIC LICENSE AS PUBLISHED BY
C THE FREE SOFTWARE FOUNDATION; EITHER VERSION 2 OF THE LICENSE, OR
C (AT YOUR OPTION) ANY LATER VERSION.
C
C THIS PROGRAM IS DISTRIBUTED IN THE HOPE THAT IT WILL BE USEFUL, BUT
C WITHOUT ANY WARRANTY; WITHOUT EVEN THE IMPLIED WARRANTY OF
C MERCHANTABILITY OR FITNESS FOR A PARTICULAR PURPOSE. SEE THE GNU
C GENERAL PUBLIC LICENSE FOR MORE DETAILS.
C
C YOU SHOULD HAVE RECEIVED A COPY OF THE GNU GENERAL PUBLIC LICENSE
C ALONG WITH THIS PROGRAM; IF NOT, WRITE TO EDF R&D CODE_ASTER,
C    1 AVENUE DU GENERAL DE GAULLE, 92141 CLAMART CEDEX, FRANCE.
C ======================================================================
      IMPLICIT REAL*8 (A-H,O-Z)
C
C BUT : CREATION ET CHARGEMENT DE L'OBJET 'CHAR'.CHTH.CONVE.VALE
C       CONTENANT LE NOM DU CHAMP DE VITESSE DE TRANSPORT
C       DANS LE CAS DE L'EQUATION DE DIFFUSION-CONVECTION
C
C SORTIE EN ERREUR : SI LE MOT FACTEUR CONVECTION SE TROUVE PLUS D'UNE
C                    FOIS DANS LA COMMANDE
C
C ARGUMENT D'ENTREE:
C      CHAR  : NOM UTILISATEUR DU RESULTAT DE CHARGE
C
C---------------- COMMUNS NORMALISES  JEVEUX  --------------------------
      COMMON/IVARJE/ZI(1)
      COMMON/RVARJE/ZR(1)
      COMMON/CVARJE/ZC(1)
      COMMON/LVARJE/ZL(1)
      COMMON/KVARJE/ZK8(1),ZK16(1),ZK24(1),ZK32(1),ZK80(1)
      COMMON/NOMAJE/PGC
      CHARACTER*6  PGC
      INTEGER ZI
      COMPLEX*16 ZC
      LOGICAL ZL
      REAL*8 ZR
      CHARACTER*8  ZK8,CHAR,VITESS
      CHARACTER*16 ZK16
      CHARACTER*24 ZK24
      CHARACTER*19 CARTE
      CHARACTER*32 ZK32
      CHARACTER*80 ZK80
      INTEGER      IARG
C
C     CREATION ET CHARGEMENT DE L'OBJET 'CHAR'.CHTH.CONVE
C
      CALL JEMARQ()
      VITESS = '        '
      CALL GETFAC('CONVECTION',NCONV)
      IF (NCONV.GT.1) THEN
         CALL U2MESS('F','MODELISA3_60')
      ELSE IF (NCONV.EQ.1) THEN
         CARTE = CHAR//'.CHTH.CONVE'
         CALL JECREO(CARTE//'.VALE','G V K8')
         CALL JEECRA(CARTE//'.VALE','LONMAX',1,' ')
         CALL JEVEUO (CARTE//'.VALE', 'E', IAD)
         CALL GETVID ('CONVECTION', 'VITESSE', 1,IARG, 1, VITESS,
     &      NVITES)
         ZK8(IAD-1+1) = VITESS
         CALL CHPVER('F',ZK8(IAD-1+1),'NOEU','DEPL_R',IER)
      END IF
      CALL JEDEMA()
      END
